!function(m,C){function c(e,t,n){if(n===C&&1===e.nodeType){var r="data-"+t.replace(se,"-$1").toLowerCase();if("string"==typeof(n=e.getAttribute(r))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:ae.test(n)?ye.parseJSON(n):n)}catch(e){}ye.data(e,t,n)}else n=C}return n}function u(e){var t;for(t in e)if(("data"!==t||!ye.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function s(){return!1}function n(){return!0}function i(e){return!e||!e.parentNode||11===e.parentNode.nodeType}function t(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function r(e,n,r){if(n=n||0,ye.isFunction(n))return ye.grep(e,function(e,t){return!!n.call(e,t,e)===r});if(n.nodeType)return ye.grep(e,function(e,t){return e===n===r});if("string"==typeof n){var t=ye.grep(e,function(e){return 1===e.nodeType});if(Ae.test(n))return ye.filter(n,t,!r);n=ye.filter(n,t)}return ye.grep(e,function(e,t){return 0<=ye.inArray(e,n)===r})}function y(e){var t=Fe.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}function l(e,t){if(1===t.nodeType&&ye.hasData(e)){var n,r,i,o=ye._data(e),a=ye._data(t,o),s=o.events;if(s)for(n in delete a.handle,a.events={},s)for(r=0,i=s[n].length;r<i;r++)ye.event.add(t,n,s[n][r]);a.data&&(a.data=ye.extend({},a.data))}}function f(e,t){var n;1===t.nodeType&&(t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),"object"===(n=t.nodeName.toLowerCase())?(t.parentNode&&(t.outerHTML=e.outerHTML),ye.support.html5Clone&&e.innerHTML&&!ye.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Ie.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.selected=e.defaultSelected:"input"===n||"textarea"===n?t.defaultValue=e.defaultValue:"script"===n&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(ye.expando))}function p(e){return void 0!==e.getElementsByTagName?e.getElementsByTagName("*"):void 0!==e.querySelectorAll?e.querySelectorAll("*"):[]}function v(e){Ie.test(e.type)&&(e.defaultChecked=e.checked)}function d(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=ft.length;i--;)if((t=ft[i]+n)in e)return t;return r}function b(e,t){return e=t||e,"none"===ye.css(e,"display")||!ye.contains(e.ownerDocument,e)}function e(e,t){for(var n,r,i=[],o=0,a=e.length;o<a;o++)(n=e[o]).style&&(i[o]=ye._data(n,"olddisplay"),t?(!i[o]&&"none"===n.style.display&&(n.style.display=""),""===n.style.display&&b(n)&&(i[o]=ye._data(n,"olddisplay",x(n.nodeName)))):(r=Ge(n,"display"),!i[o]&&"none"!==r&&ye._data(n,"olddisplay",r)));for(o=0;o<a;o++)(n=e[o]).style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?i[o]||"":"none"));return e}function a(e,t,n){var r=it.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function h(e,t,n,r){for(var i=n===(r?"border":"content")?4:"width"===t?1:0,o=0;i<4;i+=2)"margin"===n&&(o+=ye.css(e,n+ct[i],!0)),r?("content"===n&&(o-=parseFloat(Ge(e,"padding"+ct[i]))||0),"margin"!==n&&(o-=parseFloat(Ge(e,"border"+ct[i]+"Width"))||0)):(o+=parseFloat(Ge(e,"padding"+ct[i]))||0,"padding"!==n&&(o+=parseFloat(Ge(e,"border"+ct[i]+"Width"))||0));return o}function o(e,t,n){var r="width"===t?e.offsetWidth:e.offsetHeight,i=!0,o=ye.support.boxSizing&&"border-box"===ye.css(e,"boxSizing");if(r<=0||null==r){if(((r=Ge(e,t))<0||null==r)&&(r=e.style[t]),ot.test(r))return r;i=o&&(ye.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+h(e,t,n||(o?"border":"content"),i)+"px"}function x(e){if(st[e])return st[e];var t=ye("<"+e+">").appendTo(F.body),n=t.css("display");return t.remove(),"none"!==n&&""!==n||(Qe=F.body.appendChild(Qe||ye.extend(F.createElement("iframe"),{frameBorder:0,width:0,height:0})),Ke&&Qe.createElement||((Ke=(Qe.contentWindow||Qe.contentDocument).document).write("<!doctype html><html><body>"),Ke.close()),t=Ke.body.appendChild(Ke.createElement(e)),n=Ge(t,"display"),F.body.removeChild(Qe)),st[e]=n}function g(n,e,r,i){var t;if(ye.isArray(e))ye.each(e,function(e,t){r||ht.test(n)?i(n,t):g(n+"["+("object"==typeof t?e:"")+"]",t,r,i)});else if(r||"object"!==ye.type(e))i(n,e);else for(t in e)g(n+"["+t+"]",e[t],r,i)}function w(s){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r,i=e.toLowerCase().split(U),o=0,a=i.length;if(ye.isFunction(t))for(;o<a;o++)n=i[o],(r=/^\+/.test(n))&&(n=n.substr(1)||"*"),(s[n]=s[n]||[])[r?"unshift":"push"](t)}}function k(e,t,n,r,i,o){(o=o||{})[i=i||t.dataTypes[0]]=!0;for(var a,s=e[i],l=0,u=s?s.length:0,c=e===jt;l<u&&(c||!a);l++)"string"==typeof(a=s[l](t,n,r))&&(a=!c||o[a]?C:(t.dataTypes.unshift(a),k(e,t,n,r,a,o)));return(c||!a)&&!o["*"]&&(a=k(e,t,n,r,"*",o)),a}function T(e,t){var n,r,i=ye.ajaxSettings.flatOptions||{};for(n in t)t[n]!==C&&((i[n]?e:r||(r={}))[n]=t[n]);r&&ye.extend(!0,e,r)}function N(){try{return new m.XMLHttpRequest}catch(e){}}function E(){return setTimeout(function(){Pt=C},0),Pt=ye.now()}function S(o,e,t){var n,a,r,i=0,s=Xt.length,l=ye.Deferred().always(function(){delete u.elem}),u=function(){for(var e=Pt||E(),t=Math.max(0,c.startTime+c.duration-e),n=1-(t/c.duration||0),r=0,i=c.tweens.length;r<i;r++)c.tweens[r].run(n);return l.notifyWith(o,[c,n,t]),n<1&&i?t:(l.resolveWith(o,[c]),!1)},c=l.promise({elem:o,props:ye.extend({},e),opts:ye.extend(!0,{specialEasing:{}},t),originalProperties:e,originalOptions:t,startTime:Pt||E(),duration:t.duration,tweens:[],createTween:function(e,t,n){var r=ye.Tween(o,c.opts,e,t,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(r),r},stop:function(e){for(var t=0,n=e?c.tweens.length:0;t<n;t++)c.tweens[t].run(1);return e?l.resolveWith(o,[c,e]):l.rejectWith(o,[c,e]),this}}),f=c.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(r=ye.camelCase(n),i=t[r],o=e[n],ye.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=ye.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(f,c.opts.specialEasing);i<s;i++)if(n=Xt[i].call(c,o,f,c.opts))return n;return a=c,r=f,ye.each(r,function(e,t){for(var n=(Ut[e]||[]).concat(Ut["*"]),r=0,i=n.length;r<i;r++)if(n[r].call(a,e,t))return}),ye.isFunction(c.opts.start)&&c.opts.start.call(o,c),ye.fx.timer(ye.extend(u,{anim:c,queue:c.opts.queue,elem:o})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function A(e,t,n,r,i){return new A.prototype.init(e,t,n,r,i)}function j(e,t){var n,r={height:e},i=0;for(t=t?1:0;i<4;i+=2-t)r["margin"+(n=ct[i])]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function D(e){return ye.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}var L,H,F=m.document,M=m.location,O=m.navigator,_=m.jQuery,q=m.$,B=Array.prototype.push,W=Array.prototype.slice,P=Array.prototype.indexOf,R=Object.prototype.toString,$=Object.prototype.hasOwnProperty,I=String.prototype.trim,ye=function(e,t){return new ye.fn.init(e,t,L)},z=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,X=/\S/,U=/\s+/,Y=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,V=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,J=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,G=/^[\],:{}\s]*$/,Q=/(?:^|:|,)(?:\s*\[)+/g,K=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,Z=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,ee=/^-ms-/,te=/-([\da-z])/gi,ne=function(e,t){return(t+"").toUpperCase()},re=function(){F.addEventListener?(F.removeEventListener("DOMContentLoaded",re,!1),ye.ready()):"complete"===F.readyState&&(F.detachEvent("onreadystatechange",re),ye.ready())},ie={};ye.fn=ye.prototype={constructor:ye,init:function(e,t,n){var r,i,o;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if("string"!=typeof e)return ye.isFunction(e)?n.ready(e):(e.selector!==C&&(this.selector=e.selector,this.context=e.context),ye.makeArray(e,this));if(!(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&3<=e.length?[null,e,null]:V.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1])return o=(t=t instanceof ye?t[0]:t)&&t.nodeType?t.ownerDocument||t:F,e=ye.parseHTML(r[1],o,!0),J.test(r[1])&&ye.isPlainObject(t)&&this.attr.call(e,t,!0),ye.merge(this,e);if((i=F.getElementById(r[2]))&&i.parentNode){if(i.id!==r[2])return n.find(e);this.length=1,this[0]=i}return this.context=F,this.selector=e,this},selector:"",jquery:"1.8.3",length:0,size:function(){return this.length},toArray:function(){return W.call(this)},get:function(e){return null==e?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e,t,n){var r=ye.merge(this.constructor(),e);return r.prevObject=this,r.context=this.context,"find"===t?r.selector=this.selector+(this.selector?" ":"")+n:t&&(r.selector=this.selector+"."+t+"("+n+")"),r},each:function(e,t){return ye.each(this,e,t)},ready:function(e){return ye.ready.promise().done(e),this},eq:function(e){return-1===(e=+e)?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(W.apply(this,arguments),"slice",W.call(arguments).join(","))},map:function(n){return this.pushStack(ye.map(this,function(e,t){return n.call(e,t,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:B,sort:[].sort,splice:[].splice},ye.fn.init.prototype=ye.fn,ye.extend=ye.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,l=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[1]||{},s=2),"object"!=typeof a&&!ye.isFunction(a)&&(a={}),l===s&&(a=this,--s);s<l;s++)if(null!=(e=arguments[s]))for(t in e)n=a[t],a!==(r=e[t])&&(u&&r&&(ye.isPlainObject(r)||(i=ye.isArray(r)))?(o=i?(i=!1,n&&ye.isArray(n)?n:[]):n&&ye.isPlainObject(n)?n:{},a[t]=ye.extend(u,o,r)):r!==C&&(a[t]=r));return a},ye.extend({noConflict:function(e){return m.$===ye&&(m.$=q),e&&m.jQuery===ye&&(m.jQuery=_),ye},isReady:!1,readyWait:1,holdReady:function(e){e?ye.readyWait++:ye.ready(!0)},ready:function(e){if(!0===e?!--ye.readyWait:!ye.isReady){if(!F.body)return setTimeout(ye.ready,1);(ye.isReady=!0)!==e&&0<--ye.readyWait||(H.resolveWith(F,[ye]),ye.fn.trigger&&ye(F).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===ye.type(e)},isArray:Array.isArray||function(e){return"array"===ye.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):ie[R.call(e)]||"object"},isPlainObject:function(e){if(!e||"object"!==ye.type(e)||e.nodeType||ye.isWindow(e))return!1;try{if(e.constructor&&!$.call(e,"constructor")&&!$.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}var t;for(t in e);return t===C||$.call(e,t)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){var r;return e&&"string"==typeof e?("boolean"==typeof t&&(n=t,t=0),t=t||F,(r=J.exec(e))?[t.createElement(r[1])]:(r=ye.buildFragment([e],t,n?null:[]),ye.merge([],(r.cacheable?ye.clone(r.fragment):r.fragment).childNodes))):null},parseJSON:function(e){return e&&"string"==typeof e?(e=ye.trim(e),m.JSON&&m.JSON.parse?m.JSON.parse(e):G.test(e.replace(K,"@").replace(Z,"]").replace(Q,""))?new Function("return "+e)():void ye.error("Invalid JSON: "+e)):null},parseXML:function(e){var t;if(!e||"string"!=typeof e)return null;try{m.DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e))}catch(e){t=C}return(!t||!t.documentElement||t.getElementsByTagName("parsererror").length)&&ye.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(e){e&&X.test(e)&&(m.execScript||function(e){m.eval.call(m,e)})(e)},camelCase:function(e){return e.replace(ee,"ms-").replace(te,ne)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,a=o===C||ye.isFunction(e);if(n)if(a){for(r in e)if(!1===t.apply(e[r],n))break}else for(;i<o&&!1!==t.apply(e[i++],n););else if(a){for(r in e)if(!1===t.call(e[r],r,e[r]))break}else for(;i<o&&!1!==t.call(e[i],i,e[i++]););return e},trim:I&&!I.call("\ufeffÂ ")?function(e){return null==e?"":I.call(e)}:function(e){return null==e?"":(e+"").replace(Y,"")},makeArray:function(e,t){var n,r=t||[];return null!=e&&(n=ye.type(e),null==e.length||"string"===n||"function"===n||"regexp"===n||ye.isWindow(e)?B.call(r,e):ye.merge(r,e)),r},inArray:function(e,t,n){var r;if(t){if(P)return P.call(t,e,n);for(r=t.length,n=n?n<0?Math.max(0,r+n):n:0;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){var n=t.length,r=e.length,i=0;if("number"==typeof n)for(;i<n;i++)e[r++]=t[i];else for(;t[i]!==C;)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){var r=[],i=0,o=e.length;for(n=!!n;i<o;i++)n!==!!t(e[i],i)&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=[],a=0,s=e.length;if(e instanceof ye||s!==C&&"number"==typeof s&&(0<s&&e[0]&&e[s-1]||0===s||ye.isArray(e)))for(;a<s;a++)null!=(r=t(e[a],a,n))&&(o[o.length]=r);else for(i in e)null!=(r=t(e[i],i,n))&&(o[o.length]=r);return o.concat.apply([],o)},guid:1,proxy:function(e,t){var n,r,i;return"string"==typeof t&&(n=e[t],t=e,e=n),ye.isFunction(e)?(r=W.call(arguments,2),(i=function(){return e.apply(t,r.concat(W.call(arguments)))}).guid=e.guid=e.guid||ye.guid++,i):C},access:function(e,t,n,r,i,o,a){var s,l=null==n,u=0,c=e.length;if(n&&"object"==typeof n){for(u in n)ye.access(e,t,u,n[u],1,o,r);i=1}else if(r!==C){if(s=a===C&&ye.isFunction(r),l&&(t=s?(s=t,function(e,t,n){return s.call(ye(e),n)}):(t.call(e,r),null)),t)for(;u<c;u++)t(e[u],n,s?r.call(e[u],u,t(e[u],n)):r,a);i=1}return i?e:l?t.call(e):c?t(e[0],n):o},now:function(){return(new Date).getTime()}}),ye.ready.promise=function(e){if(!H)if(H=ye.Deferred(),"complete"===F.readyState)setTimeout(ye.ready,1);else if(F.addEventListener)F.addEventListener("DOMContentLoaded",re,!1),m.addEventListener("load",ye.ready,!1);else{F.attachEvent("onreadystatechange",re),m.attachEvent("onload",ye.ready);var n=!1;try{n=null==m.frameElement&&F.documentElement}catch(e){}n&&n.doScroll&&function t(){if(!ye.isReady){try{n.doScroll("left")}catch(e){return setTimeout(t,50)}ye.ready()}}()}return H.promise(e)},ye.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){ie["[object "+t+"]"]=t.toLowerCase()}),L=ye(F);var oe={};ye.Callbacks=function(i){var e,n;i="string"==typeof i?oe[i]||(n=oe[e=i]={},ye.each(e.split(U),function(e,t){n[t]=!0}),n):ye.extend({},i);var t,r,o,a,s,l,u=[],c=!i.once&&[],f=function(e){for(t=i.memory&&e,r=!0,l=a||0,a=0,s=u.length,o=!0;u&&l<s;l++)if(!1===u[l].apply(e[0],e[1])&&i.stopOnFalse){t=!1;break}o=!1,u&&(c?c.length&&f(c.shift()):t?u=[]:p.disable())},p={add:function(){if(u){var e=u.length;(function r(e){ye.each(e,function(e,t){var n=ye.type(t);"function"===n?(!i.unique||!p.has(t))&&u.push(t):t&&t.length&&"string"!==n&&r(t)})})(arguments),o?s=u.length:t&&(a=e,f(t))}return this},remove:function(){return u&&ye.each(arguments,function(e,t){for(var n;-1<(n=ye.inArray(t,u,n));)u.splice(n,1),o&&(n<=s&&s--,n<=l&&l--)}),this},has:function(e){return-1<ye.inArray(e,u)},empty:function(){return u=[],this},disable:function(){return u=c=t=C,this},disabled:function(){return!u},lock:function(){return c=C,t||p.disable(),this},locked:function(){return!c},fireWith:function(e,t){return t=[e,(t=t||[]).slice?t.slice():t],u&&(!r||c)&&(o?c.push(t):f(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!r}};return p},ye.extend({Deferred:function(e){var a=[["resolve","done",ye.Callbacks("once memory"),"resolved"],["reject","fail",ye.Callbacks("once memory"),"rejected"],["notify","progress",ye.Callbacks("memory")]],i="pending",o={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var o=arguments;return ye.Deferred(function(i){ye.each(a,function(e,t){var n=t[0],r=o[e];s[t[1]](ye.isFunction(r)?function(){var e=r.apply(this,arguments);e&&ye.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[n+"With"](this===s?i:this,[e])}:i[n])}),o=null}).promise()},promise:function(e){return null!=e?ye.extend(e,o):o}},s={};return o.pipe=o.then,ye.each(a,function(e,t){var n=t[2],r=t[3];o[t[1]]=n.add,r&&n.add(function(){i=r},a[1^e][2].disable,a[2][2].lock),s[t[0]]=n.fire,s[t[0]+"With"]=n.fireWith}),o.promise(s),e&&e.call(s,s),s},when:function(e){var i,t,n,r=0,o=W.call(arguments),a=o.length,s=1!==a||e&&ye.isFunction(e.promise)?a:0,l=1===s?e:ye.Deferred(),u=function(t,n,r){return function(e){n[t]=this,r[t]=1<arguments.length?W.call(arguments):e,r===i?l.notifyWith(n,r):--s||l.resolveWith(n,r)}};if(1<a)for(i=new Array(a),t=new Array(a),n=new Array(a);r<a;r++)o[r]&&ye.isFunction(o[r].promise)?o[r].promise().done(u(r,n,o)).fail(l.reject).progress(u(r,t,i)):--s;return s||l.resolveWith(n,o),l.promise()}}),ye.support=function(){var a,e,t,n,r,i,o,s,l,u,c,f=F.createElement("div");if(f.setAttribute("className","t"),f.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=f.getElementsByTagName("*"),t=f.getElementsByTagName("a")[0],!e||!t||!e.length)return{};r=(n=F.createElement("select")).appendChild(F.createElement("option")),i=f.getElementsByTagName("input")[0],t.style.cssText="top:1px;float:left;opacity:.5",a={leadingWhitespace:3===f.firstChild.nodeType,tbody:!f.getElementsByTagName("tbody").length,htmlSerialize:!!f.getElementsByTagName("link").length,style:/top/.test(t.getAttribute("style")),hrefNormalized:"/a"===t.getAttribute("href"),opacity:/^0.5/.test(t.style.opacity),cssFloat:!!t.style.cssFloat,checkOn:"on"===i.value,optSelected:r.selected,getSetAttribute:"t"!==f.className,enctype:!!F.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==F.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===F.compatMode,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},i.checked=!0,a.noCloneChecked=i.cloneNode(!0).checked,n.disabled=!0,a.optDisabled=!r.disabled;try{delete f.test}catch(e){a.deleteExpando=!1}if(!f.addEventListener&&f.attachEvent&&f.fireEvent&&(f.attachEvent("onclick",c=function(){a.noCloneEvent=!1}),f.cloneNode(!0).fireEvent("onclick"),f.detachEvent("onclick",c)),(i=F.createElement("input")).value="t",i.setAttribute("type","radio"),a.radioValue="t"===i.value,i.setAttribute("checked","checked"),i.setAttribute("name","t"),f.appendChild(i),(o=F.createDocumentFragment()).appendChild(f.lastChild),a.checkClone=o.cloneNode(!0).cloneNode(!0).lastChild.checked,a.appendChecked=i.checked,o.removeChild(i),o.appendChild(f),f.attachEvent)for(l in{submit:!0,change:!0,focusin:!0})(u=(s="on"+l)in f)||(f.setAttribute(s,"return;"),u="function"==typeof f[s]),a[l+"Bubbles"]=u;return ye(function(){var e,t,n,r,i="padding:0;margin:0;border:0;display:block;overflow:hidden;",o=F.getElementsByTagName("body")[0];o&&((e=F.createElement("div")).style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",o.insertBefore(e,o.firstChild),t=F.createElement("div"),e.appendChild(t),t.innerHTML="<table><tr><td></td><td>t</td></tr></table>",(n=t.getElementsByTagName("td"))[0].style.cssText="padding:0;margin:0;border:0;display:none",u=0===n[0].offsetHeight,n[0].style.display="",n[1].style.display="none",a.reliableHiddenOffsets=u&&0===n[0].offsetHeight,t.innerHTML="",t.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",a.boxSizing=4===t.offsetWidth,a.doesNotIncludeMarginInBodyOffset=1!==o.offsetTop,m.getComputedStyle&&(a.pixelPosition="1%"!==(m.getComputedStyle(t,null)||{}).top,a.boxSizingReliable="4px"===(m.getComputedStyle(t,null)||{width:"4px"}).width,(r=F.createElement("div")).style.cssText=t.style.cssText=i,r.style.marginRight=r.style.width="0",t.style.width="1px",t.appendChild(r),a.reliableMarginRight=!parseFloat((m.getComputedStyle(r,null)||{}).marginRight)),void 0!==t.style.zoom&&(t.innerHTML="",t.style.cssText=i+"width:1px;padding:1px;display:inline;zoom:1",a.inlineBlockNeedsLayout=3===t.offsetWidth,t.style.display="block",t.style.overflow="visible",t.innerHTML="<div></div>",t.firstChild.style.width="5px",a.shrinkWrapBlocks=3!==t.offsetWidth,e.style.zoom=1),o.removeChild(e),e=t=n=r=null)}),o.removeChild(f),e=t=n=r=i=o=f=null,a}();var ae=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,se=/([A-Z])/g;ye.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(ye.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return!!(e=e.nodeType?ye.cache[e[ye.expando]]:e[ye.expando])&&!u(e)},data:function(e,t,n,r){if(ye.acceptData(e)){var i,o,a=ye.expando,s="string"==typeof t,l=e.nodeType,u=l?ye.cache:e,c=l?e[a]:e[a]&&a;if(c&&u[c]&&(r||u[c].data)||!s||n!==C)return c||(l?e[a]=c=ye.deletedIds.pop()||ye.guid++:c=a),u[c]||(u[c]={},l||(u[c].toJSON=ye.noop)),"object"!=typeof t&&"function"!=typeof t||(r?u[c]=ye.extend(u[c],t):u[c].data=ye.extend(u[c].data,t)),i=u[c],r||(i.data||(i.data={}),i=i.data),n!==C&&(i[ye.camelCase(t)]=n),s?null==(o=i[t])&&(o=i[ye.camelCase(t)]):o=i,o}},removeData:function(e,t,n){if(ye.acceptData(e)){var r,i,o,a=e.nodeType,s=a?ye.cache:e,l=a?e[ye.expando]:ye.expando;if(s[l]){if(t&&(r=n?s[l]:s[l].data)){ye.isArray(t)||(t=t in r?[t]:(t=ye.camelCase(t))in r?[t]:t.split(" "));for(i=0,o=t.length;i<o;i++)delete r[t[i]];if(!(n?u:ye.isEmptyObject)(r))return}(n||(delete s[l].data,u(s[l])))&&(a?ye.cleanData([e],!0):ye.support.deleteExpando||s!=s.window?delete s[l]:s[l]=null)}}},_data:function(e,t,n){return ye.data(e,t,n,!0)},acceptData:function(e){var t=e.nodeName&&ye.noData[e.nodeName.toLowerCase()];return!t||!0!==t&&e.getAttribute("classid")===t}}),ye.fn.extend({data:function(n,e){var r,i,t,o,a,s=this[0],l=0,u=null;if(n!==C)return"object"==typeof n?this.each(function(){ye.data(this,n)}):((r=n.split(".",2))[1]=r[1]?"."+r[1]:"",i=r[1]+"!",ye.access(this,function(t){if(t===C)return(u=this.triggerHandler("getData"+i,[r[0]]))===C&&s&&(u=ye.data(s,n),u=c(s,n,u)),u===C&&r[1]?this.data(r[0]):u;r[1]=t,this.each(function(){var e=ye(this);e.triggerHandler("setData"+i,r),ye.data(this,n,t),e.triggerHandler("changeData"+i,r)})},null,e,1<arguments.length,null,!1));if(this.length&&(u=ye.data(s),1===s.nodeType&&!ye._data(s,"parsedAttrs"))){for(a=(t=s.attributes).length;l<a;l++)(o=t[l].name).indexOf("data-")||(o=ye.camelCase(o.substring(5)),c(s,o,u[o]));ye._data(s,"parsedAttrs",!0)}return u},removeData:function(e){return this.each(function(){ye.removeData(this,e)})}}),ye.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=ye._data(e,t),n&&(!r||ye.isArray(n)?r=ye._data(e,t,ye.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=ye.queue(e,t),r=n.length,i=n.shift(),o=ye._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){ye.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return ye._data(e,n)||ye._data(e,n,{empty:ye.Callbacks("once memory").add(function(){ye.removeData(e,t+"queue",!0),ye.removeData(e,n,!0)})})}}),ye.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?ye.queue(this[0],t):n===C?this:this.each(function(){var e=ye.queue(this,t,n);ye._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&ye.dequeue(this,t)})},dequeue:function(e){return this.each(function(){ye.dequeue(this,e)})},delay:function(r,e){return r=ye.fx&&ye.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=setTimeout(e,r);t.stop=function(){clearTimeout(n)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=ye.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=C),e=e||"fx";a--;)(n=ye._data(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var le,ue,ce,fe=/[\t\r\n]/g,pe=/\r/g,de=/^(?:button|input)$/i,he=/^(?:button|input|object|select|textarea)$/i,ge=/^a(?:rea|)$/i,me=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,ve=ye.support.getSetAttribute;ye.fn.extend({attr:function(e,t){return ye.access(this,ye.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){ye.removeAttr(this,e)})},prop:function(e,t){return ye.access(this,ye.prop,e,t,1<arguments.length)},removeProp:function(e){return e=ye.propFix[e]||e,this.each(function(){try{this[e]=C,delete this[e]}catch(e){}})},addClass:function(t){var e,n,r,i,o,a,s;if(ye.isFunction(t))return this.each(function(e){ye(this).addClass(t.call(this,e,this.className))});if(t&&"string"==typeof t)for(e=t.split(U),n=0,r=this.length;n<r;n++)if(1===(i=this[n]).nodeType)if(i.className||1!==e.length){for(o=" "+i.className+" ",a=0,s=e.length;a<s;a++)o.indexOf(" "+e[a]+" ")<0&&(o+=e[a]+" ");i.className=ye.trim(o)}else i.className=t;return this},removeClass:function(t){var e,n,r,i,o,a,s;if(ye.isFunction(t))return this.each(function(e){ye(this).removeClass(t.call(this,e,this.className))});if(t&&"string"==typeof t||t===C)for(e=(t||"").split(U),a=0,s=this.length;a<s;a++)if(1===(r=this[a]).nodeType&&r.className){for(n=(" "+r.className+" ").replace(fe," "),i=0,o=e.length;i<o;i++)for(;0<=n.indexOf(" "+e[i]+" ");)n=n.replace(" "+e[i]+" "," ");r.className=t?ye.trim(n):""}return this},toggleClass:function(o,a){var s=typeof o,l="boolean"==typeof a;return ye.isFunction(o)?this.each(function(e){ye(this).toggleClass(o.call(this,e,this.className,a),a)}):this.each(function(){if("string"===s)for(var e,t=0,n=ye(this),r=a,i=o.split(U);e=i[t++];)r=l?r:!n.hasClass(e),n[r?"addClass":"removeClass"](e);else"undefined"!==s&&"boolean"!==s||(this.className&&ye._data(this,"__className__",this.className),this.className=this.className||!1===o?"":ye._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,r=this.length;n<r;n++)if(1===this[n].nodeType&&0<=(" "+this[n].className+" ").replace(fe," ").indexOf(t))return!0;return!1},val:function(r){var i,e,o,t=this[0];return arguments.length?(o=ye.isFunction(r),this.each(function(e){var t,n=ye(this);1===this.nodeType&&(null==(t=o?r.call(this,e,n.val()):r)?t="":"number"==typeof t?t+="":ye.isArray(t)&&(t=ye.map(t,function(e){return null==e?"":e+""})),(i=ye.valHooks[this.type]||ye.valHooks[this.nodeName.toLowerCase()])&&"set"in i&&i.set(this,t,"value")!==C||(this.value=t))})):t?(i=ye.valHooks[t.type]||ye.valHooks[t.nodeName.toLowerCase()])&&"get"in i&&(e=i.get(t,"value"))!==C?e:"string"==typeof(e=t.value)?e.replace(pe,""):null==e?"":e:void 0}}),ye.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){for(var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||i<0,a=o?null:[],s=o?i+1:r.length,l=i<0?s:o?i:0;l<s;l++)if(((n=r[l]).selected||l===i)&&(ye.support.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!ye.nodeName(n.parentNode,"optgroup"))){if(t=ye(n).val(),o)return t;a.push(t)}return a},set:function(e,t){var n=ye.makeArray(t);return ye(e).find("option").each(function(){this.selected=0<=ye.inArray(ye(this).val(),n)}),n.length||(e.selectedIndex=-1),n}}},attrFn:{},attr:function(e,t,n,r){var i,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return r&&ye.isFunction(ye.fn[t])?ye(e)[t](n):void 0===e.getAttribute?ye.prop(e,t,n):((a=1!==s||!ye.isXMLDoc(e))&&(t=t.toLowerCase(),o=ye.attrHooks[t]||(me.test(t)?ue:le)),n!==C?null===n?void ye.removeAttr(e,t):o&&"set"in o&&a&&(i=o.set(e,n,t))!==C?i:(e.setAttribute(t,n+""),n):o&&"get"in o&&a&&null!==(i=o.get(e,t))?i:null===(i=e.getAttribute(t))?C:i)},removeAttr:function(e,t){var n,r,i,o,a=0;if(t&&1===e.nodeType)for(r=t.split(U);a<r.length;a++)(i=r[a])&&(n=ye.propFix[i]||i,(o=me.test(i))||ye.attr(e,i,""),e.removeAttribute(ve?i:n),o&&n in e&&(e[n]=!1))},attrHooks:{type:{set:function(e,t){if(de.test(e.nodeName)&&e.parentNode)ye.error("type property can't be changed");else if(!ye.support.radioValue&&"radio"===t&&ye.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return le&&ye.nodeName(e,"button")?le.get(e,t):t in e?e.value:null},set:function(e,t,n){if(le&&ye.nodeName(e,"button"))return le.set(e,t,n);e.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,t,n){var r,i,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return(1!==o||!ye.isXMLDoc(e))&&(t=ye.propFix[t]||t,i=ye.propHooks[t]),n!==C?i&&"set"in i&&(r=i.set(e,n,t))!==C?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=e.getAttributeNode("tabindex");return t&&t.specified?parseInt(t.value,10):he.test(e.nodeName)||ge.test(e.nodeName)&&e.href?0:C}}}}),ue={get:function(e,t){var n,r=ye.prop(e,t);return!0===r||"boolean"!=typeof r&&(n=e.getAttributeNode(t))&&!1!==n.nodeValue?t.toLowerCase():C},set:function(e,t,n){var r;return!1===t?ye.removeAttr(e,n):((r=ye.propFix[n]||n)in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},ve||(ce={name:!0,id:!0,coords:!0},le=ye.valHooks.button={get:function(e,t){var n;return(n=e.getAttributeNode(t))&&(ce[t]?""!==n.value:n.specified)?n.value:C},set:function(e,t,n){var r=e.getAttributeNode(n);return r||(r=F.createAttribute(n),e.setAttributeNode(r)),r.value=t+""}},ye.each(["width","height"],function(e,n){ye.attrHooks[n]=ye.extend(ye.attrHooks[n],{set:function(e,t){if(""===t)return e.setAttribute(n,"auto"),t}})}),ye.attrHooks.contenteditable={get:le.get,set:function(e,t,n){""===t&&(t="false"),le.set(e,t,n)}}),ye.support.hrefNormalized||ye.each(["href","src","width","height"],function(e,n){ye.attrHooks[n]=ye.extend(ye.attrHooks[n],{get:function(e){var t=e.getAttribute(n,2);return null===t?C:t}})}),ye.support.style||(ye.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||C},set:function(e,t){return e.style.cssText=t+""}}),ye.support.optSelected||(ye.propHooks.selected=ye.extend(ye.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),ye.support.enctype||(ye.propFix.enctype="encoding"),ye.support.checkOn||ye.each(["radio","checkbox"],function(){ye.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),ye.each(["radio","checkbox"],function(){ye.valHooks[this]=ye.extend(ye.valHooks[this],{set:function(e,t){if(ye.isArray(t))return e.checked=0<=ye.inArray(ye(e).val(),t)}})});var be=/^(?:textarea|input|select)$/i,xe=/^([^\.]*|)(?:\.(.+)|)$/,we=/(?:^|\s)hover(\.\S+|)\b/,Te=/^key/,Ne=/^(?:mouse|contextmenu)|click/,Ce=/^(?:focusinfocus|focusoutblur)$/,ke=function(e){return ye.event.special.hover?e:e.replace(we,"mouseenter$1 mouseleave$1")};ye.event={add:function(e,t,n,r,i){var o,a,s,l,u,c,f,p,d,h,g;if(3!==e.nodeType&&8!==e.nodeType&&t&&n&&(o=ye._data(e))){for(n.handler&&(n=(d=n).handler,i=d.selector),n.guid||(n.guid=ye.guid++),(s=o.events)||(o.events=s={}),(a=o.handle)||(o.handle=a=function(e){return void 0===ye||e&&ye.event.triggered===e.type?C:ye.event.dispatch.apply(a.elem,arguments)},a.elem=e),t=ye.trim(ke(t)).split(" "),l=0;l<t.length;l++)c=(u=xe.exec(t[l])||[])[1],f=(u[2]||"").split(".").sort(),g=ye.event.special[c]||{},c=(i?g.delegateType:g.bindType)||c,g=ye.event.special[c]||{},p=ye.extend({type:c,origType:u[1],data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&ye.expr.match.needsContext.test(i),namespace:f.join(".")},d),(h=s[c])||((h=s[c]=[]).delegateCount=0,g.setup&&!1!==g.setup.call(e,r,f,a)||(e.addEventListener?e.addEventListener(c,a,!1):e.attachEvent&&e.attachEvent("on"+c,a))),g.add&&(g.add.call(e,p),p.handler.guid||(p.handler.guid=n.guid)),i?h.splice(h.delegateCount++,0,p):h.push(p),ye.event.global[c]=!0;e=null}},global:{},remove:function(e,t,n,r,i){var o,a,s,l,u,c,f,p,d,h,g,m=ye.hasData(e)&&ye._data(e);if(m&&(p=m.events)){for(t=ye.trim(ke(t||"")).split(" "),o=0;o<t.length;o++)if(s=l=(a=xe.exec(t[o])||[])[1],u=a[2],s){for(d=ye.event.special[s]||{},c=(h=p[s=(r?d.delegateType:d.bindType)||s]||[]).length,u=u?new RegExp("(^|\\.)"+u.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null,f=0;f<h.length;f++)g=h[f],(i||l===g.origType)&&(!n||n.guid===g.guid)&&(!u||u.test(g.namespace))&&(!r||r===g.selector||"**"===r&&g.selector)&&(h.splice(f--,1),g.selector&&h.delegateCount--,d.remove&&d.remove.call(e,g));0===h.length&&c!==h.length&&((!d.teardown||!1===d.teardown.call(e,u,m.handle))&&ye.removeEvent(e,s,m.handle),delete p[s])}else for(s in p)ye.event.remove(e,s+t[o],n,r,!0);ye.isEmptyObject(p)&&(delete m.handle,ye.removeData(e,"events",!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(e,t,n,r){if(!n||3!==n.nodeType&&8!==n.nodeType){var i,o,a,s,l,u,c,f,p,d,h=e.type||e,g=[];if(Ce.test(h+ye.event.triggered))return;if(0<=h.indexOf("!")&&(h=h.slice(0,-1),o=!0),0<=h.indexOf(".")&&(h=(g=h.split(".")).shift(),g.sort()),(!n||ye.event.customEvent[h])&&!ye.event.global[h])return;if((e="object"==typeof e?e[ye.expando]?e:new ye.Event(h,e):new ye.Event(h)).type=h,e.isTrigger=!0,e.exclusive=o,e.namespace=g.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,u=h.indexOf(":")<0?"on"+h:"",!n){for(a in i=ye.cache)i[a].events&&i[a].events[h]&&ye.event.trigger(e,t,i[a].handle.elem,!0);return}if(e.result=C,e.target||(e.target=n),(t=null!=t?ye.makeArray(t):[]).unshift(e),(c=ye.event.special[h]||{}).trigger&&!1===c.trigger.apply(n,t))return;if(p=[[n,c.bindType||h]],!r&&!c.noBubble&&!ye.isWindow(n)){for(d=c.delegateType||h,s=Ce.test(d+h)?n:n.parentNode,l=n;s;s=s.parentNode)p.push([s,d]),l=s;l===(n.ownerDocument||F)&&p.push([l.defaultView||l.parentWindow||m,d])}for(a=0;a<p.length&&!e.isPropagationStopped();a++)s=p[a][0],e.type=p[a][1],(f=(ye._data(s,"events")||{})[e.type]&&ye._data(s,"handle"))&&f.apply(s,t),(f=u&&s[u])&&ye.acceptData(s)&&f.apply&&!1===f.apply(s,t)&&e.preventDefault();return e.type=h,!r&&!e.isDefaultPrevented()&&(!c._default||!1===c._default.apply(n.ownerDocument,t))&&("click"!==h||!ye.nodeName(n,"a"))&&ye.acceptData(n)&&u&&n[h]&&("focus"!==h&&"blur"!==h||0!==e.target.offsetWidth)&&!ye.isWindow(n)&&((l=n[u])&&(n[u]=null),n[ye.event.triggered=h](),ye.event.triggered=C,l&&(n[u]=l)),e.result}},dispatch:function(e){e=ye.event.fix(e||m.event);var t,n,r,i,o,a,s,l,u,c=(ye._data(this,"events")||{})[e.type]||[],f=c.delegateCount,p=W.call(arguments),d=!e.exclusive&&!e.namespace,h=ye.event.special[e.type]||{},g=[];if((p[0]=e).delegateTarget=this,!h.preDispatch||!1!==h.preDispatch.call(this,e)){if(f&&(!e.button||"click"!==e.type))for(r=e.target;r!=this;r=r.parentNode||this)if(!0!==r.disabled||"click"!==e.type){for(o={},s=[],t=0;t<f;t++)o[u=(l=c[t]).selector]===C&&(o[u]=l.needsContext?0<=ye(u,this).index(r):ye.find(u,this,null,[r]).length),o[u]&&s.push(l);s.length&&g.push({elem:r,matches:s})}for(c.length>f&&g.push({elem:this,matches:c.slice(f)}),t=0;t<g.length&&!e.isPropagationStopped();t++)for(a=g[t],e.currentTarget=a.elem,n=0;n<a.matches.length&&!e.isImmediatePropagationStopped();n++)l=a.matches[n],(d||!e.namespace&&!l.namespace||e.namespace_re&&e.namespace_re.test(l.namespace))&&(e.data=l.data,e.handleObj=l,(i=((ye.event.special[l.origType]||{}).handle||l.handler).apply(a.elem,p))!==C&&(!1===(e.result=i)&&(e.preventDefault(),e.stopPropagation())));return h.postDispatch&&h.postDispatch.call(this,e),e.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,o=t.button,a=t.fromElement;return null==e.pageX&&null!=t.clientX&&(r=(n=e.target.ownerDocument||F).documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?t.toElement:a),!e.which&&o!==C&&(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[ye.expando])return e;var t,n,r=e,i=ye.event.fixHooks[e.type]||{},o=i.props?this.props.concat(i.props):this.props;for(e=ye.Event(r),t=o.length;t;)e[n=o[--t]]=r[n];return e.target||(e.target=r.srcElement||F),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,i.filter?i.filter(e,r):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){ye.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,r){var i=ye.extend(new ye.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?ye.event.trigger(i,null,t):ye.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},ye.event.handle=ye.event.dispatch,ye.removeEvent=F.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(void 0===e[r]&&(e[r]=null),e.detachEvent(r,n))},ye.Event=function(e,t){if(!(this instanceof ye.Event))return new ye.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||!1===e.returnValue||e.getPreventDefault&&e.getPreventDefault()?n:s):this.type=e,t&&ye.extend(this,t),this.timeStamp=e&&e.timeStamp||ye.now(),this[ye.expando]=!0},ye.Event.prototype={preventDefault:function(){this.isDefaultPrevented=n;var e=this.originalEvent;e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=n;var e=this.originalEvent;e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=n,this.stopPropagation()},isDefaultPrevented:s,isPropagationStopped:s,isImmediatePropagationStopped:s},ye.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,i){ye.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;r.selector;return n&&(n===this||ye.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),ye.support.submitBubbles||(ye.event.special.submit={setup:function(){if(ye.nodeName(this,"form"))return!1;ye.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,n=ye.nodeName(t,"input")||ye.nodeName(t,"button")?t.form:C;n&&!ye._data(n,"_submit_attached")&&(ye.event.add(n,"submit._submit",function(e){e._submit_bubble=!0}),ye._data(n,"_submit_attached",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&ye.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(ye.nodeName(this,"form"))return!1;ye.event.remove(this,"._submit")}}),ye.support.changeBubbles||(ye.event.special.change={setup:function(){if(be.test(this.nodeName))return"checkbox"!==this.type&&"radio"!==this.type||(ye.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),ye.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),ye.event.simulate("change",this,e,!0)})),!1;ye.event.add(this,"beforeactivate._change",function(e){var t=e.target;be.test(t.nodeName)&&!ye._data(t,"_change_attached")&&(ye.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&ye.event.simulate("change",this.parentNode,e,!0)}),ye._data(t,"_change_attached",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return ye.event.remove(this,"._change"),!be.test(this.nodeName)}}),ye.support.focusinBubbles||ye.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){ye.event.simulate(t,e.target,ye.event.fix(e),!0)};ye.event.special[t]={setup:function(){0==n++&&F.addEventListener(e,r,!0)},teardown:function(){0==--n&&F.removeEventListener(e,r,!0)}}}),ye.fn.extend({on:function(e,t,n,r,i){var o,a;if("object"==typeof e){for(a in"string"!=typeof t&&(n=n||t,t=C),e)this.on(a,t,n,e[a],i);return this}if(null==n&&null==r?(r=t,n=t=C):null==r&&("string"==typeof t?(r=n,n=C):(r=n,n=t,t=C)),!1===r)r=s;else if(!r)return this;return 1===i&&(o=r,(r=function(e){return ye().off(e),o.apply(this,arguments)}).guid=o.guid||(o.guid=ye.guid++)),this.each(function(){ye.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,ye(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(n=t,t=C),!1===n&&(n=s),this.each(function(){ye.event.remove(this,e,n,t)});for(i in e)this.off(i,t,e[i]);return this},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return ye(this.context).on(e,this.selector,t,n),this},die:function(e,t){return ye(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){ye.event.trigger(e,t,this)})},triggerHandler:function(e,t){if(this[0])return ye.event.trigger(e,t,this[0],!0)},toggle:function(n){var r=arguments,e=n.guid||ye.guid++,i=0,t=function(e){var t=(ye._data(this,"lastToggle"+n.guid)||0)%i;return ye._data(this,"lastToggle"+n.guid,t+1),e.preventDefault(),r[t].apply(this,arguments)||!1};for(t.guid=e;i<r.length;)r[i++].guid=e;return this.click(t)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),ye.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,n){ye.fn[n]=function(e,t){return null==t&&(t=e,e=null),0<arguments.length?this.on(n,null,e,t):this.trigger(n)},Te.test(n)&&(ye.event.fixHooks[n]=ye.event.keyHooks),Ne.test(n)&&(ye.event.fixHooks[n]=ye.event.mouseHooks)}),function(e,t){function w(e,t,n,r){n=n||[];var i,o,a,s,l=(t=t||_).nodeType;if(!e||"string"!=typeof e)return n;if(1!==l&&9!==l)return[];if(!(a=g(t))&&!r&&(i=oe.exec(e)))if(s=i[1]){if(9===l){if(!(o=t.getElementById(s))||!o.parentNode)return n;if(o.id===s)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(s))&&m(t,o)&&o.id===s)return n.push(o),n}else{if(i[2])return R.apply(n,$.call(t.getElementsByTagName(e),0)),n;if((s=i[3])&&ge&&t.getElementsByClassName)return R.apply(n,$.call(t.getElementsByClassName(s),0)),n}return u(e.replace(te,"$1"),t,n,r,a)}function n(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function r(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}function i(a){return z(function(o){return o=+o,z(function(e,t){for(var n,r=a([],e.length,o),i=r.length;i--;)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function c(e,t,n){if(e===t)return n;for(var r=e.nextSibling;r;){if(r===t)return-1;r=r.nextSibling}return 1}function f(e,t){var n,r,i,o,a,s,l,u=Y[M][e+" "];if(u)return t?0:u.slice(0);for(a=e,s=[],l=C.preFilter;a;){for(o in n&&!(r=ne.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=re.exec(a))&&(i.push(n=new O(r.shift())),a=a.slice(n.length),n.type=r[0].replace(te," ")),C.filter)(r=ce[o].exec(a))&&(!l[o]||(r=l[o](r)))&&(i.push(n=new O(r.shift())),a=a.slice(n.length),n.type=o,n.matches=r);if(!n)break}return t?a.length:a?w.error(e):Y(e,s).slice(0)}function p(a,e,t){var s=e.dir,l=t&&"parentNode"===e.dir,u=W++;return e.first?function(e,t,n){for(;e=e[s];)if(l||1===e.nodeType)return a(e,t,n)}:function(e,t,n){if(n){for(;e=e[s];)if((l||1===e.nodeType)&&a(e,t,n))return e}else for(var r,i=B+" "+u+" ",o=i+N;e=e[s];)if(l||1===e.nodeType){if((r=e[M])===o)return e.sizset;if("string"==typeof r&&0===r.indexOf(i)){if(e.sizset)return e}else{if(e[M]=o,a(e,t,n))return e.sizset=!0,e;e.sizset=!1}}}}function d(i){return 1<i.length?function(e,t,n){for(var r=i.length;r--;)if(!i[r](e,t,n))return!1;return!0}:i[0]}function T(e,t,n,r,i){for(var o,a=[],s=0,l=e.length,u=null!=t;s<l;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),u&&t.push(s)));return a}function v(d,h,g,m,y,e){return m&&!m[M]&&(m=v(m)),y&&!y[M]&&(y=v(y,e)),z(function(e,t,n,r){var i,o,a,s=[],l=[],u=t.length,c=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)w(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),f=!d||!e&&h?c:T(c,s,d,n,r),p=g?y||(e?d:u||m)?[]:t:f;if(g&&g(f,p,n,r),m)for(i=T(p,l),m(i,[],n,r),o=i.length;o--;)(a=i[o])&&(p[l[o]]=!(f[l[o]]=a));if(e){if(y||d){if(y){for(i=[],o=p.length;o--;)(a=p[o])&&i.push(f[o]=a);y(null,p=[],i,r)}for(o=p.length;o--;)(a=p[o])&&-1<(i=y?I.call(e,a):s[o])&&(e[i]=!(t[i]=a))}}else p=T(p===t?p.splice(u,p.length):p),y?y(null,t,p,r):R.apply(t,p)})}function h(e){for(var r,t,n,i=e.length,o=C.relative[e[0].type],a=o||C.relative[" "],s=o?1:0,l=p(function(e){return e===r},a,!0),u=p(function(e){return-1<I.call(r,e)},a,!0),c=[function(e,t,n){return!o&&(n||t!==k)||((r=t).nodeType?l(e,t,n):u(e,t,n))}];s<i;s++)if(t=C.relative[e[s].type])c=[p(d(c),t)];else{if((t=C.filter[e[s].type].apply(null,e[s].matches))[M]){for(n=++s;n<i&&!C.relative[e[n].type];n++);return v(1<s&&d(c),1<s&&e.slice(0,s-1).join("").replace(te,"$1"),t,s<n&&h(e.slice(s,n)),n<i&&h(e=e.slice(n)),n<i&&e.join(""))}c.push(t)}return d(c)}function u(e,t,n,r,i){var o,a,s,l,u,c=f(e);c.length;if(!r&&1===c.length){if(2<(a=c[0]=c[0].slice(0)).length&&"ID"===(s=a[0]).type&&9===t.nodeType&&!i&&C.relative[a[1].type]){if(!(t=C.find.ID(s.matches[0].replace(ue,""),t,i)[0]))return n;e=e.slice(a.shift().length)}for(o=ce.POS.test(e)?-1:a.length-1;0<=o&&(s=a[o],!C.relative[l=s.type]);o--)if((u=C.find[l])&&(r=u(s.matches[0].replace(ue,""),ae.test(a[0].type)&&t.parentNode||t,i))){if(a.splice(o,1),!(e=r.length&&a.join("")))return R.apply(n,$.call(r,0)),n;break}}return y(e,c)(r,t,i,n,ae.test(e)),n}function o(){}var N,a,C,s,g,m,y,l,b,k,x,E,S,A,j,D,L,H,F="undefined",M=("sizcache"+Math.random()).replace(".",""),O=String,_=e.document,q=_.documentElement,B=0,W=0,P=[].pop,R=[].push,$=[].slice,I=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return t;return-1},z=function(e,t){return e[M]=null==t||t,e},X=function(){var n={},r=[];return z(function(e,t){return r.push(e)>C.cacheLength&&delete n[r.shift()],n[e+" "]=t},n)},U=X(),Y=X(),V=X(),J="[\\x20\\t\\r\\n\\f]",G="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",Q=G.replace("w","w#"),K="\\["+J+"*("+G+")"+J+"*(?:([*^$|!~]?=)"+J+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+Q+")|)|)"+J+"*\\]",Z=":("+G+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+K+")|[^:]|\\\\.)*|.*))\\)|)",ee=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+J+"*((?:-\\d)?\\d*)"+J+"*\\)|)(?=[^-]|$)",te=new RegExp("^"+J+"+|((?:^|[^\\\\])(?:\\\\.)*)"+J+"+$","g"),ne=new RegExp("^"+J+"*,"+J+"*"),re=new RegExp("^"+J+"*([\\x20\\t\\r\\n\\f>+~])"+J+"*"),ie=new RegExp(Z),oe=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,ae=/[\x20\t\r\n\f]*[+~]/,se=/h\d/i,le=/input|select|textarea|button/i,ue=/\\(?!\\)/g,ce={ID:new RegExp("^#("+G+")"),CLASS:new RegExp("^\\.("+G+")"),NAME:new RegExp("^\\[name=['\"]?("+G+")['\"]?\\]"),TAG:new RegExp("^("+G.replace("w","w*")+")"),ATTR:new RegExp("^"+K),PSEUDO:new RegExp("^"+Z),POS:new RegExp(ee,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+J+"*(even|odd|(([+-]|)(\\d*)n|)"+J+"*(?:([+-]|)"+J+"*(\\d+)|))"+J+"*\\)|)","i"),needsContext:new RegExp("^"+J+"*[>+~]|"+ee,"i")},fe=function(e){var t=_.createElement("div");try{return e(t)}catch(e){return!1}finally{t=null}},pe=fe(function(e){return e.appendChild(_.createComment("")),!e.getElementsByTagName("*").length}),de=fe(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==F&&"#"===e.firstChild.getAttribute("href")}),he=fe(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),ge=fe(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!(!e.getElementsByClassName||!e.getElementsByClassName("e").length)&&(e.lastChild.className="e",2===e.getElementsByClassName("e").length)}),me=fe(function(e){e.id=M+0,e.innerHTML="<a name='"+M+"'></a><div name='"+M+"'></div>",q.insertBefore(e,q.firstChild);var t=_.getElementsByName&&_.getElementsByName(M).length===2+_.getElementsByName(M+0).length;return a=!_.getElementById(M),q.removeChild(e),t});try{$.call(q.childNodes,0)[0].nodeType}catch(e){$=function(e){for(var t,n=[];t=this[e];e++)n.push(t);return n}}w.matches=function(e,t){return w(e,null,null,t)},w.matchesSelector=function(e,t){return 0<w(t,null,null,[e]).length},s=w.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=s(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=s(t);return n},g=w.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},m=w.contains=q.contains?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&1===r.nodeType&&n.contains&&n.contains(r))}:q.compareDocumentPosition?function(e,t){return t&&!!(16&e.compareDocumentPosition(t))}:function(e,t){for(;t=t.parentNode;)if(t===e)return!0;return!1},w.attr=function(e,t){var n,r=g(e);return r||(t=t.toLowerCase()),(n=C.attrHandle[t])?n(e):r||he?e.getAttribute(t):(n=e.getAttributeNode(t))?"boolean"==typeof e[t]?e[t]?t:null:n.specified?n.value:null:null},C=w.selectors={cacheLength:50,createPseudo:z,match:ce,attrHandle:de?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:a?function(e,t,n){if(typeof t.getElementById!==F&&!n){var r=t.getElementById(e);return r&&r.parentNode?[r]:[]}}:function(e,t,n){if(typeof t.getElementById!==F&&!n){var r=t.getElementById(e);return r?r.id===e||typeof r.getAttributeNode!==F&&r.getAttributeNode("id").value===e?[r]:void 0:[]}},TAG:pe?function(e,t){if(typeof t.getElementsByTagName!==F)return t.getElementsByTagName(e)}:function(e,t){var n=t.getElementsByTagName(e);if("*"!==e)return n;for(var r,i=[],o=0;r=n[o];o++)1===r.nodeType&&i.push(r);return i},NAME:me&&function(e,t){if(typeof t.getElementsByName!==F)return t.getElementsByName(name)},CLASS:ge&&function(e,t,n){if(typeof t.getElementsByClassName!==F&&!n)return t.getElementsByClassName(e)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ue,""),e[3]=(e[4]||e[5]||"").replace(ue,""),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1]?(e[2]||w.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*("even"===e[2]||"odd"===e[2])),e[4]=+(e[6]+e[7]||"odd"===e[2])):e[2]&&w.error(e[0]),e},PSEUDO:function(e){var t,n;return ce.CHILD.test(e[0])?null:(e[3]?e[2]=e[3]:(t=e[4])&&(ie.test(t)&&(n=f(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(t=t.slice(0,n),e[0]=e[0].slice(0,n)),e[2]=t),e.slice(0,3))}},filter:{ID:a?function(t){return t=t.replace(ue,""),function(e){return e.getAttribute("id")===t}}:function(n){return n=n.replace(ue,""),function(e){var t=typeof e.getAttributeNode!==F&&e.getAttributeNode("id");return t&&t.value===n}},TAG:function(t){return"*"===t?function(){return!0}:(t=t.replace(ue,"").toLowerCase(),function(e){return e.nodeName&&e.nodeName.toLowerCase()===t})},CLASS:function(e){var t=U[M][e+" "];return t||(t=new RegExp("(^|"+J+")"+e+"("+J+"|$)"))&&U(e,function(e){return t.test(e.className||typeof e.getAttribute!==F&&e.getAttribute("class")||"")})},ATTR:function(r,i,o){return function(e,t){var n=w.attr(e,r);return null==n?"!="===i:!i||(n+="","="===i?n===o:"!="===i?n!==o:"^="===i?o&&0===n.indexOf(o):"*="===i?o&&-1<n.indexOf(o):"$="===i?o&&n.substr(n.length-o.length)===o:"~="===i?-1<(" "+n+" ").indexOf(o):"|="===i&&(n===o||n.substr(0,o.length+1)===o+"-"))}},CHILD:function(n,e,i,o){return"nth"===n?function(e){var t,n,r=e.parentNode;if(1===i&&0===o)return!0;if(r)for(n=0,t=r.firstChild;t&&(1!==t.nodeType||(n++,e!==t));t=t.nextSibling);return(n-=o)===i||n%i==0&&0<=n/i}:function(e){var t=e;switch(n){case"only":case"first":for(;t=t.previousSibling;)if(1===t.nodeType)return!1;if("first"===n)return!0;t=e;case"last":for(;t=t.nextSibling;)if(1===t.nodeType)return!1;return!0}}},PSEUDO:function(e,o){var t,a=C.pseudos[e]||C.setFilters[e.toLowerCase()]||w.error("unsupported pseudo: "+e);return a[M]?a(o):1<a.length?(t=[e,e,"",o],C.setFilters.hasOwnProperty(e.toLowerCase())?z(function(e,t){for(var n,r=a(e,o),i=r.length;i--;)e[n=I.call(e,r[i])]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:z(function(e){var r=[],i=[],s=y(e.replace(te,"$1"));return s[M]?z(function(e,t,n,r){for(var i,o=s(e,null,r,[]),a=e.length;a--;)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,n){return r[0]=e,s(r,null,n,i),!i.pop()}}),has:z(function(t){return function(e){return 0<w(t,e).length}}),contains:z(function(t){return function(e){return-1<(e.textContent||e.innerText||s(e)).indexOf(t)}}),enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},parent:function(e){return!C.pseudos.empty(e)},empty:function(e){var t;for(e=e.firstChild;e;){if("@"<e.nodeName||3===(t=e.nodeType)||4===t)return!1;e=e.nextSibling}return!0},header:function(e){return se.test(e.nodeName)},text:function(e){var t,n;return"input"===e.nodeName.toLowerCase()&&"text"===(t=e.type)&&(null==(n=e.getAttribute("type"))||n.toLowerCase()===t)},radio:n("radio"),checkbox:n("checkbox"),file:n("file"),password:n("password"),image:n("image"),submit:r("submit"),reset:r("reset"),button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},input:function(e){return le.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return e===t.activeElement&&(!t.hasFocus||t.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},active:function(e){return e===e.ownerDocument.activeElement},first:i(function(){return[0]}),last:i(function(e,t){return[t-1]}),eq:i(function(e,t,n){return[n<0?n+t:n]}),even:i(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:i(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:i(function(e,t,n){for(var r=n<0?n+t:n;0<=--r;)e.push(r);return e}),gt:i(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}},l=q.compareDocumentPosition?function(e,t){return e===t?(b=!0,0):(e.compareDocumentPosition&&t.compareDocumentPosition?4&e.compareDocumentPosition(t):e.compareDocumentPosition)?-1:1}:function(e,t){if(e===t)return b=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,r,i=[],o=[],a=e.parentNode,s=t.parentNode,l=a;if(a===s)return c(e,t);if(!a)return-1;if(!s)return 1;for(;l;)i.unshift(l),l=l.parentNode;for(l=s;l;)o.unshift(l),l=l.parentNode;n=i.length,r=o.length;for(var u=0;u<n&&u<r;u++)if(i[u]!==o[u])return c(i[u],o[u]);return u===n?c(e,o[u],-1):c(i[u],t,1)},[0,0].sort(l),x=!b,w.uniqueSort=function(e){var t,n=[],r=1,i=0;if(b=x,e.sort(l),b){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));for(;i--;)e.splice(n[i],1)}return e},w.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},y=w.compile=function(e,t){var n,m,y,v,b,x,r=[],i=[],o=V[M][e+" "];if(!o){for(t||(t=f(e)),n=t.length;n--;)(o=h(t[n]))[M]?r.push(o):i.push(o);o=V(e,(m=i,v=0<(y=r).length,b=0<m.length,(x=function(e,t,n,r,i){var o,a,s,l=[],u=0,c="0",f=e&&[],p=null!=i,d=k,h=e||b&&C.find.TAG("*",i&&t.parentNode||t),g=B+=null==d?1:Math.E;for(p&&(k=t!==_&&t,N=x.el);null!=(o=h[c]);c++){if(b&&o){for(a=0;s=m[a];a++)if(s(o,t,n)){r.push(o);break}p&&(B=g,N=++x.el)}v&&((o=!s&&o)&&u--,e&&f.push(o))}if(u+=c,v&&c!==u){for(a=0;s=y[a];a++)s(f,l,t,n);if(e){if(0<u)for(;c--;)!f[c]&&!l[c]&&(l[c]=P.call(r));l=T(l)}R.apply(r,l),p&&!e&&0<l.length&&1<u+y.length&&w.uniqueSort(r)}return p&&(B=g,k=d),f}).el=0,v?z(x):x))}return o},_.querySelectorAll&&(S=u,A=/'|\\/g,j=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,D=[":focus"],L=[":active"],H=q.matchesSelector||q.mozMatchesSelector||q.webkitMatchesSelector||q.oMatchesSelector||q.msMatchesSelector,fe(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||D.push("\\["+J+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||D.push(":checked")}),fe(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&D.push("[*^$]="+J+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||D.push(":enabled",":disabled")}),D=new RegExp(D.join("|")),u=function(e,t,n,r,i){if(!r&&!i&&!D.test(e)){var o,a,s=!0,l=M,u=t,c=9===t.nodeType&&e;if(1===t.nodeType&&"object"!==t.nodeName.toLowerCase()){for(o=f(e),(s=t.getAttribute("id"))?l=s.replace(A,"\\$&"):t.setAttribute("id",l),l="[id='"+l+"'] ",a=o.length;a--;)o[a]=l+o[a].join("");u=ae.test(e)&&t.parentNode||t,c=o.join(",")}if(c)try{return R.apply(n,$.call(u.querySelectorAll(c),0)),n}catch(e){}finally{s||t.removeAttribute("id")}}return S(e,t,n,r,i)},H&&(fe(function(e){E=H.call(e,"div");try{H.call(e,"[test!='']:sizzle"),L.push("!=",Z)}catch(e){}}),L=new RegExp(L.join("|")),w.matchesSelector=function(e,t){if(t=t.replace(j,"='$1']"),!g(e)&&!L.test(t)&&!D.test(t))try{var n=H.call(e,t);if(n||E||e.document&&11!==e.document.nodeType)return n}catch(e){}return 0<w(t,null,null,[e]).length})),C.pseudos.nth=C.pseudos.eq,C.filters=o.prototype=C.pseudos,C.setFilters=new o,w.attr=ye.attr,ye.find=w,ye.expr=w.selectors,ye.expr[":"]=ye.expr.pseudos,ye.unique=w.uniqueSort,ye.text=w.getText,ye.isXMLDoc=w.isXML,ye.contains=w.contains}(m);var Ee=/Until$/,Se=/^(?:parents|prev(?:Until|All))/,Ae=/^.[^:#\[\.,]*$/,je=ye.expr.match.needsContext,De={children:!0,contents:!0,next:!0,prev:!0};ye.fn.extend({find:function(e){var t,n,r,i,o,a,s=this;if("string"!=typeof e)return ye(e).filter(function(){for(t=0,n=s.length;t<n;t++)if(ye.contains(s[t],this))return!0});for(a=this.pushStack("","find",e),t=0,n=this.length;t<n;t++)if(r=a.length,ye.find(e,this[t],a),0<t)for(i=r;i<a.length;i++)for(o=0;o<r;o++)if(a[o]===a[i]){a.splice(i--,1);break}return a},has:function(e){var t,n=ye(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++)if(ye.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(r(this,e,!1),"not",e)},filter:function(e){return this.pushStack(r(this,e,!0),"filter",e)},is:function(e){return!!e&&("string"==typeof e?je.test(e)?0<=ye(e,this.context).index(this[0]):0<ye.filter(e,this).length:0<this.filter(e).length)},closest:function(e,t){for(var n,r=0,i=this.length,o=[],a=je.test(e)||"string"!=typeof e?ye(e,t||this.context):0;r<i;r++)for(n=this[r];n&&n.ownerDocument&&n!==t&&11!==n.nodeType;){if(a?-1<a.index(n):ye.find.matchesSelector(n,e)){o.push(n);break}n=n.parentNode}return o=1<o.length?ye.unique(o):o,this.pushStack(o,"closest",e)},index:function(e){return e?"string"==typeof e?ye.inArray(this[0],ye(e)):ye.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n="string"==typeof e?ye(e,t):ye.makeArray(e&&e.nodeType?[e]:e),r=ye.merge(this.get(),n);return this.pushStack(i(n[0])||i(r[0])?r:ye.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ye.fn.andSelf=ye.fn.addBack,ye.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ye.dir(e,"parentNode")},parentsUntil:function(e,t,n){return ye.dir(e,"parentNode",n)},next:function(e){return t(e,"nextSibling")},prev:function(e){return t(e,"previousSibling")},nextAll:function(e){return ye.dir(e,"nextSibling")},prevAll:function(e){return ye.dir(e,"previousSibling")},nextUntil:function(e,t,n){return ye.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return ye.dir(e,"previousSibling",n)},siblings:function(e){return ye.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ye.sibling(e.firstChild)},contents:function(e){return ye.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:ye.merge([],e.childNodes)}},function(r,i){ye.fn[r]=function(e,t){var n=ye.map(this,i,e);return Ee.test(r)||(t=e),t&&"string"==typeof t&&(n=ye.filter(t,n)),n=1<this.length&&!De[r]?ye.unique(n):n,1<this.length&&Se.test(r)&&(n=n.reverse()),this.pushStack(n,r,W.call(arguments).join(","))}}),ye.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),1===t.length?ye.find.matchesSelector(t[0],e)?[t[0]]:[]:ye.find.matches(e,t)},dir:function(e,t,n){for(var r=[],i=e[t];i&&9!==i.nodeType&&(n===C||1!==i.nodeType||!ye(i).is(n));)1===i.nodeType&&r.push(i),i=i[t];return r},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var Le,He,Fe="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Me=/ jQuery\d+="(?:null|\d+)"/g,Oe=/^\s+/,_e=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,qe=/<([\w:]+)/,Be=/<tbody/i,We=/<|&#?\w+;/,Pe=/<(?:script|style|link)/i,Re=/<(?:script|object|embed|option|style)/i,$e=new RegExp("<(?:"+Fe+")[\\s/>]","i"),Ie=/^(?:checkbox|radio)$/,ze=/checked\s*(?:[^=]|=\s*.checked.)/i,Xe=/\/(java|ecma)script/i,Ue=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Ye={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Ve=y(F),Je=Ve.appendChild(F.createElement("div"));Ye.optgroup=Ye.option,Ye.tbody=Ye.tfoot=Ye.colgroup=Ye.caption=Ye.thead,Ye.th=Ye.td,ye.support.htmlSerialize||(Ye._default=[1,"X<div>","</div>"]),ye.fn.extend({text:function(e){return ye.access(this,function(e){return e===C?ye.text(this):this.empty().append((this[0]&&this[0].ownerDocument||F).createTextNode(e))},null,e,arguments.length)},wrapAll:function(t){if(ye.isFunction(t))return this.each(function(e){ye(this).wrapAll(t.call(this,e))});if(this[0]){var e=ye(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(n){return ye.isFunction(n)?this.each(function(e){ye(this).wrapInner(n.call(this,e))}):this.each(function(){var e=ye(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=ye.isFunction(t);return this.each(function(e){ye(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(){return this.parent().each(function(){ye.nodeName(this,"body")||ye(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!i(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=ye.clean(arguments);return this.pushStack(ye.merge(e,this),"before",this.selector)}},after:function(){if(!i(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=ye.clean(arguments);return this.pushStack(ye.merge(this,e),"after",this.selector)}},remove:function(e,t){for(var n,r=0;null!=(n=this[r]);r++)e&&!ye.filter(e,[n]).length||(!t&&1===n.nodeType&&(ye.cleanData(n.getElementsByTagName("*")),ye.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)for(1===e.nodeType&&ye.cleanData(e.getElementsByTagName("*"));e.firstChild;)e.removeChild(e.firstChild);return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return ye.clone(this,e,t)})},html:function(e){return ye.access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===C)return 1===t.nodeType?t.innerHTML.replace(Me,""):C;if("string"==typeof e&&!Pe.test(e)&&(ye.support.htmlSerialize||!$e.test(e))&&(ye.support.leadingWhitespace||!Oe.test(e))&&!Ye[(qe.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(_e,"<$1></$2>");try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(ye.cleanData(t.getElementsByTagName("*")),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(r){return i(this[0])?this.length?this.pushStack(ye(ye.isFunction(r)?r():r),"replaceWith",r):this:ye.isFunction(r)?this.each(function(e){var t=ye(this),n=t.html();t.replaceWith(r.call(this,e,n))}):("string"!=typeof r&&(r=ye(r).detach()),this.each(function(){var e=this.nextSibling,t=this.parentNode;ye(this).remove(),e?ye(e).before(r):ye(t).append(r)}))},detach:function(e){return this.remove(e,!0)},domManip:function(n,r,i){var e,t,o,a,s,l,u=0,c=(n=[].concat.apply([],n))[0],f=[],p=this.length;if(!ye.support.checkClone&&1<p&&"string"==typeof c&&ze.test(c))return this.each(function(){ye(this).domManip(n,r,i)});if(ye.isFunction(c))return this.each(function(e){var t=ye(this);n[0]=c.call(this,e,r?t.html():C),t.domManip(n,r,i)});if(this[0]){if(t=(o=(e=ye.buildFragment(n,this,f)).fragment).firstChild,1===o.childNodes.length&&(o=t),t)for(r=r&&ye.nodeName(t,"tr"),a=e.cacheable||p-1;u<p;u++)i.call(r&&ye.nodeName(this[u],"table")?(s=this[u],l="tbody",s.getElementsByTagName(l)[0]||s.appendChild(s.ownerDocument.createElement(l))):this[u],u===a?o:ye.clone(o,!0,!0));o=t=null,f.length&&ye.each(f,function(e,t){t.src?ye.ajax?ye.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,throws:!0}):ye.error("no ajax"):ye.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Ue,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),ye.buildFragment=function(e,t,n){var r,i,o,a=e[0];return t=(t=!(t=t||F).nodeType&&t[0]||t).ownerDocument||t,1===e.length&&"string"==typeof a&&a.length<512&&t===F&&"<"===a.charAt(0)&&!Re.test(a)&&(ye.support.checkClone||!ze.test(a))&&(ye.support.html5Clone||!$e.test(a))&&(i=!0,o=(r=ye.fragments[a])!==C),r||(r=t.createDocumentFragment(),ye.clean(e,t,r,n),i&&(ye.fragments[a]=o&&r)),{fragment:r,cacheable:i}},ye.fragments={},ye.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(s,l){ye.fn[s]=function(e){var t,n=0,r=[],i=ye(e),o=i.length,a=1===this.length&&this[0].parentNode;if((null==a||a&&11===a.nodeType&&1===a.childNodes.length)&&1===o)return i[l](this[0]),this;for(;n<o;n++)t=(0<n?this.clone(!0):this).get(),ye(i[n])[l](t),r=r.concat(t);return this.pushStack(r,s,i.selector)}}),ye.extend({clone:function(e,t,n){var r,i,o,a;if(ye.support.html5Clone||ye.isXMLDoc(e)||!$e.test("<"+e.nodeName+">")?a=e.cloneNode(!0):(Je.innerHTML=e.outerHTML,Je.removeChild(a=Je.firstChild)),!(ye.support.noCloneEvent&&ye.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ye.isXMLDoc(e)))for(f(e,a),r=p(e),i=p(a),o=0;r[o];++o)i[o]&&f(r[o],i[o]);if(t&&(l(e,a),n))for(r=p(e),i=p(a),o=0;r[o];++o)l(r[o],i[o]);return r=i=null,a},clean:function(e,t,n,r){var i,o,a,s,l,u,c,f,p,d,h,g=t===F&&Ve,m=[];for(t&&void 0!==t.createDocumentFragment||(t=F),i=0;null!=(a=e[i]);i++)if("number"==typeof a&&(a+=""),a){if("string"==typeof a)if(We.test(a)){for(g=g||y(t),c=t.createElement("div"),g.appendChild(c),a=a.replace(_e,"<$1></$2>"),s=(qe.exec(a)||["",""])[1].toLowerCase(),u=(l=Ye[s]||Ye._default)[0],c.innerHTML=l[1]+a+l[2];u--;)c=c.lastChild;if(!ye.support.tbody)for(f=Be.test(a),o=(p="table"!==s||f?"<table>"!==l[1]||f?[]:c.childNodes:c.firstChild&&c.firstChild.childNodes).length-1;0<=o;--o)ye.nodeName(p[o],"tbody")&&!p[o].childNodes.length&&p[o].parentNode.removeChild(p[o]);!ye.support.leadingWhitespace&&Oe.test(a)&&c.insertBefore(t.createTextNode(Oe.exec(a)[0]),c.firstChild),a=c.childNodes,c.parentNode.removeChild(c)}else a=t.createTextNode(a);a.nodeType?m.push(a):ye.merge(m,a)}if(c&&(a=c=g=null),!ye.support.appendChecked)for(i=0;null!=(a=m[i]);i++)ye.nodeName(a,"input")?v(a):void 0!==a.getElementsByTagName&&ye.grep(a.getElementsByTagName("input"),v);if(n)for(d=function(e){if(!e.type||Xe.test(e.type))return r?r.push(e.parentNode?e.parentNode.removeChild(e):e):n.appendChild(e)},i=0;null!=(a=m[i]);i++)ye.nodeName(a,"script")&&d(a)||(n.appendChild(a),void 0!==a.getElementsByTagName&&(h=ye.grep(ye.merge([],a.getElementsByTagName("script")),d),m.splice.apply(m,[i+1,0].concat(h)),i+=h.length));return m},cleanData:function(e,t){for(var n,r,i,o,a=0,s=ye.expando,l=ye.cache,u=ye.support.deleteExpando,c=ye.event.special;null!=(i=e[a]);a++)if((t||ye.acceptData(i))&&(n=(r=i[s])&&l[r])){if(n.events)for(o in n.events)c[o]?ye.event.remove(i,o):ye.removeEvent(i,o,n.handle);l[r]&&(delete l[r],u?delete i[s]:i.removeAttribute?i.removeAttribute(s):i[s]=null,ye.deletedIds.push(r))}}}),ye.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},He={},(Le=ye.uaMatch(O.userAgent)).browser&&(He[Le.browser]=!0,He.version=Le.version),He.chrome?He.webkit=!0:He.webkit&&(He.safari=!0),ye.browser=He,ye.sub=function(){function n(e,t){return new n.fn.init(e,t)}ye.extend(!0,n,this),n.superclass=this,((n.fn=n.prototype=this()).constructor=n).sub=this.sub,n.fn.init=function(e,t){return t&&t instanceof ye&&!(t instanceof n)&&(t=n(t)),ye.fn.init.call(this,e,t,r)},n.fn.init.prototype=n.fn;var r=n(F);return n};var Ge,Qe,Ke,Ze=/alpha\([^)]*\)/i,et=/opacity=([^)]*)/,tt=/^(top|right|bottom|left)$/,nt=/^(none|table(?!-c[ea]).+)/,rt=/^margin/,it=new RegExp("^("+z+")(.*)$","i"),ot=new RegExp("^("+z+")(?!px)[a-z%]+$","i"),at=new RegExp("^([-+])=("+z+")","i"),st={BODY:"block"},lt={position:"absolute",visibility:"hidden",display:"block"},ut={letterSpacing:0,fontWeight:400},ct=["Top","Right","Bottom","Left"],ft=["Webkit","O","Moz","ms"],pt=ye.fn.toggle;ye.fn.extend({css:function(e,t){return ye.access(this,function(e,t,n){return n!==C?ye.style(e,t,n):ye.css(e,t)},e,t,1<arguments.length)},show:function(){return e(this,!0)},hide:function(){return e(this)},toggle:function(e,t){var n="boolean"==typeof e;return ye.isFunction(e)&&ye.isFunction(t)?pt.apply(this,arguments):this.each(function(){(n?e:b(this))?ye(this).show():ye(this).hide()})}}),ye.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Ge(e,"opacity");return""===n?"1":n}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:ye.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=ye.camelCase(t),l=e.style;if(t=ye.cssProps[s]||(ye.cssProps[s]=d(l,s)),a=ye.cssHooks[t]||ye.cssHooks[s],n===C)return a&&"get"in a&&(i=a.get(e,!1,r))!==C?i:l[t];if("string"===(o=typeof n)&&(i=at.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(ye.css(e,t)),o="number"),!(null==n||"number"===o&&isNaN(n)||("number"===o&&!ye.cssNumber[s]&&(n+="px"),a&&"set"in a&&(n=a.set(e,n,r))===C)))try{l[t]=n}catch(e){}}},css:function(e,t,n,r){var i,o,a,s=ye.camelCase(t);return t=ye.cssProps[s]||(ye.cssProps[s]=d(e.style,s)),(a=ye.cssHooks[t]||ye.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,r)),i===C&&(i=Ge(e,t)),"normal"===i&&t in ut&&(i=ut[t]),n||r!==C?(o=parseFloat(i),n||ye.isNumeric(o)?o||0:i):i},swap:function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r}}),m.getComputedStyle?Ge=function(e,t){var n,r,i,o,a=m.getComputedStyle(e,null),s=e.style;return a&&(""===(n=a.getPropertyValue(t)||a[t])&&!ye.contains(e.ownerDocument,e)&&(n=ye.style(e,t)),ot.test(n)&&rt.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=n,n=a.width,s.width=r,s.minWidth=i,s.maxWidth=o)),n}:F.documentElement.currentStyle&&(Ge=function(e,t){var n,r,i=e.currentStyle&&e.currentStyle[t],o=e.style;return null==i&&o&&o[t]&&(i=o[t]),ot.test(i)&&!tt.test(t)&&(n=o.left,(r=e.runtimeStyle&&e.runtimeStyle.left)&&(e.runtimeStyle.left=e.currentStyle.left),o.left="fontSize"===t?"1em":i,i=o.pixelLeft+"px",o.left=n,r&&(e.runtimeStyle.left=r)),""===i?"auto":i}),ye.each(["height","width"],function(e,r){ye.cssHooks[r]={get:function(e,t,n){if(t)return 0===e.offsetWidth&&nt.test(Ge(e,"display"))?ye.swap(e,lt,function(){return o(e,r,n)}):o(e,r,n)},set:function(e,t,n){return a(0,t,n?h(e,r,n,ye.support.boxSizing&&"border-box"===ye.css(e,"boxSizing")):0)}}}),ye.support.opacity||(ye.cssHooks.opacity={get:function(e,t){return et.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=ye.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=r&&r.filter||n.filter||"";(n.zoom=1)<=t&&""===ye.trim(o.replace(Ze,""))&&n.removeAttribute&&(n.removeAttribute("filter"),r&&!r.filter)||(n.filter=Ze.test(o)?o.replace(Ze,i):o+" "+i)}}),ye(function(){ye.support.reliableMarginRight||(ye.cssHooks.marginRight={get:function(e,t){return ye.swap(e,{display:"inline-block"},function(){if(t)return Ge(e,"marginRight")})}}),!ye.support.pixelPosition&&ye.fn.position&&ye.each(["top","left"],function(e,r){ye.cssHooks[r]={get:function(e,t){if(t){var n=Ge(e,r);return ot.test(n)?ye(e).position()[r]+"px":n}}}})}),ye.expr&&ye.expr.filters&&(ye.expr.filters.hidden=function(e){return 0===e.offsetWidth&&0===e.offsetHeight||!ye.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||Ge(e,"display"))},ye.expr.filters.visible=function(e){return!ye.expr.filters.hidden(e)}),ye.each({margin:"",padding:"",border:"Width"},function(i,o){ye.cssHooks[i+o]={expand:function(e){var t,n="string"==typeof e?e.split(" "):[e],r={};for(t=0;t<4;t++)r[i+ct[t]+o]=n[t]||n[t-2]||n[0];return r}},rt.test(i)||(ye.cssHooks[i+o].set=a)});var dt=/%20/g,ht=/\[\]$/,gt=/\r?\n/g,mt=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,yt=/^(?:select|textarea)/i;ye.fn.extend({serialize:function(){return ye.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?ye.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||yt.test(this.nodeName)||mt.test(this.type))}).map(function(e,n){var t=ye(this).val();return null==t?null:ye.isArray(t)?ye.map(t,function(e,t){return{name:n.name,value:e.replace(gt,"\r\n")}}):{name:n.name,value:t.replace(gt,"\r\n")}}).get()}}),ye.param=function(e,t){var n,r=[],i=function(e,t){t=ye.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===C&&(t=ye.ajaxSettings&&ye.ajaxSettings.traditional),ye.isArray(e)||e.jquery&&!ye.isPlainObject(e))ye.each(e,function(){i(this.name,this.value)});else for(n in e)g(n,e[n],t,i);return r.join("&").replace(dt,"+")};var vt,bt,xt=/#.*$/,wt=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Tt=/^(?:GET|HEAD)$/,Nt=/^\/\//,Ct=/\?/,kt=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Et=/([?&])_=[^&]*/,St=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,At=ye.fn.load,jt={},Dt={},Lt=["*/"]+["*"];try{bt=M.href}catch(e){(bt=F.createElement("a")).href="",bt=bt.href}vt=St.exec(bt.toLowerCase())||[],ye.fn.load=function(e,t,n){if("string"!=typeof e&&At)return At.apply(this,arguments);if(!this.length)return this;var r,i,o,a=this,s=e.indexOf(" ");return 0<=s&&(r=e.slice(s,e.length),e=e.slice(0,s)),ye.isFunction(t)?(n=t,t=C):t&&"object"==typeof t&&(i="POST"),ye.ajax({url:e,type:i,dataType:"html",data:t,complete:function(e,t){n&&a.each(n,o||[e.responseText,t,e])}}).done(function(e){o=arguments,a.html(r?ye("<div>").append(e.replace(kt,"")).find(r):e)}),this},ye.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){ye.fn[t]=function(e){return this.on(t,e)}}),ye.each(["get","post"],function(e,i){ye[i]=function(e,t,n,r){return ye.isFunction(t)&&(r=r||n,n=t,t=C),ye.ajax({type:i,url:e,data:t,success:n,dataType:r})}}),ye.extend({getScript:function(e,t){return ye.get(e,C,t,"script")},getJSON:function(e,t,n){return ye.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?T(e,ye.ajaxSettings):(t=e,e=ye.ajaxSettings),T(e,t),e},ajaxSettings:{url:bt,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(vt[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Lt},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":m.String,"text html":!0,"text json":ye.parseJSON,"text xml":ye.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:w(jt),ajaxTransport:w(Dt),ajax:function(e,t){function n(e,t,n,r){var i,o,a,s,l,u=t;2!==w&&(w=2,d&&clearTimeout(d),p=C,f=r||"",T.readyState=0<e?4:0,n&&(s=function(e,t,n){var r,i,o,a,s=e.contents,l=e.dataTypes,u=e.responseFields;for(i in u)i in n&&(t[u[i]]=n[i]);for(;"*"===l[0];)l.shift(),r===C&&(r=e.mimeType||t.getResponseHeader("content-type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){l.unshift(i);break}if(l[0]in n)o=l[0];else{for(i in n){if(!l[0]||e.converters[i+" "+l[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==l[0]&&l.unshift(o),n[o]}(g,T,n)),200<=e&&e<300||304===e?(g.ifModified&&((l=T.getResponseHeader("Last-Modified"))&&(ye.lastModified[c]=l),(l=T.getResponseHeader("Etag"))&&(ye.etag[c]=l)),i=304===e?(u="notmodified",!0):(u=(i=function(e,t){var n,r,i,o,a=e.dataTypes.slice(),s=a[0],l={},u=0;if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a[1])for(n in e.converters)l[n.toLowerCase()]=e.converters[n];for(;i=a[++u];)if("*"!==i){if("*"!==s&&s!==i){if(!(n=l[s+" "+i]||l["* "+i]))for(r in l)if((o=r.split(" "))[1]===i&&(n=l[s+" "+o[0]]||l["* "+o[0]])){!0===n?n=l[r]:!0!==l[r]&&(i=o[0],a.splice(u--,0,i));break}if(!0!==n)if(n&&e.throws)t=n(t);else try{t=n(t)}catch(e){return{state:"parsererror",error:n?e:"No conversion from "+s+" to "+i}}}s=i}return{state:"success",data:t}}(g,s)).state,o=i.data,!(a=i.error))):(a=u)&&!e||(u="error",e<0&&(e=0)),T.status=e,T.statusText=(t||u)+"",i?v.resolveWith(m,[o,u,T]):v.rejectWith(m,[T,u,a]),T.statusCode(x),x=C,h&&y.trigger("ajax"+(i?"Success":"Error"),[T,g,i?o:a]),b.fireWith(m,[T,u]),h&&(y.trigger("ajaxComplete",[T,g]),--ye.active||ye.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=C),t=t||{};var c,f,r,p,d,i,h,o,g=ye.ajaxSetup({},t),m=g.context||g,y=m!==g&&(m.nodeType||m instanceof ye)?ye(m):ye.event,v=ye.Deferred(),b=ye.Callbacks("once memory"),x=g.statusCode||{},a={},s={},w=0,l="canceled",T={readyState:0,setRequestHeader:function(e,t){if(!w){var n=e.toLowerCase();e=s[n]=s[n]||e,a[e]=t}return this},getAllResponseHeaders:function(){return 2===w?f:null},getResponseHeader:function(e){var t;if(2===w){if(!r)for(r={};t=wt.exec(f);)r[t[1].toLowerCase()]=t[2];t=r[e.toLowerCase()]}return t===C?null:t},overrideMimeType:function(e){return w||(g.mimeType=e),this},abort:function(e){return e=e||l,p&&p.abort(e),n(0,e),this}};if(v.promise(T),T.success=T.done,T.error=T.fail,T.complete=b.add,T.statusCode=function(e){var t;if(e)if(w<2)for(t in e)x[t]=[x[t],e[t]];else t=e[T.status],T.always(t);return this},g.url=((e||g.url)+"").replace(xt,"").replace(Nt,vt[1]+"//"),g.dataTypes=ye.trim(g.dataType||"*").toLowerCase().split(U),null==g.crossDomain&&(i=St.exec(g.url.toLowerCase()),g.crossDomain=!(!i||i[1]===vt[1]&&i[2]===vt[2]&&(i[3]||("http:"===i[1]?80:443))==(vt[3]||("http:"===vt[1]?80:443)))),g.data&&g.processData&&"string"!=typeof g.data&&(g.data=ye.param(g.data,g.traditional)),k(jt,g,t,T),2===w)return T;if(h=g.global,g.type=g.type.toUpperCase(),g.hasContent=!Tt.test(g.type),h&&0==ye.active++&&ye.event.trigger("ajaxStart"),!g.hasContent&&(g.data&&(g.url+=(Ct.test(g.url)?"&":"?")+g.data,delete g.data),c=g.url,!1===g.cache)){var u=ye.now(),N=g.url.replace(Et,"$1_="+u);g.url=N+(N===g.url?(Ct.test(g.url)?"&":"?")+"_="+u:"")}for(o in(g.data&&g.hasContent&&!1!==g.contentType||t.contentType)&&T.setRequestHeader("Content-Type",g.contentType),g.ifModified&&(c=c||g.url,ye.lastModified[c]&&T.setRequestHeader("If-Modified-Since",ye.lastModified[c]),ye.etag[c]&&T.setRequestHeader("If-None-Match",ye.etag[c])),T.setRequestHeader("Accept",g.dataTypes[0]&&g.accepts[g.dataTypes[0]]?g.accepts[g.dataTypes[0]]+("*"!==g.dataTypes[0]?", "+Lt+"; q=0.01":""):g.accepts["*"]),g.headers)T.setRequestHeader(o,g.headers[o]);if(!g.beforeSend||!1!==g.beforeSend.call(m,T,g)&&2!==w){for(o in l="abort",{success:1,error:1,complete:1})T[o](g[o]);if(p=k(Dt,g,t,T)){T.readyState=1,h&&y.trigger("ajaxSend",[T,g]),g.async&&0<g.timeout&&(d=setTimeout(function(){T.abort("timeout")},g.timeout));try{w=1,p.send(a,n)}catch(e){if(!(w<2))throw e;n(-1,e)}}else n(-1,"No Transport");return T}return T.abort()},active:0,lastModified:{},etag:{}});var Ht=[],Ft=/\?/,Mt=/(=)\?(?=&|$)|\?\?/,Ot=ye.now();ye.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Ht.pop()||ye.expando+"_"+Ot++;return this[e]=!0,e}}),ye.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=e.data,s=e.url,l=!1!==e.jsonp,u=l&&Mt.test(s),c=l&&!u&&"string"==typeof a&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Mt.test(a);if("jsonp"===e.dataTypes[0]||u||c)return r=e.jsonpCallback=ye.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,i=m[r],u?e.url=s.replace(Mt,"$1"+r):c?e.data=a.replace(Mt,"$1"+r):l&&(e.url+=(Ft.test(s)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||ye.error(r+" was not called"),o[0]},e.dataTypes[0]="json",m[r]=function(){o=arguments},n.always(function(){m[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,Ht.push(r)),o&&ye.isFunction(i)&&i(o[0]),o=i=C}),"script"}),ye.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return ye.globalEval(e),e}}}),ye.ajaxPrefilter("script",function(e){e.cache===C&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),ye.ajaxTransport("script",function(t){if(t.crossDomain){var r,i=F.head||F.getElementsByTagName("head")[0]||F.documentElement;return{send:function(e,n){(r=F.createElement("script")).async="async",t.scriptCharset&&(r.charset=t.scriptCharset),r.src=t.url,r.onload=r.onreadystatechange=function(e,t){(t||!r.readyState||/loaded|complete/.test(r.readyState))&&(r.onload=r.onreadystatechange=null,i&&r.parentNode&&i.removeChild(r),r=C,t||n(200,"success"))},i.insertBefore(r,i.firstChild)},abort:function(){r&&r.onload(0,1)}}}});var _t,qt,Bt=!!m.ActiveXObject&&function(){for(var e in _t)_t[e](0,1)},Wt=0;ye.ajaxSettings.xhr=m.ActiveXObject?function(){return!this.isLocal&&N()||function(){try{return new m.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}()}:N,qt=ye.ajaxSettings.xhr(),ye.extend(ye.support,{ajax:!!qt,cors:!!qt&&"withCredentials"in qt}),ye.support.ajax&&ye.ajaxTransport(function(c){var f;if(!c.crossDomain||ye.support.cors)return{send:function(e,s){var l,t,u=c.xhr();if(c.username?u.open(c.type,c.url,c.async,c.username,c.password):u.open(c.type,c.url,c.async),c.xhrFields)for(t in c.xhrFields)u[t]=c.xhrFields[t];c.mimeType&&u.overrideMimeType&&u.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(t in e)u.setRequestHeader(t,e[t])}catch(e){}u.send(c.hasContent&&c.data||null),f=function(e,t){var n,r,i,o,a;try{if(f&&(t||4===u.readyState))if(f=C,l&&(u.onreadystatechange=ye.noop,Bt&&delete _t[l]),t)4!==u.readyState&&u.abort();else{n=u.status,i=u.getAllResponseHeaders(),o={},(a=u.responseXML)&&a.documentElement&&(o.xml=a);try{o.text=u.responseText}catch(e){}try{r=u.statusText}catch(e){r=""}n||!c.isLocal||c.crossDomain?1223===n&&(n=204):n=o.text?200:404}}catch(e){t||s(-1,e)}o&&s(n,r,o,i)},c.async?4===u.readyState?setTimeout(f,0):(l=++Wt,Bt&&(_t||(_t={},ye(m).unload(Bt)),_t[l]=f),u.onreadystatechange=f):f()},abort:function(){f&&f(0,1)}}});var Pt,Rt,$t=/^(?:toggle|show|hide)$/,It=new RegExp("^(?:([-+])=|)("+z+")([a-z%]*)$","i"),zt=/queueHooks$/,Xt=[function(t,e,n){var r,i,o,a,s,l,u,c,f,p=this,d=t.style,h={},g=[],m=t.nodeType&&b(t);for(r in n.queue||(null==(c=ye._queueHooks(t,"fx")).unqueued&&(c.unqueued=0,f=c.empty.fire,c.empty.fire=function(){c.unqueued||f()}),c.unqueued++,p.always(function(){p.always(function(){c.unqueued--,ye.queue(t,"fx").length||c.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===ye.css(t,"display")&&"none"===ye.css(t,"float")&&(ye.support.inlineBlockNeedsLayout&&"inline"!==x(t.nodeName)?d.zoom=1:d.display="inline-block")),n.overflow&&(d.overflow="hidden",ye.support.shrinkWrapBlocks||p.done(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]})),e)if(o=e[r],$t.exec(o)){if(delete e[r],l=l||"toggle"===o,o===(m?"hide":"show"))continue;g.push(r)}if(a=g.length){"hidden"in(s=ye._data(t,"fxshow")||ye._data(t,"fxshow",{}))&&(m=s.hidden),l&&(s.hidden=!m),m?ye(t).show():p.done(function(){ye(t).hide()}),p.done(function(){var e;for(e in ye.removeData(t,"fxshow",!0),h)ye.style(t,e,h[e])});for(r=0;r<a;r++)i=g[r],u=p.createTween(i,m?s[i]:0),h[i]=s[i]||ye.style(t,i),i in s||(s[i]=u.start,m&&(u.end=u.start,u.start="width"===i||"height"===i?1:0))}}],Ut={"*":[function(e,t){var n,r,i=this.createTween(e,t),o=It.exec(t),a=i.cur(),s=+a||0,l=1,u=20;if(o){if(n=+o[2],"px"!==(r=o[3]||(ye.cssNumber[e]?"":"px"))&&s)for(s=ye.css(i.elem,e,!0)||n||1;s/=l=l||".5",ye.style(i.elem,e,s+r),l!==(l=i.cur()/a)&&1!==l&&--u;);i.unit=r,i.start=s,i.end=o[1]?s+(o[1]+1)*n:n}return i}]};ye.Animation=ye.extend(S,{tweener:function(e,t){for(var n,r=0,i=(e=ye.isFunction(e)?(t=e,["*"]):e.split(" ")).length;r<i;r++)n=e[r],Ut[n]=Ut[n]||[],Ut[n].unshift(t)},prefilter:function(e,t){t?Xt.unshift(e):Xt.push(e)}}),((ye.Tween=A).prototype={constructor:A,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(ye.cssNumber[n]?"":"px")},cur:function(){var e=A.propHooks[this.prop];return e&&e.get?e.get(this):A.propHooks._default.get(this)},run:function(e){var t,n=A.propHooks[this.prop];return this.options.duration?this.pos=t=ye.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):A.propHooks._default.set(this),this}}).init.prototype=A.prototype,(A.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=ye.css(e.elem,e.prop,!1,""))&&"auto"!==t?t:0:e.elem[e.prop]},set:function(e){ye.fx.step[e.prop]?ye.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[ye.cssProps[e.prop]]||ye.cssHooks[e.prop])?ye.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}}).scrollTop=A.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ye.each(["toggle","show","hide"],function(r,i){var o=ye.fn[i];ye.fn[i]=function(e,t,n){return null==e||"boolean"==typeof e||!r&&ye.isFunction(e)&&ye.isFunction(t)?o.apply(this,arguments):this.animate(j(i,!0),e,t,n)}}),ye.fn.extend({fadeTo:function(e,t,n,r){return this.filter(b).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=ye.isEmptyObject(t),o=ye.speed(e,n,r),a=function(){var e=S(this,ye.extend({},t),o);i&&e.stop(!0)};return i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=C),e&&!1!==i&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=ye.timers,r=ye._data(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&zt.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem===this&&(null==i||n[t].queue===i)&&(n[t].anim.stop(o),e=!1,n.splice(t,1));(e||!o)&&ye.dequeue(this,i)})}}),ye.each({slideDown:j("show"),slideUp:j("hide"),slideToggle:j("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){ye.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),ye.speed=function(e,t,n){var r=e&&"object"==typeof e?ye.extend({},e):{complete:n||!n&&t||ye.isFunction(e)&&e,duration:e,easing:n&&t||t&&!ye.isFunction(t)&&t};return r.duration=ye.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in ye.fx.speeds?ye.fx.speeds[r.duration]:ye.fx.speeds._default,null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){ye.isFunction(r.old)&&r.old.call(this),r.queue&&ye.dequeue(this,r.queue)},r},ye.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},ye.timers=[],ye.fx=A.prototype.init,ye.fx.tick=function(){var e,t=ye.timers,n=0;for(Pt=ye.now();n<t.length;n++)!(e=t[n])()&&t[n]===e&&t.splice(n--,1);t.length||ye.fx.stop(),Pt=C},ye.fx.timer=function(e){e()&&ye.timers.push(e)&&!Rt&&(Rt=setInterval(ye.fx.tick,ye.fx.interval))},ye.fx.interval=13,ye.fx.stop=function(){clearInterval(Rt),Rt=null},ye.fx.speeds={slow:600,fast:200,_default:400},ye.fx.step={},ye.expr&&ye.expr.filters&&(ye.expr.filters.animated=function(t){return ye.grep(ye.timers,function(e){return t===e.elem}).length});var Yt=/^(?:body|html)$/i;ye.fn.offset=function(t){if(arguments.length)return t===C?this:this.each(function(e){ye.offset.setOffset(this,t,e)});var e,n,r,i,o,a,s,l={top:0,left:0},u=this[0],c=u&&u.ownerDocument;return c?(n=c.body)===u?ye.offset.bodyOffset(u):(e=c.documentElement,ye.contains(e,u)?(void 0!==u.getBoundingClientRect&&(l=u.getBoundingClientRect()),r=D(c),i=e.clientTop||n.clientTop||0,o=e.clientLeft||n.clientLeft||0,a=r.pageYOffset||e.scrollTop,s=r.pageXOffset||e.scrollLeft,{top:l.top+a-i,left:l.left+s-o}):l):void 0},ye.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return ye.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(ye.css(e,"marginTop"))||0,n+=parseFloat(ye.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var r=ye.css(e,"position");"static"===r&&(e.style.position="relative");var i,o,a=ye(e),s=a.offset(),l=ye.css(e,"top"),u=ye.css(e,"left"),c={},f={};o=("absolute"===r||"fixed"===r)&&-1<ye.inArray("auto",[l,u])?(i=(f=a.position()).top,f.left):(i=parseFloat(l)||0,parseFloat(u)||0),ye.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(c.top=t.top-s.top+i),null!=t.left&&(c.left=t.left-s.left+o),"using"in t?t.using.call(e,c):a.css(c)}},ye.fn.extend({position:function(){if(this[0]){var e=this[0],t=this.offsetParent(),n=this.offset(),r=Yt.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(ye.css(e,"marginTop"))||0,n.left-=parseFloat(ye.css(e,"marginLeft"))||0,r.top+=parseFloat(ye.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(ye.css(t[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||F.body;e&&!Yt.test(e.nodeName)&&"static"===ye.css(e,"position");)e=e.offsetParent;return e||F.body})}}),ye.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o=/Y/.test(i);ye.fn[t]=function(e){return ye.access(this,function(e,t,n){var r=D(e);if(n===C)return r?i in r?r[i]:r.document.documentElement[t]:e[t];r?r.scrollTo(o?ye(r).scrollLeft():n,o?n:ye(r).scrollTop()):e[t]=n},t,e,arguments.length,null)}}),ye.each({Height:"height",Width:"width"},function(o,a){ye.each({padding:"inner"+o,content:a,"":"outer"+o},function(r,e){ye.fn[e]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return ye.access(this,function(e,t,n){var r;return ye.isWindow(e)?e.document.documentElement["client"+o]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+o],r["scroll"+o],e.body["offset"+o],r["offset"+o],r["client"+o])):n===C?ye.css(e,t,n,i):ye.style(e,t,n,i)},a,n?e:C,n,null)}})}),m.jQuery=m.$=ye,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return ye})}(window);!function(m){m.browserTest=function(e,r){var s="unknown",i="X",t=function(e,r){for(var o=0;o<r.length;o+=1)e=e.replace(r[o][0],r[o][1]);return e},o=function(e,r,o,a){var n={name:t((r.exec(e)||[s,s])[1],o)};return n[n.name]=!0,n.version=(a.exec(e)||[i,i,i,i])[3],n.name.match(/safari/)&&400<n.version&&(n.version="2.0"),"presto"===n.name&&(n.version=9.27<m.browser.version?"futhark":"linear_b"),n.versionNumber=parseFloat(n.version,10)||0,n.versionX=n.version!==i?(n.version+"").substr(0,1):i,n.className=n.name+n.versionX,n};e=((e=/Trident/.exec(e)&&/rv/.exec(e)?e.replace("rv:","msie/"):e).match(/Opera|Navigator|Minefield|KHTML|Chrome/)?t(e,[[/(Firefox|MSIE|KHTML,\slike\sGecko|Konqueror)/,""],["Chrome Safari","Chrome"],["KHTML","Konqueror"],["Minefield","Firefox"],["Navigator","Netscape"]]):e).toLowerCase(),m.browser=m.extend(r?{}:m.browser,o(e,/(camino|chrome|firefox|netscape|konqueror|lynx|msie|opera|safari|mobile|nintendo|dolfin)/,[],/(camino|chrome|firefox|netscape|netscape6|opera|version|konqueror|lynx|msie|safari|mobile|nintendo)(\/|\s)([a-z0-9\.\+]*?)(\;|dev|rel|\s|\)|$)/)),m.layout=o(e,/(gecko|konqueror|msie|opera|webkit)/,[["konqueror","khtml"],["msie","trident"],["opera","presto"]],/(applewebkit|rv|konqueror|msie)(\:|\/\s)([a-z0-9\.]*?)(\;|\)|\s)/);var a=(/(wince|win|mac|linux|sunos|solaris|iphone|ipad|ipod|nokia|webos|blackberry|s60|widerweb|symbian|nintendo|bada|kfot|playstation)/.exec(navigator.platform.toLowerCase())||[s])[0].replace("sunos","solaris").replace("widerweb","motorola").replace("s60","symbian").replace("kfot","kindle");a=(/(android)/.exec(e.toLowerCase())||[a])[0],a=(/(windows)/.exec(e.toLowerCase())||[a])[0],m.browser.name="playstation"==a&&"unknown"==m.browser.name?"mobile":m.browser.name,m.os={name:a},r||m("html").addClass([m.os.name,m.browser.name,m.browser.className,m.layout.name,m.layout.className].join(" "))},m.browserTest(navigator.userAgent)}(jQuery);!function(){var o,d=0,i=0,u={},h={};function m(e,t,n){return"_root"==t?n:e!==n?(i=e,o||(o=i.matches?i.matches:i.webkitMatchesSelector?i.webkitMatchesSelector:i.mozMatchesSelector?i.mozMatchesSelector:i.msMatchesSelector?i.msMatchesSelector:i.oMatchesSelector?i.oMatchesSelector:v.matchesSelector)).call(e,t)?e:e.parentNode?(d++,m(e.parentNode,t,n)):void 0:void 0;var i}function p(e,t,n,i){if(u[e.id])if(t)if(i||n)if(i){if(u[e.id][t][n])for(var o=0;o<u[e.id][t][n].length;o++)if(u[e.id][t][n][o]===i){u[e.id][t][n].splice(o,1);break}}else delete u[e.id][t][n];else u[e.id][t]={};else for(var r in u[e.id])u[e.id].hasOwnProperty(r)&&(u[e.id][r]={})}function r(e,t,n,i){if(this.element){e instanceof Array||(e=[e]),n||"function"!=typeof t||(n=t,t="_root");var o,r,c,a,f,l=this.id;for(o=0;o<e.length;o++)i?p(this,e[o],t,n):(u[l]&&u[l][e[o]]||v.addEvent(this,e[o],s(e[o])),r=this,c=e[o],a=t,f=n,u[r.id]||(u[r.id]={}),u[r.id][c]||(u[r.id][c]={}),u[r.id][c][a]||(u[r.id][c][a]=[]),u[r.id][c][a].push(f));return this}function s(t){return function(e){!function(e,t,n){if(u[e][n]){var i,o,r=t.target||t.srcElement,c={},a=0,f=0;for(i in d=0,u[e][n])u[e][n].hasOwnProperty(i)&&(o=m(r,i,h[e].element))&&v.matchesEvent(n,h[e].element,o,"_root"==i,t)&&(d++,u[e][n][i].match=o,c[d]=u[e][n][i]);for(t.stopPropagation=function(){t.cancelBubble=!0},a=0;a<=d;a++)if(c[a])for(f=0;f<c[a].length;f++){if(!1===c[a][f].call(c[a].match,t))return v.cancel(t);if(t.cancelBubble)return}}}(l,e,t)}}}function v(e,t){if(!(this instanceof v)){for(var n in h)if(h[n].element===e)return h[n];return h[++i]=new v(e,i),h[i]}this.element=e,this.id=t}v.prototype.on=function(e,t,n){return r.call(this,e,t,n)},v.prototype.off=function(e,t,n){return r.call(this,e,t,n,!0)},v.matchesSelector=function(){},v.cancel=function(e){e.preventDefault(),e.stopPropagation()},v.addEvent=function(e,t,n){var i="blur"==t||"focus"==t;e.element.addEventListener(t,n,i)},v.matchesEvent=function(){return!0},"undefined"!=typeof module&&module.exports&&(module.exports=v),window.Gator=v}();function lamejs(){function ea(e){return new Int32Array(e)}function ta(e){return new Float32Array(e)}function aa(e){if(1==e.length)return ta(e[0]);var t=e[0];e=e.slice(1);for(var a=[],s=0;s<t;s++)a.push(aa(e));return a}function M(e){if(1==e.length)return ea(e[0]);var t=e[0];e=e.slice(1);for(var a=[],s=0;s<t;s++)a.push(M(e));return a}function w(e){if(1==e.length)return Array(e[0]);var t=e[0];e=e.slice(1);for(var a=[],s=0;s<t;s++)a.push(w(e));return a}function sa(e){this.ordinal=e}function ut(e){this.ordinal=e}function na(e){this.ordinal=function(){return e}}function R(){this.getLameVersion=function(){return"3.98.4"},this.getLameShortVersion=function(){return"3.98.4"},this.getLameVeryShortVersion=function(){return"LAME3.98r"},this.getPsyVersion=function(){return"0.93"},this.getLameUrl=function(){return"http://www.mp3dev.org/"},this.getLameOsBitness=function(){return"32bits"}}function E(){function p(e){this.bits=0|e}function S(e,t,a,s,n,r){for(t=.5946/t,e>>=1;0!=e--;)n[r++]=t>a[s++]?0:1,n[r++]=t>a[s++]?0:1}function R(e,t,a,s,n,r){var _=(e>>=1)%2;for(e>>=1;0!=e--;){var i=a[s++]*t,o=a[s++]*t,l=0|i,f=a[s++]*t,h=0|o,c=a[s++]*t,b=0|f;i+=M.adj43[l],l=0|c,o+=M.adj43[h],n[r++]=0|i,f+=M.adj43[b],n[r++]=0|o,c+=M.adj43[l],n[r++]=0|f,n[r++]=0|c}0!=_&&(i=a[s++]*t,o=a[s++]*t,i+=M.adj43[0|i],o+=M.adj43[0|o],n[r++]=0|i,n[r++]=0|o)}function d(e,t,a,s){var n,r=t,_=n=0;do{n<(i=e[r++])&&(n=i),_<(o=e[r++])&&(_=o)}while(r<a);switch(n<_&&(n=_),n){case 0:return n;case 1:for(r=t,t=0,n=te.ht[1].hlen;_=2*e[r+0]+e[r+1],r+=2,t+=n[_],r<a;);return s.bits+=t,1;case 2:case 3:for(r=t,t=b[n-1],n=0,_=te.ht[t].xlen,i=2==t?te.table23:te.table56;o=e[r+0]*_+e[r+1],r+=2,n+=i[o],r<a;);return(e=65535&n)<(n>>=16)&&(n=e,t++),s.bits+=n,t;case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:r=t,t=b[n-1];var i=_=n=0,o=te.ht[t].xlen,l=te.ht[t].hlen,f=te.ht[t+1].hlen,h=te.ht[t+2].hlen;do{var c=e[r+0]*o+e[r+1];r=r+2;n+=l[c],_+=f[c],i+=h[c]}while(r<a);return e=t,_<n&&(n=_,e++),i<n&&(n=i,e=t+2),s.bits+=n,e;default:if(P.IXMAX_VAL<n)return s.bits=P.LARGE_BITS,-1;for(n-=15,r=24;r<32&&!(te.ht[r].linmax>=n);r++);for(_=r-8;_<24&&!(te.ht[_].linmax>=n);_++);for(n=_,i=65536*te.ht[n].xlen+te.ht[r].xlen,_=0;0!=(o=e[t++])&&(14<o&&(o=15,_+=i),o*=16),0!=(l=e[t++])&&(14<l&&(l=15,_+=i),o+=l),_+=te.largetbl[o],t<a;);return(e=65535&_)<(_>>=16)&&(_=e,n=r),s.bits+=_,n}}function g(e,t,a,s,n,r,_,i){for(var o=t.big_values,l=2;l<ra.SBMAX_l+1;l++){var f=e.scalefac_band.l[l];if(o<=f)break;var h=n[l-2]+t.count1bits;if(a.part2_3_length<=h)break;f=d(s,f,o,h=new p(h)),h=h.bits,a.part2_3_length<=h||(a.assign(t),a.part2_3_length=h,a.region0_count=r[l-2],a.region1_count=l-2-r[l-2],a.table_select[0]=_[l-2],a.table_select[1]=i[l-2],a.table_select[2]=f)}}var M=null;this.qupvt=null,this.setModules=function(e){M=this.qupvt=e};var n=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]],b=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];this.noquant_count_bits=function(e,t,a){var s=t.l3_enc,n=Math.min(576,t.max_nonzero_coeff+2>>1<<1);for(null!=a&&(a.sfb_count1=0);1<n&&0==(s[n-1]|s[n-2]);n-=2);t.count1=n;for(var r=0,_=0;3<n&&!(1<(2147483647&(s[n-1]|s[n-2]|s[n-3]|s[n-4])));n-=4){var i=2*(2*(2*s[n-4]+s[n-3])+s[n-2])+s[n-1];r+=te.t32l[i],_+=te.t33l[i]}if(i=r,t.count1table_select=0,_<r&&(i=_,t.count1table_select=1),t.count1bits=i,0==(t.big_values=n))return i;if(t.block_type==ra.SHORT_TYPE?((r=3*e.scalefac_band.s[3])>t.big_values&&(r=t.big_values),_=t.big_values):t.block_type==ra.NORM_TYPE?(r=t.region0_count=e.bv_scf[n-2],_=t.region1_count=e.bv_scf[n-1],_=e.scalefac_band.l[r+_+2],r=e.scalefac_band.l[r+1],_<n&&(i=new p(i),t.table_select[2]=d(s,_,n,i),i=i.bits)):(t.region0_count=7,t.region1_count=ra.SBMAX_l-1-7-1,(_=n)<(r=e.scalefac_band.l[8])&&(r=_)),r=Math.min(r,n),_=Math.min(_,n),0<r&&(i=new p(i),t.table_select[0]=d(s,0,r,i),i=i.bits),r<_&&(i=new p(i),t.table_select[1]=d(s,r,_,i),i=i.bits),2==e.use_best_huffman&&(t.part2_3_length=i,best_huffman_divide(e,t),i=t.part2_3_length),null!=a&&t.block_type==ra.NORM_TYPE){for(s=0;e.scalefac_band.l[s]<t.big_values;)s++;a.sfb_count1=s}return i},this.count_bits=function(e,t,a,s){var n=a.l3_enc,r=P.IXMAX_VAL/M.IPOW20(a.global_gain);if(a.xrpow_max>r)return P.LARGE_BITS;r=M.IPOW20(a.global_gain);var _,i=0,o=0,l=0,f=0,h=0,c=n,b=0,u=t,m=0,p=null!=s&&a.global_gain==s.global_gain,d=a.block_type==ra.SHORT_TYPE?38:21;for(_=0;_<=d;_++){var g=-1;if((p||a.block_type==ra.NORM_TYPE)&&(g=a.global_gain-(a.scalefac[_]+(0!=a.preflag?M.pretab[_]:0)<<a.scalefac_scale+1)-8*a.subblock_gain[a.window[_]]),p&&s.step[_]==g)0!=o&&(R(o,r,u,m,c,b),o=0),0!=l&&(S(l,r,u,m,c,b),l=0);else{var v=a.width[_];if(i+a.width[_]>a.max_nonzero_coeff&&(_=a.max_nonzero_coeff-i+1,mt.fill(n,a.max_nonzero_coeff,576,0),(v=_)<0&&(v=0),_=d+1),0==o&&0==l&&(c=n,b=h,u=t,m=f),null!=s&&0<s.sfb_count1&&_>=s.sfb_count1&&0<s.step[_]&&g>=s.step[_]?(0!=o&&(R(o,r,u,m,c,b),o=0,c=n,b=h,u=t,m=f),l+=v):(0!=l&&(S(l,r,u,m,c,b),l=0,c=n,b=h,u=t,m=f),o+=v),v<=0){0!=l&&(S(l,r,u,m,c,b),l=0),0!=o&&(R(o,r,u,m,c,b),o=0);break}}_<=d&&(h+=a.width[_],f+=a.width[_],i+=a.width[_])}if(0!=o&&R(o,r,u,m,c,b),0!=l&&S(l,r,u,m,c,b),0!=(2&e.substep_shaping))for(r=0,d=.634521682242439/M.IPOW20(a.global_gain+a.scalefac_scale),i=0;i<a.sfbmax;i++)if(p=a.width[i],0==e.pseudohalf[i])r+=p;else for(o=r,r+=p;o<r;++o)n[o]=t[o]>=d?n[o]:0;return this.noquant_count_bits(e,a,s)},this.best_huffman_divide=function(e,t){var a=new N,s=t.l3_enc,n=ea(23),r=ea(23),_=ea(23),i=ea(23);if(t.block_type!=ra.SHORT_TYPE||1!=e.mode_gr){if(a.assign(t),t.block_type==ra.NORM_TYPE){for(var o=t.big_values,l=0;l<=22;l++)n[l]=P.LARGE_BITS;for(l=0;l<16;l++){var f=e.scalefac_band.l[l+1];if(o<=f)break;for(var h=new p(b=0),c=d(s,0,f,h),b=h.bits,u=0;u<8;u++){var m=e.scalefac_band.l[l+u+2];if(o<=m)break;m=d(s,f,m,h=new p(h=b)),h=h.bits,n[l+u]>h&&(n[l+u]=h,_[(r[l+u]=l)+u]=c,i[l+u]=m)}}g(e,a,t,s,n,r,_,i)}if(!(0==(o=a.big_values)||1<(s[o-2]|s[o-1])||576<(o=t.count1+2))){for(a.assign(t),a.count1=o,f=l=0;o>a.big_values;o-=4)b=2*(2*(2*s[o-4]+s[o-3])+s[o-2])+s[o-1],l+=te.t32l[b],f+=te.t33l[b];a.big_values=o,a.count1table_select=0,f<l&&(l=f,a.count1table_select=1),a.count1bits=l,a.block_type==ra.NORM_TYPE?g(e,a,t,s,n,r,_,i):(a.part2_3_length=l,o<(l=e.scalefac_band.l[8])&&(l=o),0<l&&(e=new p(a.part2_3_length),a.table_select[0]=d(s,0,l,e),a.part2_3_length=e.bits),l<o&&(e=new p(a.part2_3_length),a.table_select[1]=d(s,l,o,e),a.part2_3_length=e.bits),t.part2_3_length>a.part2_3_length&&t.assign(a))}}};var l=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],f=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],h=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],c=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];E.slen1_tab=h,E.slen2_tab=c,this.best_scalefac_store=function(e,t,a,s){var n,r,_=s.tt[t][a],i=0;for(n=r=0;n<_.sfbmax;n++){var o=_.width[n];for(r+=o,o=-o;o<0&&0==_.l3_enc[o+r];o++);0==o&&(_.scalefac[n]=i=-2)}if(0==_.scalefac_scale&&0==_.preflag){for(n=r=0;n<_.sfbmax;n++)0<_.scalefac[n]&&(r|=_.scalefac[n]);if(0==(1&r)&&0!=r){for(n=0;n<_.sfbmax;n++)0<_.scalefac[n]&&(_.scalefac[n]>>=1);_.scalefac_scale=i=1}}if(0==_.preflag&&_.block_type!=ra.SHORT_TYPE&&2==e.mode_gr){for(n=11;n<ra.SBPSY_l&&!(_.scalefac[n]<M.pretab[n]&&-2!=_.scalefac[n]);n++);if(n==ra.SBPSY_l){for(n=11;n<ra.SBPSY_l;n++)0<_.scalefac[n]&&(_.scalefac[n]-=M.pretab[n]);_.preflag=i=1}}for(n=0;n<4;n++)s.scfsi[a][n]=0;if(2==e.mode_gr&&1==t&&s.tt[0][a].block_type!=ra.SHORT_TYPE&&s.tt[1][a].block_type!=ra.SHORT_TYPE){for(t=s.tt[1][a],r=s.tt[0][a],i=0;i<te.scfsi_band.length-1;i++){for(n=te.scfsi_band[i];n<te.scfsi_band[i+1]&&!(r.scalefac[n]!=t.scalefac[n]&&0<=t.scalefac[n]);n++);if(n==te.scfsi_band[i+1]){for(n=te.scfsi_band[i];n<te.scfsi_band[i+1];n++)t.scalefac[n]=-1;s.scfsi[a][i]=1}}for(n=s=a=0;n<11;n++)-1!=t.scalefac[n]&&(s++,a<t.scalefac[n]&&(a=t.scalefac[n]));for(o=r=0;n<ra.SBPSY_l;n++)-1!=t.scalefac[n]&&(o++,r<t.scalefac[n]&&(r=t.scalefac[n]));for(i=0;i<16;i++)a<l[i]&&r<f[i]&&(n=h[i]*s+c[i]*o,t.part2_length>n&&(t.part2_length=n,t.scalefac_compress=i));i=0}for(n=0;n<_.sfbmax;n++)-2==_.scalefac[n]&&(_.scalefac[n]=0);0!=i&&(2==e.mode_gr?this.scale_bitcount(_):this.scale_bitcount_lsf(e,_))};var _=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],i=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],o=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(e){var t,a=0,s=0,n=e.scalefac;if(e.block_type==ra.SHORT_TYPE){var r=_;0!=e.mixed_block_flag&&(r=i)}else if(r=o,0==e.preflag){for(t=11;t<ra.SBPSY_l&&!(n[t]<M.pretab[t]);t++);if(t==ra.SBPSY_l)for(e.preflag=1,t=11;t<ra.SBPSY_l;t++)n[t]-=M.pretab[t]}for(t=0;t<e.sfbdivide;t++)a<n[t]&&(a=n[t]);for(;t<e.sfbmax;t++)s<n[t]&&(s=n[t]);for(e.part2_length=P.LARGE_BITS,t=0;t<16;t++)a<l[t]&&s<f[t]&&e.part2_length>r[t]&&(e.part2_length=r[t],e.scalefac_compress=t);return e.part2_length==P.LARGE_BITS};var u=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(e,t){var a,s,n,r,_=ea(4),i=t.scalefac;for(e=0!=t.preflag?2:0,n=0;n<4;n++)_[n]=0;if(t.block_type==ra.SHORT_TYPE){var o=1,l=M.nr_of_sfb_block[e][o];for(a=r=0;a<4;a++){var f=l[a]/3;for(n=0;n<f;n++,r++)for(s=0;s<3;s++)i[3*r+s]>_[a]&&(_[a]=i[3*r+s])}}else for(o=0,l=M.nr_of_sfb_block[e][o],a=r=0;a<4;a++)for(f=l[a],n=0;n<f;n++,r++)i[r]>_[a]&&(_[a]=i[r]);for(l=!1,a=0;a<4;a++)_[a]>u[e][a]&&(l=!0);if(!l){for(t.sfb_partition_table=M.nr_of_sfb_block[e][o],a=0;a<4;a++)t.slen[a]=m[_[a]];switch(o=t.slen[0],a=t.slen[1],_=t.slen[2],f=t.slen[3],e){case 0:t.scalefac_compress=(5*o+a<<4)+(_<<2)+f;break;case 1:t.scalefac_compress=400+(5*o+a<<2)+_;break;case 2:t.scalefac_compress=500+3*o+a;break;default:ee.err.printf("intensity stereo not implemented yet\n")}}if(!l)for(a=t.part2_length=0;a<4;a++)t.part2_length+=t.slen[a]*t.sfb_partition_table[a];return l};var m=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(e){for(var t=2;t<=576;t+=2){for(var a,s=0;e.scalefac_band.l[++s]<t;);for(a=n[s][0];e.scalefac_band.l[a+1]>t;)a--;for(a<0&&(a=n[s][0]),e.bv_scf[t-2]=a,a=n[s][1];e.scalefac_band.l[a+e.bv_scf[t-2]+2]>t;)a--;a<0&&(a=n[s][1]),e.bv_scf[t-1]=a}}}function W(){function u(e,t,a,s,n,r){for(;0!=n--;)a[s]=1e-10+e[t+0]*r[0]-a[s-1]*r[1]+e[t-1]*r[2]-a[s-2]*r[3]+e[t-2]*r[4]-a[s-3]*r[5]+e[t-3]*r[6]-a[s-4]*r[7]+e[t-4]*r[8]-a[s-5]*r[9]+e[t-5]*r[10]-a[s-6]*r[11]+e[t-6]*r[12]-a[s-7]*r[13]+e[t-7]*r[14]-a[s-8]*r[15]+e[t-8]*r[16]-a[s-9]*r[17]+e[t-9]*r[18]-a[s-10]*r[19]+e[t-10]*r[20],++s,++t}function m(e,t,a,s,n,r){for(;0!=n--;)a[s]=e[t+0]*r[0]-a[s-1]*r[1]+e[t-1]*r[2]-a[s-2]*r[3]+e[t-2]*r[4],++s,++t}function p(e){return e*e}var s=W.RMS_WINDOW_TIME_NUMERATOR,n=W.RMS_WINDOW_TIME_DENOMINATOR,d=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],g=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];this.InitGainAnalysis=function(e,t){e:{for(var a=0;a<MAX_ORDER;a++)e.linprebuf[a]=e.lstepbuf[a]=e.loutbuf[a]=e.rinprebuf[a]=e.rstepbuf[a]=e.routbuf[a]=0;switch(0|t){case 48e3:e.reqindex=0;break;case 44100:e.reqindex=1;break;case 32e3:e.reqindex=2;break;case 24e3:e.reqindex=3;break;case 22050:e.reqindex=4;break;case 16e3:e.reqindex=5;break;case 12e3:e.reqindex=6;break;case 11025:e.reqindex=7;break;case 8e3:e.reqindex=8;break;default:t=INIT_GAIN_ANALYSIS_ERROR;break e}e.sampleWindow=0|(t*s+n-1)/n,e.lsum=0,e.rsum=0,e.totsamp=0,mt.ill(e.A,0),t=INIT_GAIN_ANALYSIS_OK}return t!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(e.linpre=MAX_ORDER,e.rinpre=MAX_ORDER,e.lstep=MAX_ORDER,e.rstep=MAX_ORDER,e.lout=MAX_ORDER,e.rout=MAX_ORDER,mt.fill(e.B,0),INIT_GAIN_ANALYSIS_OK)},this.AnalyzeSamples=function(e,t,a,s,n,r,_){if(0==r)return GAIN_ANALYSIS_OK;var i=0,o=r;switch(_){case 1:s=t,n=a;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(r<MAX_ORDER?(ee.arraycopy(t,a,e.linprebuf,MAX_ORDER,r),ee.arraycopy(s,n,e.rinprebuf,MAX_ORDER,r)):(ee.arraycopy(t,a,e.linprebuf,MAX_ORDER,MAX_ORDER),ee.arraycopy(s,n,e.rinprebuf,MAX_ORDER,MAX_ORDER));0<o;){var l=o>e.sampleWindow-e.totsamp?e.sampleWindow-e.totsamp:o;if(i<MAX_ORDER){_=e.linpre+i;var f=e.linprebuf,h=e.rinpre+i,c=e.rinprebuf;l>MAX_ORDER-i&&(l=MAX_ORDER-i)}else _=a+i,f=t,h=n+i,c=s;u(f,_,e.lstepbuf,e.lstep+e.totsamp,l,d[e.reqindex]),u(c,h,e.rstepbuf,e.rstep+e.totsamp,l,d[e.reqindex]),m(e.lstepbuf,e.lstep+e.totsamp,e.loutbuf,e.lout+e.totsamp,l,g[e.reqindex]),m(e.rstepbuf,e.rstep+e.totsamp,e.routbuf,e.rout+e.totsamp,l,g[e.reqindex]),_=e.lout+e.totsamp,f=e.loutbuf,h=e.rout+e.totsamp,c=e.routbuf;for(var b=l%8;0!=b--;)e.lsum+=p(f[_++]),e.rsum+=p(c[h++]);for(b=l/8;0!=b--;)e.lsum+=p(f[_+0])+p(f[_+1])+p(f[_+2])+p(f[_+3])+p(f[_+4])+p(f[_+5])+p(f[_+6])+p(f[_+7]),_+=8,e.rsum+=p(c[h+0])+p(c[h+1])+p(c[h+2])+p(c[h+3])+p(c[h+4])+p(c[h+5])+p(c[h+6])+p(c[h+7]),h+=8;if(o-=l,i+=l,e.totsamp+=l,e.totsamp==e.sampleWindow&&((_=(_=10*W.STEPS_per_dB*Math.log10((e.lsum+e.rsum)/e.totsamp*.5+1e-37))<=0?0:0|_)>=e.A.length&&(_=e.A.length-1),e.A[_]++,e.lsum=e.rsum=0,ee.arraycopy(e.loutbuf,e.totsamp,e.loutbuf,0,MAX_ORDER),ee.arraycopy(e.routbuf,e.totsamp,e.routbuf,0,MAX_ORDER),ee.arraycopy(e.lstepbuf,e.totsamp,e.lstepbuf,0,MAX_ORDER),ee.arraycopy(e.rstepbuf,e.totsamp,e.rstepbuf,0,MAX_ORDER),e.totsamp=0),e.totsamp>e.sampleWindow)return GAIN_ANALYSIS_ERROR}return r<MAX_ORDER?(ee.arraycopy(e.linprebuf,r,e.linprebuf,0,MAX_ORDER-r),ee.arraycopy(e.rinprebuf,r,e.rinprebuf,0,MAX_ORDER-r),ee.arraycopy(t,a,e.linprebuf,MAX_ORDER-r,r),ee.arraycopy(s,n,e.rinprebuf,MAX_ORDER-r,r)):(ee.arraycopy(t,a+r-MAX_ORDER,e.linprebuf,0,MAX_ORDER),ee.arraycopy(s,n+r-MAX_ORDER,e.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK},this.GetTitleGain=function(e){var t,a=e.A,s=e.A.length,n=0;for(t=0;t<s;t++)n+=a[t];if(0==n)a=GAIN_NOT_ENOUGH_SAMPLES;else{for(n=0|Math.ceil(n*(1-.95)),t=s;0<t--&&!((n-=a[t])<=0););a=64.82-t/W.STEPS_per_dB}for(s=0;s<e.A.length;s++)e.B[s]+=e.A[s],e.A[s]=0;for(s=0;s<MAX_ORDER;s++)e.linprebuf[s]=e.lstepbuf[s]=e.loutbuf[s]=e.rinprebuf[s]=e.rstepbuf[s]=e.routbuf[s]=0;return e.totsamp=0,e.lsum=e.rsum=0,a}}function A(){function e(e,t,a,s,n,r,_,i,o,l,f,h,c,b,u){this.vbr_q=e,this.quant_comp=t,this.quant_comp_s=a,this.expY=s,this.st_lrm=n,this.st_s=r,this.masking_adj=_,this.masking_adj_short=i,this.ath_lower=o,this.ath_curve=l,this.ath_sensitivity=f,this.interch=h,this.safejoint=c,this.sfb21mod=b,this.msfix=u}function t(e,t,a,s,n,r,_,i,o,l,f,h,c,b){this.quant_comp=t,this.quant_comp_s=a,this.safejoint=s,this.nsmsfix=n,this.st_lrm=r,this.st_s=_,this.nsbass=i,this.scale=o,this.masking_adj=l,this.ath_lower=f,this.ath_curve=h,this.interch=c,this.sfscale=b}function s(e,t,a){var s=e.VBR==ut.vbr_rh?_:i,n=e.VBR_q_frac,r=s[t];s=s[t+1];r.st_lrm+=n*(s.st_lrm-r.st_lrm),r.st_s+=n*(s.st_s-r.st_s),r.masking_adj+=n*(s.masking_adj-r.masking_adj),r.masking_adj_short+=n*(s.masking_adj_short-r.masking_adj_short),r.ath_lower+=n*(s.ath_lower-r.ath_lower),r.ath_curve+=n*(s.ath_curve-r.ath_curve),r.ath_sensitivity+=n*(s.ath_sensitivity-r.ath_sensitivity),r.interch+=n*(s.interch-r.interch),r.msfix+=n*(s.msfix-r.msfix),(s=r.vbr_q)<0&&(s=0),9<s&&(s=9),e.VBR_q=s,(e.VBR_q_frac=0)!=a?e.quant_comp=r.quant_comp:0<Math.abs(e.quant_comp- -1)||(e.quant_comp=r.quant_comp),0!=a?e.quant_comp_short=r.quant_comp_s:0<Math.abs(e.quant_comp_short- -1)||(e.quant_comp_short=r.quant_comp_s),0!=r.expY&&(e.experimentalY=0!=r.expY),0!=a?e.internal_flags.nsPsy.attackthre=r.st_lrm:0<Math.abs(e.internal_flags.nsPsy.attackthre- -1)||(e.internal_flags.nsPsy.attackthre=r.st_lrm),0!=a?e.internal_flags.nsPsy.attackthre_s=r.st_s:0<Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)||(e.internal_flags.nsPsy.attackthre_s=r.st_s),0!=a?e.maskingadjust=r.masking_adj:0<Math.abs(e.maskingadjust-0)||(e.maskingadjust=r.masking_adj),0!=a?e.maskingadjust_short=r.masking_adj_short:0<Math.abs(e.maskingadjust_short-0)||(e.maskingadjust_short=r.masking_adj_short),0!=a?e.ATHlower=-r.ath_lower/10:0<Math.abs(10*-e.ATHlower-0)||(e.ATHlower=-r.ath_lower/10),0!=a?e.ATHcurve=r.ath_curve:0<Math.abs(e.ATHcurve- -1)||(e.ATHcurve=r.ath_curve),0!=a?e.athaa_sensitivity=r.ath_sensitivity:0<Math.abs(e.athaa_sensitivity- -1)||(e.athaa_sensitivity=r.ath_sensitivity),0<r.interch&&(0!=a?e.interChRatio=r.interch:0<Math.abs(e.interChRatio- -1)||(e.interChRatio=r.interch)),0<r.safejoint&&(e.exp_nspsytune|=r.safejoint),0<r.sfb21mod&&(e.exp_nspsytune|=r.sfb21mod<<20),0!=a?e.msfix=r.msfix:0<Math.abs(e.msfix- -1)||(e.msfix=r.msfix),0==a&&(e.VBR_q=t,e.VBR_q_frac=n)}function n(e,t,a){var s=r.nearestBitrateFullIndex(t);if(e.VBR=ut.vbr_abr,e.VBR_mean_bitrate_kbps=t,e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320),e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.brate=e.VBR_mean_bitrate_kbps,320<e.VBR_mean_bitrate_kbps&&(e.disable_reservoir=!0),0<o[s].safejoint&&(e.exp_nspsytune|=2),0<o[s].sfscale&&(e.internal_flags.noise_shaping=2),0<Math.abs(o[s].nsbass)){var n=int(4*o[s].nsbass);n<0&&(n+=64),e.exp_nspsytune|=n<<2}return 0!=a?e.quant_comp=o[s].quant_comp:0<Math.abs(e.quant_comp- -1)||(e.quant_comp=o[s].quant_comp),0!=a?e.quant_comp_short=o[s].quant_comp_s:0<Math.abs(e.quant_comp_short- -1)||(e.quant_comp_short=o[s].quant_comp_s),0!=a?e.msfix=o[s].nsmsfix:0<Math.abs(e.msfix- -1)||(e.msfix=o[s].nsmsfix),0!=a?e.internal_flags.nsPsy.attackthre=o[s].st_lrm:0<Math.abs(e.internal_flags.nsPsy.attackthre- -1)||(e.internal_flags.nsPsy.attackthre=o[s].st_lrm),0!=a?e.internal_flags.nsPsy.attackthre_s=o[s].st_s:0<Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)||(e.internal_flags.nsPsy.attackthre_s=o[s].st_s),0!=a?e.scale=o[s].scale:0<Math.abs(e.scale- -1)||(e.scale=o[s].scale),0!=a?e.maskingadjust=o[s].masking_adj:0<Math.abs(e.maskingadjust-0)||(e.maskingadjust=o[s].masking_adj),0<o[s].masking_adj?0!=a?e.maskingadjust_short=.9*o[s].masking_adj:0<Math.abs(e.maskingadjust_short-0)||(e.maskingadjust_short=.9*o[s].masking_adj):0!=a?e.maskingadjust_short=1.1*o[s].masking_adj:0<Math.abs(e.maskingadjust_short-0)||(e.maskingadjust_short=1.1*o[s].masking_adj),0!=a?e.ATHlower=-o[s].ath_lower/10:0<Math.abs(10*-e.ATHlower-0)||(e.ATHlower=-o[s].ath_lower/10),0!=a?e.ATHcurve=o[s].ath_curve:0<Math.abs(e.ATHcurve- -1)||(e.ATHcurve=o[s].ath_curve),0!=a?e.interChRatio=o[s].interch:0<Math.abs(e.interChRatio- -1)||(e.interChRatio=o[s].interch),t}var r;this.setModules=function(e){r=e};var _=[new e(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new e(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new e(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new e(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new e(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new e(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new e(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new e(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new e(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],i=[new e(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new e(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new e(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new e(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new e(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new e(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new e(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new e(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new e(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)],o=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];this.apply_preset=function(e,t,a){switch(t){case X.R3MIX:t=X.V3,e.VBR=ut.vbr_mtrh;break;case X.MEDIUM:t=X.V4,e.VBR=ut.vbr_rh;break;case X.MEDIUM_FAST:t=X.V4,e.VBR=ut.vbr_mtrh;break;case X.STANDARD:t=X.V2,e.VBR=ut.vbr_rh;break;case X.STANDARD_FAST:t=X.V2,e.VBR=ut.vbr_mtrh;break;case X.EXTREME:t=X.V0,e.VBR=ut.vbr_rh;break;case X.EXTREME_FAST:t=X.V0,e.VBR=ut.vbr_mtrh;break;case X.INSANE:return t=320,e.preset=t,n(e,t,a),e.VBR=ut.vbr_off,t}switch(e.preset=t){case X.V9:return s(e,9,a),t;case X.V8:return s(e,8,a),t;case X.V7:return s(e,7,a),t;case X.V6:return s(e,6,a),t;case X.V5:return s(e,5,a),t;case X.V4:return s(e,4,a),t;case X.V3:return s(e,3,a),t;case X.V2:return s(e,2,a),t;case X.V1:return s(e,1,a),t;case X.V0:return s(e,0,a),t}return 8<=t&&t<=320?n(e,t,a):(e.preset=0,t)}}function B(){var i;this.setModules=function(e){i=e},this.ResvFrameBegin=function(e,t){var a=e.internal_flags,s=a.l3_side,n=i.getframebits(e);t.bits=(n-8*a.sideinfo_len)/a.mode_gr;var r=2048*a.mode_gr-8;if(320<e.brate)var _=8*int(1e3*e.brate/(e.out_samplerate/1152)/8+.5);else _=11520,e.strict_ISO&&(_=8*int(32e4/(e.out_samplerate/1152)/8+.5));return a.ResvMax=_-n,a.ResvMax>r&&(a.ResvMax=r),(a.ResvMax<0||e.disable_reservoir)&&(a.ResvMax=0),_<(e=t.bits*a.mode_gr+Math.min(a.ResvSize,a.ResvMax))&&(e=_),s.resvDrain_pre=0,null!=a.pinfo&&(a.pinfo.mean_bits=t.bits/2,a.pinfo.resvsize=a.ResvSize),e},this.ResvMaxBits=function(e,t,a,s){var n=e.internal_flags,r=n.ResvSize,_=n.ResvMax;return 0!=s&&(r+=t),0!=(1&n.substep_shaping)&&(_*=.9),a.bits=t,9*_<10*r?(s=r-9*_/10,a.bits+=s,n.substep_shaping|=128):(s=0,n.substep_shaping&=127,e.disable_reservoir||0!=(1&n.substep_shaping)||(a.bits-=.1*t)),e=r<6*n.ResvMax/10?r:6*n.ResvMax/10,(e-=s)<0&&(e=0),e},this.ResvAdjust=function(e,t){e.ResvSize-=t.part2_3_length+t.part2_length},this.ResvFrameEnd=function(e,t){var a,s=e.l3_side;e.ResvSize+=t*e.mode_gr,t=0,s.resvDrain_post=0,(s.resvDrain_pre=0)!=(a=e.ResvSize%8)&&(t+=a),0<(a=e.ResvSize-t-e.ResvMax)&&(t+=a),a=Math.min(8*s.main_data_begin,t)/8,s.resvDrain_pre+=8*a,t-=8*a,e.ResvSize-=8*a,s.main_data_begin-=a,s.resvDrain_post+=t,e.ResvSize-=t}}function H(){function i(e,t){return(((255&e[t+0])<<8|255&e[t+1])<<8|255&e[t+2])<<8|255&e[t+3]}function T(e,t,a){e[t+0]=a>>24&255,e[t+1]=a>>16&255,e[t+2]=a>>8&255,e[t+3]=255&a}function E(e,t,a){e[t+0]=a>>8&255,e[t+1]=255&a}function n(e,t,a){return 255&(e<<t|a&~(-1<<t))}function k(e,t){var a=e.internal_flags;t[0]=n(t[0],8,255),t[1]=n(t[1],3,7),t[1]=n(t[1],1,e.out_samplerate<16e3?0:1),t[1]=n(t[1],1,e.version),t[1]=n(t[1],2,1),t[1]=n(t[1],1,e.error_protection?0:1),t[2]=n(t[2],4,a.bitrate_index),t[2]=n(t[2],2,a.samplerate_index),t[2]=n(t[2],1,0),t[2]=n(t[2],1,e.extension),t[3]=n(t[3],2,e.mode.ordinal()),t[3]=n(t[3],2,a.mode_ext),t[3]=n(t[3],1,e.copyright),t[3]=n(t[3],1,e.original),t[3]=n(t[3],2,e.emphasis),t[0]=255;a=241&t[1];var s=1==e.version?128:e.out_samplerate<16e3?32:64;e.VBR==ut.vbr_off&&(s=e.brate),s=e.free_format?0:255&16*r.BitrateIndex(s,e.version,e.out_samplerate),t[1]=1==e.version?255&(10|a):255&(2|a),a=13&t[2],t[2]=255&(s|a)}function y(e,t){return t>>8^a[255&(t^e)]}var r,x,P;this.setModules=function(e,t,a){r=e,x=t,P=a};var I=H.NUMTOCENTRIES,_=H.MAXFRAMESIZE,o=I+4+4+4+4+4+9+1+1+8+1+1+3+1+1+2+4+2+2,a=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];this.addVbrFrame=function(e){var t=e.internal_flags,a=t.VBR_seek_table;if(e=te.bitrate_table[e.version][t.bitrate_index],a.nVbrNumFrames++,a.sum+=e,a.seen++,!(a.seen<a.want)&&(a.pos<a.size&&(a.bag[a.pos]=a.sum,a.pos++,a.seen=0),a.pos==a.size)){for(e=1;e<a.size;e+=2)a.bag[e/2]=a.bag[e];a.want*=2,a.pos/=2}},this.getVbrTag=function(e){var t=new VBRTagData,a=0;t.flags=0;var s=e[a+1]>>3&1,n=e[a+2]>>2&3,r=e[a+3]>>6&3,_=e[a+2]>>4&15;_=te.bitrate_table[s][_];if(t.samprate=14==e[a+1]>>4?te.samplerate_table[2][n]:te.samplerate_table[s][n],n=a=0!=s?3!=r?a+36:a+21:3!=r?a+21:a+13,!new String(e,n,4(),null).equals("Xing")&&!new String(e,n,4(),null).equals("Info"))return null;if(a+=4,t.hId=s,n=t.flags=i(e,a),a+=4,0!=(1&n)&&(t.frames=i(e,a),a+=4),0!=(2&n)&&(t.bytes=i(e,a),a+=4),0!=(4&n)){if(null!=t.toc)for(r=0;r<I;r++)t.toc[r]=e[a+r];a+=I}return t.vbrScale=-1,0!=(8&n)&&(t.vbrScale=i(e,a),a+=4),t.headersize=72e3*(s+1)*_/t.samprate,s=e[(a+=21)+0]<<4,s+=e[a+1]>>4,_=(15&e[a+1])<<8,(s<0||3e3<s)&&(s=-1),((_+=255&e[a+2])<0||3e3<_)&&(_=-1),t.encDelay=s,t.encPadding=_,t},this.InitVbrTag=function(e){var t=e.internal_flags,a=1==e.version?128:e.out_samplerate<16e3?32:64;e.VBR==ut.vbr_off&&(a=e.brate),a=72e3*(e.version+1)*a/e.out_samplerate;var s=t.sideinfo_len+o;if((t.VBR_seek_table.TotalFrameSize=a)<s||_<a)e.bWriteVbrTag=!1;else for(t.VBR_seek_table.nVbrNumFrames=0,t.VBR_seek_table.nBytesWritten=0,t.VBR_seek_table.sum=0,t.VBR_seek_table.seen=0,t.VBR_seek_table.want=1,t.VBR_seek_table.pos=0,null==t.VBR_seek_table.bag&&(t.VBR_seek_table.bag=new int[400],t.VBR_seek_table.size=400),k(e,a=new Int8Array(_)),t=t.VBR_seek_table.TotalFrameSize,s=0;s<t;++s)x.add_dummy_byte(e,255&a[s],1)},this.updateMusicCRC=function(e,t,a,s){for(var n=0;n<s;++n)e[0]=y(t[a+n],e[0])},this.getLameTagFrame=function(e,t){var a=e.internal_flags;if(!e.bWriteVbrTag||a.Class_ID!=X.LAME_ID||a.VBR_seek_table.pos<=0)return 0;if(t.length<a.VBR_seek_table.TotalFrameSize)return a.VBR_seek_table.TotalFrameSize;mt.fill(t,0,a.VBR_seek_table.TotalFrameSize,0),k(e,t);var s=new Int8Array(I);if(e.free_format)for(var n=1;n<I;++n)s[n]=255&255*n/100;else{var r=a.VBR_seek_table;if(!(r.pos<=0))for(n=1;n<I;++n){(l=0|Math.floor(n/I*r.pos))>r.pos-1&&(l=r.pos-1),255<(l=0|256*r.bag[l]/r.sum)&&(l=255),s[n]=255&l}}l=a.sideinfo_len,e.error_protection&&(l-=2),t[l++]=0,t[l++]=0,t[l++]=0,t[l++]=0,T(t,l,15),T(t,l+=4,a.VBR_seek_table.nVbrNumFrames),T(t,l+=4,0|(r=a.VBR_seek_table.nBytesWritten+a.VBR_seek_table.TotalFrameSize)),l+=4,ee.arraycopy(s,0,t,l,s.length),l+=s.length,e.error_protection&&x.CRC_writeheader(a,t);var _=0;for(n=0;n<l;n++)_=y(t[n],_);s=l,n=_;var i,o=e.internal_flags,l=0,f=(_=e.encoder_delay,e.encoder_padding),h=100-10*e.VBR_q-e.quality,c=P.getLameVeryShortVersion(),b=[1,5,3,2,4,0,3],u=0|(255<e.lowpassfreq/100+.5?255:e.lowpassfreq/100+.5),m=0,p=0,d=e.internal_flags.noise_shaping,g=0,v=0!=(1&e.exp_nspsytune),S=0!=(2&e.exp_nspsytune),R=i=!1,M=e.internal_flags.nogap_total,A=e.internal_flags.nogap_current,B=e.ATHtype;switch(e.VBR){case vbr_abr:var w=e.VBR_mean_bitrate_kbps;break;case vbr_off:w=e.brate;break;default:w=e.VBR_min_bitrate_kbps}switch(b=0+(e.VBR.ordinal()<b.length?b[e.VBR.ordinal()]:0),o.findReplayGain&&(510<o.RadioGain&&(o.RadioGain=510),o.RadioGain<-510&&(o.RadioGain=-510),p=11264,p=0<=o.RadioGain?p|o.RadioGain:512|p|-o.RadioGain),o.findPeakSample&&(m=Math.abs(0|o.PeakSample/32767*Math.pow(2,23)+.5)),-1!=M&&(0<A&&(R=!0),A<M-1&&(i=!0)),v=B+((v?1:0)<<4)+((S?1:0)<<5)+((i?1:0)<<6)+((R?1:0)<<7),h<0&&(h=0),e.mode){case MONO:S=0;break;case STEREO:S=1;break;case DUAL_CHANNEL:S=2;break;case JOINT_STEREO:S=e.force_ms?4:3;break;default:S=7}for(i=e.in_samplerate<=32e3?0:48e3==e.in_samplerate?2:48e3<e.in_samplerate?3:1,(e.short_blocks==sa.short_block_forced||e.short_blocks==sa.short_block_dispensed||-1==e.lowpassfreq&&-1==e.highpassfreq||e.scale_left<e.scale_right||e.scale_left>e.scale_right||e.disable_reservoir&&e.brate<320||e.noATH||e.ATHonly||0==B||e.in_samplerate<=32e3)&&(g=1),d=d+(S<<2)+(g<<5)+(i<<6),o=o.nMusicCRC,T(t,s+l,h),l+=4,h=0;h<9;h++)t[s+l+h]=255&c.charAt(h);for(t[s+(l+=9)]=255&b,t[s+ ++l]=255&u,T(t,s+ ++l,m),E(t,s+(l+=4),p),E(t,s+(l+=2),0),t[s+(l+=2)]=255&v,t[s+ ++l]=255<=w?255:255&w,t[s+ ++l]=255&_>>4,t[s+l+1]=255&(_<<4)+(f>>8),t[s+l+2]=255&f,t[s+(l+=3)]=255&d,l++,t[s+l++]=0,E(t,s+l,e.preset),T(t,s+(l+=2),r),E(t,s+(l+=4),o),l+=2,e=0;e<l;e++)n=y(t[s+e],n);return E(t,s+l,n),a.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(e,t){if(e.internal_flags.VBR_seek_table.pos<=0)return-1;if(t.seek(t.length()),0==t.length())return-1;t.seek(0);var a=new Int8Array(10);return t.readFully(a),a=new String(a,"ISO-8859-1").startsWith("ID3")?0:((127&a[6])<<21|(127&a[7])<<14|(127&a[8])<<7|127&a[9])+a.length,t.seek(a),a=new Int8Array(_),(e=getLameTagFrame(e,a))>a.length?-1:(e<1||t.write(a,0,e),0)}}function J(){function g(e,t,a){for(;0<a;){if(0==b){if(b=8,c++,e.header[e.w_ptr].write_timing==T){var s=e;ee.arraycopy(s.header[s.w_ptr].buf,0,h,c,s.sideinfo_len),c+=s.sideinfo_len,T+=8*s.sideinfo_len,s.w_ptr=s.w_ptr+1&$.MAX_HEADER_BUF-1}h[c]=0}a-=s=Math.min(a,b),b-=s,h[c]|=t>>a<<b,T+=s}}function v(e,t){var a,s=e.internal_flags;if(8<=t&&(g(s,76,8),t-=8),8<=t&&(g(s,65,8),t-=8),8<=t&&(g(s,77,8),t-=8),8<=t&&(g(s,69,8),t-=8),32<=t){var n=r.getLameShortVersion();if(32<=t)for(a=0;a<n.length&&8<=t;++a)t-=8,g(s,n.charAt(a),8)}for(;1<=t;--t)g(s,s.ancillary_flag,1),s.ancillary_flag^=e.disable_reservoir?0:1}function S(e,t,a){for(var s=e.header[e.h_ptr].ptr;0<a;){var n=Math.min(a,8-(7&s));a-=n,e.header[e.h_ptr].buf[s>>3]|=t>>a<<8-(7&s)-n,s+=n}e.header[e.h_ptr].ptr=s}function n(e,t){e<<=8;for(var a=0;a<8;a++)0!=(65536&((t<<=1)^(e<<=1)))&&(t^=32773);return t}function R(e,t){var a,s=te.ht[t.count1table_select+32],n=0,r=t.big_values,_=t.big_values;for(a=(t.count1-t.big_values)/4;0<a;--a){var i=0,o=0,l=t.l3_enc[r+0];0!=l&&(o+=8,t.xr[_+0]<0&&i++),0!=(l=t.l3_enc[r+1])&&(o+=4,i*=2,t.xr[_+1]<0&&i++),0!=(l=t.l3_enc[r+2])&&(o+=2,i*=2,t.xr[_+2]<0&&i++),0!=(l=t.l3_enc[r+3])&&(o++,i*=2,t.xr[_+3]<0&&i++),r+=4,_+=4,g(e,i+s.table[o],s.hlen[o]),n+=s.hlen[o]}return n}function _(e,t,a,s,n){var r=te.ht[t],_=0;if(0==t)return _;for(;a<s;a+=2){var i=0,o=0,l=r.xlen,f=r.xlen,h=0,c=n.l3_enc[a],b=n.l3_enc[a+1];0!=c&&(n.xr[a]<0&&h++,i--),15<t&&(14<c&&(h|=c-15<<1,o=l,c=15),14<b&&(h<<=l,h|=f=b-15,o+=l,b=15),f=16),0!=b&&(h<<=1,n.xr[a+1]<0&&h++,i--),c=c*f+b,o-=i,i+=r.hlen[c],g(e,r.table[c],i),g(e,h,o),_+=i+o}return _}function M(e,t){var a=3*e.scalefac_band.s[3];return a>t.big_values&&(a=t.big_values),_(e,t.table_select[0],0,a,t)+_(e,t.table_select[1],a,t.big_values,t)}function A(e,t){var a=t.big_values,s=t.region0_count+1,n=e.scalefac_band.l[s];s+=t.region1_count+1;var r=e.scalefac_band.l[s];return a<n&&(n=a),a<r&&(r=a),s=_(e,t.table_select[0],0,n,t),(s+=_(e,t.table_select[1],n,r,t))+_(e,t.table_select[2],r,a,t)}function B(){this.total=0}function w(e,t){var a=e.internal_flags,s=a.w_ptr,n=a.h_ptr-1;-1==n&&(n=$.MAX_HEADER_BUF-1);var r=a.header[n].write_timing-T;if(0<=(t.total=r)){var _=1+n-s;n<s&&(_=1+n-s+$.MAX_HEADER_BUF),r-=8*_*a.sideinfo_len}return r+=e=i.getframebits(e),t.total+=e,t.total=0!=t.total%8?1+t.total/8:t.total/8,t.total+=c+1,r<0&&ee.err.println("strange error flushing buffer ... \n"),r}var i=this,o=null,l=null,r=null,f=null;this.setModules=function(e,t,a,s){o=e,l=t,r=a,f=s};var h=null,T=0,c=0,b=0;this.getframebits=function(e){var t=e.internal_flags;return 8*(0|72e3*(e.version+1)*(0!=t.bitrate_index?te.bitrate_table[e.version][t.bitrate_index]:e.brate)/e.out_samplerate+t.padding)},this.CRC_writeheader=function(e,t){var a=n(255&t[2],65535);a=n(255&t[3],a);for(var s=6;s<e.sideinfo_len;s++)a=n(255&t[s],a);t[4]=byte(a>>8),t[5]=byte(255&a)},this.flush_bitstream=function(e){var t,a=e.internal_flags,s=a.l3_side;(t=w(e,new B))<0||(v(e,t),a.ResvSize=0,s.main_data_begin=0,a.findReplayGain&&(s=o.GetTitleGain(a.rgdata),a.RadioGain=0|Math.floor(10*s+.5)),a.findPeakSample&&(a.noclipGainChange=0|Math.ceil(200*Math.log10(a.PeakSample/32767)),0<a.noclipGainChange&&(EQ(e.scale,1)||EQ(e.scale,0))?a.noclipScale=Math.floor(32767/a.PeakSample*100)/100:a.noclipScale=-1))},this.add_dummy_byte=function(e,t,a){e=e.internal_flags;for(var s;0<a--;){s=t;for(var n=8;0<n;){0==b&&(b=8,h[++c]=0);var r=Math.min(n,b);n-=r,b-=r,h[c]|=s>>n<<b,T+=r}for(s=0;s<$.MAX_HEADER_BUF;++s)e.header[s].write_timing+=8}},this.format_bitstream=function(e){var t=e.internal_flags,a=t.l3_side,s=this.getframebits(e);v(e,a.resvDrain_pre);var n,r,_,i=(l=e.internal_flags).l3_side;if(l.header[l.h_ptr].ptr=0,mt.fill(l.header[l.h_ptr].buf,0,l.sideinfo_len,0),e.out_samplerate<16e3?S(l,4094,12):S(l,4095,12),S(l,e.version,1),S(l,1,2),S(l,e.error_protection?0:1,1),S(l,l.bitrate_index,4),S(l,l.samplerate_index,2),S(l,l.padding,1),S(l,e.extension,1),S(l,e.mode.ordinal(),2),S(l,l.mode_ext,2),S(l,e.copyright,1),S(l,e.original,1),S(l,e.emphasis,2),e.error_protection&&S(l,0,16),1==e.version){for(S(l,i.main_data_begin,9),2==l.channels_out?S(l,i.private_bits,3):S(l,i.private_bits,5),_=0;_<l.channels_out;_++)for(n=0;n<4;n++)S(l,i.scfsi[_][n],1);for(r=0;r<2;r++)for(_=0;_<l.channels_out;_++)S(l,(n=i.tt[r][_]).part2_3_length+n.part2_length,12),S(l,n.big_values/2,9),S(l,n.global_gain,8),S(l,n.scalefac_compress,4),n.block_type!=ra.NORM_TYPE?(S(l,1,1),S(l,n.block_type,2),S(l,n.mixed_block_flag,1),14==n.table_select[0]&&(n.table_select[0]=16),S(l,n.table_select[0],5),14==n.table_select[1]&&(n.table_select[1]=16),S(l,n.table_select[1],5),S(l,n.subblock_gain[0],3),S(l,n.subblock_gain[1],3),S(l,n.subblock_gain[2],3)):(S(l,0,1),14==n.table_select[0]&&(n.table_select[0]=16),S(l,n.table_select[0],5),14==n.table_select[1]&&(n.table_select[1]=16),S(l,n.table_select[1],5),14==n.table_select[2]&&(n.table_select[2]=16),S(l,n.table_select[2],5),S(l,n.region0_count,4),S(l,n.region1_count,3)),S(l,n.preflag,1),S(l,n.scalefac_scale,1),S(l,n.count1table_select,1)}else for(S(l,i.main_data_begin,8),S(l,i.private_bits,l.channels_out),_=r=0;_<l.channels_out;_++)S(l,(n=i.tt[r][_]).part2_3_length+n.part2_length,12),S(l,n.big_values/2,9),S(l,n.global_gain,8),S(l,n.scalefac_compress,9),n.block_type!=ra.NORM_TYPE?(S(l,1,1),S(l,n.block_type,2),S(l,n.mixed_block_flag,1),14==n.table_select[0]&&(n.table_select[0]=16),S(l,n.table_select[0],5),14==n.table_select[1]&&(n.table_select[1]=16),S(l,n.table_select[1],5),S(l,n.subblock_gain[0],3),S(l,n.subblock_gain[1],3),S(l,n.subblock_gain[2],3)):(S(l,0,1),14==n.table_select[0]&&(n.table_select[0]=16),S(l,n.table_select[0],5),14==n.table_select[1]&&(n.table_select[1]=16),S(l,n.table_select[1],5),14==n.table_select[2]&&(n.table_select[2]=16),S(l,n.table_select[2],5),S(l,n.region0_count,4),S(l,n.region1_count,3)),S(l,n.scalefac_scale,1),S(l,n.count1table_select,1);e.error_protection&&CRC_writeheader(l,l.header[l.h_ptr].buf),i=l.h_ptr,l.h_ptr=i+1&$.MAX_HEADER_BUF-1,l.header[l.h_ptr].write_timing=l.header[i].write_timing+s,l.h_ptr==l.w_ptr&&ee.err.println("Error: MAX_HEADER_BUF too small in bitstream.c \n");var o,l=8*t.sideinfo_len,f=0,h=e.internal_flags,c=h.l3_side;if(1==e.version)for(_=0;_<2;_++)for(n=0;n<h.channels_out;n++){i=c.tt[_][n];var b=E.slen1_tab[i.scalefac_compress],u=E.slen2_tab[i.scalefac_compress];for(r=o=0;r<i.sfbdivide;r++)-1!=i.scalefac[r]&&(g(h,i.scalefac[r],b),o+=b);for(;r<i.sfbmax;r++)-1!=i.scalefac[r]&&(g(h,i.scalefac[r],u),o+=u);o=i.block_type==ra.SHORT_TYPE?o+M(h,i):o+A(h,i),f+=o+=R(h,i)}else for(n=_=0;n<h.channels_out;n++){var m,p=0,d=r=o=0;if((i=c.tt[_][n]).block_type==ra.SHORT_TYPE){for(;d<4;d++)for(u=i.sfb_partition_table[d]/3,b=i.slen[d],m=0;m<u;m++,r++)g(h,Math.max(i.scalefac[3*r+0],0),b),g(h,Math.max(i.scalefac[3*r+1],0),b),g(h,Math.max(i.scalefac[3*r+2],0),b),p+=3*b;o+=M(h,i)}else{for(;d<4;d++)for(u=i.sfb_partition_table[d],b=i.slen[d],m=0;m<u;m++,r++)g(h,Math.max(i.scalefac[r],0),b),p+=b;o+=A(h,i)}f+=p+(o+=R(h,i))}if(l+=f,v(e,a.resvDrain_post),l+=a.resvDrain_post,a.main_data_begin+=(s-l)/8,w(e,new B)!=t.ResvSize&&ee.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),8*a.main_data_begin!=t.ResvSize&&(ee.err.printf("bit reservoir error: \nl3_side.main_data_begin: %d \nResvoir size:             %d \nresv drain (post)         %d \nresv drain (pre)          %d \nheader and sideinfo:      %d \ndata bits:                %d \ntotal bits:               %d (remainder: %d) \nbitsperframe:             %d \n",8*a.main_data_begin,t.ResvSize,a.resvDrain_post,a.resvDrain_pre,8*t.sideinfo_len,l-a.resvDrain_post-8*t.sideinfo_len,l,l%8,s),ee.err.println("This is a fatal error.  It has several possible causes:"),ee.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),ee.err.println(" 9%%  Your system is overclocked"),ee.err.println(" 1%%  bug in LAME encoding library"),t.ResvSize=8*a.main_data_begin),1e9<T){for(e=0;e<$.MAX_HEADER_BUF;++e)t.header[e].write_timing-=T;T=0}return 0},this.copy_buffer=function(e,t,a,s,n){var r=c+1;if(r<=0)return 0;if(0!=s&&s<r)return-1;if(ee.arraycopy(h,0,t,a,r),c=-1,(b=0)!=n&&((s=ea(1))[0]=e.nMusicCRC,f.updateMusicCRC(s,t,a,r),e.nMusicCRC=s[0],0<r&&(e.VBR_seek_table.nBytesWritten+=r),e.decode_on_the_fly)){s=aa([2,1152]),n=r;for(var _,i=-1;0!=i;)if(i=l.hip_decode1_unclipped(e.hip,t,a,n,s[0],s[1]),n=0,-1==i&&(i=0),0<i){if(e.findPeakSample){for(_=0;_<i;_++)s[0][_]>e.PeakSample?e.PeakSample=s[0][_]:-s[0][_]>e.PeakSample&&(e.PeakSample=-s[0][_]);if(1<e.channels_out)for(_=0;_<i;_++)s[1][_]>e.PeakSample?e.PeakSample=s[1][_]:-s[1][_]>e.PeakSample&&(e.PeakSample=-s[1][_])}if(e.findReplayGain&&o.AnalyzeSamples(e.rgdata,s[0],0,s[1],0,i,e.channels_out)==W.GAIN_ANALYSIS_ERROR)return-6}}return r},this.init_bit_stream_w=function(e){h=new Int8Array(X.LAME_MAXMP3BUFFER),e.h_ptr=e.w_ptr=0,e.header[e.h_ptr].write_timing=0,c=-1,T=b=0}}function e(e,t,a,s){this.xlen=e,this.linmax=t,this.table=a,this.hlen=s}function T(e){this.bits=e}function O(){this.bits=this.over_SSD=this.over_count=this.max_noise=this.tot_noise=this.over_noise=0}function t(){this.setModules=function(e,t){}}function k(){this.floor=this.decay=this.adjustLimit=this.adjust=this.aaSensitivityP=this.useAdjust=0,this.l=ta(ra.SBMAX_l),this.s=ta(ra.SBMAX_s),this.psfb21=ta(ra.PSFB21),this.psfb12=ta(ra.PSFB12),this.cb_l=ta(ra.CBANDS),this.cb_s=ta(ra.CBANDS),this.eql_w=ta(ra.BLKSIZE/2)}function a(){this.scale_right=this.scale_left=this.scale=this.out_samplerate=this.in_samplerate=this.num_channels=this.num_samples=this.class_id=0,this.decode_only=this.bWriteVbrTag=this.analysis=!1,this.quality=0,this.mode=na.STEREO,this.write_id3tag_automatic=this.decode_on_the_fly=this.findReplayGain=this.free_format=this.force_ms=!1,this.error_protection=this.emphasis=this.extension=this.original=this.copyright=this.compression_ratio=this.brate=0,this.disable_reservoir=this.strict_ISO=!1,this.quant_comp_short=this.quant_comp=0,this.experimentalY=!1,this.preset=this.exp_nspsytune=this.experimentalZ=0,this.VBR=null,this.maskingadjust_short=this.maskingadjust=this.highpasswidth=this.lowpasswidth=this.highpassfreq=this.lowpassfreq=this.VBR_hard_min=this.VBR_max_bitrate_kbps=this.VBR_min_bitrate_kbps=this.VBR_mean_bitrate_kbps=this.VBR_q=this.VBR_q_frac=0,this.noATH=this.ATHshort=this.ATHonly=!1,this.athaa_sensitivity=this.athaa_loudapprox=this.athaa_type=this.ATHlower=this.ATHcurve=this.ATHtype=0,this.short_blocks=null,this.useTemporal=!1,this.msfix=this.interChRatio=0,this.tune=!1,this.lame_allocated_gfp=this.frameNum=this.framesize=this.encoder_padding=this.encoder_delay=this.version=this.tune_value_a=0,this.internal_flags=null}function y(e){this.quantize=e,this.iteration_loop=function(e,t,a,s){var n=e.internal_flags,r=ta(G.SFBMAX),_=ta(576),i=ea(2),o=n.l3_side,l=new T(0);this.quantize.rv.ResvFrameBegin(e,l),l=l.bits;for(var f=0;f<n.mode_gr;f++){var h=this.quantize.qupvt.on_pe(e,t,i,l,f,f);for(n.mode_ext==ra.MPG_MD_MS_LR&&(this.quantize.ms_convert(n.l3_side,f),this.quantize.qupvt.reduce_side(i,a[f],l,h)),h=0;h<n.channels_out;h++){var c=o.tt[f][h];if(c.block_type!=ra.SHORT_TYPE){var b=0;b=n.PSY.mask_adjust-b}else b=0,b=n.PSY.mask_adjust_short-b;n.masking_lower=Math.pow(10,.1*b),this.quantize.init_outer_loop(n,c),this.quantize.init_xrpow(n,c,_)&&(this.quantize.qupvt.calc_xmin(e,s[f][h],c,r),this.quantize.outer_loop(e,c,r,_,h,i[h])),this.quantize.iteration_finish_one(n,f,h)}}this.quantize.rv.ResvFrameEnd(n,l)}}function x(){this.linprebuf=ta(2*W.MAX_ORDER),this.linpre=0,this.lstepbuf=ta(W.MAX_SAMPLES_PER_WINDOW+W.MAX_ORDER),this.lstep=0,this.loutbuf=ta(W.MAX_SAMPLES_PER_WINDOW+W.MAX_ORDER),this.lout=0,this.rinprebuf=ta(2*W.MAX_ORDER),this.rinpre=0,this.rstepbuf=ta(W.MAX_SAMPLES_PER_WINDOW+W.MAX_ORDER),this.rstep=0,this.routbuf=ta(W.MAX_SAMPLES_PER_WINDOW+W.MAX_ORDER),this.first=this.freqindex=this.rsum=this.lsum=this.totsamp=this.sampleWindow=this.rout=0,this.A=ea(0|W.STEPS_per_dB*W.MAX_dB),this.B=ea(0|W.STEPS_per_dB*W.MAX_dB)}function n(e,t,a,s){this.l=ea(1+ra.SBMAX_l),this.s=ea(1+ra.SBMAX_s),this.psfb21=ea(1+ra.PSFB21),this.psfb12=ea(1+ra.PSFB12);var n=this.l,r=this.s;4==arguments.length&&(this.arrL=e,this.arrS=t,this.arr21=a,this.arr12=s,ee.arraycopy(this.arrL,0,n,0,Math.min(this.arrL.length,this.l.length)),ee.arraycopy(this.arrS,0,r,0,Math.min(this.arrS.length,this.s.length)),ee.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),ee.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}function P(){function c(e,t){return t=s.ATHformula(t,e),Math.pow(10,(t-100)/10+e.ATHlower)}function g(e){this.s=e}var b=null,h=null,s=null;this.setModules=function(e,t,a){b=e,h=t,s=a},this.IPOW20=function(e){return d[e]};var u=P.IXMAX_VAL+2,m=P.Q_MAX,p=P.Q_MAX2;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var S=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=S,this.sfBandIndex=[new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var v=ta(m+p+1),d=ta(m),R=ta(u),M=ta(u);this.adj43=M,this.iteration_init=function(e){var t=e.internal_flags,a=t.l3_side;if(0==t.iteration_init_init){t.iteration_init_init=1,a.main_data_begin=0;for(var s,n,r=e.internal_flags.ATH.l,_=e.internal_flags.ATH.psfb21,i=e.internal_flags.ATH.s,o=e.internal_flags.ATH.psfb12,l=e.internal_flags,f=e.out_samplerate,h=0;h<ra.SBMAX_l;h++)for(n=l.scalefac_band.l[h],a=l.scalefac_band.l[h+1],r[h]=j.MAX_VALUE;n<a;n++)s=c(e,s=n*f/1152),r[h]=Math.min(r[h],s);for(h=0;h<ra.PSFB21;h++)for(n=l.scalefac_band.psfb21[h],a=l.scalefac_band.psfb21[h+1],_[h]=j.MAX_VALUE;n<a;n++)s=c(e,s=n*f/1152),_[h]=Math.min(_[h],s);for(h=0;h<ra.SBMAX_s;h++){for(n=l.scalefac_band.s[h],a=l.scalefac_band.s[h+1],i[h]=j.MAX_VALUE;n<a;n++)s=c(e,s=n*f/384),i[h]=Math.min(i[h],s);i[h]*=l.scalefac_band.s[h+1]-l.scalefac_band.s[h]}for(h=0;h<ra.PSFB12;h++){for(n=l.scalefac_band.psfb12[h],a=l.scalefac_band.psfb12[h+1],o[h]=j.MAX_VALUE;n<a;n++)s=c(e,s=n*f/384),o[h]=Math.min(o[h],s);o[h]*=l.scalefac_band.s[13]-l.scalefac_band.s[12]}if(e.noATH){for(h=0;h<ra.SBMAX_l;h++)r[h]=1e-20;for(h=0;h<ra.PSFB21;h++)_[h]=1e-20;for(h=0;h<ra.SBMAX_s;h++)i[h]=1e-20;for(h=0;h<ra.PSFB12;h++)o[h]=1e-20}for(l.ATH.floor=10*Math.log10(c(e,-1)),R[0]=0,a=1;a<u;a++)R[a]=Math.pow(a,4/3);for(a=0;a<u-1;a++)M[a]=a+1-Math.pow(.5*(R[a]+R[a+1]),.75);for(M[a]=.5,a=0;a<m;a++)d[a]=Math.pow(2,-.1875*(a-210));for(a=0;a<=m+p;a++)v[a]=Math.pow(2,.25*(a-210-p));for(b.huffman_init(t),32<=(a=e.exp_nspsytune>>2&63)&&(a-=64),r=Math.pow(10,a/4/10),32<=(a=e.exp_nspsytune>>8&63)&&(a-=64),_=Math.pow(10,a/4/10),32<=(a=e.exp_nspsytune>>14&63)&&(a-=64),i=Math.pow(10,a/4/10),32<=(a=e.exp_nspsytune>>20&63)&&(a-=64),o=i*Math.pow(10,a/4/10),a=0;a<ra.SBMAX_l;a++)e=a<=6?r:a<=13?_:a<=20?i:o,t.nsPsy.longfact[a]=e;for(a=0;a<ra.SBMAX_s;a++)e=a<=5?r:a<=10?_:a<=11?i:o,t.nsPsy.shortfact[a]=e}},this.on_pe=function(e,t,a,s,n,r){var _,i=e.internal_flags,o=0,l=ea(2);o=new T(o);e=h.ResvMaxBits(e,s,o,r);var f=(o=o.bits)+e;for($.MAX_BITS_PER_GRANULE<f&&(f=$.MAX_BITS_PER_GRANULE),_=r=0;_<i.channels_out;++_)a[_]=Math.min($.MAX_BITS_PER_CHANNEL,o/i.channels_out),l[_]=0|a[_]*t[n][_]/700-a[_],l[_]>3*s/4&&(l[_]=3*s/4),l[_]<0&&(l[_]=0),l[_]+a[_]>$.MAX_BITS_PER_CHANNEL&&(l[_]=Math.max(0,$.MAX_BITS_PER_CHANNEL-a[_])),r+=l[_];if(e<r)for(_=0;_<i.channels_out;++_)l[_]=e*l[_]/r;for(_=0;_<i.channels_out;++_)a[_]+=l[_],e-=l[_];for(_=r=0;_<i.channels_out;++_)r+=a[_];if($.MAX_BITS_PER_GRANULE<r)for(_=0;_<i.channels_out;++_)a[_]*=$.MAX_BITS_PER_GRANULE,a[_]/=r;return f},this.reduce_side=function(e,t,a,s){(t=.33*(.5-t)/.5)<0&&(t=0),.5<t&&(t=.5),(t=0|.5*t*(e[0]+e[1]))>$.MAX_BITS_PER_CHANNEL-e[0]&&(t=$.MAX_BITS_PER_CHANNEL-e[0]),t<0&&(t=0),125<=e[1]&&(125<e[1]-t?(e[0]<a&&(e[0]+=t),e[1]-=t):(e[0]+=e[1]-125,e[1]=125)),s<(t=e[0]+e[1])&&(e[0]=s*e[0]/t,e[1]=s*e[1]/t)},this.athAdjust=function(e,t,a){t=_a.FAST_LOG10_X(t,10);var s=0;return t-=a,1e-20<(e*=e)&&(s=1+_a.FAST_LOG10_X(e,10/90.30873362)),s<0&&(s=0),Math.pow(10,.1*(t*s+(a+90.30873362-94.82444863)))},this.calc_xmin=function(e,t,a,s){var n,r=0,_=e.internal_flags,i=0,o=0,l=_.ATH,f=a.xr,h=e.VBR==ut.vbr_mtrh?1:0,c=_.masking_lower;for(e.VBR!=ut.vbr_mtrh&&e.VBR!=ut.vbr_mt||(c=1),n=0;n<a.psy_lmax;n++){var b=e.VBR==ut.vbr_rh||e.VBR==ut.vbr_mtrh?athAdjust(l.adjust,l.l[n],l.floor):l.adjust*l.l[n],u=a.width[n],m=b/u,p=2220446049250313e-31,d=u>>1,g=0;do{var v=f[i]*f[i];g+=v,p+=v<m?v:m,g+=v=f[++i]*f[i],p+=v<m?v:m,i++}while(0<--d);b<g&&o++,n==ra.SBPSY_l&&(p<(d=b*_.nsPsy.longfact[n])&&(p=d)),0!=h&&(b=p),e.ATHonly||0<(p=t.en.l[n])&&(d=g*t.thm.l[n]*c/p,0!=h&&(d*=_.nsPsy.longfact[n]),b<d&&(b=d)),s[r++]=0!=h?b:b*_.nsPsy.longfact[n]}if(b=575,a.block_type!=ra.SHORT_TYPE)for(g=576;0!=g--&&J.EQ(f[g],0);)b=g;a.max_nonzero_coeff=b;for(var S=a.sfb_smin;n<a.psymax;S++,n+=3){var R,M=e.VBR==ut.vbr_rh||e.VBR==ut.vbr_mtrh?athAdjust(l.adjust,l.s[S],l.floor):l.adjust*l.s[S];for(u=a.width[n],R=0;R<3;R++){for(g=0,d=u>>1,m=M/u,p=2220446049250313e-31;g+=v=f[i]*f[i],p+=v<m?v:m,g+=v=f[++i]*f[i],p+=v<m?v:m,i++,0<--d;);M<g&&o++,S==ra.SBPSY_s&&(p<(d=M*_.nsPsy.shortfact[S])&&(p=d)),b=0!=h?p:M,e.ATHonly||e.ATHshort||0<(p=t.en.s[S][R])&&(d=g*t.thm.s[S][R]*c/p,0!=h&&(d*=_.nsPsy.shortfact[S]),b<d&&(b=d)),s[r++]=0!=h?b:b*_.nsPsy.shortfact[S]}e.useTemporal&&(s[r-3]>s[r-3+1]&&(s[r-3+1]+=(s[r-3]-s[r-3+1])*_.decay),s[r-3+1]>s[r-3+2]&&(s[r-3+2]+=(s[r-3+1]-s[r-3+2])*_.decay))}return o},this.calc_noise_core=function(e,t,a,s){var n=0,r=t.s,_=e.l3_enc;if(r>e.count1)for(;0!=a--;){var i=e.xr[r];r++,n+=i*i,i=e.xr[r],r++,n+=i*i}else if(r>e.big_values){var o=ta(2);for(o[0]=0,o[1]=s;0!=a--;)i=Math.abs(e.xr[r])-o[_[r]],r++,n+=i*i,i=Math.abs(e.xr[r])-o[_[r]],r++,n+=i*i}else for(;0!=a--;)i=Math.abs(e.xr[r])-R[_[r]]*s,r++,n+=i*i,i=Math.abs(e.xr[r])-R[_[r]]*s,r++,n+=i*i;return t.s=r,n},this.calc_noise=function(e,t,a,s,n){var r,_=0,i=0,o=0,l=0,f=0,h=-20,c=0,b=e.scalefac,u=0;for(r=s.over_SSD=0;r<e.psymax;r++){var m=e.global_gain-(b[u++]+(0!=e.preflag?S[r]:0)<<e.scalefac_scale+1)-8*e.subblock_gain[e.window[r]];if(null!=n&&n.step[r]==m){var p=n.noise[r];c+=e.width[r],a[_++]=p/t[i++],p=n.noise_log[r]}else{p=v[m+P.Q_MAX2];var d=e.width[r]>>1;c+e.width[r]>e.max_nonzero_coeff&&(d=0<(d=e.max_nonzero_coeff-c+1)?d>>1:0),c=new g(c),p=this.calc_noise_core(e,c,d,p),c=c.s,null!=n&&(n.step[r]=m,n.noise[r]=p),p=a[_++]=p/t[i++],p=_a.FAST_LOG10(Math.max(p,1e-20)),null!=n&&(n.noise_log[r]=p)}null!=n&&(n.global_gain=e.global_gain),f+=p,0<p&&(m=Math.max(0|10*p+.5,1),s.over_SSD+=m*m,o++,l+=p),h=Math.max(h,p)}return s.over_count=o,s.tot_noise=f,s.over_noise=l,s.max_noise=h,o},this.set_pinfo=function(e,t,a,s,n){var r,_,i=e.internal_flags,o=0==t.scalefac_scale?.5:1,l=t.scalefac,f=ta(G.SFBMAX),h=ta(G.SFBMAX),c=new O;calc_xmin(e,a,t,f),calc_noise(t,f,h,c,null);var b=0,u=t.sfb_lmax;for(t.block_type!=ra.SHORT_TYPE&&0==t.mixed_block_flag&&(u=22),r=0;r<u;r++){var m=i.scalefac_band.l[r],p=i.scalefac_band.l[r+1],d=p-m;for(_=0;b<p;b++)_+=t.xr[b]*t.xr[b];_/=d;var g=1e15;i.pinfo.en[s][n][r]=g*_,i.pinfo.xfsf[s][n][r]=g*f[r]*h[r]/d,_=0<a.en.l[r]&&!e.ATHonly?_/a.en.l[r]:0,i.pinfo.thr[s][n][r]=g*Math.max(_*a.thm.l[r],i.ATH.l[r]),(i.pinfo.LAMEsfb[s][n][r]=0)!=t.preflag&&11<=r&&(i.pinfo.LAMEsfb[s][n][r]=-o*S[r]),r<ra.SBPSY_l&&(i.pinfo.LAMEsfb[s][n][r]-=o*l[r])}if(t.block_type==ra.SHORT_TYPE)for(u=r,r=t.sfb_smin;r<ra.SBMAX_s;r++){m=i.scalefac_band.s[r],d=(p=i.scalefac_band.s[r+1])-m;for(var v=0;v<3;v++){for(_=0,g=m;g<p;g++)_+=t.xr[b]*t.xr[b],b++;_=Math.max(_/d,1e-20),g=1e15,i.pinfo.en_s[s][n][3*r+v]=g*_,i.pinfo.xfsf_s[s][n][3*r+v]=g*f[u]*h[u]/d,_=0<a.en.s[r][v]?_/a.en.s[r][v]:0,(e.ATHonly||e.ATHshort)&&(_=0),i.pinfo.thr_s[s][n][3*r+v]=g*Math.max(_*a.thm.s[r][v],i.ATH.s[r]),i.pinfo.LAMEsfb_s[s][n][3*r+v]=-2*t.subblock_gain[v],r<ra.SBPSY_s&&(i.pinfo.LAMEsfb_s[s][n][3*r+v]-=o*l[u]),u++}}i.pinfo.LAMEqss[s][n]=t.global_gain,i.pinfo.LAMEmainbits[s][n]=t.part2_3_length+t.part2_length,i.pinfo.LAMEsfbits[s][n]=t.part2_length,i.pinfo.over[s][n]=c.over_count,i.pinfo.max_noise[s][n]=10*c.max_noise,i.pinfo.over_noise[s][n]=10*c.over_noise,i.pinfo.tot_noise[s][n]=10*c.tot_noise,i.pinfo.over_SSD[s][n]=c.over_SSD}}function L(){this.sfb_count1=this.global_gain=0,this.step=ea(39),this.noise=ta(39),this.noise_log=ta(39)}function N(){this.xr=ta(576),this.l3_enc=ea(576),this.scalefac=ea(G.SFBMAX),this.mixed_block_flag=this.block_type=this.scalefac_compress=this.global_gain=this.count1=this.big_values=this.part2_3_length=this.xrpow_max=0,this.table_select=ea(3),this.subblock_gain=ea(4),this.sfbdivide=this.psymax=this.sfbmax=this.psy_lmax=this.sfb_smin=this.sfb_lmax=this.part2_length=this.count1table_select=this.scalefac_scale=this.preflag=this.region1_count=this.region0_count=0,this.width=ea(G.SFBMAX),this.window=ea(G.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=ea(4),this.max_nonzero_coeff=0;var t=this;this.assign=function(e){t.xr=new Float32Array(e.xr),t.l3_enc=new Int32Array(e.l3_enc),t.scalefac=new Int32Array(e.scalefac),t.xrpow_max=e.xrpow_max,t.part2_3_length=e.part2_3_length,t.big_values=e.big_values,t.count1=e.count1,t.global_gain=e.global_gain,t.scalefac_compress=e.scalefac_compress,t.block_type=e.block_type,t.mixed_block_flag=e.mixed_block_flag,t.table_select=new Int32Array(e.table_select),t.subblock_gain=new Int32Array(e.subblock_gain),t.region0_count=e.region0_count,t.region1_count=e.region1_count,t.preflag=e.preflag,t.scalefac_scale=e.scalefac_scale,t.count1table_select=e.count1table_select,t.part2_length=e.part2_length,t.sfb_lmax=e.sfb_lmax,t.sfb_smin=e.sfb_smin,t.psy_lmax=e.psy_lmax,t.sfbmax=e.sfbmax,t.psymax=e.psymax,t.sfbdivide=e.sfbdivide,t.width=new Int32Array(e.width),t.window=new Int32Array(e.window),t.count1bits=e.count1bits,t.sfb_partition_table=e.sfb_partition_table.slice(0),t.slen=new Int32Array(e.slen),t.max_nonzero_coeff=e.max_nonzero_coeff}}function I(){function P(e){this.ordinal=e}function I(e){for(var t=0;t<e.sfbmax;t++)if(0==e.scalefac[t]+e.subblock_gain[e.window[t]])return!1;return!0}var b,d;this.rv=null,this.qupvt=null;var H,V,n=new t;this.setModules=function(e,t,a,s){b=e,this.rv=d=t,this.qupvt=H=a,V=s,n.setModules(H,V)},this.ms_convert=function(e,t){for(var a=0;a<576;++a){var s=e.tt[t][0].xr[a],n=e.tt[t][1].xr[a];e.tt[t][0].xr[a]=.5*(s+n)*_a.SQRT2,e.tt[t][1].xr[a]=.5*(s-n)*_a.SQRT2}},this.init_xrpow=function(e,t,a){var s=0|t.max_nonzero_coeff;t.xrpow_max=0,mt.fill(a,s,576,0);for(var n,r=n=0;r<=s;++r){var _=Math.abs(t.xr[r]);n+=_,a[r]=Math.sqrt(_*Math.sqrt(_)),a[r]>t.xrpow_max&&(t.xrpow_max=a[r])}if(1e-20<n){for((a=0)!=(2&e.substep_shaping)&&(a=1),s=0;s<t.psymax;s++)e.pseudohalf[s]=a;return!0}return mt.fill(t.l3_enc,0,576,0),!1},this.init_outer_loop=function(e,t){t.part2_3_length=0,t.big_values=0,t.count1=0,t.global_gain=210,t.scalefac_compress=0,t.table_select[0]=0,t.table_select[1]=0,t.table_select[2]=0,t.subblock_gain[0]=0,t.subblock_gain[1]=0,t.subblock_gain[2]=0,t.subblock_gain[3]=0,t.region0_count=0,t.region1_count=0,t.preflag=0,t.scalefac_scale=0,t.count1table_select=0,t.part2_length=0,t.sfb_lmax=ra.SBPSY_l,t.sfb_smin=ra.SBPSY_s,t.psy_lmax=e.sfb21_extra?ra.SBMAX_l:ra.SBPSY_l,t.psymax=t.psy_lmax,t.sfbmax=t.sfb_lmax,t.sfbdivide=11;for(var a=0;a<ra.SBMAX_l;a++)t.width[a]=e.scalefac_band.l[a+1]-e.scalefac_band.l[a],t.window[a]=3;if(t.block_type==ra.SHORT_TYPE){var s=ta(576);t.sfb_smin=0,(t.sfb_lmax=0)!=t.mixed_block_flag&&(t.sfb_smin=3,t.sfb_lmax=2*e.mode_gr+4),t.psymax=t.sfb_lmax+3*((e.sfb21_extra?ra.SBMAX_s:ra.SBPSY_s)-t.sfb_smin),t.sfbmax=t.sfb_lmax+3*(ra.SBPSY_s-t.sfb_smin),t.sfbdivide=t.sfbmax-18,t.psy_lmax=t.sfb_lmax;var n=e.scalefac_band.l[t.sfb_lmax];for(ee.arraycopy(t.xr,0,s,0,576),a=t.sfb_smin;a<ra.SBMAX_s;a++)for(var r=e.scalefac_band.s[a],_=e.scalefac_band.s[a+1],i=0;i<3;i++)for(var o=r;o<_;o++)t.xr[n++]=s[3*o+i];for(s=t.sfb_lmax,a=t.sfb_smin;a<ra.SBMAX_s;a++)t.width[s]=t.width[s+1]=t.width[s+2]=e.scalefac_band.s[a+1]-e.scalefac_band.s[a],t.window[s]=0,t.window[s+1]=1,t.window[s+2]=2,s+=3}if(t.count1bits=0,t.sfb_partition_table=H.nr_of_sfb_block[0][0],t.slen[0]=0,t.slen[1]=0,t.slen[2]=0,t.slen[3]=0,t.max_nonzero_coeff=575,mt.fill(t.scalefac,0),a=e.ATH,s=t.xr,t.block_type!=ra.SHORT_TYPE)for(n=!1,r=ra.PSFB21-1;0<=r&&!n;r--)for(t=e.scalefac_band.psfb21[r],_=e.scalefac_band.psfb21[r+1],i=H.athAdjust(a.adjust,a.psfb21[r],a.floor),1e-12<e.nsPsy.longfact[21]&&(i*=e.nsPsy.longfact[21]),--_;t<=_;_--){if(!(Math.abs(s[_])<i)){n=!0;break}s[_]=0}else for(i=0;i<3;i++)for(n=!1,r=ra.PSFB12-1;0<=r&&!n;r--)for(_=(t=3*e.scalefac_band.s[12]+(e.scalefac_band.s[13]-e.scalefac_band.s[12])*i+(e.scalefac_band.psfb12[r]-e.scalefac_band.psfb12[0]))+(e.scalefac_band.psfb12[r+1]-e.scalefac_band.psfb12[r]),o=H.athAdjust(a.adjust,a.psfb12[r],a.floor),1e-12<e.nsPsy.shortfact[12]&&(o*=e.nsPsy.shortfact[12]),--_;t<=_;_--){if(!(Math.abs(s[_])<o)){n=!0;break}s[_]=0}},P.BINSEARCH_NONE=new P(0),P.BINSEARCH_UP=new P(1),P.BINSEARCH_DOWN=new P(2),this.trancate_smallspectrums=function(e,t,a,s){var n=ta(G.SFBMAX);if((0!=(4&e.substep_shaping)||t.block_type!=ra.SHORT_TYPE)&&0==(128&e.substep_shaping)){H.calc_noise(t,a,n,new O,null);for(var r=0;r<576;r++){var _=0;0!=t.l3_enc[r]&&(_=Math.abs(t.xr[r])),s[r]=_}r=0,_=8,t.block_type==ra.SHORT_TYPE&&(_=6);do{var i,o,l=t.width[_];r=r+l;if(!(1<=n[_]||(mt.sort(s,r-l,l),J.EQ(s[r-1],0)))){var f=(1-n[_])*a[_],h=i=0;do{for(o=1;h+o<l&&!J.NEQ(s[h+r-l],s[h+r+o-l]);o++);var c=s[h+r-l]*s[h+r-l]*o;if(f<c){0!=h&&(i=s[h+r-l-1]);break}f-=c,h+=o}while(h<l);if(!J.EQ(i,0))for(;Math.abs(t.xr[r-l])<=i&&(t.l3_enc[r-l]=0),0<--l;);}}while(++_<t.psymax);t.part2_3_length=V.noquant_count_bits(e,t,null)}},this.outer_loop=function(e,t,a,s,n,r){var _,i=e.internal_flags,o=new N,l=ta(576),f=ta(G.SFBMAX),h=new O,c=new L,b=9999999,u=!1,m=!1,p=0,d=i.CurrentStep[n],g=!1,v=i.OldValue[n],S=P.BINSEARCH_NONE;for(t.global_gain=v,_=r-t.part2_length;;){var R=V.count_bits(i,s,t,null);if(1==d||R==_)break;R=_<R?(S==P.BINSEARCH_DOWN&&(g=!0),g&&(d/=2),S=P.BINSEARCH_UP,d):(S==P.BINSEARCH_UP&&(g=!0),g&&(d/=2),S=P.BINSEARCH_DOWN,-d),t.global_gain+=R,t.global_gain<0&&(g=!(t.global_gain=0)),255<t.global_gain&&(t.global_gain=255,g=!0)}for(;_<R&&t.global_gain<255;)t.global_gain++,R=V.count_bits(i,s,t,null);if(i.CurrentStep[n]=4<=v-t.global_gain?4:2,i.OldValue[n]=t.global_gain,t.part2_3_length=R,0==i.noise_shaping)return 100;for(H.calc_noise(t,a,f,h,c),h.bits=t.part2_3_length,o.assign(t),n=0,ee.arraycopy(s,0,l,0,576);!u;){do{if(_=new O,g=255,d=0!=(2&i.substep_shaping)?20:3,i.sfb21_extra){if(1<f[o.sfbmax])break;if(o.block_type==ra.SHORT_TYPE&&(1<f[o.sfbmax+1]||1<f[o.sfbmax+2]))break}v=o,R=s,S=e.internal_flags;for(var M=v,A=f,B=R,w=e.internal_flags,T=0==M.scalefac_scale?1.2968395546510096:1.6817928305074292,E=0,k=0;k<M.sfbmax;k++)E<A[k]&&(E=A[k]);switch(3==(k=w.noise_shaping_amp)&&(k=m?2:1),k){case 2:break;case 1:E=1<E?Math.pow(E,.5):.95*E;break;default:E=1<E?1:.95*E}var y=0;for(k=0;k<M.sfbmax;k++){var x=M.width[k];y=y+x;if(!(A[k]<E)){if(0!=(2&w.substep_shaping)&&(w.pseudohalf[k]=0==w.pseudohalf[k]?1:0,0==w.pseudohalf[k]&&2==w.noise_shaping_amp))break;for(M.scalefac[k]++,x=-x;x<0;x++)B[y+x]*=T,B[y+x]>M.xrpow_max&&(M.xrpow_max=B[y+x]);if(2==w.noise_shaping_amp)break}}if(T=I(v))v=!1;else if(T=2==S.mode_gr?V.scale_bitcount(v):V.scale_bitcount_lsf(S,v)){if(1<S.noise_shaping)if(mt.fill(S.pseudohalf,0),0==v.scalefac_scale){for(T=v,A=M=0;A<T.sfbmax;A++){if(w=T.width[A],B=T.scalefac[A],0!=T.preflag&&(B+=H.pretab[A]),M+=w,0!=(1&B))for(B++,w=-w;w<0;w++)R[M+w]*=1.2968395546510096,R[M+w]>T.xrpow_max&&(T.xrpow_max=R[M+w]);T.scalefac[A]=B>>1}T.preflag=0,T.scalefac_scale=1,T=!1}else if(v.block_type==ra.SHORT_TYPE&&0<S.subblock_gain){e:{for(T=S,A=R,B=(M=v).scalefac,R=0;R<M.sfb_lmax;R++)if(16<=B[R]){R=!0;break e}for(w=0;w<3;w++){for(k=E=0,R=M.sfb_lmax+w;R<M.sfbdivide;R+=3)E<B[R]&&(E=B[R]);for(;R<M.sfbmax;R+=3)k<B[R]&&(k=B[R]);if(!(E<16&&k<8)){if(7<=M.subblock_gain[w]){R=!0;break e}for(M.subblock_gain[w]++,E=T.scalefac_band.l[M.sfb_lmax],R=M.sfb_lmax+w;R<M.sfbmax;R+=3)if(k=M.width[R],y=B[R],0<=(y-=4>>M.scalefac_scale))B[R]=y,E+=3*k;else{for(B[R]=0,y=H.IPOW20(210+(y<<M.scalefac_scale+1)),E+=k*(w+1),x=-k;x<0;x++)A[E+x]*=y,A[E+x]>M.xrpow_max&&(M.xrpow_max=A[E+x]);E+=k*(3-w-1)}for(y=H.IPOW20(202),E+=M.width[R]*(w+1),x=-M.width[R];x<0;x++)A[E+x]*=y,A[E+x]>M.xrpow_max&&(M.xrpow_max=A[E+x])}}R=!1}T=R||I(v)}T||(T=2==S.mode_gr?V.scale_bitcount(v):V.scale_bitcount_lsf(S,v)),v=!T}else v=!0;if(!v)break;if(0!=o.scalefac_scale&&(g=254),(v=r-o.part2_length)<=0)break;for(;(o.part2_3_length=V.count_bits(i,s,o,c))>v&&o.global_gain<=g;)o.global_gain++;if(o.global_gain>g)break;if(0==h.over_count){for(;(o.part2_3_length=V.count_bits(i,s,o,c))>b&&o.global_gain<=g;)o.global_gain++;if(o.global_gain>g)break}switch(H.calc_noise(o,a,f,_,c),_.bits=o.part2_3_length,g=h,v=_,T=o,R=f,S=t.block_type!=ra.SHORT_TYPE?e.quant_comp:e.quant_comp_short){default:case 9:0<g.over_count?(S=v.over_SSD<=g.over_SSD,v.over_SSD==g.over_SSD&&(S=v.bits<g.bits)):S=v.max_noise<0&&10*v.max_noise+v.bits<=10*g.max_noise+g.bits;break;case 0:S=v.over_count<g.over_count||v.over_count==g.over_count&&v.over_noise<g.over_noise||v.over_count==g.over_count&&J.EQ(v.over_noise,g.over_noise)&&v.tot_noise<g.tot_noise;break;case 8:for(S=v,A=1e-37,M=0;M<T.psymax;M++)B=R[M],A+=B=_a.FAST_LOG10(.368+.632*B*B*B);S.max_noise=Math.max(1e-20,A);case 1:S=v.max_noise<g.max_noise;break;case 2:S=v.tot_noise<g.tot_noise;break;case 3:S=v.tot_noise<g.tot_noise&&v.max_noise<g.max_noise;break;case 4:S=v.max_noise<=0&&.2<g.max_noise||v.max_noise<=0&&g.max_noise<0&&g.max_noise>v.max_noise-.2&&v.tot_noise<g.tot_noise||v.max_noise<=0&&0<g.max_noise&&g.max_noise>v.max_noise-.2&&v.tot_noise<g.tot_noise+g.over_noise||0<v.max_noise&&-.05<g.max_noise&&g.max_noise>v.max_noise-.1&&v.tot_noise+v.over_noise<g.tot_noise+g.over_noise||0<v.max_noise&&-.1<g.max_noise&&g.max_noise>v.max_noise-.15&&v.tot_noise+v.over_noise+v.over_noise<g.tot_noise+g.over_noise+g.over_noise;break;case 5:S=v.over_noise<g.over_noise||J.EQ(v.over_noise,g.over_noise)&&v.tot_noise<g.tot_noise;break;case 6:S=v.over_noise<g.over_noise||J.EQ(v.over_noise,g.over_noise)&&(v.max_noise<g.max_noise||J.EQ(v.max_noise,g.max_noise)&&v.tot_noise<=g.tot_noise);break;case 7:S=v.over_count<g.over_count||v.over_noise<g.over_noise}if(0==g.over_count&&(S=S&&v.bits<g.bits),0!=(S=S?1:0))b=t.part2_3_length,h=_,t.assign(o),n=0,ee.arraycopy(s,0,l,0,576);else if(0==i.full_outer_loop){if(++n>d&&0==h.over_count)break;if(3==i.noise_shaping_amp&&m&&30<n)break;if(3==i.noise_shaping_amp&&m&&15<o.global_gain-p)break}}while(o.global_gain+o.scalefac_scale<255);3==i.noise_shaping_amp?m?u=!0:(o.assign(t),ee.arraycopy(l,0,s,0,576),n=0,p=o.global_gain,m=!0):u=!0}return e.VBR==ut.vbr_rh||e.VBR==ut.vbr_mtrh?ee.arraycopy(l,0,s,0,576):0!=(1&i.substep_shaping)&&trancate_smallspectrums(i,t,a,s),h.over_count},this.iteration_finish_one=function(e,t,a){var s=e.l3_side,n=s.tt[t][a];V.best_scalefac_store(e,t,a,s),1==e.use_best_huffman&&V.best_huffman_divide(e,n),d.ResvAdjust(e,n)},this.VBR_encode_granule=function(e,t,a,s,n,r,_){var i=e.internal_flags,o=new N,l=ta(576),f=_,h=(_+r)/2,c=0,b=i.sfb21_extra;mt.fill(o.l3_enc,0);do{i.sfb21_extra=!(f-42<h)&&b;var u=outer_loop(e,t,a,s,n,h);u<=0?(c=1,_=t.part2_3_length,o.assign(t),ee.arraycopy(s,0,l,0,576),u=(_-=32)-r,h=(_+r)/2):(u=_-(r=h+32),h=(_+r)/2,0!=c&&(c=2,t.assign(o),ee.arraycopy(l,0,s,0,576)))}while(12<u);i.sfb21_extra=b,2==c&&ee.arraycopy(o.l3_enc,0,t.l3_enc,0,576)},this.get_framebits=function(e,t){var a=e.internal_flags;a.bitrate_index=a.VBR_min_bitrate,b.getframebits(e),a.bitrate_index=1;for(var s=b.getframebits(e),n=1;n<=a.VBR_max_bitrate;n++)a.bitrate_index=n,s=new T(s),t[n]=d.ResvFrameBegin(e,s),s=s.bits},this.VBR_old_prepare=function(e,t,a,s,n,r,_,i,o){var l=e.internal_flags,f=1,h=0;l.bitrate_index=l.VBR_max_bitrate;var c=d.ResvFrameBegin(e,new T(0))/l.mode_gr;get_framebits(e,r);for(var b=0;b<l.mode_gr;b++){var u=H.on_pe(e,t,i[b],c,b,0);for(l.mode_ext==ra.MPG_MD_MS_LR&&(ms_convert(l.l3_side,b),H.reduce_side(i[b],a[b],c,u)),u=0;u<l.channels_out;++u){var m=l.l3_side.tt[b][u];if(m.block_type!=ra.SHORT_TYPE){var p=1.28/(1+Math.exp(3.5-t[b][u]/300))-.05;p=l.PSY.mask_adjust-p}else p=2.56/(1+Math.exp(3.5-t[b][u]/300))-.14,p=l.PSY.mask_adjust_short-p;l.masking_lower=Math.pow(10,.1*p),init_outer_loop(l,m),o[b][u]=H.calc_xmin(e,s[b][u],m,n[b][u]),0!=o[b][u]&&(f=0),_[b][u]=126,h+=i[b][u]}}for(b=0;b<l.mode_gr;b++)for(u=0;u<l.channels_out;u++)h>r[l.VBR_max_bitrate]&&(i[b][u]*=r[l.VBR_max_bitrate],i[b][u]/=h),_[b][u]>i[b][u]&&(_[b][u]=i[b][u]);return f},this.bitpressure_strategy=function(e,t,a,s){for(var n=0;n<e.mode_gr;n++)for(var r=0;r<e.channels_out;r++){for(var _=e.l3_side.tt[n][r],i=t[n][r],o=0,l=0;l<_.psy_lmax;l++)i[o++]*=1+.029*l*l/ra.SBMAX_l/ra.SBMAX_l;if(_.block_type==ra.SHORT_TYPE)for(l=_.sfb_smin;l<ra.SBMAX_s;l++)i[o++]*=1+.029*l*l/ra.SBMAX_s/ra.SBMAX_s,i[o++]*=1+.029*l*l/ra.SBMAX_s/ra.SBMAX_s,i[o++]*=1+.029*l*l/ra.SBMAX_s/ra.SBMAX_s;s[n][r]=0|Math.max(a[n][r],.9*s[n][r])}},this.VBR_new_prepare=function(e,t,a,s,n,r){var _,i=e.internal_flags,o=1,l=_=0;if(e.free_format){i.bitrate_index=0,_=new T(_);var f=d.ResvFrameBegin(e,_);_=_.bits,n[0]=f}else i.bitrate_index=i.VBR_max_bitrate,_=new T(_),d.ResvFrameBegin(e,_),_=_.bits,get_framebits(e,n),f=n[i.VBR_max_bitrate];for(n=0;n<i.mode_gr;n++){H.on_pe(e,t,r[n],_,n,0),i.mode_ext==ra.MPG_MD_MS_LR&&ms_convert(i.l3_side,n);for(var h=0;h<i.channels_out;++h){var c=i.l3_side.tt[n][h];i.masking_lower=Math.pow(10,.1*i.PSY.mask_adjust),init_outer_loop(i,c),0!=H.calc_xmin(e,a[n][h],c,s[n][h])&&(o=0),l+=r[n][h]}}for(n=0;n<i.mode_gr;n++)for(h=0;h<i.channels_out;h++)f<l&&(r[n][h]*=f,r[n][h]/=l);return o},this.calc_target_bits=function(e,t,a,s,n,r){var _=e.internal_flags,i=_.l3_side;_.bitrate_index=_.VBR_max_bitrate;var o=new T(0);r[0]=d.ResvFrameBegin(e,o),_.bitrate_index=1,o=b.getframebits(e)-8*_.sideinfo_len,n[0]=o/(_.mode_gr*_.channels_out),o=e.VBR_mean_bitrate_kbps*e.framesize*1e3,0!=(1&_.substep_shaping)&&(o*=1.09),o/=e.out_samplerate,o-=8*_.sideinfo_len,o/=_.mode_gr*_.channels_out;var l=.93+.07*(11-e.compression_ratio)/5.5;for(l<.9&&(l=.9),1<l&&(l=1),e=0;e<_.mode_gr;e++){var f=0;for(n=0;n<_.channels_out;n++){if(s[e][n]=int(l*o),700<t[e][n]){var h=int((t[e][n]-700)/1.4),c=i.tt[e][n];s[e][n]=int(l*o),c.block_type==ra.SHORT_TYPE&&h<o/2&&(h=o/2),3*o/2<h?h=3*o/2:h<0&&(h=0),s[e][n]+=h}s[e][n]>$.MAX_BITS_PER_CHANNEL&&(s[e][n]=$.MAX_BITS_PER_CHANNEL),f+=s[e][n]}if($.MAX_BITS_PER_GRANULE<f)for(n=0;n<_.channels_out;++n)s[e][n]*=$.MAX_BITS_PER_GRANULE,s[e][n]/=f}if(_.mode_ext==ra.MPG_MD_MS_LR)for(e=0;e<_.mode_gr;e++)H.reduce_side(s[e],a[e],o*_.channels_out,$.MAX_BITS_PER_GRANULE);for(e=t=0;e<_.mode_gr;e++)for(n=0;n<_.channels_out;n++)s[e][n]>$.MAX_BITS_PER_CHANNEL&&(s[e][n]=$.MAX_BITS_PER_CHANNEL),t+=s[e][n];if(t>r[0])for(e=0;e<_.mode_gr;e++)for(n=0;n<_.channels_out;n++)s[e][n]*=r[0],s[e][n]/=t}}function s(){function B(e,t,a){for(var s,n,r=10,_=t+238-14-286,i=-15;i<0;i++){var o=l[r+-10];n=e[_+-224]*o,s=e[t+224]*o,o=l[r+-9],n+=e[_+-160]*o,s+=e[t+160]*o,o=l[r+-8],n+=e[_+-96]*o,s+=e[t+96]*o,o=l[r+-7],n+=e[_+-32]*o,s+=e[t+32]*o,o=l[r+-6],n+=e[_+32]*o,s+=e[t+-32]*o,o=l[r+-5],n+=e[_+96]*o,s+=e[t+-96]*o,o=l[r+-4],n+=e[_+160]*o,s+=e[t+-160]*o,o=l[r+-3],n+=e[_+224]*o,s+=e[t+-224]*o,o=l[r+-2],n+=e[t+-256]*o,s-=e[_+256]*o,o=l[r+-1],n+=e[t+-192]*o,s-=e[_+192]*o,o=l[r+0],n+=e[t+-128]*o,s-=e[_+128]*o,o=l[r+1],n+=e[t+-64]*o,s-=e[_+64]*o,o=l[r+2],n+=e[t+0]*o,s-=e[_+0]*o,o=l[r+3],n+=e[t+64]*o,s-=e[_+-64]*o,o=l[r+4],n+=e[t+128]*o,s-=e[_+-128]*o,o=l[r+5],n+=e[t+192]*o,o=(s-=e[_+-192]*o)-(n*=l[r+6]),a[30+2*i]=s+n,a[31+2*i]=l[r+7]*o,r+=18,t--,_++}s=e[t+-16]*l[r+-10],n=e[t+-32]*l[r+-2],s+=(e[t+-48]-e[t+16])*l[r+-9],n+=e[t+-96]*l[r+-1],s+=(e[t+-80]+e[t+48])*l[r+-8],n+=e[t+-160]*l[r+0],s+=(e[t+-112]-e[t+80])*l[r+-7],n+=e[t+-224]*l[r+1],s+=(e[t+-144]+e[t+112])*l[r+-6],n-=e[t+32]*l[r+2],s+=(e[t+-176]-e[t+144])*l[r+-5],n-=e[t+96]*l[r+3],s+=(e[t+-208]+e[t+176])*l[r+-4],n-=e[t+160]*l[r+4],s+=(e[t+-240]-e[t+208])*l[r+-3],e=(n-=e[t+224])-s,t=n+s,s=a[14],n=a[15]-s,a[31]=t+s,a[30]=e+n,a[15]=e-n,a[14]=t-s,s=a[28]-a[0],a[0]+=a[28],a[28]=s*l[r+-36+7],s=a[29]-a[1],a[1]+=a[29],a[29]=s*l[r+-36+7],s=a[26]-a[2],a[2]+=a[26],a[26]=s*l[r+-72+7],s=a[27]-a[3],a[3]+=a[27],a[27]=s*l[r+-72+7],s=a[24]-a[4],a[4]+=a[24],a[24]=s*l[r+-108+7],s=a[25]-a[5],a[5]+=a[25],a[25]=s*l[r+-108+7],s=a[22]-a[6],a[6]+=a[22],a[22]=s*_a.SQRT2,s=a[23]-a[7],a[7]+=a[23],a[23]=s*_a.SQRT2-a[7],a[7]-=a[6],a[22]-=a[7],a[23]-=a[22],s=a[6],a[6]=a[31]-s,a[31]+=s,s=a[7],a[7]=a[30]-s,a[30]+=s,s=a[22],a[22]=a[15]-s,a[15]+=s,s=a[23],a[23]=a[14]-s,a[14]+=s,s=a[20]-a[8],a[8]+=a[20],a[20]=s*l[r+-180+7],s=a[21]-a[9],a[9]+=a[21],a[21]=s*l[r+-180+7],s=a[18]-a[10],a[10]+=a[18],a[18]=s*l[r+-216+7],s=a[19]-a[11],a[11]+=a[19],a[19]=s*l[r+-216+7],s=a[16]-a[12],a[12]+=a[16],a[16]=s*l[r+-252+7],s=a[17]-a[13],a[13]+=a[17],a[17]=s*l[r+-252+7],s=-a[20]+a[24],a[20]+=a[24],a[24]=s*l[r+-216+7],s=-a[21]+a[25],a[21]+=a[25],a[25]=s*l[r+-216+7],s=a[4]-a[8],a[4]+=a[8],a[8]=s*l[r+-216+7],s=a[5]-a[9],a[5]+=a[9],a[9]=s*l[r+-216+7],s=a[0]-a[12],a[0]+=a[12],a[12]=s*l[r+-72+7],s=a[1]-a[13],a[1]+=a[13],a[13]=s*l[r+-72+7],s=a[16]-a[28],a[16]+=a[28],a[28]=s*l[r+-72+7],s=-a[17]+a[29],a[17]+=a[29],a[29]=s*l[r+-72+7],s=_a.SQRT2*(a[2]-a[10]),a[2]+=a[10],a[10]=s,s=_a.SQRT2*(a[3]-a[11]),a[3]+=a[11],a[11]=s,s=_a.SQRT2*(-a[18]+a[26]),a[18]+=a[26],a[26]=s-a[18],s=_a.SQRT2*(-a[19]+a[27]),a[19]+=a[27],a[27]=s-a[19],s=a[2],a[19]-=a[3],a[3]-=s,a[2]=a[31]-s,a[31]+=s,s=a[3],a[11]-=a[19],a[18]-=s,a[3]=a[30]-s,a[30]+=s,s=a[18],a[27]-=a[11],a[19]-=s,a[18]=a[15]-s,a[15]+=s,s=a[19],a[10]-=s,a[19]=a[14]-s,a[14]+=s,s=a[10],a[11]-=s,a[10]=a[23]-s,a[23]+=s,s=a[11],a[26]-=s,a[11]=a[22]-s,a[22]+=s,s=a[26],a[27]-=s,a[26]=a[7]-s,a[7]+=s,s=a[27],a[27]=a[6]-s,a[6]+=s,s=_a.SQRT2*(a[0]-a[4]),a[0]+=a[4],a[4]=s,s=_a.SQRT2*(a[1]-a[5]),a[1]+=a[5],a[5]=s,s=_a.SQRT2*(a[16]-a[20]),a[16]+=a[20],a[20]=s,s=_a.SQRT2*(a[17]-a[21]),a[17]+=a[21],a[21]=s,s=-_a.SQRT2*(a[8]-a[12]),a[8]+=a[12],a[12]=s-a[8],s=-_a.SQRT2*(a[9]-a[13]),a[9]+=a[13],a[13]=s-a[9],s=-_a.SQRT2*(a[25]-a[29]),a[25]+=a[29],a[29]=s-a[25],s=-_a.SQRT2*(a[24]+a[28]),a[24]-=a[28],a[28]=s-a[24],s=a[24]-a[16],a[24]=s,s=a[20]-s,a[20]=s,s=a[28]-s,a[28]=s,s=a[25]-a[17],a[25]=s,s=a[21]-s,a[21]=s,s=a[29]-s,a[29]=s,s=a[17]-a[1],a[17]=s,s=a[9]-s,a[9]=s,s=a[25]-s,a[25]=s,s=a[5]-s,a[5]=s,s=a[21]-s,a[21]=s,s=a[13]-s,a[13]=s,s=a[29]-s,a[29]=s,s=a[1]-a[0],a[1]=s,s=a[16]-s,a[16]=s,s=a[17]-s,a[17]=s,s=a[8]-s,a[8]=s,s=a[9]-s,a[9]=s,s=a[24]-s,a[24]=s,s=a[25]-s,a[25]=s,s=a[4]-s,a[4]=s,s=a[5]-s,a[5]=s,s=a[20]-s,a[20]=s,s=a[21]-s,a[21]=s,s=a[12]-s,a[12]=s,s=a[13]-s,a[13]=s,s=a[28]-s,a[28]=s,s=a[29]-s,a[29]=s,s=a[0],a[0]+=a[31],a[31]-=s,s=a[1],a[1]+=a[30],a[30]-=s,s=a[16],a[16]+=a[15],a[15]-=s,s=a[17],a[17]+=a[14],a[14]-=s,s=a[8],a[8]+=a[23],a[23]-=s,s=a[9],a[9]+=a[22],a[22]-=s,s=a[24],a[24]+=a[7],a[7]-=s,s=a[25],a[25]+=a[6],a[6]-=s,s=a[4],a[4]+=a[27],a[27]-=s,s=a[5],a[5]+=a[26],a[26]-=s,s=a[20],a[20]+=a[11],a[11]-=s,s=a[21],a[21]+=a[10],a[10]-=s,s=a[12],a[12]+=a[19],a[19]-=s,s=a[13],a[13]+=a[18],a[18]-=s,s=a[28],a[28]+=a[3],a[3]-=s,s=a[29],a[29]+=a[2],a[2]-=s}var l=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.0178904535*_a.SQRT2/2384e-9,.008938074*_a.SQRT2/2384e-9,.0015673635*_a.SQRT2/2384e-9,.001228571*_a.SQRT2/2384e-9,.0004856585*_a.SQRT2/2384e-9,109434e-9*_a.SQRT2/2384e-9,50783e-9*_a.SQRT2/2384e-9,6914e-9*_a.SQRT2/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],w=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],T=w[ra.SHORT_TYPE],E=w[ra.SHORT_TYPE],k=w[ra.SHORT_TYPE],y=w[ra.SHORT_TYPE],x=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];this.mdct_sub48=function(e,t,a){for(var s=286,n=0;n<e.channels_out;n++){for(var r=0;r<e.mode_gr;r++){for(var _,i=e.l3_side.tt[r][n],o=i.xr,l=0,f=e.sb_sample[n][1-r],h=0,c=0;c<9;c++)for(B(t,s,f[h]),B(t,s+32,f[h+1]),h+=2,s+=64,_=1;_<32;_+=2)f[h-1][_]*=-1;for(_=0;_<32;_++,l+=18){f=i.block_type,h=e.sb_sample[n][r];var b=e.sb_sample[n][1-r];if(0!=i.mixed_block_flag&&_<2&&(f=0),e.amp_filter[_]<1e-12)mt.fill(o,l+0,l+18,0);else{if(e.amp_filter[_]<1)for(c=0;c<18;c++)b[c][x[_]]*=e.amp_filter[_];if(f==ra.SHORT_TYPE){for(c=-3;c<0;c++){var u=w[ra.SHORT_TYPE][c+3];o[l+3*c+9]=h[9+c][x[_]]*u-h[8-c][x[_]],o[l+3*c+18]=h[14-c][x[_]]*u+h[15+c][x[_]],o[l+3*c+10]=h[15+c][x[_]]*u-h[14-c][x[_]],o[l+3*c+19]=b[2-c][x[_]]*u+b[3+c][x[_]],o[l+3*c+11]=b[3+c][x[_]]*u-b[2-c][x[_]],o[l+3*c+20]=b[8-c][x[_]]*u+b[9+c][x[_]]}for(c=o,h=l,u=0;u<3;u++){var m=c[h+6]*w[ra.SHORT_TYPE][0]-c[h+15],p=m+(b=c[h+0]*w[ra.SHORT_TYPE][2]-c[h+9]),d=m-b,g=(m=c[h+15]*w[ra.SHORT_TYPE][0]+c[h+6])+(b=c[h+9]*w[ra.SHORT_TYPE][2]+c[h+0]),v=-m+b;b=2069978111953089e-26*(c[h+3]*w[ra.SHORT_TYPE][1]-c[h+12]),m=2069978111953089e-26*(c[h+12]*w[ra.SHORT_TYPE][1]+c[h+3]),c[h+0]=190752519173728e-25*p+b,c[h+15]=190752519173728e-25*-g+m,d*=16519652744032674e-27,g=9537625958686404e-27*g+m,c[h+3]=d-g,c[h+6]=d+g,p=9537625958686404e-27*p-b,v*=16519652744032674e-27,c[h+9]=p+v,c[h+12]=p-v,h++}}else{for(u=ta(18),c=-9;c<0;c++)p=w[f][c+27]*b[c+9][x[_]]+w[f][c+36]*b[8-c][x[_]],d=w[f][c+9]*h[c+9][x[_]]-w[f][c+18]*h[8-c][x[_]],u[c+9]=p-d*T[3+c+9],u[c+18]=p*T[3+c+9]+d;c=o,h=l;var S=(p=u)[17]-p[9],R=p[15]-p[11],M=p[14]-p[12];v=p[0]+p[8],g=p[1]+p[7],m=p[2]+p[6],d=p[3]+p[5],c[h+17]=v+m-d-(g-p[4]),u=(v+m-d)*E[19]+(g-p[4]),b=(S-R-M)*E[18],c[h+5]=b+u,c[h+6]=b-u;var A=(p[16]-p[10])*E[18];g=g*E[19]+p[4],b=S*E[12]+A+R*E[13]+M*E[14],u=-v*E[16]+g-m*E[17]+d*E[15],c[h+1]=b+u,c[h+2]=b-u,b=S*E[13]-A-R*E[14]+M*E[12],u=-v*E[17]+g-m*E[15]+d*E[16],c[h+9]=b+u,c[h+10]=b-u,b=S*E[14]-A+R*E[12]-M*E[13],u=v*E[15]-g+m*E[16]-d*E[17],c[h+13]=b+u,c[h+14]=b-u,S=p[8]-p[0],R=p[6]-p[2],M=p[5]-p[3],v=p[17]+p[9],g=p[16]+p[10],m=p[15]+p[11],d=p[14]+p[12],c[h+0]=v+m+d+(g+p[13]),b=(v+m+d)*E[19]-(g+p[13]),u=(S-R+M)*E[18],c[h+11]=b+u,c[h+12]=b-u,A=(p[7]-p[1])*E[18],g=p[13]-g*E[19],b=v*E[15]-g+m*E[16]+d*E[17],u=S*E[14]+A+R*E[12]+M*E[13],c[h+3]=b+u,c[h+4]=b-u,b=-v*E[17]+g-m*E[15]-d*E[16],u=S*E[13]+A-R*E[14]-M*E[12],c[h+7]=b+u,c[h+8]=b-u,b=-v*E[16]+g-m*E[17]-d*E[15],u=S*E[12]-A+R*E[13]-M*E[14],c[h+15]=b+u,c[h+16]=b-u}}if(f!=ra.SHORT_TYPE&&0!=_)for(c=7;0<=c;--c)f=o[l+c]*k[20+c]+o[l+-1-c]*y[28+c],h=o[l+c]*y[28+c]-o[l+-1-c]*k[20+c],o[l+-1-c]=f,o[l+c]=h}}if(t=a,s=286,1==e.mode_gr)for(r=0;r<18;r++)ee.arraycopy(e.sb_sample[n][1][r],0,e.sb_sample[n][0][r],0,32)}}}function V(){this.thm=new i,this.en=new i}function ra(){var g=ra.FFTOFFSET,v=ra.MPG_MD_MS_LR,S=null,R=this.psy=null,M=null,A=null;this.setModules=function(e,t,a,s){S=e,R=this.psy=t,M=s,A=a};var B=new s;this.lame_encode_mp3_frame=function(e,t,a,s,n,r){var _=w([2,2]);_[0][0]=new V,_[0][1]=new V,_[1][0]=new V,_[1][1]=new V;var i=w([2,2]);i[0][0]=new V,i[0][1]=new V,i[1][0]=new V,i[1][1]=new V;var o,l,f=[null,null],h=e.internal_flags,c=aa([2,4]),b=[.5,.5],u=[[0,0],[0,0]],m=[[0,0],[0,0]];if((f[0]=t,f[1]=a,0==h.lame_encode_frame_init)&&0==(t=e.internal_flags).lame_encode_frame_init){a=ta(2014);var p=ta(2014);for(t.lame_encode_frame_init=1,l=o=0;o<286+576*(1+t.mode_gr);++o)o<576*t.mode_gr?(a[o]=0,2==t.channels_out&&(p[o]=0)):(a[o]=f[0][l],2==t.channels_out&&(p[o]=f[1][l]),++l);for(l=0;l<t.mode_gr;l++)for(o=0;o<t.channels_out;o++)t.l3_side.tt[l][o].block_type=ra.SHORT_TYPE;B.mdct_sub48(t,a,p)}if(h.padding=0,(h.slot_lag-=h.frac_SpF)<0&&(h.slot_lag+=e.out_samplerate,h.padding=1),0!=h.psymodel)for(p=[null,null],o=0,l=ea(2),a=0;a<h.mode_gr;a++){for(t=0;t<h.channels_out;t++)p[t]=f[t],o=576+576*a-ra.FFTOFFSET;if(0!=(t=e.VBR==ut.vbr_mtrh||e.VBR==ut.vbr_mt?R.L3psycho_anal_vbr(e,p,o,a,_,i,u[a],m[a],c[a],l):R.L3psycho_anal_ns(e,p,o,a,_,i,u[a],m[a],c[a],l)))return-4;for(e.mode==na.JOINT_STEREO&&(b[a]=c[a][2]+c[a][3],0<b[a]&&(b[a]=c[a][3]/b[a])),t=0;t<h.channels_out;t++){var d=h.l3_side.tt[a][t];d.block_type=l[t],d.mixed_block_flag=0}}else for(a=0;a<h.mode_gr;a++)for(t=0;t<h.channels_out;t++)h.l3_side.tt[a][t].block_type=ra.NORM_TYPE,h.l3_side.tt[a][t].mixed_block_flag=0,m[a][t]=u[a][t]=700;if(0==h.ATH.useAdjust?h.ATH.adjust=1:(t=h.loudness_sq[0][0],c=h.loudness_sq[1][0],2==h.channels_out?(t+=h.loudness_sq[0][1],c+=h.loudness_sq[1][1]):(t+=t,c+=c),2==h.mode_gr&&(t=Math.max(t,c)),t=.5*t*h.ATH.aaSensitivityP,h.ATH.adjustLimit=.03125<t?(1<=h.ATH.adjust?h.ATH.adjust=1:h.ATH.adjust<h.ATH.adjustLimit&&(h.ATH.adjust=h.ATH.adjustLimit),1):(c=31.98*t+625e-6,h.ATH.adjust>=c?(h.ATH.adjust*=.075*c+.925,h.ATH.adjust<c&&(h.ATH.adjust=c)):h.ATH.adjustLimit>=c?h.ATH.adjust=c:h.ATH.adjust<h.ATH.adjustLimit&&(h.ATH.adjust=h.ATH.adjustLimit),c)),B.mdct_sub48(h,f[0],f[1]),h.mode_ext=ra.MPG_MD_LR_LR,e.force_ms)h.mode_ext=ra.MPG_MD_MS_LR;else if(e.mode==na.JOINT_STEREO){for(a=p=c=0;a<h.mode_gr;a++)for(t=0;t<h.channels_out;t++)c+=m[a][t],p+=u[a][t];c<=1*p&&(c=h.l3_side.tt[0],t=h.l3_side.tt[h.mode_gr-1],c[0].block_type==c[1].block_type&&t[0].block_type==t[1].block_type&&(h.mode_ext=ra.MPG_MD_MS_LR))}if(h.mode_ext==v&&(_=i,u=m),e.analysis&&null!=h.pinfo)for(a=0;a<h.mode_gr;a++)for(t=0;t<h.channels_out;t++)h.pinfo.ms_ratio[a]=h.ms_ratio[a],h.pinfo.ms_ener_ratio[a]=b[a],h.pinfo.blocktype[a][t]=h.l3_side.tt[a][t].block_type,h.pinfo.pe[a][t]=u[a][t],ee.arraycopy(h.l3_side.tt[a][t].xr,0,h.pinfo.xr[a][t],0,576),h.mode_ext==v&&(h.pinfo.ers[a][t]=h.pinfo.ers[a][t+2],ee.arraycopy(h.pinfo.energy[a][t+2],0,h.pinfo.energy[a][t],0,h.pinfo.energy[a][t].length));if(e.VBR==ut.vbr_off||e.VBR==ut.vbr_abr){for(i=0;i<18;i++)h.nsPsy.pefirbuf[i]=h.nsPsy.pefirbuf[i+1];for(a=m=0;a<h.mode_gr;a++)for(t=0;t<h.channels_out;t++)m+=u[a][t];for(h.nsPsy.pefirbuf[18]=m,m=h.nsPsy.pefirbuf[9],i=0;i<9;i++)m+=(h.nsPsy.pefirbuf[i]+h.nsPsy.pefirbuf[18-i])*ra.fircoef[i];for(m=3350*h.mode_gr*h.channels_out/m,a=0;a<h.mode_gr;a++)for(t=0;t<h.channels_out;t++)u[a][t]*=m}if(h.iteration_loop.iteration_loop(e,u,b,_),S.format_bitstream(e),s=S.copy_buffer(h,s,n,r,1),e.bWriteVbrTag&&M.addVbrFrame(e),e.analysis&&null!=h.pinfo){for(t=0;t<h.channels_out;t++){for(n=0;n<g;n++)h.pinfo.pcmdata[t][n]=h.pinfo.pcmdata[t][n+e.framesize];for(n=g;n<1600;n++)h.pinfo.pcmdata[t][n]=f[t][n-g]}A.set_frame_pinfo(e,_)}for(h.bitrate_stereoMode_Hist[h.bitrate_index][4]++,h.bitrate_stereoMode_Hist[15][4]++,2==h.channels_out&&(h.bitrate_stereoMode_Hist[h.bitrate_index][h.mode_ext]++,h.bitrate_stereoMode_Hist[15][h.mode_ext]++),e=0;e<h.mode_gr;++e)for(f=0;f<h.channels_out;++f)n=0|h.l3_side.tt[e][f].block_type,0!=h.l3_side.tt[e][f].mixed_block_flag&&(n=4),h.bitrate_blockType_Hist[h.bitrate_index][n]++,h.bitrate_blockType_Hist[h.bitrate_index][5]++,h.bitrate_blockType_Hist[15][n]++,h.bitrate_blockType_Hist[15][5]++;return s}}function r(){this.size=this.pos=this.want=this.seen=this.sum=0,this.bag=null,this.TotalFrameSize=this.nBytesWritten=this.nVbrNumFrames=0}function _(){this.tt=[[null,null],[null,null]],this.resvDrain_post=this.resvDrain_pre=this.private_bits=this.main_data_begin=0,this.scfsi=[ea(4),ea(4)];for(var e=0;e<2;e++)for(var t=0;t<2;t++)this.tt[e][t]=new N}function i(){this.l=ta(ra.SBMAX_l),this.s=aa([ra.SBMAX_s,3]);var s=this;this.assign=function(e){ee.arraycopy(e.l,0,s.l,0,ra.SBMAX_l);for(var t=0;t<ra.SBMAX_s;t++)for(var a=0;a<3;a++)s.s[t][a]=e.s[t][a]}}function o(){this.last_en_subshort=aa([4,9]),this.lastAttacks=ea(4),this.pefirbuf=ta(19),this.longfact=ta(ra.SBMAX_l),this.shortfact=ta(ra.SBMAX_s),this.attackthre_s=this.attackthre=0}function $(){function e(){this.ptr=this.write_timing=0,this.buf=new Int8Array(40)}this.fill_buffer_resample_init=this.iteration_init_init=this.lame_encode_frame_init=this.Class_ID=0,this.mfbuf=aa([2,$.MFSIZE]),this.full_outer_loop=this.use_best_huffman=this.subblock_gain=this.noise_shaping_stop=this.psymodel=this.substep_shaping=this.noise_shaping_amp=this.noise_shaping=this.highpass2=this.highpass1=this.lowpass2=this.lowpass1=this.mode_ext=this.samplerate_index=this.bitrate_index=this.VBR_max_bitrate=this.VBR_min_bitrate=this.mf_size=this.mf_samples_to_encode=this.resample_ratio=this.channels_out=this.channels_in=this.mode_gr=0,this.l3_side=new _,this.ms_ratio=ta(2),this.slot_lag=this.frac_SpF=this.padding=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=ea(2),this.CurrentStep=ea(2),this.masking_lower=0,this.bv_scf=ea(576),this.pseudohalf=ea(G.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=Array(2),this.blackfilt=Array(2*$.BPC+1),this.itime=new Float64Array(2),this.sideinfo_len=0,this.sb_sample=aa([2,2,18,ra.SBLIMIT]),this.amp_filter=ta(32),this.header=Array($.MAX_HEADER_BUF),this.ResvMax=this.ResvSize=this.ancillary_flag=this.w_ptr=this.h_ptr=0,this.scalefac_band=new n,this.minval_l=ta(ra.CBANDS),this.minval_s=ta(ra.CBANDS),this.nb_1=aa([4,ra.CBANDS]),this.nb_2=aa([4,ra.CBANDS]),this.nb_s1=aa([4,ra.CBANDS]),this.nb_s2=aa([4,ra.CBANDS]),this.s3_ll=this.s3_ss=null,this.decay=0,this.thm=Array(4),this.en=Array(4),this.tot_ener=ta(4),this.loudness_sq=aa([2,2]),this.loudness_sq_save=ta(2),this.mld_l=ta(ra.SBMAX_l),this.mld_s=ta(ra.SBMAX_s),this.bm_l=ea(ra.SBMAX_l),this.bo_l=ea(ra.SBMAX_l),this.bm_s=ea(ra.SBMAX_s),this.bo_s=ea(ra.SBMAX_s),this.npart_s=this.npart_l=0,this.s3ind=M([ra.CBANDS,2]),this.s3ind_s=M([ra.CBANDS,2]),this.numlines_s=ea(ra.CBANDS),this.numlines_l=ea(ra.CBANDS),this.rnumlines_l=ta(ra.CBANDS),this.mld_cb_l=ta(ra.CBANDS),this.mld_cb_s=ta(ra.CBANDS),this.numlines_l_num1=this.numlines_s_num1=0,this.pe=ta(4),this.ms_ener_ratio_old=this.ms_ratio_l_old=this.ms_ratio_s_old=0,this.blocktype_old=ea(2),this.nsPsy=new o,this.VBR_seek_table=new r,this.PSY=this.ATH=null,this.nogap_current=this.nogap_total=0,this.findPeakSample=this.findReplayGain=this.decode_on_the_fly=!0,this.AudiophileGain=this.RadioGain=this.PeakSample=0,this.rgdata=null,this.noclipScale=this.noclipGainChange=0,this.bitrate_stereoMode_Hist=M([16,5]),this.bitrate_blockType_Hist=M([16,6]),this.hip=this.pinfo=null,this.in_buffer_nsamples=0,this.iteration_loop=this.in_buffer_1=this.in_buffer_0=null;for(var t=0;t<this.en.length;t++)this.en[t]=new i;for(t=0;t<this.thm.length;t++)this.thm[t]=new i;for(t=0;t<this.header.length;t++)this.header[t]=new e}function h(){function u(e,t,a){var s=0,n=t+(a<<=1),r=4;do{var _,i=r>>1,o=r,l=r<<1,f=l+o;r=l<<1;var h=t,c=h+i;do{var b=e[h+0]-e[h+o],u=e[h+0]+e[h+o],m=e[h+l]-e[h+f],p=e[h+l]+e[h+f];e[h+l]=u-p,e[h+0]=u+p,e[h+f]=b-m,e[h+o]=b+m,b=e[c+0]-e[c+o],u=e[c+0]+e[c+o],m=_a.SQRT2*e[c+f],p=_a.SQRT2*e[c+l],e[c+l]=u-p,e[c+0]=u+p,e[c+f]=b-m,e[c+o]=b+m,c+=r,h+=r}while(h<n);var d=T[s+0],g=T[s+1];for(_=1;_<i;_++){var v=1-2*g*g,S=2*g*d;h=t+_,c=t+o-_;do{var R=S*e[h+o]-v*e[c+o];p=v*e[h+o]+S*e[c+o],b=e[h+0]-p,u=e[h+0]+p;var M=e[c+0]-R,A=e[c+0]+R;R=S*e[h+f]-v*e[c+f],p=v*e[h+f]+S*e[c+f],m=e[h+l]-p,p=e[h+l]+p;var B=e[c+l]-R,w=e[c+l]+R;R=g*p-d*B,p=d*p+g*B,e[h+l]=u-p,e[h+0]=u+p,e[c+f]=M-R,e[c+o]=M+R,R=d*w-g*m,p=g*w+d*m,e[c+l]=A-p,e[c+0]=A+p,e[h+f]=b-R,e[h+o]=b+R,c+=r,h+=r}while(h<n);d=(v=d)*T[s+0]-g*T[s+1],g=v*T[s+1]+g*T[s+0]}s+=2}while(r<a)}var c=ta(ra.BLKSIZE),m=ta(ra.BLKSIZE_s/2),T=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475],p=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(e,t,a,s,n){for(e=0;e<3;e++){var r=ra.BLKSIZE_s/2,_=65535&192*(e+1),i=ra.BLKSIZE_s/8-1;do{var o=255&p[i<<2],l=m[o]*s[a][n+o+_],f=m[127-o]*s[a][n+o+_+128],h=l-f;l+=f;var c=m[o+64]*s[a][n+o+_+64],b=c-(f=m[63-o]*s[a][n+o+_+192]);c+=f,r-=4,t[e][r+0]=l+c,t[e][r+2]=l-c,t[e][r+1]=h+b,t[e][r+3]=h-b,h=(l=m[o+1]*s[a][n+o+_+1])-(f=m[126-o]*s[a][n+o+_+129]),l+=f,b=(c=m[o+65]*s[a][n+o+_+65])-(f=m[62-o]*s[a][n+o+_+193]),c+=f,t[e][r+ra.BLKSIZE_s/2+0]=l+c,t[e][r+ra.BLKSIZE_s/2+2]=l-c,t[e][r+ra.BLKSIZE_s/2+1]=h+b,t[e][r+ra.BLKSIZE_s/2+3]=h-b}while(0<=--i);u(t[e],r,ra.BLKSIZE_s/2)}},this.fft_long=function(e,t,a,s,n){e=ra.BLKSIZE/8-1;var r=ra.BLKSIZE/2;do{var _=255&p[e],i=c[_]*s[a][n+_],o=c[_+512]*s[a][n+_+512],l=i-o;i+=o;var f=c[_+256]*s[a][n+_+256],h=f-(o=c[_+768]*s[a][n+_+768]);f+=o,t[(r-=4)+0]=i+f,t[r+2]=i-f,t[r+1]=l+h,t[r+3]=l-h,l=(i=c[_+1]*s[a][n+_+1])-(o=c[_+513]*s[a][n+_+513]),i+=o,h=(f=c[_+257]*s[a][n+_+257])-(o=c[_+769]*s[a][n+_+769]),f+=o,t[r+ra.BLKSIZE/2+0]=i+f,t[r+ra.BLKSIZE/2+2]=i-f,t[r+ra.BLKSIZE/2+1]=l+h,t[r+ra.BLKSIZE/2+3]=l-h}while(0<=--e);u(t,r,ra.BLKSIZE/2)},this.init_fft=function(e){for(e=0;e<ra.BLKSIZE;e++)c[e]=.42-.5*Math.cos(2*Math.PI*(e+.5)/ra.BLKSIZE)+.08*Math.cos(4*Math.PI*(e+.5)/ra.BLKSIZE);for(e=0;e<ra.BLKSIZE_s/2;e++)m[e]=.5*(1-Math.cos(2*Math.PI*(e+.5)/ra.BLKSIZE_s))}}function D(){function Yt(e,t){for(var a=0,s=0;s<ra.BLKSIZE/2;++s)a+=e[s]*t.ATH.eql_w[s];return a*n}function ct(e,t,a,s,n,r){if(e<t){if(!(t<e*R))return e+t;var _=t/e}else{if(t*R<=e)return e+t;_=e/t}return e+=t,s+3<=6?v<=_?e:(s=0|_a.FAST_LOG10_X(_,16),e*o[s]):(s=0|_a.FAST_LOG10_X(_,16),t=0!=r?n.ATH.cb_s[a]*n.ATH.adjust:n.ATH.cb_l[a]*n.ATH.adjust,e<M*t?t<e?(a=1,s<=13&&(a=l[s]),t=_a.FAST_LOG10_X(e/t,10/15),e*((i[s]-a)*t+a)):13<s?e:e*l[s]:e*i[s])}function Ct(e,t,a){if(e<0&&(e=0),t<0&&(t=0),e<=0)return t;if(t<=0)return e;var s=e<t?t/e:e/t;return-2<=a&&a<=2?v<=s?e+t:(a=0|_a.FAST_LOG10_X(s,16),(e+t)*r[a]):s<R?e+t:(e<t&&(e=t),e)}function Ft(e,t,a,s,n){var r,_,i=0,o=0;for(r=_=0;r<ra.SBMAX_s;++_,++r){var l=e.bo_s[r],f=e.npart_s;for(l=l<f?l:f;_<l;)i+=t[_],o+=a[_],_++;if(e.en[s].s[r][n]=i,e.thm[s].s[r][n]=o,f<=_){++r;break}f=1-(o=e.PSY.bo_s_weight[r]),i=o*t[_],o*=a[_],e.en[s].s[r][n]+=i,e.thm[s].s[r][n]+=o,i=f*t[_],o=f*a[_]}for(;r<ra.SBMAX_s;++r)e.en[s].s[r][n]=0,e.thm[s].s[r][n]=0}function jt(e,t,a,s){var n,r,_=0,i=0;for(n=r=0;n<ra.SBMAX_l;++r,++n){var o=e.bo_l[n],l=e.npart_l;for(o=o<l?o:l;r<o;)_+=t[r],i+=a[r],r++;if(e.en[s].l[n]=_,e.thm[s].l[n]=i,l<=r){++n;break}l=1-(i=e.PSY.bo_l_weight[n]),_=i*t[r],i*=a[r],e.en[s].l[n]+=_,e.thm[s].l[n]+=i,_=l*t[r],i=l*a[r]}for(;n<ra.SBMAX_l;++n)e.en[s].l[n]=0,e.thm[s].l[n]=0}function Gt(e,t,a){return 1<=a?e:a<=0?t:0<t?Math.pow(e/t,a)*t:0}function zt(e,t){for(var a=309.07,s=0;s<ra.SBMAX_s-1;s++)for(var n=0;n<3;n++){if(0<(r=e.thm.s[s][n])){var r=r*t,_=e.en.s[s][n];r<_&&(a=1e10*r<_?a+23.02585092994046*f[s]:a+f[s]*_a.FAST_LOG10(_/r))}}return a}function Kt(e,t){for(var a=281.0575,s=0;s<ra.SBMAX_l-1;s++){if(0<(n=e.thm.l[s])){var n=n*t,r=e.en.l[s];n<r&&(a=1e10*n<r?a+23.02585092994046*_[s]:a+_[s]*_a.FAST_LOG10(r/n))}}return a}function Zt(e,t,a,s,n){var r,_;for(r=_=0;r<e.npart_l;++r){var i,o=0,l=0;for(i=0;i<e.numlines_l[r];++i,++_){var f=t[_];o=o+f;l<f&&(l=f)}a[r]=o,s[r]=l,n[r]=o*e.rnumlines_l[r]}}function Qt(e,t,a,s){var n=Jt.length-1,r=0,_=a[r]+a[r+1];if(0<_){var i=t[r];i<t[r+1]&&(i=t[r+1]),n<(i=0|(_=20*(2*i-_)/(_*(e.numlines_l[r]+e.numlines_l[r+1]-1))))&&(i=n),s[r]=i}else s[r]=0;for(r=1;r<e.npart_l-1;r++)_=a[r-1]+a[r]+a[r+1],s[r]=0<_?((i=t[r-1])<t[r]&&(i=t[r]),i<t[r+1]&&(i=t[r+1]),n<(i=0|(_=20*(3*i-_)/(_*(e.numlines_l[r-1]+e.numlines_l[r]+e.numlines_l[r+1]-1))))&&(i=n),i):0;_=a[r-1]+a[r],s[r]=0<_?((i=t[r-1])<t[r]&&(i=t[r]),n<(i=0|(_=20*(2*i-_)/(_*(e.numlines_l[r-1]+e.numlines_l[r]-1))))&&(i=n),i):0}function Ut(e,t,a,s,n,r,_){var i=2*r;n=0<r?Math.pow(10,n):1;for(var o,l,f=0;f<_;++f){var h=e[2][f],c=e[3][f],b=t[0][f],u=t[1][f],m=t[2][f],p=t[3][f];o=b<=1.58*u&&u<=1.58*b?(o=a[f]*h,l=Math.max(m,Math.min(p,a[f]*c)),Math.max(p,Math.min(m,o))):(l=m,p),0<r&&(p=s[f]*n,b=Math.min(Math.max(b,p),Math.max(u,p)),0<(u=(m=Math.max(l,p))+(p=Math.max(o,p)))&&b*i<u&&(m*=b=b*i/u,p*=b),l=Math.min(m,l),o=Math.min(p,o)),h<l&&(l=h),c<o&&(o=c),t[2][f]=l,t[3][f]=o}}function m(e,t){return(e=0<=e?27*-e:e*t)<=-72?0:Math.exp(.2302585093*e)}function S(e){return e<0&&(e=0),e*=.001,13*Math.atan(.76*e)+3.5*Math.atan(e*e/56.25)}function p(e,t,a,s,n,r,_,i,o,l,f,h){var c,b=ta(ra.CBANDS+1),u=i/(15<h?1152:384),m=ea(ra.HBLKSIZE);i/=o;var p=0,d=0;for(c=0;c<ra.CBANDS;c++){var g,v=S(i*p);for(b[c]=i*p,g=p;S(i*g)-v<.34&&g<=o/2;g++);for(e[c]=g-p,d=c+1;p<g;)m[p++]=c;if(o/2<p){p=o/2,++c;break}}for(b[c]=i*p,v=0;v<h;v++)c=l[v],p=l[v+1],(c=0|Math.floor(.5+f*(c-.5)))<0&&(c=0),o/2<(g=0|Math.floor(.5+f*(p-.5)))&&(g=o/2),a[v]=(m[c]+m[g])/2,t[v]=m[g],_[v]=(u*p-b[t[v]])/(b[t[v]+1]-b[t[v]]),_[v]<0?_[v]=0:1<_[v]&&(_[v]=1),p=S(i*l[v]*f),p=Math.min(p,15.5)/15.5,r[v]=Math.pow(10,1.25*(1-Math.cos(Math.PI*p))-2.5);for(t=p=0;t<d;t++)a=e[t],v=S(i*p),r=S(i*(p+a-1)),s[t]=.5*(v+r),v=S(i*(p-.5)),r=S(i*(p+a-.5)),n[t]=r-v,p+=a;return d}function d(e,t,a,s,n,r){var _=aa([ra.CBANDS,ra.CBANDS]),i=0;if(r)for(var o=0;o<t;o++)for(r=0;r<t;r++){var l=a[o]-a[r];if(.5<=(l=0<=l?3*l:1.5*l)&&l<=2.5){var f=l-.5;f=8*(f*f-2*f)}else f=0;l=(f=(l=15.811389+7.5*(l+=.474)-17.5*Math.sqrt(1+l*l))<=-60?0:(l=Math.exp(.2302585093*(f+l)))/.6609193)*s[r],_[o][r]=l*n[o]}else for(r=0;r<t;r++){var h,c;o=f=15+Math.min(21/a[r],12);for(h=0;1e-20<m(h,o);--h);var b=h;for(c=0;1e-12<Math.abs(c-b);)0<m(h=(c+b)/2,o)?c=h:b=h;for(l=b,h=0;1e-20<m(h,o);h+=1);for(b=0,c=h;1e-12<Math.abs(c-b);)0<m(h=(c+b)/2,o)?b=h:c=h;var u=0;for(b=0;b<=1e3;++b)u+=h=m(h=l+b*(c-l)/1e3,o);for(h=1001/(u*(c-l)),o=0;o<t;o++)l=h*m(a[o]-a[r],f)*s[r],_[o][r]=l*n[o]}for(o=0;o<t;o++){for(r=0;r<t&&!(0<_[o][r]);r++);for(e[o][0]=r,r=t-1;0<r&&!(0<_[o][r]);r--);e[o][1]=r,i+=e[o][1]-e[o][0]+1}for(a=ta(i),o=s=0;o<t;o++)for(r=e[o][0];r<=e[o][1];r++)a[s++]=_[o][r];return a}function g(e){return e=S(e),e=Math.min(e,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*e))-2.5)}function a(e,t){return e<-.3&&(e=3410),e=Math.max(.1,e/1e3),3.64*Math.pow(e,-.8)-6.8*Math.exp(-.6*Math.pow(e-3.4,2))+6*Math.exp(-.15*Math.pow(e-8.7,2))+.001*(.6+.04*t)*Math.pow(e,4)}var v,R,M,Wt=new h,n=1/217621504/(ra.BLKSIZE/2),Jt=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749],i=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],o=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],l=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276],r=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],f=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130],_=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1],bt=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];this.L3psycho_anal_ns=function(e,t,a,s,n,r,_,i,o,l){var f,h,c,b,u,m,p,d,g=e.internal_flags,v=aa([2,ra.BLKSIZE]),S=aa([2,3,ra.BLKSIZE_s]),R=ta(ra.CBANDS+1),M=ta(ra.CBANDS+1),A=ta(ra.CBANDS+2),B=ea(2),w=ea(2),T=aa([2,576]),E=ea(ra.CBANDS+2),k=ea(ra.CBANDS+2);mt.fill(k,0);var y=g.channels_out;e.mode==na.JOINT_STEREO&&(y=4);var x=e.VBR==ut.vbr_off?0==g.ResvMax?0:g.ResvSize/g.ResvMax*.5:e.VBR==ut.vbr_rh||e.VBR==ut.vbr_mtrh||e.VBR==ut.vbr_mt?.6:1;for(h=0;h<g.channels_out;h++){var P=t[h],I=a+576-350-21+192;for(b=0;b<576;b++){var H,V=P[I+b+10];for(u=H=0;u<9;u+=2)V+=bt[u]*(P[I+b+u]+P[I+b+21-u]),H+=bt[u+1]*(P[I+b+u+1]+P[I+b+21-u-1]);T[h][b]=V+H}n[s][h].en.assign(g.en[h]),n[s][h].thm.assign(g.thm[h]),2<y&&(r[s][h].en.assign(g.en[h+2]),r[s][h].thm.assign(g.thm[h+2]))}for(h=0;h<y;h++){var O=ta(12),L=[0,0,0,0],N=ta(12),D=1,X=ta(ra.CBANDS),q=ta(ra.CBANDS),Y=[0,0,0,0],C=ta(ra.HBLKSIZE),F=aa([3,ra.HBLKSIZE_s]);for(b=0;b<3;b++)O[b]=g.nsPsy.last_en_subshort[h][b+6],N[b]=O[b]/g.nsPsy.last_en_subshort[h][b+4],L[0]+=O[b];if(2==h)for(b=0;b<576;b++){var j=T[0][b],G=T[1][b];T[0][b]=j+G,T[1][b]=j-G}var z=T[1&h],K=0;for(b=0;b<9;b++){var Z=K+64;for(f=1;K<Z;K++)f<Math.abs(z[K])&&(f=Math.abs(z[K]));g.nsPsy.last_en_subshort[h][b]=O[b+3]=f,L[1+b/3]+=f,f=f>O[b+3-2]?f/O[b+3-2]:O[b+3-2]>10*f?O[b+3-2]/(10*f):0,N[b+3]=f}if(e.analysis){var Q=N[0];for(b=1;b<12;b++)Q<N[b]&&(Q=N[b]);g.pinfo.ers[s][h]=g.pinfo.ers_save[h],g.pinfo.ers_save[h]=Q}var U=3==h?g.nsPsy.attackthre_s:g.nsPsy.attackthre;for(b=0;b<12;b++)0==Y[b/3]&&N[b]>U&&(Y[b/3]=b%3+1);for(b=1;b<4;b++)(L[b-1]>L[b]?L[b-1]/L[b]:L[b]/L[b-1])<1.7&&(Y[b]=0,1==b&&(Y[0]=0));0!=Y[0]&&0!=g.nsPsy.lastAttacks[h]&&(Y[0]=0),3!=g.nsPsy.lastAttacks[h]&&0==Y[0]+Y[1]+Y[2]+Y[3]||((D=0)!=Y[1]&&0!=Y[0]&&(Y[1]=0),0!=Y[2]&&0!=Y[1]&&(Y[2]=0),0!=Y[3]&&0!=Y[2]&&(Y[3]=0)),h<2?w[h]=D:0==D&&(w[0]=w[1]=0),o[h]=g.tot_ener[h];var W=void 0,J=void 0,$=void 0,ee=void 0,te=e,ae=C,se=F,ne=v,re=1&h,_e=S,ie=1&h,oe=s,le=h,fe=t,he=a,ce=te.internal_flags;if(le<2)Wt.fft_long(ce,ne[re],le,fe,he),Wt.fft_short(ce,_e[ie],le,fe,he);else if(2==le){for(var be=ra.BLKSIZE-1;0<=be;--be)W=ne[re+0][be],J=ne[re+1][be],ne[re+0][be]=(W+J)*_a.SQRT2*.5,ne[re+1][be]=(W-J)*_a.SQRT2*.5;for(var ue=2;0<=ue;--ue)for(be=ra.BLKSIZE_s-1;0<=be;--be)W=_e[ie+0][ue][be],J=_e[ie+1][ue][be],_e[ie+0][ue][be]=(W+J)*_a.SQRT2*.5,_e[ie+1][ue][be]=(W-J)*_a.SQRT2*.5}for(ae[0]=ne[re+0][0],ae[0]*=ae[0],be=ra.BLKSIZE/2-1;0<=be;--be)$=ne[re+0][ra.BLKSIZE/2-be],ee=ne[re+0][ra.BLKSIZE/2+be],ae[ra.BLKSIZE/2-be]=.5*($*$+ee*ee);for(ue=2;0<=ue;--ue)for(se[ue][0]=_e[ie+0][ue][0],se[ue][0]*=se[ue][0],be=ra.BLKSIZE_s/2-1;0<=be;--be)$=_e[ie+0][ue][ra.BLKSIZE_s/2-be],ee=_e[ie+0][ue][ra.BLKSIZE_s/2+be],se[ue][ra.BLKSIZE_s/2-be]=.5*($*$+ee*ee);var me=0;for(be=11;be<ra.HBLKSIZE;be++)me+=ae[be];if(ce.tot_ener[le]=me,te.analysis){for(be=0;be<ra.HBLKSIZE;be++)ce.pinfo.energy[oe][le][be]=ce.pinfo.energy_save[le][be],ce.pinfo.energy_save[le][be]=ae[be];ce.pinfo.pe[oe][le]=ce.pe[le]}for(2==te.athaa_loudapprox&&le<2&&(ce.loudness_sq[oe][le]=ce.loudness_sq_save[le],ce.loudness_sq_save[le]=Yt(ae,ce)),Zt(g,C,R,X,q),Qt(g,X,q,E),d=0;d<3;d++){var pe,de,ge=void 0,ve=void 0,Se=void 0,Re=F,Me=M,Ae=A,Be=h,we=d,Te=e.internal_flags;for(ge=ve=0;ge<Te.npart_s;++ge){for(var Ee=0,ke=0,ye=Te.numlines_s[ge],xe=0;xe<ye;++xe,++ve){var Pe=Re[we][ve];Ee=Ee+Pe;ke<Pe&&(ke=Pe)}Me[ge]=Ee}for(ve=ge=0;ge<Te.npart_s;ge++){var Ie=Te.s3ind_s[ge][0],He=Te.s3_ss[ve++]*Me[Ie];for(++Ie;Ie<=Te.s3ind_s[ge][1];)He+=Te.s3_ss[ve]*Me[Ie],++ve,++Ie;Se=2*Te.nb_s1[Be][ge],Ae[ge]=Math.min(He,Se),Te.blocktype_old[1&Be]==ra.SHORT_TYPE&&(Se=16*Te.nb_s2[Be][ge],Ae[ge]=Math.min(Se,Ae[ge])),Te.nb_s2[Be][ge]=Te.nb_s1[Be][ge],Te.nb_s1[Be][ge]=He}for(;ge<=ra.CBANDS;++ge)Me[ge]=0,Ae[ge]=0;for(Ft(g,M,A,h,d),p=0;p<ra.SBMAX_s;p++){if(de=g.thm[h].s[p][d],de*=.8,2<=Y[d]||1==Y[d+1]){var Ve=0!=d?d-1:2;f=Gt(g.thm[h].s[p][Ve],de,.6*x),de=Math.min(de,f)}1==Y[d]?(Ve=0!=d?d-1:2,f=Gt(g.thm[h].s[p][Ve],de,.3*x),de=Math.min(de,f)):(0!=d&&3==Y[d-1]||0==d&&3==g.nsPsy.lastAttacks[h])&&(Ve=2!=d?d+1:0,f=Gt(g.thm[h].s[p][Ve],de,.3*x),de=Math.min(de,f)),pe=O[3*d+3]+O[3*d+4]+O[3*d+5],6*O[3*d+5]<pe&&(de*=.5,6*O[3*d+4]<pe&&(de*=.5)),g.thm[h].s[p][d]=de}}for(g.nsPsy.lastAttacks[h]=Y[2],c=m=0;c<g.npart_l;c++){for(var Oe=g.s3ind[c][0],Le=R[Oe]*Jt[E[Oe]],Ne=g.s3_ll[m++]*Le;++Oe<=g.s3ind[c][1];)Le=R[Oe]*Jt[E[Oe]],Ne=ct(Ne,g.s3_ll[m++]*Le,Oe,Oe-c,g,0);Ne*=.158489319246111,A[c]=g.blocktype_old[1&h]==ra.SHORT_TYPE?Ne:Gt(Math.min(Ne,Math.min(2*g.nb_1[h][c],16*g.nb_2[h][c])),Ne,x),g.nb_2[h][c]=g.nb_1[h][c],g.nb_1[h][c]=Ne}for(;c<=ra.CBANDS;++c)R[c]=0,A[c]=0;jt(g,R,A,h)}if((e.mode==na.STEREO||e.mode==na.JOINT_STEREO)&&0<e.interChRatio){var De=e.interChRatio,Xe=e.internal_flags;if(1<Xe.channels_out){for(var qe=0;qe<ra.SBMAX_l;qe++){var Ye=Xe.thm[0].l[qe],Ce=Xe.thm[1].l[qe];Xe.thm[0].l[qe]+=Ce*De,Xe.thm[1].l[qe]+=Ye*De}for(qe=0;qe<ra.SBMAX_s;qe++)for(var Fe=0;Fe<3;Fe++)Ye=Xe.thm[0].s[qe][Fe],Ce=Xe.thm[1].s[qe][Fe],Xe.thm[0].s[qe][Fe]+=Ce*De,Xe.thm[1].s[qe][Fe]+=Ye*De}}if(e.mode==na.JOINT_STEREO){for(var je,Ge,ze,Ke,Ze=0;Ze<ra.SBMAX_l;Ze++)g.thm[0].l[Ze]>1.58*g.thm[1].l[Ze]||g.thm[1].l[Ze]>1.58*g.thm[0].l[Ze]||(Ke=g.mld_l[Ze]*g.en[3].l[Ze],ze=Math.max(g.thm[2].l[Ze],Math.min(g.thm[3].l[Ze],Ke)),Ke=g.mld_l[Ze]*g.en[2].l[Ze],Ge=Math.max(g.thm[3].l[Ze],Math.min(g.thm[2].l[Ze],Ke)),g.thm[2].l[Ze]=ze,g.thm[3].l[Ze]=Ge);for(Ze=0;Ze<ra.SBMAX_s;Ze++)for(var Qe=0;Qe<3;Qe++)g.thm[0].s[Ze][Qe]>1.58*g.thm[1].s[Ze][Qe]||g.thm[1].s[Ze][Qe]>1.58*g.thm[0].s[Ze][Qe]||(Ke=g.mld_s[Ze]*g.en[3].s[Ze][Qe],ze=Math.max(g.thm[2].s[Ze][Qe],Math.min(g.thm[3].s[Ze][Qe],Ke)),Ke=g.mld_s[Ze]*g.en[2].s[Ze][Qe],Ge=Math.max(g.thm[3].s[Ze][Qe],Math.min(g.thm[2].s[Ze][Qe],Ke)),g.thm[2].s[Ze][Qe]=ze,g.thm[3].s[Ze][Qe]=Ge);if(je=e.msfix,0<Math.abs(je)){for(var Ue,We,Je,$e,et,tt=st=je,at=Math.pow(10,e.ATHlower*g.ATH.adjust),st=2*st,nt=(tt=2*tt,0);nt<ra.SBMAX_l;nt++)We=g.ATH.cb_l[g.bm_l[nt]]*at,(et=Math.min(Math.max(g.thm[0].l[nt],We),Math.max(g.thm[1].l[nt],We)))*st<($e=Math.max(g.thm[2].l[nt],We))+(Je=Math.max(g.thm[3].l[nt],We))&&($e*=Ue=et*tt/($e+Je),Je*=Ue),g.thm[2].l[nt]=Math.min($e,g.thm[2].l[nt]),g.thm[3].l[nt]=Math.min(Je,g.thm[3].l[nt]);for(at*=ra.BLKSIZE_s/ra.BLKSIZE,nt=0;nt<ra.SBMAX_s;nt++)for(var rt=0;rt<3;rt++)We=g.ATH.cb_s[g.bm_s[nt]]*at,(et=Math.min(Math.max(g.thm[0].s[nt][rt],We),Math.max(g.thm[1].s[nt][rt],We)))*st<($e=Math.max(g.thm[2].s[nt][rt],We))+(Je=Math.max(g.thm[3].s[nt][rt],We))&&($e*=Ue=et*st/($e+Je),Je*=Ue),g.thm[2].s[nt][rt]=Math.min(g.thm[2].s[nt][rt],$e),g.thm[3].s[nt][rt]=Math.min(g.thm[3].s[nt][rt],Je)}}var _t=e.internal_flags;e.short_blocks!=sa.short_block_coupled||0!=w[0]&&0!=w[1]||(w[0]=w[1]=0);for(var it=0;it<_t.channels_out;it++)B[it]=ra.NORM_TYPE,e.short_blocks==sa.short_block_dispensed&&(w[it]=1),e.short_blocks==sa.short_block_forced&&(w[it]=0),0!=w[it]?_t.blocktype_old[it]==ra.SHORT_TYPE&&(B[it]=ra.STOP_TYPE):(B[it]=ra.SHORT_TYPE,_t.blocktype_old[it]==ra.NORM_TYPE&&(_t.blocktype_old[it]=ra.START_TYPE),_t.blocktype_old[it]==ra.STOP_TYPE&&(_t.blocktype_old[it]=ra.SHORT_TYPE)),l[it]=_t.blocktype_old[it],_t.blocktype_old[it]=B[it];for(h=0;h<y;h++){var ot=0;if(1<h){var lt=i;ot=-2;var ft=ra.NORM_TYPE;l[0]!=ra.SHORT_TYPE&&l[1]!=ra.SHORT_TYPE||(ft=ra.SHORT_TYPE);var ht=r[s][h-2]}else lt=_,ot=0,ft=l[h],ht=n[s][h];lt[ot+h]=ft==ra.SHORT_TYPE?zt(ht,g.masking_lower):Kt(ht,g.masking_lower),e.analysis&&(g.pinfo.pe[s][h]=lt[ot+h])}return 0};var $t=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];this.L3psycho_anal_vbr=function(e,t,a,s,n,r,_,i,o,l){for(var f,h,c,b=e.internal_flags,u=ta(ra.HBLKSIZE),m=aa([3,ra.HBLKSIZE_s]),p=aa([2,ra.BLKSIZE]),d=aa([2,3,ra.BLKSIZE_s]),g=aa([4,ra.CBANDS]),v=aa([4,ra.CBANDS]),S=aa([4,3]),R=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],M=ea(2),A=e.mode==na.JOINT_STEREO?4:b.channels_out,B=aa([2,576]),w=e.internal_flags,T=w.channels_out,E=e.mode==na.JOINT_STEREO?4:T,k=0;k<T;k++){firbuf=t[k];for(var y=a+576-350-21+192,x=0;x<576;x++){for(var P,I=firbuf[y+x+10],H=P=0;H<9;H+=2)I+=$t[H]*(firbuf[y+x+H]+firbuf[y+x+21-H]),P+=$t[H+1]*(firbuf[y+x+H+1]+firbuf[y+x+21-H-1]);B[k][x]=I+P}n[s][k].en.assign(w.en[k]),n[s][k].thm.assign(w.thm[k]),2<E&&(r[s][k].en.assign(w.en[k+2]),r[s][k].thm.assign(w.thm[k+2]))}for(k=0;k<E;k++){var V=ta(12),O=ta(12),L=[0,0,0,0],N=B[1&k],D=0,X=3==k?w.nsPsy.attackthre_s:w.nsPsy.attackthre,q=1;if(2==k)for(x=0,H=576;0<H;++x,--H){var Y=B[0][x],C=B[1][x];B[0][x]=Y+C,B[1][x]=Y-C}for(x=0;x<3;x++)O[x]=w.nsPsy.last_en_subshort[k][x+6],V[x]=O[x]/w.nsPsy.last_en_subshort[k][x+4],L[0]+=O[x];for(x=0;x<9;x++){for(var F=D+64,j=1;D<F;D++)j<Math.abs(N[D])&&(j=Math.abs(N[D]));w.nsPsy.last_en_subshort[k][x]=O[x+3]=j,L[1+x/3]+=j,j=j>O[x+3-2]?j/O[x+3-2]:O[x+3-2]>10*j?O[x+3-2]/(10*j):0,V[x+3]=j}for(x=0;x<3;++x){var G=O[3*x+3]+O[3*x+4]+O[3*x+5],z=1;6*O[3*x+5]<G&&(z*=.5,6*O[3*x+4]<G&&(z*=.5)),S[k][x]=z}if(e.analysis){var K=V[0];for(x=1;x<12;x++)K<V[x]&&(K=V[x]);w.pinfo.ers[s][k]=w.pinfo.ers_save[k],w.pinfo.ers_save[k]=K}for(x=0;x<12;x++)0==R[k][x/3]&&V[x]>X&&(R[k][x/3]=x%3+1);for(x=1;x<4;x++){var Z=L[x-1],Q=L[x];Math.max(Z,Q)<4e4&&Z<1.7*Q&&Q<1.7*Z&&(1==x&&R[k][0]<=R[k][x]&&(R[k][0]=0),R[k][x]=0)}R[k][0]<=w.nsPsy.lastAttacks[k]&&(R[k][0]=0),3!=w.nsPsy.lastAttacks[k]&&0==R[k][0]+R[k][1]+R[k][2]+R[k][3]||((q=0)!=R[k][1]&&0!=R[k][0]&&(R[k][1]=0),0!=R[k][2]&&0!=R[k][1]&&(R[k][2]=0),0!=R[k][3]&&0!=R[k][2]&&(R[k][3]=0)),k<2?M[k]=q:0==q&&(M[0]=M[1]=0),o[k]=w.tot_ener[k]}var U=e.internal_flags;e.short_blocks!=sa.short_block_coupled||0!=M[0]&&0!=M[1]||(M[0]=M[1]=0);for(var W=0;W<U.channels_out;W++)e.short_blocks==sa.short_block_dispensed&&(M[W]=1),e.short_blocks==sa.short_block_forced&&(M[W]=0);for(var J=0;J<A;J++){var $=e,ee=J,te=s,ae=u,se=p,ne=c=1&J,re=$.internal_flags;if(ee<2)Wt.fft_long(re,se[ne],ee,t,a);else if(2==ee)for(var _e=ra.BLKSIZE-1;0<=_e;--_e){var ie=se[ne+0][_e],oe=se[ne+1][_e];se[ne+0][_e]=(ie+oe)*_a.SQRT2*.5,se[ne+1][_e]=(ie-oe)*_a.SQRT2*.5}for(ae[0]=se[ne+0][0],ae[0]*=ae[0],_e=ra.BLKSIZE/2-1;0<=_e;--_e){var le=se[ne+0][ra.BLKSIZE/2-_e],fe=se[ne+0][ra.BLKSIZE/2+_e];ae[ra.BLKSIZE/2-_e]=.5*(le*le+fe*fe)}var he=0;for(_e=11;_e<ra.HBLKSIZE;_e++)he+=ae[_e];if(re.tot_ener[ee]=he,$.analysis){for(_e=0;_e<ra.HBLKSIZE;_e++)re.pinfo.energy[te][ee][_e]=re.pinfo.energy_save[ee][_e],re.pinfo.energy_save[ee][_e]=ae[_e];re.pinfo.pe[te][ee]=re.pe[ee]}var ce=J,be=u,ue=e.internal_flags;if(2==e.athaa_loudapprox&&ce<2&&(ue.loudness_sq[s][ce]=ue.loudness_sq_save[ce],ue.loudness_sq_save[ce]=Yt(be,ue)),0!=M[c]){var me=void 0,pe=void 0,de=b,ge=u,ve=g[J],Se=v[J],Re=J,Me=ta(ra.CBANDS),Ae=ta(ra.CBANDS),Be=ea(ra.CBANDS+2);Zt(de,ge,ve,Me,Ae),Qt(de,Me,Ae,Be);var we=0;for(me=0;me<de.npart_l;me++){var Te=de.s3ind[me][0],Ee=de.s3ind[me][1],ke=0,ye=0,xe=(ke=Be[Te],ye=ye+1,de.s3_ll[we]*ve[Te]*Jt[Be[Te]]);for(++we,++Te;Te<=Ee;){ke+=Be[Te],ye+=1;var Pe=de.s3_ll[we]*ve[Te]*Jt[Be[Te]];xe=Ct(xe,Pe,Te-me),++we,++Te}var Ie=.5*Jt[ke=(1+2*ke)/(2*ye)];if(xe*=Ie,de.blocktype_old[1&Re]==ra.SHORT_TYPE)pe=2*de.nb_1[Re][me],Se[me]=0<pe?Math.min(xe,pe):Math.min(xe,.3*ve[me]);else{var He=16*de.nb_2[Re][me],Ve=2*de.nb_1[Re][me];He<=0&&(He=xe),Ve<=0&&(Ve=xe),pe=de.blocktype_old[1&Re]==ra.NORM_TYPE?Math.min(Ve,He):Ve,Se[me]=Math.min(xe,pe)}de.nb_2[Re][me]=de.nb_1[Re][me],de.nb_1[Re][me]=xe,Pe=Me[me],Pe*=de.minval_l[me],Pe*=Ie,Se[me]>Pe&&(Se[me]=Pe),1<de.masking_lower&&(Se[me]*=de.masking_lower),Se[me]>ve[me]&&(Se[me]=ve[me]),de.masking_lower<1&&(Se[me]*=de.masking_lower)}for(;me<ra.CBANDS;++me)ve[me]=0,Se[me]=0}else for(var Oe=b,Le=J,Ne=0;Ne<Oe.npart_l;Ne++)Oe.nb_2[Le][Ne]=Oe.nb_1[Le][Ne],Oe.nb_1[Le][Ne]=0}for(2==M[0]+M[1]&&e.mode==na.JOINT_STEREO&&Ut(g,v,b.mld_cb_l,b.ATH.cb_l,e.ATHlower*b.ATH.adjust,e.msfix,b.npart_l),J=0;J<A;J++)0!=M[c=1&J]&&jt(b,g[J],v[J],J);for(var De=0;De<3;De++){for(J=0;J<A;++J)if(0!=M[c=1&J]){var Xe=b,qe=J;if(0==De)for(var Ye=0;Ye<Xe.npart_s;Ye++)Xe.nb_s2[qe][Ye]=Xe.nb_s1[qe][Ye],Xe.nb_s1[qe][Ye]=0}else{var Ce=J,Fe=De,je=m,Ge=d,ze=c,Ke=e.internal_flags;if(0==Fe&&Ce<2&&Wt.fft_short(Ke,Ge[ze],Ce,t,a),2==Ce)for(var Ze=ra.BLKSIZE_s-1;0<=Ze;--Ze){var Qe=Ge[ze+0][Fe][Ze],Ue=Ge[ze+1][Fe][Ze];Ge[ze+0][Fe][Ze]=(Qe+Ue)*_a.SQRT2*.5,Ge[ze+1][Fe][Ze]=(Qe-Ue)*_a.SQRT2*.5}for(je[Fe][0]=Ge[ze+0][Fe][0],je[Fe][0]*=je[Fe][0],Ze=ra.BLKSIZE_s/2-1;0<=Ze;--Ze){var We=Ge[ze+0][Fe][ra.BLKSIZE_s/2-Ze],Je=Ge[ze+0][Fe][ra.BLKSIZE_s/2+Ze];je[Fe][ra.BLKSIZE_s/2-Ze]=.5*(We*We+Je*Je)}var $e=void 0,et=void 0,tt=void 0,at=m,st=g[J],nt=v[J],rt=J,_t=De,it=e.internal_flags,ot=new float[ra.CBANDS],lt=ta(ra.CBANDS),ft=new int[ra.CBANDS];for($e=et=0;$e<it.npart_s;++$e){var ht=0,ct=0,bt=it.numlines_s[$e];for(tt=0;tt<bt;++tt,++et){var ut=at[_t][et];ht=ht+ut;ct<ut&&(ct=ut)}st[$e]=ht,ot[$e]=ct,lt[$e]=ht/bt}for(;$e<ra.CBANDS;++$e)ot[$e]=0,lt[$e]=0;var mt=void 0,pt=void 0,dt=it,gt=ot,vt=lt,St=ft,Rt=Jt.length-1,Mt=0,At=vt[Mt]+vt[Mt+1];for(St[Mt]=0<At?((mt=gt[Mt])<gt[Mt+1]&&(mt=gt[Mt+1]),Rt<(pt=0|(At=20*(2*mt-At)/(At*(dt.numlines_s[Mt]+dt.numlines_s[Mt+1]-1))))&&(pt=Rt),pt):0,Mt=1;Mt<dt.npart_s-1;Mt++)At=vt[Mt-1]+vt[Mt]+vt[Mt+1],St[Mt]=0<At?((mt=gt[Mt-1])<gt[Mt]&&(mt=gt[Mt]),mt<gt[Mt+1]&&(mt=gt[Mt+1]),Rt<(pt=0|(At=20*(3*mt-At)/(At*(dt.numlines_s[Mt-1]+dt.numlines_s[Mt]+dt.numlines_s[Mt+1]-1))))&&(pt=Rt),pt):0;for(At=vt[Mt-1]+vt[Mt],St[Mt]=0<At?((mt=gt[Mt-1])<gt[Mt]&&(mt=gt[Mt]),Rt<(pt=0|(At=20*(2*mt-At)/(At*(dt.numlines_s[Mt-1]+dt.numlines_s[Mt]-1))))&&(pt=Rt),pt):0,et=$e=0;$e<it.npart_s;$e++){var Bt=it.s3ind_s[$e][0],wt=it.s3ind_s[$e][1],Tt=ft[Bt],Et=1,kt=it.s3_ss[et]*st[Bt]*Jt[ft[Bt]];for(++et,++Bt;Bt<=wt;){Tt+=ft[Bt],Et+=1;var yt=it.s3_ss[et]*st[Bt]*Jt[ft[Bt]];kt=Ct(kt,yt,Bt-$e),++et,++Bt}var xt=.5*Jt[Tt=(1+2*Tt)/(2*Et)];kt*=xt,nt[$e]=kt,it.nb_s2[rt][$e]=it.nb_s1[rt][$e],it.nb_s1[rt][$e]=kt,yt=ot[$e],yt*=it.minval_s[$e],yt*=xt,nt[$e]>yt&&(nt[$e]=yt),1<it.masking_lower&&(nt[$e]*=it.masking_lower),nt[$e]>st[$e]&&(nt[$e]=st[$e]),it.masking_lower<1&&(nt[$e]*=it.masking_lower)}for(;$e<ra.CBANDS;++$e)st[$e]=0,nt[$e]=0}for(0==M[0]+M[1]&&e.mode==na.JOINT_STEREO&&Ut(g,v,b.mld_cb_s,b.ATH.cb_s,e.ATHlower*b.ATH.adjust,e.msfix,b.npart_s),J=0;J<A;++J)0==M[c=1&J]&&Ft(b,g[J],v[J],J,De)}for(J=0;J<A;J++)if(0==M[c=1&J])for(var Pt=0;Pt<ra.SBMAX_s;Pt++){var It=ta(3);for(De=0;De<3;De++){var Ht=.8*(Ht=b.thm[J].s[Pt][De]);2<=R[J][De]||1==R[J][De+1]?(h=0!=De?De-1:2,f=Gt(b.thm[J].s[Pt][h],Ht,.36),Ht=Math.min(Ht,f)):1==R[J][De]?(h=0!=De?De-1:2,f=Gt(b.thm[J].s[Pt][h],Ht,.18),Ht=Math.min(Ht,f)):(0!=De&&3==R[J][De-1]||0==De&&3==b.nsPsy.lastAttacks[J])&&(h=2!=De?De+1:0,f=Gt(b.thm[J].s[Pt][h],Ht,.18),Ht=Math.min(Ht,f)),Ht*=S[J][De],It[De]=Ht}for(De=0;De<3;De++)b.thm[J].s[Pt][De]=It[De]}for(J=0;J<A;J++)b.nsPsy.lastAttacks[J]=R[J][2];for(var Vt=e.internal_flags,Ot=0;Ot<Vt.channels_out;Ot++){var Lt=ra.NORM_TYPE;0!=M[Ot]?Vt.blocktype_old[Ot]==ra.SHORT_TYPE&&(Lt=ra.STOP_TYPE):(Lt=ra.SHORT_TYPE,Vt.blocktype_old[Ot]==ra.NORM_TYPE&&(Vt.blocktype_old[Ot]=ra.START_TYPE),Vt.blocktype_old[Ot]==ra.STOP_TYPE&&(Vt.blocktype_old[Ot]=ra.SHORT_TYPE)),l[Ot]=Vt.blocktype_old[Ot],Vt.blocktype_old[Ot]=Lt}for(J=0;J<A;J++){if(1<J){var Nt=i,Dt=-2,Xt=ra.NORM_TYPE;l[0]!=ra.SHORT_TYPE&&l[1]!=ra.SHORT_TYPE||(Xt=ra.SHORT_TYPE);var qt=r[s][J-2]}else Nt=_,Dt=0,Xt=l[J],qt=n[s][J];Nt[Dt+J]=Xt==ra.SHORT_TYPE?zt(qt,b.masking_lower):Kt(qt,b.masking_lower),e.analysis&&(b.pinfo.pe[s][J]=Nt[Dt+J])}return 0},this.psymodel_init=function(e){var t,a,s,n=e.internal_flags,r=!0,_=13,i=t=0,o=-8.25,l=-4.5,f=ta(ra.CBANDS),h=ta(ra.CBANDS),c=ta(ra.CBANDS),b=e.out_samplerate;switch(e.experimentalZ){default:case 0:r=!0;break;case 1:r=e.VBR!=ut.vbr_mtrh&&e.VBR!=ut.vbr_mt;break;case 2:r=!1;break;case 3:_=8,t=-1.75,i=-.0125,o=-8.25,l=-2.25}for(n.ms_ener_ratio_old=.25,n.blocktype_old[0]=n.blocktype_old[1]=ra.NORM_TYPE,s=0;s<4;++s){for(var u=0;u<ra.CBANDS;++u)n.nb_1[s][u]=1e20,n.nb_2[s][u]=1e20,n.nb_s1[s][u]=n.nb_s2[s][u]=1;for(a=0;a<ra.SBMAX_l;a++)n.en[s].l[a]=1e20,n.thm[s].l[a]=1e20;for(u=0;u<3;++u){for(a=0;a<ra.SBMAX_s;a++)n.en[s].s[a][u]=1e20,n.thm[s].s[a][u]=1e20;n.nsPsy.lastAttacks[s]=0}for(u=0;u<9;u++)n.nsPsy.last_en_subshort[s][u]=10}for(n.loudness_sq_save[0]=n.loudness_sq_save[1]=0,n.npart_l=p(n.numlines_l,n.bo_l,n.bm_l,f,h,n.mld_l,n.PSY.bo_l_weight,b,ra.BLKSIZE,n.scalefac_band.l,ra.BLKSIZE/1152,ra.SBMAX_l),s=0;s<n.npart_l;s++)a=t,f[s]>=_&&(a=i*(f[s]-_)/(24-_)+t*(24-f[s])/(24-_)),c[s]=Math.pow(10,a/10),n.rnumlines_l[s]=0<n.numlines_l[s]?1/n.numlines_l[s]:0;for(n.s3_ll=d(n.s3ind,n.npart_l,f,h,c,r),s=u=0;s<n.npart_l;s++){for(i=j.MAX_VALUE,a=0;a<n.numlines_l[s];a++,u++)t=b*u/(1e3*ra.BLKSIZE),t=this.ATHformula(1e3*t,e)-20,t=Math.pow(10,.1*t),(t*=n.numlines_l[s])<i&&(i=t);n.ATH.cb_l[s]=i,6<(i=20*f[s]/10-20)&&(i=100),i<-15&&(i=-15),i-=8,n.minval_l[s]=Math.pow(10,i/10)*n.numlines_l[s]}for(n.npart_s=p(n.numlines_s,n.bo_s,n.bm_s,f,h,n.mld_s,n.PSY.bo_s_weight,b,ra.BLKSIZE_s,n.scalefac_band.s,ra.BLKSIZE_s/384,ra.SBMAX_s),s=u=0;s<n.npart_s;s++){for(a=o,f[s]>=_&&(a=l*(f[s]-_)/(24-_)+o*(24-f[s])/(24-_)),c[s]=Math.pow(10,a/10),i=j.MAX_VALUE,a=0;a<n.numlines_s[s];a++,u++)t=b*u/(1e3*ra.BLKSIZE_s),t=this.ATHformula(1e3*t,e)-20,t=Math.pow(10,.1*t),(t*=n.numlines_s[s])<i&&(i=t);n.ATH.cb_s[s]=i,i=7*f[s]/12-7,12<f[s]&&(i*=1+3.1*Math.log(1+i)),f[s]<12&&(i*=1+2.3*Math.log(1-i)),i<-15&&(i=-15),i-=8,n.minval_s[s]=Math.pow(10,i/10)*n.numlines_s[s]}for(n.s3_ss=d(n.s3ind_s,n.npart_s,f,h,c,r),v=Math.pow(10,.5625),R=Math.pow(10,1.5),M=Math.pow(10,1.5),Wt.init_fft(n),n.decay=Math.exp(-2.302585092994046/(.01*b/192)),s=3.5,0!=(2&e.exp_nspsytune)&&(s=1),0<Math.abs(e.msfix)&&(s=e.msfix),e.msfix=s,r=0;r<n.npart_l;r++)n.s3ind[r][1]>n.npart_l-1&&(n.s3ind[r][1]=n.npart_l-1);if(n.ATH.decay=Math.pow(10,576*n.mode_gr/b*-1.2),n.ATH.adjust=.01,-(n.ATH.adjustLimit=1)!=e.ATHtype){for(u=e.out_samplerate/ra.BLKSIZE,s=t=r=0;s<ra.BLKSIZE/2;++s)t+=u,n.ATH.eql_w[s]=1/Math.pow(10,this.ATHformula(t,e)/10),r+=n.ATH.eql_w[s];for(r=1/r,s=ra.BLKSIZE/2;0<=--s;)n.ATH.eql_w[s]*=r}for(r=u=0;r<n.npart_s;++r)for(s=0;s<n.numlines_s[r];++s)++u;for(r=u=0;r<n.npart_l;++r)for(s=0;s<n.numlines_l[r];++s)++u;for(s=u=0;s<n.npart_l;s++)t=b*(u+n.numlines_l[s]/2)/(1*ra.BLKSIZE),n.mld_cb_l[s]=g(t),u+=n.numlines_l[s];for(;s<ra.CBANDS;++s)n.mld_cb_l[s]=1;for(s=u=0;s<n.npart_s;s++)t=b*(u+n.numlines_s[s]/2)/(1*ra.BLKSIZE_s),n.mld_cb_s[s]=g(t),u+=n.numlines_s[s];for(;s<ra.CBANDS;++s)n.mld_cb_s[s]=1;return 0},this.ATHformula=function(e,t){switch(t.ATHtype){case 0:e=a(e,9);break;case 1:e=a(e,-1);break;case 2:e=a(e,0);break;case 3:e=a(e,1)+6;break;case 4:e=a(e,t.ATHcurve);break;default:e=a(e,0)}return e}}function X(){function o(){this.mask_adjust_short=this.mask_adjust=0,this.bo_l_weight=ta(ra.SBMAX_l),this.bo_s_weight=ta(ra.SBMAX_s)}function l(){this.lowerlimit=0}function s(e,t){this.lowpass=t}function f(e){return 1<e?0:e<=0?1:Math.cos(Math.PI/2*e)}function h(e,t){switch(e){case 44100:return t.version=1,0;case 48e3:return t.version=1;case 32e3:return t.version=1,2;case 22050:return t.version=0;case 24e3:return t.version=0,1;case 16e3:return t.version=0,2;case 11025:return t.version=0;case 12e3:return t.version=0,1;case 8e3:return t.version=0,2;default:return t.version=0,-1}}function c(e,t,a){a<16e3&&(t=2),a=te.bitrate_table[t][1];for(var s=2;s<=14;s++)0<te.bitrate_table[t][s]&&Math.abs(te.bitrate_table[t][s]-e)<Math.abs(a-e)&&(a=te.bitrate_table[t][s]);return a}function b(e,t,a){for(a<16e3&&(t=2),a=0;a<=14;a++)if(0<te.bitrate_table[t][a]&&te.bitrate_table[t][a]==e)return a;return-1}function u(e,t){var a=[new s(8,2e3),new s(16,3700),new s(24,3900),new s(32,5500),new s(40,7e3),new s(48,7500),new s(56,1e4),new s(64,11e3),new s(80,13500),new s(96,15100),new s(112,15600),new s(128,17e3),new s(160,17500),new s(192,18600),new s(224,19400),new s(256,19700),new s(320,20500)];t=Z.nearestBitrateFullIndex(t),e.lowerlimit=a[t].lowpass}function j(e){var t=ra.BLKSIZE+e.framesize-ra.FFTOFFSET;return Math.max(t,512+e.framesize-32)}function G(){this.n_out=this.n_in=0}function z(){this.num_used=0}function K(e,t){return 0!=t?K(t,e%t):e}var Z=this;X.V9=410,X.V8=420,X.V7=430,X.V6=440,X.V5=450,X.V4=460,X.V3=470,X.V2=480,X.V1=490,X.V0=500,X.R3MIX=1e3,X.STANDARD=1001,X.EXTREME=1002,X.INSANE=1003,X.STANDARD_FAST=1004,X.EXTREME_FAST=1005,X.MEDIUM=1006,X.MEDIUM_FAST=1007,X.LAME_MAXMP3BUFFER=147456;var Q,U,m,p,d,g,v,S,R=new D;this.enc=new ra,this.setModules=function(e,t,a,s,n,r,_,i,o){Q=e,U=t,m=a,p=s,d=n,g=r,v=i,S=o,this.enc.setModules(U,R,p,g)},this.lame_init=function(){var e=new a;e.class_id=4294479419;var t=e.internal_flags=new $;return e.mode=na.NOT_SET,e.original=1,e.in_samplerate=44100,e.num_channels=2,e.num_samples=-1,e.bWriteVbrTag=!0,e.quality=-1,e.short_blocks=null,t.subblock_gain=-1,e.lowpassfreq=0,e.highpassfreq=0,e.lowpasswidth=-1,e.highpasswidth=-1,e.VBR=ut.vbr_off,e.VBR_q=4,e.ATHcurve=-1,e.VBR_mean_bitrate_kbps=128,e.VBR_min_bitrate_kbps=0,e.VBR_max_bitrate_kbps=0,e.VBR_hard_min=0,t.VBR_min_bitrate=1,t.VBR_max_bitrate=13,e.quant_comp=-1,e.quant_comp_short=-1,e.msfix=-1,t.resample_ratio=1,t.OldValue[0]=180,t.OldValue[1]=180,t.CurrentStep[0]=4,t.CurrentStep[1]=4,t.masking_lower=1,t.nsPsy.attackthre=-1,t.nsPsy.attackthre_s=-1,e.scale=-1,e.athaa_type=-1,e.ATHtype=-1,e.athaa_loudapprox=-1,e.athaa_sensitivity=0,e.useTemporal=null,e.interChRatio=-1,t.mf_samples_to_encode=ra.ENCDELAY+ra.POSTDELAY,e.encoder_padding=0,t.mf_size=ra.ENCDELAY-ra.MDCTDELAY,e.findReplayGain=!1,e.decode_on_the_fly=!1,t.decode_on_the_fly=!1,t.findReplayGain=!1,t.findPeakSample=!1,t.RadioGain=0,t.AudiophileGain=0,t.noclipGainChange=0,t.noclipScale=-1,e.preset=0,e.write_id3tag_automatic=!0,e.lame_allocated_gfp=1,e},this.nearestBitrateFullIndex=function(e){for(var t=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],a=t[16],s=16,n=t[16],r=16,_=0;_<16;_++)if(Math.max(e,t[_+1])!=e){a=t[_+1],s=_+1,n=t[_],r=_;break}return e-n<a-e?r:s},this.lame_init_params=function(e){var t=e.internal_flags;if(t.Class_ID=0,null==t.ATH&&(t.ATH=new k),null==t.PSY&&(t.PSY=new o),null==t.rgdata&&(t.rgdata=new x),t.channels_in=e.num_channels,1==t.channels_in&&(e.mode=na.MONO),t.channels_out=e.mode==na.MONO?1:2,t.mode_ext=ra.MPG_MD_MS_LR,e.mode==na.MONO&&(e.force_ms=!1),e.VBR==ut.vbr_off&&128!=e.VBR_mean_bitrate_kbps&&0==e.brate&&(e.brate=e.VBR_mean_bitrate_kbps),e.VBR!=ut.vbr_off&&e.VBR!=ut.vbr_mtrh&&e.VBR!=ut.vbr_mt&&(e.free_format=!1),e.VBR==ut.vbr_off&&0==e.brate&&J.EQ(e.compression_ratio,0)&&(e.compression_ratio=11.025),e.VBR==ut.vbr_off&&0<e.compression_ratio&&(0==e.out_samplerate&&(e.out_samplerate=map2MP3Frequency(int(.97*e.in_samplerate))),e.brate=0|16*e.out_samplerate*t.channels_out/(1e3*e.compression_ratio),t.samplerate_index=h(e.out_samplerate,e),e.free_format||(e.brate=c(e.brate,e.version,e.out_samplerate))),0!=e.out_samplerate&&(e.out_samplerate<16e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,64)):e.out_samplerate<32e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,160)):(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,32),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320))),0==e.lowpassfreq){switch(e.VBR){case ut.vbr_off:var a=new l;u(a,e.brate),a=a.lowerlimit;break;case ut.vbr_abr:u(a=new l,e.VBR_mean_bitrate_kbps),a=a.lowerlimit;break;case ut.vbr_rh:var s=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(0<=e.VBR_q&&e.VBR_q<=9){a=s[e.VBR_q];var n=s[e.VBR_q+1];s=e.VBR_q_frac,a=linear_int(a,n,s)}else a=19500;break;default:s=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950],a=0<=e.VBR_q&&e.VBR_q<=9?(a=s[e.VBR_q],n=s[e.VBR_q+1],s=e.VBR_q_frac,linear_int(a,n,s)):19500}e.mode!=na.MONO||e.VBR!=ut.vbr_off&&e.VBR!=ut.vbr_abr||(a*=1.5),e.lowpassfreq=0|a}if(0==e.out_samplerate&&(2*e.lowpassfreq>e.in_samplerate&&(e.lowpassfreq=e.in_samplerate/2),a=0|e.lowpassfreq,n=44100,48e3<=(s=e.in_samplerate)?n=48e3:44100<=s?n=44100:32e3<=s?n=32e3:24e3<=s?n=24e3:22050<=s?n=22050:16e3<=s?n=16e3:12e3<=s?n=12e3:11025<=s?n=11025:8e3<=s&&(n=8e3),a=-1==a?n:(a<=15960&&(n=44100),a<=15250&&(n=32e3),a<=11220&&(n=24e3),a<=9970&&(n=22050),a<=7230&&(n=16e3),a<=5420&&(n=12e3),a<=4510&&(n=11025),a<=3970&&(n=8e3),s<n?44100<s?48e3:32e3<s?44100:24e3<s?32e3:22050<s?24e3:16e3<s?22050:12e3<s?16e3:11025<s?12e3:8e3<s?11025:8e3:n),e.out_samplerate=a),e.lowpassfreq=Math.min(20500,e.lowpassfreq),e.lowpassfreq=Math.min(e.out_samplerate/2,e.lowpassfreq),e.VBR==ut.vbr_off&&(e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.brate)),e.VBR==ut.vbr_abr&&(e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.VBR_mean_bitrate_kbps)),e.bWriteVbrTag||(e.findReplayGain=!1,e.decode_on_the_fly=!1,t.findPeakSample=!1),t.findReplayGain=e.findReplayGain,t.decode_on_the_fly=e.decode_on_the_fly,t.decode_on_the_fly&&(t.findPeakSample=!0),t.findReplayGain&&Q.InitGainAnalysis(t.rgdata,e.out_samplerate)==W.INIT_GAIN_ANALYSIS_ERROR)return e.internal_flags=null,-6;switch(t.decode_on_the_fly&&!e.decode_only&&(null!=t.hip&&S.hip_decode_exit(t.hip),t.hip=S.hip_decode_init()),t.mode_gr=e.out_samplerate<=24e3?1:2,e.framesize=576*t.mode_gr,e.encoder_delay=ra.ENCDELAY,t.resample_ratio=e.in_samplerate/e.out_samplerate,e.VBR){case ut.vbr_mt:case ut.vbr_rh:case ut.vbr_mtrh:e.compression_ratio=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5][e.VBR_q];break;case ut.vbr_abr:e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.VBR_mean_bitrate_kbps);break;default:e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.brate)}e.mode==na.NOT_SET&&(e.mode=na.JOINT_STEREO),0<e.highpassfreq?(t.highpass1=2*e.highpassfreq,t.highpass2=0<=e.highpasswidth?2*(e.highpassfreq+e.highpasswidth):2*e.highpassfreq,t.highpass1/=e.out_samplerate,t.highpass2/=e.out_samplerate):(t.highpass1=0,t.highpass2=0),0<e.lowpassfreq?(t.lowpass2=2*e.lowpassfreq,0<=e.lowpasswidth?(t.lowpass1=2*(e.lowpassfreq-e.lowpasswidth),t.lowpass1<0&&(t.lowpass1=0)):t.lowpass1=2*e.lowpassfreq,t.lowpass1/=e.out_samplerate,t.lowpass2/=e.out_samplerate):(t.lowpass1=0,t.lowpass2=0);var r=32,_=-1;if(0<(a=e.internal_flags).lowpass1){var i=999;for(s=0;s<=31;s++)(n=s/31)>=a.lowpass2&&(r=Math.min(r,s)),a.lowpass1<n&&n<a.lowpass2&&(i=Math.min(i,s));a.lowpass1=999==i?(r-.75)/31:(i-.75)/31,a.lowpass2=r/31}if(0<a.highpass2&&a.highpass2<.75/31*.9&&(a.highpass1=0,a.highpass2=0,ee.err.println("Warning: highpass filter disabled.  highpass frequency too small\n")),0<a.highpass2){for(r=-1,s=0;s<=31;s++)(n=s/31)<=a.highpass1&&(_=Math.max(_,s)),a.highpass1<n&&n<a.highpass2&&(r=Math.max(r,s));a.highpass1=_/31,a.highpass2=-1==r?(_+.75)/31:(r+.75)/31}for(s=0;s<32;s++)n=s/31,_=a.highpass2>a.highpass1?f((a.highpass2-n)/(a.highpass2-a.highpass1+1e-20)):1,n=a.lowpass2>a.lowpass1?f((n-a.lowpass1)/(a.lowpass2-a.lowpass1+1e-20)):1,a.amp_filter[s]=_*n;if(t.samplerate_index=h(e.out_samplerate,e),t.samplerate_index<0)return e.internal_flags=null,-1;if(e.VBR==ut.vbr_off){if(e.free_format)t.bitrate_index=0;else if(e.brate=c(e.brate,e.version,e.out_samplerate),t.bitrate_index=b(e.brate,e.version,e.out_samplerate),t.bitrate_index<=0)return e.internal_flags=null,-1}else t.bitrate_index=1;for(e.analysis&&(e.bWriteVbrTag=!1),null!=t.pinfo&&(e.bWriteVbrTag=!1),U.init_bit_stream_w(t),a=t.samplerate_index+3*e.version+6*(e.out_samplerate<16e3?1:0),s=0;s<ra.SBMAX_l+1;s++)t.scalefac_band.l[s]=p.sfBandIndex[a].l[s];for(s=0;s<ra.PSFB21+1;s++)n=(t.scalefac_band.l[22]-t.scalefac_band.l[21])/ra.PSFB21,n=t.scalefac_band.l[21]+s*n,t.scalefac_band.psfb21[s]=n;for(t.scalefac_band.psfb21[ra.PSFB21]=576,s=0;s<ra.SBMAX_s+1;s++)t.scalefac_band.s[s]=p.sfBandIndex[a].s[s];for(s=0;s<ra.PSFB12+1;s++)n=(t.scalefac_band.s[13]-t.scalefac_band.s[12])/ra.PSFB12,n=t.scalefac_band.s[12]+s*n,t.scalefac_band.psfb12[s]=n;for(t.scalefac_band.psfb12[ra.PSFB12]=192,t.sideinfo_len=1==e.version?1==t.channels_out?21:36:1==t.channels_out?13:21,e.error_protection&&(t.sideinfo_len+=2),a=e.internal_flags,e.frameNum=0,e.write_id3tag_automatic&&v.id3tag_write_v2(e),a.bitrate_stereoMode_Hist=M([16,5]),a.bitrate_blockType_Hist=M([16,6]),a.PeakSample=0,e.bWriteVbrTag&&g.InitVbrTag(e),t.Class_ID=4294479419,a=0;a<19;a++)t.nsPsy.pefirbuf[a]=700*t.mode_gr*t.channels_out;switch(-1==e.ATHtype&&(e.ATHtype=4),e.VBR){case ut.vbr_mt:e.VBR=ut.vbr_mtrh;case ut.vbr_mtrh:null==e.useTemporal&&(e.useTemporal=!1),m.apply_preset(e,500-10*e.VBR_q,0),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),e.quality<5&&(e.quality=0),5<e.quality&&(e.quality=5),t.PSY.mask_adjust=e.maskingadjust,t.PSY.mask_adjust_short=e.maskingadjust_short,t.sfb21_extra=!e.experimentalY&&44e3<e.out_samplerate,t.iteration_loop=new VBRNewIterationLoop(d);break;case ut.vbr_rh:m.apply_preset(e,500-10*e.VBR_q,0),t.PSY.mask_adjust=e.maskingadjust,t.PSY.mask_adjust_short=e.maskingadjust_short,t.sfb21_extra=!e.experimentalY&&44e3<e.out_samplerate,6<e.quality&&(e.quality=6),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),t.iteration_loop=new VBROldIterationLoop(d);break;default:t.sfb21_extra=!1,e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),(a=e.VBR)==ut.vbr_off&&(e.VBR_mean_bitrate_kbps=e.brate),m.apply_preset(e,e.VBR_mean_bitrate_kbps,0),e.VBR=a,t.PSY.mask_adjust=e.maskingadjust,t.PSY.mask_adjust_short=e.maskingadjust_short,t.iteration_loop=a==ut.vbr_off?new y(d):new ABRIterationLoop(d)}if(e.VBR!=ut.vbr_off){if(t.VBR_min_bitrate=1,t.VBR_max_bitrate=14,e.out_samplerate<16e3&&(t.VBR_max_bitrate=8),0!=e.VBR_min_bitrate_kbps&&(e.VBR_min_bitrate_kbps=c(e.VBR_min_bitrate_kbps,e.version,e.out_samplerate),t.VBR_min_bitrate=b(e.VBR_min_bitrate_kbps,e.version,e.out_samplerate),t.VBR_min_bitrate<0)||0!=e.VBR_max_bitrate_kbps&&(e.VBR_max_bitrate_kbps=c(e.VBR_max_bitrate_kbps,e.version,e.out_samplerate),t.VBR_max_bitrate=b(e.VBR_max_bitrate_kbps,e.version,e.out_samplerate),t.VBR_max_bitrate<0))return-1;e.VBR_min_bitrate_kbps=te.bitrate_table[e.version][t.VBR_min_bitrate],e.VBR_max_bitrate_kbps=te.bitrate_table[e.version][t.VBR_max_bitrate],e.VBR_mean_bitrate_kbps=Math.min(te.bitrate_table[e.version][t.VBR_max_bitrate],e.VBR_mean_bitrate_kbps),e.VBR_mean_bitrate_kbps=Math.max(te.bitrate_table[e.version][t.VBR_min_bitrate],e.VBR_mean_bitrate_kbps)}switch(e.tune&&(t.PSY.mask_adjust+=e.tune_value_a,t.PSY.mask_adjust_short+=e.tune_value_a),a=e.internal_flags,e.quality){default:case 9:a.psymodel=0,a.noise_shaping=0,a.noise_shaping_amp=0,a.noise_shaping_stop=0,a.use_best_huffman=0,a.full_outer_loop=0;break;case 8:e.quality=7;case 7:a.psymodel=1,a.noise_shaping=0,a.noise_shaping_amp=0,a.noise_shaping_stop=0,a.use_best_huffman=0,a.full_outer_loop=0;break;case 6:case 5:a.psymodel=1,0==a.noise_shaping&&(a.noise_shaping=1),a.noise_shaping_amp=0,a.noise_shaping_stop=0,-1==a.subblock_gain&&(a.subblock_gain=1),a.use_best_huffman=0,a.full_outer_loop=0;break;case 4:a.psymodel=1,0==a.noise_shaping&&(a.noise_shaping=1),a.noise_shaping_amp=0,a.noise_shaping_stop=0,-1==a.subblock_gain&&(a.subblock_gain=1),a.use_best_huffman=1,a.full_outer_loop=0;break;case 3:a.psymodel=1,0==a.noise_shaping&&(a.noise_shaping=1),a.noise_shaping_amp=1,-(a.noise_shaping_stop=1)==a.subblock_gain&&(a.subblock_gain=1),a.use_best_huffman=1,a.full_outer_loop=0;break;case 2:a.psymodel=1,0==a.noise_shaping&&(a.noise_shaping=1),0==a.substep_shaping&&(a.substep_shaping=2),a.noise_shaping_amp=1,-(a.noise_shaping_stop=1)==a.subblock_gain&&(a.subblock_gain=1),a.use_best_huffman=1,a.full_outer_loop=0;break;case 1:a.psymodel=1,0==a.noise_shaping&&(a.noise_shaping=1),0==a.substep_shaping&&(a.substep_shaping=2),a.noise_shaping_amp=2,-(a.noise_shaping_stop=1)==a.subblock_gain&&(a.subblock_gain=1),a.use_best_huffman=1,a.full_outer_loop=0;break;case 0:a.psymodel=1,0==a.noise_shaping&&(a.noise_shaping=1),0==a.substep_shaping&&(a.substep_shaping=2),a.noise_shaping_amp=2,-(a.noise_shaping_stop=1)==a.subblock_gain&&(a.subblock_gain=1),a.use_best_huffman=1,a.full_outer_loop=0}return t.ATH.useAdjust=e.athaa_type<0?3:e.athaa_type,t.ATH.aaSensitivityP=Math.pow(10,e.athaa_sensitivity/-10),null==e.short_blocks&&(e.short_blocks=sa.short_block_allowed),e.short_blocks!=sa.short_block_allowed||e.mode!=na.JOINT_STEREO&&e.mode!=na.STEREO||(e.short_blocks=sa.short_block_coupled),e.quant_comp<0&&(e.quant_comp=1),e.quant_comp_short<0&&(e.quant_comp_short=0),e.msfix<0&&(e.msfix=0),e.exp_nspsytune|=1,e.internal_flags.nsPsy.attackthre<0&&(e.internal_flags.nsPsy.attackthre=D.NSATTACKTHRE),e.internal_flags.nsPsy.attackthre_s<0&&(e.internal_flags.nsPsy.attackthre_s=D.NSATTACKTHRE_S),e.scale<0&&(e.scale=1),e.ATHtype<0&&(e.ATHtype=4),e.ATHcurve<0&&(e.ATHcurve=4),e.athaa_loudapprox<0&&(e.athaa_loudapprox=2),e.interChRatio<0&&(e.interChRatio=0),null==e.useTemporal&&(e.useTemporal=!0),t.slot_lag=t.frac_SpF=0,e.VBR==ut.vbr_off&&(t.slot_lag=t.frac_SpF=72e3*(e.version+1)*e.brate%e.out_samplerate|0),p.iteration_init(e),R.psymodel_init(e),0},this.lame_encode_flush=function(e,t,a,s){var n=e.internal_flags,r=function e(t){if(1==t.length)return new Int16Array(t[0]);var a=t[0];t=t.slice(1);for(var s=[],n=0;n<a;n++)s.push(e(t));return s}([2,1152]),_=0,i=n.mf_samples_to_encode-ra.POSTDELAY,o=j(e);if(n.mf_samples_to_encode<1)return 0;var l=0;e.in_samplerate!=e.out_samplerate&&(i+=16*e.out_samplerate/e.in_samplerate);var f=e.framesize-i%e.framesize;for(f<576&&(f+=e.framesize),f=(i+(e.encoder_padding=f))/e.framesize;0<f&&0<=_;){var h=o-n.mf_size;i=e.frameNum;1152<(h=(h=h*e.in_samplerate)/e.out_samplerate)&&(h=1152),h<1&&(h=1),_=s-l,0==s&&(_=0),a+=_=this.lame_encode_buffer(e,r[0],r[1],h,t,a,_),l+=_,f-=i!=e.frameNum?1:0}if(_<(n.mf_samples_to_encode=0))return _;if(_=s-l,0==s&&(_=0),U.flush_bitstream(e),(_=U.copy_buffer(n,t,a,_,1))<0)return _;if(a+=_,_=s-(l+=_),0==s&&(_=0),e.write_id3tag_automatic){if(v.id3tag_write_v1(e),(_=U.copy_buffer(n,t,a,_,0))<0)return _;l+=_}return l},this.lame_encode_buffer=function(e,t,a,s,n,r,_){var i=e.internal_flags,o=[null,null];if(4294479419!=i.Class_ID)return-3;if(0==s)return 0;(null==i.in_buffer_0||i.in_buffer_nsamples<s)&&(i.in_buffer_0=ta(s),i.in_buffer_1=ta(s),i.in_buffer_nsamples=s),o[0]=i.in_buffer_0,o[1]=i.in_buffer_1;for(var l=0;l<s;l++)o[0][l]=t[l],1<i.channels_in&&(o[1][l]=a[l]);return function(e,t,a,s,n,r,_){var i=e.internal_flags,o=0,l=[null,null],f=[null,null];if(4294479419!=i.Class_ID)return-3;if(0==s)return 0;var h=U.copy_buffer(i,n,r,_,0);if(h<0)return h;if(r+=h,o+=h,f[0]=t,f[1]=a,J.NEQ(e.scale,0)&&J.NEQ(e.scale,1))for(h=0;h<s;++h)f[0][h]*=e.scale,2==i.channels_out&&(f[1][h]*=e.scale);if(J.NEQ(e.scale_left,0)&&J.NEQ(e.scale_left,1))for(h=0;h<s;++h)f[0][h]*=e.scale_left;if(J.NEQ(e.scale_right,0)&&J.NEQ(e.scale_right,1))for(h=0;h<s;++h)f[1][h]*=e.scale_right;if(2==e.num_channels&&1==i.channels_out)for(h=0;h<s;++h)f[0][h]=.5*(f[0][h]+f[1][h]),f[1][h]=0;for(t=j(e),l[0]=i.mfbuf[0],l[1]=i.mfbuf[1],a=0;0<s;){var c=[null,null];c[0]=f[0],c[1]=f[1];var b=e,u=l,m=a,p=s,d=h=new G,g=b.internal_flags;if(g.resample_ratio<.9999||1.0001<g.resample_ratio)for(var v=0;v<g.channels_out;v++){var S,R=new z,M=d,A=u[v],B=g.mf_size,w=b.framesize,T=c[v],E=m,k=p,y=R,x=v,P=b.internal_flags,I=0,H=b.out_samplerate/K(b.out_samplerate,b.in_samplerate);$.BPC<H&&(H=$.BPC);var V=Math.abs(P.resample_ratio-Math.floor(.5+P.resample_ratio))<1e-4?1:0,O=1/P.resample_ratio;1<O&&(O=1);var L=31;if(0==L%2&&--L,V=(L+=V)+1,0==P.fill_buffer_resample_init){for(P.inbuf_old[0]=ta(V),P.inbuf_old[1]=ta(V),S=0;S<=2*H;++S)P.blackfilt[S]=ta(V);for(P.itime[0]=0,I=P.itime[1]=0;I<=2*H;I++){var N=0,D=(I-H)/(2*H);for(S=0;S<=L;S++){var X=P.blackfilt[I],q=S,Y=S-D,C=Math.PI*O;(Y/=L)<0&&(Y=0),1<Y&&(Y=1);var F=Y-.5;Y=.42-.5*Math.cos(2*Y*Math.PI)+.08*Math.cos(4*Y*Math.PI),N+=X[q]=Math.abs(F)<1e-9?C/Math.PI:Y*Math.sin(L*C*F)/(Math.PI*L*F)}for(S=0;S<=L;S++)P.blackfilt[I][S]/=N}P.fill_buffer_resample_init=1}for(N=P.inbuf_old[x],O=0;O<w&&(S=O*P.resample_ratio,!(k<=L+(I=0|Math.floor(S-P.itime[x]))-L/2));O++){for(D=S-P.itime[x]-(I+L%2*.5),D=0|Math.floor(2*D*H+H+.5),S=X=0;S<=L;++S)X+=((q=S+I-L/2)<0?N[V+q]:T[E+q])*P.blackfilt[D][S];A[B+O]=X}if(y.num_used=Math.min(k,L+I-L/2),P.itime[x]+=y.num_used-O*P.resample_ratio,y.num_used>=V)for(S=0;S<V;S++)N[S]=T[E+y.num_used+S-V];else{for(A=V-y.num_used,S=0;S<A;++S)N[S]=N[S+y.num_used];for(I=0;S<V;++S,++I)N[S]=T[E+I]}M.n_out=O,d.n_in=R.num_used}else for(d.n_out=Math.min(b.framesize,p),d.n_in=d.n_out,b=0;b<d.n_out;++b)u[0][g.mf_size+b]=c[0][m+b],2==g.channels_out&&(u[1][g.mf_size+b]=c[1][m+b]);if(u=h.n_in,h=h.n_out,i.findReplayGain&&!i.decode_on_the_fly&&Q.AnalyzeSamples(i.rgdata,l[0],i.mf_size,l[1],i.mf_size,h,i.channels_out)==W.GAIN_ANALYSIS_ERROR)return-6;if(s-=u,a+=u,i.mf_size+=h,i.mf_samples_to_encode<1&&(i.mf_samples_to_encode=ra.ENCDELAY+ra.POSTDELAY),i.mf_samples_to_encode+=h,i.mf_size>=t){if(u=_-o,0==_&&(u=0),h=e,u=Z.enc.lame_encode_mp3_frame(h,l[0],l[1],n,r,u),h.frameNum++,(h=u)<0)return h;for(r+=h,o+=h,i.mf_size-=e.framesize,i.mf_samples_to_encode-=e.framesize,u=0;u<i.channels_out;u++)for(h=0;h<i.mf_size;h++)l[u][h]=l[u][h+e.framesize]}}return o}(e,o[0],o[1],s,n,r,_)}}function q(){this.setModules=function(e,t){}}function Y(){this.setModules=function(e,t,a){}}function C(){}function F(){this.setModules=function(e,t){}}function l(){this.sampleRate=this.channels=this.dataLen=this.dataOffset=0}function f(e){return e.charCodeAt(0)<<24|e.charCodeAt(1)<<16|e.charCodeAt(2)<<8|e.charCodeAt(3)}var mt={fill:function(e,t,a,s){if(2==arguments.length)for(var n=0;n<e.length;n++)e[n]=t;else for(n=t;n<a;n++)e[n]=s}},ee={arraycopy:function(e,t,a,s,n){for(n=t+n;t<n;)a[s++]=e[t++]}},_a={SQRT2:1.4142135623730951,FAST_LOG10:function(e){return Math.log10(e)},FAST_LOG10_X:function(e,t){return Math.log10(e)*t}};sa.short_block_allowed=new sa(0),sa.short_block_coupled=new sa(1),sa.short_block_dispensed=new sa(2),sa.short_block_forced=new sa(3);var j={MAX_VALUE:34028235e31};ut.vbr_off=new ut(0),ut.vbr_mt=new ut(1),ut.vbr_rh=new ut(2),ut.vbr_abr=new ut(3),ut.vbr_mtrh=new ut(4),ut.vbr_default=ut.vbr_mtrh,na.STEREO=new na(0),na.JOINT_STEREO=new na(1),na.DUAL_CHANNEL=new na(2),na.MONO=new na(3),na.NOT_SET=new na(4),W.STEPS_per_dB=100,W.MAX_dB=120,W.GAIN_NOT_ENOUGH_SAMPLES=-24601,W.GAIN_ANALYSIS_ERROR=0,W.GAIN_ANALYSIS_OK=1,W.INIT_GAIN_ANALYSIS_ERROR=0,W.INIT_GAIN_ANALYSIS_OK=1,W.MAX_ORDER=W.YULE_ORDER=10,W.MAX_SAMPLES_PER_WINDOW=(W.MAX_SAMP_FREQ=48e3)*(W.RMS_WINDOW_TIME_NUMERATOR=1)/(W.RMS_WINDOW_TIME_DENOMINATOR=20)+1,H.NUMTOCENTRIES=100,H.MAXFRAMESIZE=2880,J.EQ=function(e,t){return Math.abs(e)>Math.abs(t)?Math.abs(e-t)<=1e-6*Math.abs(e):Math.abs(e-t)<=1e-6*Math.abs(t)},J.NEQ=function(e,t){return!J.EQ(e,t)};var te={t1HB:[1,1,1,0],t2HB:[1,2,1,3,1,1,3,2,0],t3HB:[3,2,1,1,1,1,3,2,0],t5HB:[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],t6HB:[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],t7HB:[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],t8HB:[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],t9HB:[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],t10HB:[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],t11HB:[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],t12HB:[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],t13HB:[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],t15HB:[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],t16HB:[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],t24HB:[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],t32HB:[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],t33HB:[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],t1l:[1,4,3,5],t2l:[1,4,7,4,5,7,6,7,8],t3l:[2,3,7,4,4,7,6,7,8],t5l:[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],t6l:[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],t7l:[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],t8l:[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],t9l:[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],t10l:[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],t11l:[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],t12l:[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],t13l:[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],t15l:[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],t16_5l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],t16l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],t24l:[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],t32l:[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],t33l:[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8]};te.ht=[new e(0,0,null,null),new e(2,0,te.t1HB,te.t1l),new e(3,0,te.t2HB,te.t2l),new e(3,0,te.t3HB,te.t3l),new e(0,0,null,null),new e(4,0,te.t5HB,te.t5l),new e(4,0,te.t6HB,te.t6l),new e(6,0,te.t7HB,te.t7l),new e(6,0,te.t8HB,te.t8l),new e(6,0,te.t9HB,te.t9l),new e(8,0,te.t10HB,te.t10l),new e(8,0,te.t11HB,te.t11l),new e(8,0,te.t12HB,te.t12l),new e(16,0,te.t13HB,te.t13l),new e(0,0,null,te.t16_5l),new e(16,0,te.t15HB,te.t15l),new e(1,1,te.t16HB,te.t16l),new e(2,3,te.t16HB,te.t16l),new e(3,7,te.t16HB,te.t16l),new e(4,15,te.t16HB,te.t16l),new e(6,63,te.t16HB,te.t16l),new e(8,255,te.t16HB,te.t16l),new e(10,1023,te.t16HB,te.t16l),new e(13,8191,te.t16HB,te.t16l),new e(4,15,te.t24HB,te.t24l),new e(5,31,te.t24HB,te.t24l),new e(6,63,te.t24HB,te.t24l),new e(7,127,te.t24HB,te.t24l),new e(8,255,te.t24HB,te.t24l),new e(9,511,te.t24HB,te.t24l),new e(11,2047,te.t24HB,te.t24l),new e(13,8191,te.t24HB,te.t24l),new e(0,0,te.t32HB,te.t32l),new e(0,0,te.t33HB,te.t33l)],te.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],te.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],te.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],te.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],te.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],te.scfsi_band=[0,6,11,16,21],P.Q_MAX=257,P.Q_MAX2=116,P.LARGE_BITS=1e5,P.IXMAX_VAL=8206;var G={};G.SFBMAX=3*ra.SBMAX_s,ra.ENCDELAY=576,ra.POSTDELAY=1152,ra.FFTOFFSET=224+(ra.MDCTDELAY=48),ra.DECDELAY=528,ra.SBLIMIT=32,ra.CBANDS=64,ra.SBPSY_l=21,ra.SBPSY_s=12,ra.SBMAX_l=22,ra.SBMAX_s=13,ra.PSFB21=6,ra.PSFB12=6,ra.HBLKSIZE=(ra.BLKSIZE=1024)/2+1,ra.HBLKSIZE_s=(ra.BLKSIZE_s=256)/2+1,ra.NORM_TYPE=0,ra.START_TYPE=1,ra.SHORT_TYPE=2,ra.STOP_TYPE=3,ra.MPG_MD_LR_LR=0,ra.MPG_MD_LR_I=1,ra.MPG_MD_MS_LR=2,ra.MPG_MD_MS_I=3,ra.fircoef=[-.1039435,-.1892065,5*-.0432472,-.155915,3898045e-23,.0467745*5,.50455,.756825,.187098*5],$.MFSIZE=3456+ra.ENCDELAY-ra.MDCTDELAY,$.MAX_HEADER_BUF=256,$.MAX_BITS_PER_CHANNEL=4095,$.MAX_BITS_PER_GRANULE=7680,$.BPC=320,l.RIFF=f("RIFF"),l.WAVE=f("WAVE"),l.fmt_=f("fmt "),l.data=f("data"),l.readHeader=function(e){var t=new l,a=e.getUint32(0,!1);if(l.RIFF==a&&(e.getUint32(4,!0),l.WAVE==e.getUint32(8,!1)&&l.fmt_==e.getUint32(12,!1))){var s=20;switch(n=e.getUint32(16,!0)){case 16:case 18:t.channels=e.getUint16(s+2,!0),t.sampleRate=e.getUint32(s+4,!0);break;default:throw"extended fmt chunk not implemented"}s=s+n;for(var n=l.data,r=0;n!=a&&(a=e.getUint32(s,!1),r=e.getUint32(s+4,!0),n!=a);)s+=r+8;return t.dataLen=r,t.dataOffset=s+8,t}},G.SFBMAX=3*ra.SBMAX_s,lamejs.Mp3Encoder=function(a,e,t){3!=arguments.length&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),a=1,e=44100,t=128);var s=new X,n=new q,r=new W,_=new J,i=new A,o=new P,l=new I,f=new H,h=new R,c=new F,b=new B,u=new E,m=new Y,p=new C;s.setModules(r,_,i,o,l,f,h,c,p),_.setModules(r,p,h,f),c.setModules(_,h),i.setModules(s),l.setModules(_,b,o,u),o.setModules(u,b,s.enc.psy),b.setModules(_),u.setModules(o),f.setModules(s,_,h),n.setModules(m,p),m.setModules(h,c,i);var d=s.lame_init();d.num_channels=a,d.in_samplerate=e,d.brate=t,d.mode=na.STEREO,d.quality=3,d.bWriteVbrTag=!1,d.disable_reservoir=!0,d.write_id3tag_automatic=!1,s.lame_init_params(d);var g=1152,v=0|1.25*g+7200,S=new Int8Array(v);this.encodeBuffer=function(e,t){return 1==a&&(t=e),e.length>g&&(g=e.length,v=0|1.25*g+7200,S=new Int8Array(v)),e=s.lame_encode_buffer(d,e,t,e.length,S,0,v),new Int8Array(S.subarray(0,e))},this.flush=function(){var e=s.lame_encode_flush(d,S,0,v);return new Int8Array(S.subarray(0,e))}},lamejs.WavHeader=l}lamejs();var Markdown={};Markdown={regexes:{markdown_link:/(^|\s)\[(.+?)\]\(((?:https?:\/\/(?:www\.)?|www\.).*?)\)/gi,markdown_quote:/(?:^|\n)(?:!|>\s|&gt;\s)(.+?)(?:\n|$)/gm,markdown_heading:/(?:^|\n)(\#{1,6}) (.*?\S *)(?:\n|$)/gm,markdown_line:/(^|[\n])(\*{3,}|\-{3,})(?=$|[\n])(.*)/g,markdown_codeblock:/(^|\s)`{3}((?:(?:.*?$)\n)?(?:[\s\S]*?))`{3}(?=$|\s)/g,markdown_code:/(^|\s)\`(.*?\S *)?\`(?=$|\s)/g,markdown_bold:/(^|\s|[{\[])\*{1,2}(.*?\S *)?\*{1,2}(?=$|\s|[\.,\?:;\-}\]](?:$|\s))/g,markdown_italic:/(^|\s|[{\[])\_(.*?\S *)?\_(?=$|\s|[\.,\?:;\-}\]](?:$|\s))/g,markdown_underline:/(^|\s|[{\[])\_{2}(.*?\S *)?\_{2}(?=$|\s|[\.,\?:;\-}\]](?:$|\s))/g,markdown_strike:/(^|\s|[{\[])\~(.*?\S *)?\~(?=$|\s|[\.,\?:;\-}\]](?:$|\s))/g,markdown_bullet:/(^\s|\n|^)(\*) (.*?\S *)*(?:(?:.*?$)\n)?((\s)*(\*)(.*?\S *)*(?:(?:.*?$)\n)?)*/gm,markdown_nextline:/(.*)(\n)(.*)/gm,markdown_image:/!\[(.*)\]\(((https?:\/\/(?:www\.)?|www\.)[a-zA-Z0-9][^@]*?)\s("|&quot;)(.*)("|&quot;)\)/gi,markdown_video:/\[!\[(.*)\]\(((https?:\/\/(?:www\.)?|www\.)[a-zA-Z0-9][^@]*?)\)]\(((https?:\/\/(?:www\.)?|www\.)[a-zA-Z0-9][^@]*?)\)/gi},apply:function(e,t){return"string"!=typeof e?e:(e=e.replace(/<br>/g,"\n").trim(),e=this.applyRecursive(e,t),e=this.applyOnce(e),e=this.applyNextLine(e),e=this.decodeChars(e))},applyOnce:function(e){return e=(e=(e=(e=e.replace(this.regexes.markdown_quote,this.getQuoteHTML)).replace(this.regexes.markdown_heading,this.getHeadingHTML)).replace(this.regexes.markdown_codeblock,this.getCodeblockHTML)).replace(this.regexes.markdown_code,this.getCodeHTML)},applyRecursive:function(e,t){return e=(e=(e=(e=(e=(e=(e=e.replace(this.regexes.markdown_bold,this.getBoldHTML)).replace(this.regexes.markdown_italic,this.getItalicHTML)).replace(this.regexes.markdown_strike,this.getStrikeHTML)).replace(this.regexes.markdown_underline,this.getUnderLineHTML)).replace(this.regexes.markdown_line,this.getLineHTML)).replace(this.regexes.markdown_bullet,this.getBulletHTML)).replace(this.regexes.markdown_link,this.getLinkHTML),t||(e=(e=e.replace(this.regexes.markdown_image,this.getImageHTML)).replace(this.regexes.markdown_video,this.getVideoHTML)),e},applyNextLine:function(e){return e.replace(this.regexes.markdown_nextline,this.getNextLineHTML)},getNextLineHTML:function(e,t,n,r){return t+"<br>"+r},getLinkHTML:function(e,t,n,r,i){return t+' <a href="'+(r.startsWith("www.")?"http://"+r:r)+'" target="_blank" rel="noopener" markdown_type="link">'+Markdown.encodeChars(n)+"</a> "},getQuoteHTML:function(e,t){return 0===(t=$.trim(t)).length?e:Markdown.setPrefixAndSuffix(e,' <blockquote class="blkqote" markdown_type="blockquote">'+Markdown.applyRecursive(t)+"</blockquote> ")},getHeadingHTML:function(e,t,n){var r=t.length;return Markdown.setPrefixAndSuffix(e," <h"+r+' markdown_type="heading">'+Markdown.encodeChars(n)+"</h"+r+"> ")},getLineHTML:function(e,t,n,r){return t+' <div class="w100 textC"><hr class="hr" markdown_type="line"></div> '+Markdown.applyRecursive($.trim(r))},getCodeblockHTML:function(e,t,n){return 0===$.trim(n).length?e:t+' <pre class="pre" markdown_type="codeblock"> '+Markdown.applyRecursive(n)+"</pre>"},getUnderLineHTML:function(e,t,n){return!n||!n.match(/[^_*`~]/)||"_"===n[0]||"_"===n[n.length-1]||" "===n[0]&&" "===n[n.length-1]?e:t+' <u markdown_type="underline">'+Markdown.applyRecursive(n)+"</u> "},getCodeHTML:function(e,t,n){return!n||!n.match(/[^_*`~]/)||"`"===n[0]||"`"===n[n.length-1]||" "===n[0]&&" "===n[n.length-1]?e:t+' <code class="code" markdown_type="code">&ldquo;'+Markdown.encodeChars(n)+"&rdquo;</code> "},getBoldHTML:function(e,t,n){return!n||!n.match(/[^_*`~]/)||"*"===n[0]||"*"===n[n.length-1]||" "===n[0]&&" "===n[n.length-1]?e:t+' <strong markdown_type="bold">'+Markdown.applyRecursive(n)+"</strong> "},getItalicHTML:function(e,t,n){return!n||!n.match(/[^_*`~]/)||"_"===n[0]||"_"===n[n.length-1]||" "===n[0]&&" "===n[n.length-1]?e:t+' <i markdown_type="italic">'+Markdown.applyRecursive(n)+"</i> "},getStrikeHTML:function(e,t,n){return!n||!n.match(/[^_*`~]/)||"~"===n[0]||"~"===n[n.length-1]||" "===n[0]&&" "===n[n.length-1]?e:t+' <s><span markdown_type="strike">'+Markdown.applyRecursive(n)+"</span></s> "},getBulletHTML:function(e){if(0==e.replace(/\s/g,"").replace(/\*/g,"").length)return e;for(var t=e.split("\n"),n="",r=0;r<t.length;r++)if(t[r].includes("*")){t[r];n+=t[r].replace(/\*/,' <li style="list-style: inherit"> ')+" </li>"}return Markdown.setPrefixAndSuffix(e,' <ul class="markd_ul" markdown_type="bullet">'+n+"</ul> ")},getNumlistHTML:function(e){if(!isNaN(e))return e;for(var t=e.split("\n"),n="",r=0;r<t.length;r++)if(t[r]=t[r].replace(/(\d)*(\.)/,"*"),t[r].includes("*")){t[r];n+=t[r].replace(/\*/,'<li style="list-style: decimal"> ')+" </li>"}return Markdown.setPrefixAndSuffix(e,' <ol class="markd_ul" markdown_type="numberlist">'+n+"</ol> ")},getImageHTML:function(e,t,n,r,i,a){var s="";try{s=_SCHEMA+"://"+_EMBEDSERVERURL}catch(e){s=_SCHEMA+"://"+_SERVERURL}return s+="/linkredirect.sas?link="+encodeURIComponent(n),Markdown.setPrefixAndSuffix(e,' <img class="markdown_img" src="'+s+'" alt="'+t+'" title="'+a+'"> ')},getVideoHTML:function(e,t,n,r,i,a){var s="";try{s=_SCHEMA+"://"+_EMBEDSERVERURL}catch(e){s=_SCHEMA+"://"+_SERVERURL}return s+="/linkredirect.sas?link="+encodeURIComponent(n),Markdown.setPrefixAndSuffix(e,' <a href="'+i+'" rel="noreferrer" target="_blank"><img class="markdown_img" src="'+s+'" alt="'+t+'"></a> ')},encodeChars:function(e){return e.replace(/\*/g,"&ast;").replace(/\_/g,"&#95;").replace(/\~/g,"&#126;")},decodeChars:function(e){return e.replace(/&ast;/g,"*").replace(/&#95;/g,"_").replace(/&#126;/g,"~")},setPrefixAndSuffix:function(e,t){var n=suffix="";return"\n"!=e[0]&&" "!=e[0]||(n=e[0]),"\n"!=e[e.length-1]&&" "!=e[e.length-1]||(suffix=e[e.length-1]),n+t+suffix}};var Browser=function(){};Browser.getInfo=function(){try{lsnocachefix("json")}catch(e){}try{({cookie:navigator.cookieEnabled,java:navigator.javaEnabled()})}catch(e){}return{cookie:navigator.cookieEnabled,java:navigator.javaEnabled(),color:window.screen.colorDepth,screen:window.screen.availWidth+" * "+window.screen.availHeight,title:Browser.getPageTitle(),currentpage:Browser.getCurrentPage(),referrer:Browser.getReferrer(),browser:$.browser.name,browserversion:$.browser.version,os:$.os.name,jsversion:jsversion,flashversion:Browser.getFlashVersion(),localtime:Browser.getLocalTime(),lang_embed:_LANG,ccode:_CCODE}},Browser.getFlashVersion=function(){try{try{var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{e.AllowScriptAccess="always"}catch(e){return"6.0.0"}}catch(e){}return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/,"").replace(/\D+/g,".").match(/^,?(.+),?$/)[1]}catch(e){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/,"").replace(/\D+/g,".").match(/^,?(.+),?$/)[1]}catch(e){}}return"0.0.0"},Browser.getLocalTime=function(){try{return(new Date).toTimeString().split(" ").slice(1).join(" ")}catch(e){}return""},Browser.setReferer=function(e){"null"!=e&&(Browser.referer=e)},Browser.setCurrentPage=function(e){Browser.currentpage=e||""},Browser.getCurrentPage=function(){return Browser.currentpage?Browser.currentpage:""},Browser.getReferrer=function(){try{return Base64.atob(opener.Button.sitereferrer)}catch(e){if("null"!=Browser.referer)return Base64.atob(Browser.referer)}return""},Browser.setPageTitle=function(e){null==e&&""==e||(Browser.pagetitle=e)},Browser.getPageTitle=function(){try{return opener.Button.pagetitle}catch(e){if(null!=Browser.pagetitle)return Browser.pagetitle}return""};function LSDebugger(){}LSDebugger.init=function(){this.infoarray=[],this.debuglimit=100,this.logarr=[],this.maxreqsize=20,this.localstoragekey="logdebuginfo";try{LSDebugger.clearDumpLog()}catch(e){}},LSDebugger.clearDumpLog=function(){var e=localStorage.getItem("siqlog");if(e){for(var t in e=JSON.parse(e))e.hasOwnProperty(t)&&t.startsWith("siqlog")&&delete e[t];localStorage.siqlog=JSON.stringify(e)}},LSDebugger.getCurrentTime=function(){var e=new Date;return e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+":"+e.getMilliseconds()},LSDebugger.pushDebugInfo=function(e){e&&(this.infoarray.length>=this.debuglimit&&this.infoarray.splice(0,1),this.infoarray.push({time:LSDebugger.getCurrentTime(),info:e}))},LSDebugger.clearDebugInfo=function(){this.infoarray=[]},LSDebugger.postDebugInfo=function(e,t,o,r){if(e){try{var g=parseInt(CurrentUser.getWMSID().split("_")[1]);if(t&&-1===$.inArray(g,t))return;if(o&&o<g%10)return}catch(e){}if(r&&!window.dext){var a={};a.subject=e,a.log=this.infoarray,a.time=(new Date).getTime();var n=LSDebugger.getFromLocalStorage(this.localstoragekey);if((n=n||[]).push(a),LSDebugger.storeInLocalStorage(this.localstoragekey,n,""),LSDebugger.clearDebugInfo(),n.length>=this.maxreqsize){var i={subject:"Over all info messages"};i.log=CommonUtil.toJSON(n),i.logonly=!0,i.nocache=(new Date).getTime();var u="logdebuginfo"+(window.dext||".sas");try{u=$Support.getAjaxURL("logdebuginfo",dext)}catch(e){}n=[],LSDebugger.removeFromLocalStorage(this.localstoragekey);var s={url:u,type:"POST",data:i,dataType:"json",success:function(e){}};"undefined"!=typeof jQuery&&$.ajax(s)}}else LSDebugger.postDebugInfoInSingleThread(e,r)}},LSDebugger.postDebugInfoInSingleThread=function(e,t){var o={};o.subject=e,o.log=CommonUtil.toJSON(this.infoarray),o.nocache=(new Date).getTime(),t&&(o.logonly=t);var r="logdebuginfo"+(window.dext||".sas");try{r=$Support.getAjaxURL("logdebuginfo",dext)}catch(e){}LSDebugger.clearDebugInfo();var g={url:r,type:"POST",data:o,dataType:"json",success:function(e){LSDebugger.clearDebugInfo()}};"undefined"!=typeof jQuery&&$.ajax(g)},LSDebugger.collectLogs=function(t,e){try{this.logarr[t][0]}catch(e){this.logarr[t]=[]}this.logarr[t].push({time:LSDebugger.getCurrentTime(),info:e})},LSDebugger.storeInLocalStorage=function(e,t,o){window.dext?$Support.LSDB.set(e,t,o):CommonUtil.storeInLocalStorage(e,t,o,!0)},LSDebugger.removeFromLocalStorage=function(e){window.dext?$Support.LSDB.remove(e):CommonUtil.removeFromLocalStorage(e,!0)},LSDebugger.getFromLocalStorage=function(e){return window.dext?$Support.LSDB.getFromLocalStorage(e):CommonUtil.getFromLocalStorage(e,!0)},LSDebugger.init();function LSResource(){}LSResource.init=function(){this.MessageObject=new Object,this.IntegMessageObject=new Object},LSResource.getRealValue=function(e,t){var c="";try{c=null==this.MessageObject[""+e]||null==this.MessageObject[""+e]?e:this.MessageObject[e]}catch(e){}try{c=c.replace(/_/g," ")}catch(e){c=""}return null!=t&&(c=LSResource.replaceParams(c,t)),c},LSResource.replaceParams=function(e,t){try{for(var c="object"==typeof t?t:t.split(","),s=0;s<c.length;s++){var r=c[s],n=new RegExp("\\$"+(s+1),"g");e=e.replace(n,r)}}catch(e){}return e},LSResource.setIntegLabel=function(e,t){if(null!=t){try{LSResource.IntegMessageObject[e]=new Object}catch(e){}LSResource.IntegMessageObject[e]=t}},LSResource.getIntegLabel=function(e,t){try{var c=LSResource.IntegMessageObject[e];if(null!=c&&null!=c[t]&&""!=c[t])return c[t]}catch(e){}return LSResource.getRealValue(t)},LSResource.init();var op=-1!=navigator.userAgent.indexOf("Opera"),ie=!op&&/msie/i.test(navigator.userAgent),ie_edge=!op&&/msie|trident/i.test(navigator.userAgent),mz=!op&&!ie&&/mozilla\/5/i.test(navigator.userAgent),wms_sf=-1!=navigator.userAgent.indexOf("Safari"),version=parseInt(navigator.appVersion),ie5=ie&&4==version&&-1!=navigator.userAgent.indexOf("msie 5.0"),ie5_5=ie&&4==version&&-1!=navigator.userAgent.indexOf("msie 5.5"),ie6=ie&&4==version&&-1!=navigator.userAgent.indexOf("msie 6."),ie7=ie&&-1!=navigator.userAgent.indexOf("MSIE 7."),ie8=ie&&-1!=navigator.userAgent.indexOf("MSIE 8."),_ISFIREFOX=-1<navigator.userAgent.toLowerCase().indexOf("firefox");if(!ie&&document.layers)var browser_nn4=!0;else if(document.layers||!document.all&&document.getElementById)var browser_nn6=!0;!function(f){f.fn.ValidationRule=function(n){return{validate:n}},f.fn.Validator=function(){return{required:new f.fn.ValidationRule(function(n){return void 0!==n&&""!==n}),email:new f.fn.ValidationRule(function(n){var t=new RegExp(/^([\w]([\w\-\.\+\'\/]*)@([\w\-]+\.[a-zA-Z0-9-]{2,22}(\.[a-zA-Z0-9-]{2,22}){0,3}))$/);return void 0!==n&&t.test(n)}),phone:new f.fn.ValidationRule(function(n){return void 0!==n&&/^(\+?\d{1,}(\s?|\-?)\d*(\s?|\-?)\(?\d{2,}\)?(\s?|\-?)\d{2,}(\s?|\-?)\d{2,})$/gi.test(n)}),charlimit:new f.fn.ValidationRule(function(n,t){return void 0!==n&&n.length<=t}),minlimit:new f.fn.ValidationRule(function(n,t){return void 0!==n&&n.length>=t}),percentage:new f.fn.ValidationRule(function(n){var t=new RegExp(/^[0-9]{1,3}%{0,1}?$/);return void 0!==n&&t.test(n)}),number:new f.fn.ValidationRule(function(n){return void 0!==n&&/^[0-9,]*$/.test(n)}),decimal:new f.fn.ValidationRule(function(n){return void 0!==n&&/^[0-9]+(\.[0-9]{0,9})?/.test(n)}),url:new f.fn.ValidationRule(function(n){var t=new RegExp(/^(((http|https):\/\/(www.){0,1})|www.){1}[a-zA-Z0-9]+[-a-zA-Z0-9@:/%_\+.~#?&/=]*[^\.]$/);return void 0!==n&&t.test(n)})}},f.fn.validateInput=function(){for(var n=f(this),t=(n.attr("data-validate")||"").trim().replace(/[\s]{2,}/g," ").split(" "),i=(n.attr("id")||n.attr("name"),"DIV"===n[0].nodeName?n.attr("val"):n.val().trim()),a=!0,e=new f.fn.Validator,l=0;l<t.length&&a;l++){var o=t[l],r=t[l+1]?t[l+1]:null;if(""===o||"optional"===o&&""===i)break;if("optional"!==o){var u=e[o]||null;null!==u&&((a=u.validate(i,r))?n.off("blur.validation"):d(n))}}return n.val(i),n.attr("data-is-valid",a),a;function d(n){n.on("keyup.validation",function(){0!=f.trim(n.val()).length&&n.off("keyup.validation, focus.validation").removeClass("errfield")}).addClass("errfield").off("blur.validation").on("blur.validation",function(){n.validateInput()}).off("focus.validation").on("focus.validation",function(n){n.stopImmediatePropagation()}),n.on("change","input[type='checkbox'], input[type='radio']",function(){this.checked&&n.removeClass("errfield")})}},f.validateField=function(n,t){var i=(new f.fn.Validator)[n]||null;return null!==i&&i.validate(t)}}(jQuery);var Smiley=function(){var i,m={":smile:":"smile",":happy:":"happy",":joy:":"joy",":grinning:":"grinning",":cool:":"cool",":love:":"love",":curious:":"curious",":awe:":"awe",":thinking:":"thinking",":search:":"search",":idea:":"idea",":wink:":"wink",":razz:":"razz",":relaxed:":"relaxed",":peace:":"peace",":blush:":"blush",":yummy:":"yummy",":yuck:":"yuck",":sad:":"sad",":upset:":"upset",":anxious:":"anxious",":worry:":"worry",":stressed-out:":"stressed-out",":angry:":"angry",":tensed:":"tensed",":tired:":"tired",":bored:":"bored",":sleepy:":"sleepy",":jealous:":"jealous",":evil:":"evil",":facepalm:":"facepalm",":doubt:":"doubt",":surprise:":"surprise",":faint:":"faint",":headache:":"headache",":sick:":"sick",":injured:":"injured",":neutral:":"neutral",":smirk:":"smirk",":keep-quiet:":"keep-quiet",":feeling-warm:":"feeling-warm",":feeling-cold:":"feeling-cold",":thumbsup:":"thumbsup",":thumbsdown:":"thumbsdown",":namaste:":"namaste",":super:":"super",":victory:":"victory",":yoyo:":"yoyo",":raising-hand:":"raising-hand",":clap:":"clap",":bye-bye:":"bye-bye",":fist:":"fist",":biceps:":"biceps",":birthday:":"birthday",":champagne:":"champagne",":christmas-tree:":"christmas-tree",":eid-mubarak:":"eid-mubarak",":fireworks:":"fireworks",":gift-box:":"gift-box",":kaaba:":"kaaba",":new-year:":"new-year",":party:":"party",":santa-hat:":"santa-hat",":coffee-cup:":"coffee-cup",":food:":"food",":chicken:":"chicken",":fire:":"fire",":fire-extinguisher:":"fire-extinguisher",":first-aid-box:":"first-aid-box",":medicine:":"medicine",":poop:":"poop",":peanuts:":"peanuts",":refugee-olympic-team:":"refugee-olympic-team",":target:":"target",":task:":"task",":report:":"report",":bug:":"bug",":milestone:":"milestone",":calendar:":"calendar",":security:":"security",":processor:":"processor",":laptop:":"laptop",":server:":"server",":badminton:":"badminton",":baseball:":"baseball",":basketball:":"basketball",":chess:":"chess",":cricket:":"cricket",":flag:":"flag",":foosball:":"foosball",":football:":"football",":golf:":"golf",":hockey:":"hockey",":snooker:":"snooker",":table-tennis:":"table-tennis",":tennis:":"tennis",":volleyball:":"volleyball",":gold-medal:":"gold-medal",":silver-medal:":"silver-medal",":bronze-medal:":"bronze-medal",":break-boy:":"break-boy",":break-girl:":"break-girl",":singing:":"singing",":man-dancing:":"man-dancing",":man-cycling:":"man-cycling",":man-swimming:":"man-swimming",":woman-dancing:":"woman-dancing",":woman-cycling:":"woman-cycling",":woman-running:":"woman-running",":woman-swimming:":"woman-swimming",":yoga:":"yoga",":archer:":"archer",":boxer:":"boxer",":badminton-player:":"badminton-player",":basketball-player:":"basketball-player",":batsman:":"batsman",":batter:":"batter",":bowler:":"bowler",":canoeing:":"canoeing",":chess-player:":"chess-player",":discus-throw:":"discus-throw",":diver:":"diver",":equestrian:":"equestrian",":fencer:":"fencer",":football-player:":"football-player",":female-tennis-player:":"female-tennis-player",":female-tabletennis-player:":"female-tabletennis-player",":female-volleyball-player:":"female-volleyball-player",":golfer:":"golfer",":gymnast:":"gymnast",":hockey-player:":"hockey-player",":hammer-throw:":"hammer-throw",":hurdler:":"hurdler",":javelin-throw:":"javelin-throw",":judo:":"judo",":long-jump:":"long-jump",":pole-vault:":"pole-vault",":athlete:":"athlete",":rhythmic-gymnastics:":"rhythmic-gymnastics",":shooter:":"shooter",":shotput-throw:":"shotput-throw",":high-jump:":"high-jump",":karate:":"karate",":male-tabletennis-player:":"male-tabletennis-player",":male-volleyball-player:":"male-volleyball-player",":male-tennis-player:":"male-tennis-player",":pitcher:":"pitcher",":snooker-player:":"snooker-player",":weightlifting:":"weightlifting",":wrestling:":"wrestling",":bicycle:":"bicycle",":sports-bike:":"sports-bike",":cruiser-bike:":"cruiser-bike",":motor-scooter:":"motor-scooter",":car:":"car",":taxi:":"taxi",":bus:":"bus",":train:":"train",":police-car:":"police-car",":ambulance:":"ambulance",":fire-engine:":"fire-engine",":aeroplane:":"aeroplane",":passenger-ship:":"passenger-ship",":parking:":"parking",":cafeteria:":"cafeteria",":garden:":"garden",":playground:":"playground",":home:":"home",":office:":"office",":library:":"library",":auditorium:":"auditorium",":store:":"store",":mail-room:":"mail-room",":pharmacy:":"pharmacy",":gym:":"gym",":americas:":"americas",":europe-africa:":"europe-africa",":asia-pacific:":"asia-pacific"},c={":)":"smile",":-)":"smile",":^)":"smile",":]":"smile",":D":"happy",":-D":"happy",":))":"happy",":-))":"happy","B-)":"cool",":xs":"love",":-?":"thinking","*-:)":"idea",";)":"wink",";-)":"wink",":-P":"razz",":P":"razz",":-p":"razz",":p":"razz","-_-":"relaxed","(a)":"angel","(A)":"angel","O-)":"angel","O:-)":"angel","O:)":"angel",":(":"sad",":-(":"sad",":[":"sad","D:":"anxious",":S":"worry",":-S":"worry",":s":"worry",":-s":"worry","-.-":"stressed-out","X-(":"angry",":-@":"angry",":@":"angry","|-)":"sleepy","I-)":"sleepy","(=_=)":"tired","?D":"doubt",":O":"surprise",":-O":"surprise",":o":"surprise",":-o":"surprise","(6.6)":"faint","(({..}))":"headache","+o(":"sick",":/":"smirk",":-/":"smirk",":-#":"shutup",":-X":"shutup","(Y)":"thumbsup","(y)":"thumbsup",":+1:":"thumbsup",":x-":"thumbsup","(N)":"thumbsdown","(n)":"thumbsdown",":-1:":"thumbsdown"},l=$.extend({},m,c),y=function(e){e.removeClass("slidetgl_show").addClass("slidetgl_hide"),setTimeout(function(){e.hide().html("").removeClass("slidetgl_hide")},300)},g=function(e,a,i){var l='<div class="smile_sublist">',s=e?'<div class="shrtct_inf">â â <span>'+LSResource.getRealValue("common.tonavigate")+'</span><span class="sqico-enter">'+LSResource.getRealValue("common.toselect")+"</span>"+LSResource.getRealValue("common.close")+" [Esc]</div>":"",r=" sel";for(var n in m){var t=m[n]||c[n],o=LSResource.getRealValue("smiley."+t);l+='<div class="smileli '+(e?"siqsmile_li":"")+r+' siq-smileys" title="'+o+'" smilename="'+t+'" ><em smilename="'+t+'" class="siqsly-'+t+' siq-smiley-icon"></em><span smilename="'+t+'" class="txtelips">'+o+"</span></div>",r=""}return s+l+"</div>"};return{init:function(){for(var e in i="",l)e=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),""!=i?i+="|"+e:i=e},replace:function(e){try{var a=new RegExp("([ >\n]|^)("+i+")(?=[ <\n]|$)","g");e=e.replace(a,function(e,a,i){return a+'<em title="'+LSResource.getRealValue("smiley."+(m[i]||c[i]))+'" class="siqsly-'+l[i]+'"></em>'})}catch(e){}return e},handleInSertSmiley:function(e,a){var i=$(a),l=i.parent().find("#smilelist");return 0==l.find(".siqsmile_li").length||(!(e=e||l.find(".smileli.sel").attr("smilename"))||(CommonUtil.handleAddDynamicKey(TRIGGER_SMILEY_KEY,i,e),l.html("").stop().hide(),!1))},checkAndTriggerSmiley:function(e,a){var i,l,s=/^(37|38|39|40)$/.test(a),r=e.target,n=$(r).val().substring(0,r.selectionStart),t=n.lastIndexOf(" "+TRIGGER_SMILEY_KEY)+1,o=$(r).parent().find("#smilelist"),m=n.indexOf(TRIGGER_SMILEY_KEY),c=o.find(".smile_sublist");if(0<t||0===t&&0===m||0===t&&"\n"===n[m-1]){var d=(l=(i=(i=n).replace(/\:\w+\:/g,"")).lastIndexOf(TRIGGER_SMILEY_KEY),("\n"===i[l-1]||" "===i[l-1]||0===l)&&i.substring(l+1));if(27==a||!1===d)return void y(o);if(s)return void CommonUtil.handleGridNavigation(c,e,".siqsmile_li");0==o.find(".siqsmile_li").length&&o.html(g(!0)).off("click").on("click",function(e){var a=$(e.target).attr("smilename");a&&Smiley.handleInSertSmiley(a,r)});var u=o.find(".smileli"),p=o.find('.smileli[smilename*="'+d+'"]');return 0==p.length&&""!==d?void y(o):(u.hide(),p.show(),c.scrollTop(0),""===d&&o.find(".smileli").show(),u.removeClass("sel"),o.find('.smileli[style*="block"]').first().addClass("sel"),o.show().addClass("slidetgl_show").removeClass("slidetgl_hide"),void $Clickoutside.bindclick(function(){y(o)},"smilelist","smiley"))}y(o)},showSmileyList:function(e,a,i){var s=i||$("#msgarea"),r=s.parent().find("#smilelist");if(r.hasClass("slidetgl_show"))y(r);else{$Clickoutside.bindclick(function(){y(r)},"smilelist","smiley");var l=g(!1);r.html(l).show().off("click").on("click",function(e){var a=$(e.target).attr("smilename");if(a){var i=s,l=CommonUtil.getTextFromHeadToCaret(i);a=TRIGGER_SMILEY_KEY+a+TRIGGER_SMILEY_KEY,a=" "==l.substr(l.length-1)?a:" "+a,CommonUtil.handleAddDynamicKey("",i,a),y(r)}}).addClass("slidetgl_show").removeClass("slidetgl_hide"),r.find(".smile_sublist").addClass("smileli_only"),a||CommonUtil.iniatializePerfectScrollBar(r.find(".smile_sublist"))}}}}();Smiley.init();var controller=new Object;function HttpCommunication(e,t){this.comid=e,this.callback=t,this.initialize=function(){var e;window.XMLHttpRequest?e=new XMLHttpRequest:window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLHTTP"));e?e.onreadystatechange=this.callback:e=!1;controller[this.comid]=e},this.request=function(t){try{this.initialize();var e=controller[this.comid];e.open("GET",t,!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),ie?e.send():e.send(null)}catch(e){document.getElementById("sendmsg").src=t}},this.postrequest=function(e,t){try{this.initialize();var n=controller[this.comid];n.open("POST",e,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.send(t)}catch(e){}},this.submitForm=function(e){0;this.initialize();var t=controller[this.comid];if(void 0===e)return!1;formEle=e.elements,formLen=e.length;var n=e.action,o=e.method,r="";for(i=0;i<formLen;i++)0<formEle[i].name.length&&(0==i||r.length<1?r+=formEle[i].name+"="+encodeURIComponent(formEle[i].value):r+="&"+formEle[i].name+"="+encodeURIComponent(formEle[i].value));if(""==r)return!1;if(""==n)return!1;t&&("get"==o.toLowerCase()?(-1!=n.indexOf("?")?urlQryStr=n+"&"+r:urlQryStr=n+"?"+r,urlQryStr="&"+lsnocachefix(),t.open("GET",urlQryStr,!0),ie?t.send():t.send(null)):(t.open("POST",n,!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),t.send(r+"&"+lsnocachefix())));return!1}}function sendPostMessage(t){var e=t&&"api"==t.operation;e&&(ie_edge||_ISFIREFOX)&&$EmbedManger.handleApiData();try{if(!opener)return setTimeout(function(){try{parent.postMessage(CommonUtil.toJSON(t),"*")}catch(e){}},0),!1;try{if(opener.Button)return"api"==t.operation?SupportUI.handleApiData(opener.Button.getApiData().value):"callbacks"==t.operation&&opener.Button.sendCallBacks(t),!1;window.opener.postMessage(CommonUtil.toJSON(t),"*")}catch(e){return setTimeout(function(){try{opener.postMessage(CommonUtil.toJSON(t),"*")}catch(e){}},0),!1}}catch(e){}return e&&SupportUI.handleApiData(),!1}function MyDate(){}var YEARINMS=31536e6,MONTHINMS=2592e6,WEEKINMS=6048e5,DAYINMS=864e5,HOURINMS=36e5,MININMS=6e4,SECINMS=1e3;function diffRawTZOffet(e,t){var r=t<e?e-t:t-e;return r*=6e4,r=t<e?-1*r:r}MyDate.getHoursandMin=function(e,t,r){var a=MyDate.getConvertedObject(e,r),o="",n=a.getHours(),u=a.getMinutes();return o+=12<n?n-12:0==n?"12":n,o+=(u<10?":0":":")+u,0!=t&&(o+=12<=n?" "+LSResource.getRealValue("time.PM"):" "+LSResource.getRealValue("time.AM")),o},MyDate.getConvertedObject=function(e,t){if(null!=e&&""!=e){if("bclient"==t)return MyDate.convertBrowser(e);if("server"==t||"client"==t)return MyDate.convertUser(e);if("zsupport"==t)return MyDate.convertZohoSupport(e)}},MyDate.convertBrowser=function(e){var t=parseInt(e);return t+=diffRawTZOffet(_TZCOFFSET,_TZCOFFSET),new Date(Number(t))},MyDate.convertUser=function(e){var t=parseInt(e);return t+=diffRawTZOffet(_TZCOFFSET,_TZOFFSET),new Date(Number(t))},MyDate.convertZohoSupport=function(e){var t=Number(e);return t+=diffRawTZOffet(0,_TZSOFFSET),t+=diffRawTZOffet(_TZCOFFSET,_TZOFFSET),new Date(Number(t))},MyDate.formatMS=function(e){var t=new Array,r=new Array("w","d","h","m","s");for(t[0]=Math.floor(e/MONTHINMS),e-=t[0]*MONTHINMS,t[1]=Math.floor(e/WEEKINMS),e-=t[1]*WEEKINMS,t[2]=Math.floor(e/DAYINMS),e-=t[2]*DAYINMS,t[3]=Math.floor(e/HOURINMS),e-=t[3]*HOURINMS,t[4]=Math.floor(e/MININMS),e-=t[4]*MININMS,t[5]=Math.floor(e/SECINMS),i=0;i<=5;i++)if(t[i])return 5!=i?zeroUpFront(t[i])+":"+zeroUpFront(t[i+1])+r[i]:"00:"+zeroUpFront(t[i])+"s"},MyDate.timeDifference=function(e){var t=36e5,r=24*t,a=30*r,o=365*r,n=(new Date).getTime()-e;if(n<6e4)return LSResource.getRealValue("date.justnow");if(n<t){var u=Math.round(n/6e4);return LSResource.getRealValue(1<u?"date.mins.ago":"date.min.ago",""+u)}if(n<r){var f=Math.round(n/t);return LSResource.getRealValue(1<f?"date.hours.ago":"date.hour.ago",""+f)}if(n<1728e5)return LSResource.getRealValue("date.yesterday");if(n<12096e5&&6048e5<n)return LSResource.getRealValue("date.lastweek");if(n<a){f=Math.round(n/r);return LSResource.getRealValue("date.days.ago",""+f)}if(n<5184e6)return LSResource.getRealValue("date.lastmonth");if(n<o){f=Math.round(n/a);return LSResource.getRealValue("date.months.ago",""+f)}f=Math.round(n/o);return LSResource.getRealValue(1<f?"date.years.ago":"date.year.ago",""+f)};function Self(){}Self.status={init:function(){this.idletime=6e3,this.entertxttime=3e3,this.prevstatus=NFY_USER_IDLE,this.timer=-1,this.isactive=!1},enterText:function(){this.prevstatus;0<Self.status.getmsglength()&&(Self.status.send($EmbedManger.getChatID(),NFY_USER_ENTERED),NFY_USER_ENTERED)},send:function(t,e){if(!$EmbedManger.getChatStatus()&&"-1"!=t){this.prevstatus=e;var s={};s.userid=LSMessanger.getUserName(),s.chid=t,s.status=e,s.dname=getUnescapedText(LSMessanger.getNickName()),s.sid=LSMessanger.getSid();var i="sendstatus.ls";$EmbedManger.isCrossDomainReq()&&(i=$Support.getAjaxURL("sendstatus",".ls")),$.ajax({url:i,data:s,dataType:"json",success:function(t){}})}},idle:function(){clearTimeout(this.timer),Self.status.send($EmbedManger.getChatID(),NFY_USER_IDLE)},update:function(t){if(t.sender!=LSMessanger.getUserName()){var e=ZSIQConversationManager&&ZSIQConversationManager.getChatWinObjById($Support.chidmappinglist[t.chid])||{};(e.chatstatus="connected")&&$EmbedManger.UI.setChatStatus(t.msg,e)}},check:function(t){0!=this.isactive&&(null==t&&Self.status.check(this.prevstatus),clearTimeout(this.timer),t==NFY_USER_TYPING?0<Self.status.getmsglength()?this.timer=setTimeout(function(){Self.status.enterText()},this.entertxttime):this.timer=setTimeout(function(){Self.status.idle()},this.idletime):t==NFY_USER_ENTERED&&(this.timer=setTimeout(function(){Self.status.idle()},this.idletime)))},active:function(t){this.isactive=!0,clearTimeout(this.timer),13==t.keyCode?this.prevstatus="":(this.prevstatus,NFY_USER_TYPING),this.check(NFY_USER_TYPING)},deactive:function(){this.isactive=!1},getmsglength:function(){return $EmbedManger.getMessageLength()},clear:function(t){$EmbedManger.UI.setChatStatus("",t)}};EmbedSound={loop:1,tunes:{smessage:"ping",endtimer:"buzz",incomingcall:"ringtone",outgoingcall:"waiting",requestscreensahre:"shortnotification"},IS_FLASH_EXIST:!1,IS_HTML5_AUDIO:!1,cache:{},init:function(){var e=this,a=0,t=0,n=!1,i=!1;try{return""!==(new Audio).canPlayType("audio/mp3")&&"no"!==(new Audio).canPlayType("audio/mp3")?e.extn="mp3":e.extn="wav",void(e.IS_HTML5_AUDIO=!0)}catch(e){}if(navigator.plugins&&navigator.plugins.length?(x=navigator.plugins["Shockwave Flash"],x?(a=2,x.description&&(y=x.description,t=y.match(/\d{1,2}/))):a=1,navigator.plugins["Shockwave Flash 2.0"]&&(t=a=2)):navigator.mimeTypes&&navigator.mimeTypes.length?(x=navigator.mimeTypes["application/x-shockwave-flash"],a=x&&x.enabledPlugin?2:1):i=!0,i)for(var o=new Array("ShockwaveFlash.ShockwaveFlash.9","ShockwaveFlash.ShockwaveFlash.8.5","ShockwaveFlash.ShockwaveFlash.8","ShockwaveFlash.ShockwaveFlash.7"),l=0;l<o.length;l++)try{if(null!=new ActiveXObject(o[l])){n=!0;break}}catch(e){}else 2==a&&7<t&&(n=!0);if(e.IS_FLASH_EXIST=n,e.IS_FLASH_EXIST){var r=document.createElement("SPAN");r.style.position="absolute",r.style.top="-10000px",r.style.left="-10000px",r.style.display="block",r.innerHTML='<objectclassid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="<%=schema%>://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0" width="28" height="20" id="player" align="middle" wmode="transparent"><param name="allowScriptAccess" value="always" /><param name="movie" value="'+CommonUtil.getStaticURL("/salesiq/flash/player_0dac92b089f977a666eb6b81c7607275_.swf")+'" /><param name="quality" value="high" /><param name="bgcolor" value="" /><param name="wmode" value="transparent"/><embed src="'+e.getSoundFileURL("player","swf","flash")+'" quality="high"  width="28"height="20" name="player" align="middle"allowScriptAccess="always" wmode="transparent"type="application/x-shockwave-flash" pluginspage="<%=schema%>://www.macromedia.com/go/getflashplayer" /></object>',document.body.appendChild(r)}},getSoundFileURL:function(e,a,t){var n=window._MEDIAHASHMAPPING,i="sound"==t?window._MEDIASERVERURL:window._JSCDNSERVER;if(n&&Object.keys(n).length){if("sound"==t)return i+"/sound/"+e+"_"+n["sound/"+e+"."+a]+"_";if("flash"==t)return i+"flash/"+e+"_"+n["flash/"+e+"."+a]+"_."+a}else{if("sound"==t)return i+"/sound/"+e;if("flash"==t)return i+"flash/"+e+"."+a}},getPlayer:function(){if(EmbedSound.IS_FLASH_EXIST)return window.document.player?window.document.player:-1!=navigator.appName.indexOf("Microsoft Internet")?document.getElementById("player"):document.embeds&&document.embeds.player?document.embeds.player:void 0},play:function(e,a){var t=this;if(t.isPlayerEnable()&&!$EmbedManger.isSoundOff()){var n=t.getSoundFileURL(t.tunes[e],t.extn,"sound");if(t.IS_HTML5_AUDIO)try{if(t._SOUND_PLAYER&&t._SOUND_PLAYER.tune&&-1!=["incomingcall","outgoingcall"].indexOf(t._SOUND_PLAYER.tune))return;void 0===t.cache[n]?(t._SOUND_PLAYER=new Audio(n+"."+t.extn),t._SOUND_PLAYER.addEventListener("loadeddata",function(){4==t._SOUND_PLAYER.readyState&&(t.cache[n]=t._SOUND_PLAYER)})):(t._SOUND_PLAYER=t.cache[n],t._SOUND_PLAYER.currentTime=0),t._SOUND_PLAYER.tune=e,a?(t._SOUND_PLAYER.loop=!0,t._SOUND_PLAYER.play(),clearTimeout(t.cleartimer),t.cleartimer=setTimeout(function(){t.stop()},1e3*a)):(t._SOUND_PLAYER.loop=!1,t._SOUND_PLAYER.play())}catch(e){}else try{var i=t.getPlayer();n=n+".mp3";i.SetVariable("_root.loops",t.loop),i.TCallLabel("_root.$listener","setloops"),i.SetVariable("_root.$listener.fpath",n),i.TCallLabel("_root.$listener","playfile")}catch(e){}}},isPlaying:function(e){try{var a=this;if(void 0===a._SOUND_PLAYER)return!1;if(!a.isPlayerEnable()||$EmbedManger.isSoundOff())return!1;var t=a._SOUND_PLAYER.src,n=t.lastIndexOf("/")+1,i=t.substring(n).split("_");return a.tunes[e]===t.substring(n,t.lastIndexOf("."))||a.tunes[e]===i[0]}catch(e){}return!1},stop:function(){var e=this;if(e.IS_HTML5_AUDIO)try{e._SOUND_PLAYER.pause(),e._SOUND_PLAYER={}}catch(e){}else try{if(!e.IS_FLASH_EXIST)return;e.getPlayer().TCallLabel("_root.$listener","stopSound")}catch(e){}},isPlayerEnable:function(){return this.IS_FLASH_EXIST||this.IS_HTML5_AUDIO}},EmbedSound.init();var _WMSDOWN=!1,isntwrkreconnect=!1;function WmsliteImpl(){}WmsliteImpl.serverdown=function(){if(!$Support||$Support.isChatExist()){_WMSDOWN=!0;var e=CommonUtil.getStaticURL("/salesiq/images/spacer_592ebefc7104d681d57852665e9ad514_.gif"),n=document.getElementById("nwcheckimg");n&&n.parentElement.removeChild(n),(n=document.createElement("img")).style.display="none",n.id="nwcheckimg",document.body.appendChild(n),n.addEventListener?(n.addEventListener("load",function(){$EmbedManger.UI.displayInfo(WmsliteImpl.getValueByType("onload"),2)}),n.addEventListener("error",function(){$EmbedManger.UI.displayInfo(WmsliteImpl.getValueByType("onerror"),2)})):(n.attachEvent("onload",function(){$EmbedManger.UI.displayInfo(LSResource.getRealValue("wms.connectionlost.error"),2)}),n.attachEvent("onerror",function(){$EmbedManger.UI.displayInfo(LSResource.getRealValue("visitorchat.reconnection.msg"),2)})),n.src=e+"?nocache="+(new Date).getTime()}},WmsliteImpl.serverup=function(e){var n={mtype:0};n.msg=e;var t=!(!_JOINED||_WMSDOWN);_JOINED=!1,_WMSDOWN&&(isntwrkreconnect=!0,$EmbedManger.UI.displayInfo(LSResource.getRealValue("visitorchat.connectivity.success"),1),setTimeout(function(){$EmbedManger.UI.hideInfo()},5e3)),_WMSDOWN=!1,LSMessanger.push(n,isntwrkreconnect,t),isntwrkreconnect=!1},WmsliteImpl.handleLogout=function(e){},WmsliteImpl.handleMessage=function(e,n){var t={};t.mtype=e,t.msg=n,LSMessanger.push(t)},WmsliteImpl.handleAccountDisabled=function(e){},WmsliteImpl.handleServiceMessage=function(e){},WmsliteImpl.getValueByType=function(e){var n="";return"onload"==e?n=LSResource.getRealValue("wms.connectionlost.error"):"onerror"==e&&(n=LSResource.getRealValue("visitorchat.reconnection.msg")),n};$(document).ready(function(){var e={},t={};parent.$ZSIQWidget?e=parent.$ZSIQWidget.getEmbedObject():opener&&opener.$ZSIQWidget&&(e=opener.$ZSIQWidget.getEmbedObject(),window.onbeforeunload=$UI.showCloseAlert),parent.$ZSIQChat&&parent.$ZSIQChat.getWidgetData?t=parent.$ZSIQChat.getWidgetData().commondata||{}:opener&&opener.$ZSIQChat&&opener.$ZSIQChat.getWidgetData&&(t=opener.$ZSIQChat.getWidgetData().commondata||{}),e.einfo.embedstatus&&(LSMessanger.setSubDomain(e.lssubdomain),LSMessanger.init(),$Support.type=e.params.type,document.title=e.pinfo.companyname+" - "+LSResource.getRealValue("common.livechat"),_EMBEDNAME=e.embedname,_SCREENNAME=e.screenname,_LANG=e.lang,_CCODE=e.ccode,_SCHEMA=e.schema,_EMBEDSERVERURL=e.embedserverurl,INIT=!1,_TZCOFFSET=-1*(new Date).getTimezoneOffset(),_TZOFFSET=e.tzoffset?parseInt(e.tzoffset):null,_TZOFFSET=null==_TZOFFSET?_TZCOFFSET:_TZOFFSET,_TOOLTIP=e.tooltip,_TZSOFFSET=parseInt(e.tzsoffset),_TZPOFFSET=parseInt(e.tzpoffset),CLIENTVERSION=e.servername,_SERVERNAME=e.clientversion,uapache=e.uapache,ucomp=e.ucomp,_VIDEOVERSION=e.videoversion,_MEDIASERVERURL=uapache?e.mediaserverurl:_SCHEMA+"://"+_EMBEDSERVERURL,_WMSJSSTATICDOMAIN=e.wmsjsstaticdomain,_WMSPUBLICDOMAIN=t.wmspublicdomain,_MEDIAHASHMAPPING=t.mediafilescdnhashes?JSON.parse(t.mediafilescdnhashes):"",_JSCDNSERVER=t.jscdnstaticserver,_SIQHELPLINK=e.siqhelplink,_ZCAMPAIGNENABLED=e.campaignenabled,_ANNONREGTIMEOUT=e.annonregistertimeout,_ISRTLSUPPORTEDLANG=e.RTL_supported_language,_PRDNAME=e.productname,_PRDURL=e.producturl,_FREELOGOLINK=e.freelogolink,_GT_ATTRIBUTIONLINK=e.gtattributionlink,_CFPARAMNAME=e.cfparamname,_CFCNAME=e.cfcname,jsversion=null,ucomp||(LSResource.MessageObject=e.jsresource),$Support.init(e))});!function(a){var e=function(t,e){this.$elem=a(t),this.dropobj=e,this.options=e.options};e.prototype={init:function(){this.setHeader(),this.setDropList(),this.bindEventHandlers(),this.$elem.addClass("sqico-drpdwn")},setHeader:function(){var t=this.dropobj;this.$elem.attr("dockeydown","dropdown").html('<em class="req" title="Mandatory"></em><a href="javascript:;" id="dropheader" purpose="'+t.purpose+'">'+t.defaultval+"</a>")},setDropList:function(){for(var t='<ul id="dropcontent">',e=this.options,n=e.length,i=this.dropobj.purpose,o=0;o<n;o++){var s=e[o],r=0!=s.isClient,a=getEscapedText(s.ID||s.value),l=getEscapedText(s.DNAME||s.text),d=getEscapedText(s.NAME||""),p="department"===i?this.getDeptStatusHTML(s):"";t+=r?'<li val="'+a+'" uniname="'+d+'">'+l+p+"</li>":""}this.$elem.append(t+"</ul>"),this.sortList()},sortList:function(){var t=this.dropobj.purpose;if(!("department"!==t||"department"==t&&$Support.getApiDepartment().length)){var e=this.$elem.find("ul"),n=e.find("li");n.sort(function(t,e){return parseInt(a(t).find("span").attr("status"))>parseInt(a(e).find("span").attr("status"))?1:-1}),e.empty().html(n)}},getDeptStatusHTML:function(t){var e=""+t.STATUS=="true"?$Support.DEPT_ONLINESTATUES:$Support.DEPT_OFFLINESTATUES,n="1"===(e=""+t.ENGAGED=="true"?$Support.DEPT_ENGAGESTATUES:e)?"department.status_"+e:"common.offline";return'<span class="desc deptst_'+e+'" status="'+e+'" title="'+LSResource.getRealValue(n)+'"><em>'+LSResource.getRealValue(n)+"</em></span>"},getDeptName:function(t){for(var e=this.options,n=e.length,i=0;i<n;i++){var o=e[i];if(o.ID===t||o.value===t)return o.DNAME||o.text}},bindEventHandlers:function(){var o=this.$elem,t=$Support.contentdiv||ZSIQConversationManager.getcurrchatwinobj().contentdiv,s=this,r={department:function(t,e){$Support.Util.handleDeptChange(t,e)},customdrpdwn:function(t){$Support.Util.handleInputChange(t.parents('div[purpose="custom"]').attr("name"),t.attr("val"))}};o.on("click","a",function(t){if(!$Support.Util.isPreview()){var n=a(this).attr("val"),e=a("div.sqico-drpdwn");s.alignDropDown(),1<e.length&&e.removeClass("zindrp").find("ul").hide(),o.addClass("zindrp").find("ul").stop().slideToggle(350,function(){var t=a(this),e=t.find('li[val="'+n+'"]');t.css("overflow",""),e.length?e.addClass("atsel"):t.find("li:first-child").addClass("atsel"),t.is(":hidden")?o.removeClass("zindrp"):t.scrollTop(0)}),o.removeClass("errfield"),$Clickoutside.bindclick(function(){s.hideDropDown()},"dropcontent","dropheader")}}).on("click","li",function(t,e){var n=a(this).attr("val");o.children("a").attr("val",n).html(s.getDeptName(n)),s.hideDropDown(),$Support.Util.setTextareaHeight(),o.attr("val",n).removeClass("errfield");var i=r[s.dropobj.purpose];"function"==typeof i&&i(a(this),e)}).on("mouseenter","li",function(){o.find("li.atsel").removeClass("atsel"),a(this).addClass("atsel")}),t.add("#msgmaindiv").on("scroll",function(){o.find("ul:visible").length&&s.alignDropDown()})},alignDropDown:function(){var t=$Support.contentdiv||ZSIQConversationManager.getcurrchatwinobj().contentdiv,e=this.$elem,n=e.children("a"),i=e.children("ul"),o=n.offset().top,s=n.outerHeight(),r=a("body").outerHeight();if(o+s+i.outerHeight()>r+t.scrollTop())return e.addClass("btmalign"),i.css({top:"auto",bottom:r-o,"z-index":"111113"}),void i.find("li").removeClass("atsel");e.removeClass("btmalign"),i.css({bottom:"auto",top:o+s})},hideDropDown:function(){var t=this.$elem;t.find("ul").slideUp(function(){t.removeClass("zindrp")}).find("li.atsel").removeClass("atsel")}},a.fn.dropdown=function(t){return this.each(function(){new e(this,t).init()})}}(jQuery);function getSource(e){return ie?window.event.srcElement:e.target}function getEventSourceId(e){return null!=(e=null==e?window.event:e).srcElement?e.srcElement.id:e.target.id}function isUndefined(e){return void 0===e}function getObjectSize(e){var t=0;for(var n in e)e.hasOwnProperty(n)&&t++;return t}function lsnocachefix(e,t){if("json"!=e)return e?"&nocache="+(new Date).getTime():"&"+_CFPARAMNAME+"="+getLDCSRFToken()+"&nocache="+(new Date).getTime();var n={};return n.nocache=(new Date).getTime(),!0!==t&&null!=t||(n[_CFPARAMNAME]=getLDCSRFToken()),n}function zeroUpFront(e){return 100<=e&&(e%=100),e<10&&(e="0"+(e=""+e)),e}function shrinkImage(e,t,n,r){var o={WIDTH:t,HEIGHT:e},i=[r/t,n/e];return 1<(i=Math.min(i[0],i[1]))?o:o={WIDTH:t*i,HEIGHT:e*i}}function getMatchedObjFromArray(e,t,n){return e.filter(function(e){if(e[t]===n)return e})}function getEncodedText(e){try{e&&(e=(e=e.replace(/&#39;|&#x27;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&").replace(/&#x2F;/g,"/")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"))}catch(e){}return e}function getHtmlFreeText(e){try{e&&"string"==typeof e&&(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"))}catch(e){}return e}function getDecodedText(e){try{e=e.replace(/&#39;|&#x27;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&").replace(/&#x2F;/g,"/")}catch(e){}return e}function getMemSize(e){return 1048576<e?getRoundedDecimals(100*e/1048576/100,2)+" MB":1024<e?getRoundedDecimals(100*e/1024/100,2)+" KB":getRoundedDecimals(e,2)+" Bytes"}function getRoundedDecimals(t,e){try{return t.toFixed(e)}catch(e){return t}}function processInput(e,t,n){if(!t)return t;switch(e){case"emailid":","==(t=t.replace(/(\s)|(\/)/g,"")).charAt(t.length-1)&&(t=t.substring(0,t.length-1)),t.match(/@/g)&&t.match(/@/g).length<=1&&(t=t.replace(/,/g,"."));break;case"trimlength":n=n||100,t=t.substring(0,n)}return t}function getLDCSRFToken(){return $Support.getParent().$ZSIQCookie.get(_CFCNAME)}function getUnescapedText(e,t){if(isUndefined(e)||!t&&!isEncoded(e))return e;var n=$("<div></div>"),r=n.html(e).text();return n.remove(),r}function getEscapedText(e){return isEncoded(e)?e:$("<div/>").text(e).html()}function isEncoded(e){try{if(!/<|>/.test(e))return!0}catch(e){}return!1}function isPostMessageSupported(){try{return!!window.postMessage}catch(e){}return!1}util={optimizeFontForMozilla:function(e){var t="<FONT";if(-1!=e.indexOf(t)){var n=e.split(t);for(i=0;i<n.length;i++)n[i]=util.insertSpanForColor(n[i]);var r="";if(1<n.length)for(i=0;i<n.length;i++)r=0==i?n[i]:r+t+n[i];""!=r&&(e=r)}return e}};var Base64={PadChar:"=",samples:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",getB64:function(e,t){var n=Base64.samples.indexOf(e.charAt(t));if(-1==n)throw"Error";return n},atob:function(t){if(!t)return"";var n,r,o,i=t.length;if(0==i)return t;try{return window.atob(t)}catch(e){if(i%4!=0)throw"Error";n=0,t.charAt(i-1)==Base64.PadChar&&(n=1,t.charAt(i-2)==Base64.PadChar&&(n=2),i-=4);var a=[];for(r=0;r<i;r+=4)o=Base64.getB64(t,r)<<18|Base64.getB64(t,r+1)<<12|Base64.getB64(t,r+2)<<6|Base64.getB64(t,r+3),a.push(String.fromCharCode(o>>16,o>>8&255,255&o));switch(n){case 1:o=Base64.getB64(t,r)<<18|Base64.getB64(t,r+1)<<12|Base64.getB64(t,r+2)<<6,a.push(String.fromCharCode(o>>16,o>>8&255));break;case 2:o=Base64.getB64(t,r)<<18|Base64.getB64(t,r+1)<<12,a.push(String.fromCharCode(o>>16))}return a.join("")}}},CommonUtil={TZOFFSET:-1*(new Date).getTimezoneOffset(),toJSON:function(e){return Object.toJSON?Object.toJSON(e):JSON.stringify(e)},parseToJSON:function(t){try{if(!t)return null;if("object"==typeof t)return t;t=JSON.parse(t)}catch(e){t=$.parseJSON(t)}return t},getCaptcha:function(e){return null!=e?"<img src='/showcaptcha?digest="+e+"'></img>":null},isAllowPasteImage:function(){return this.isAllowFileSharing()&&/chrome/.test(navigator.userAgent.toLowerCase())},isAllowFileSharing:function(){return JSON.parse($Support.EmbedObj.eprops.icfile)&&Licence.verify("filesharing")},isAllowAssist:function(){return JSON.parse($Support.EmbedObj.eprops.isscreenshare)&&JSON.parse($Support.EmbedObj.pprops.screensharing)&&CommonUtil.isIntegratedPortal(LDINTEG_ZASSIST)&&Licence.verify("assistallowed")},isAudioCallAllowed:function(e){return!(e=e||{}).isBotChat&&CommonUtil.isAudiocallEnabledFromPortal()&&JSON.parse($Support.EmbedObj.eprops.isaudiocall)&&!CommonUtil.isGroupChat(e.chatID)&&Licence.verify("audiocall")&&CommonUtil.isSecuredSchema()&&avaction.isBrowserSupported(navigator.userAgent,!0)},isScreenSharingAllowed:function(e){return e=e||{},CommonUtil.isScreenshareEnabledFromPortal()&&JSON.parse($Support.EmbedObj.eprops.issiqscreenshare)&&Licence.verify("issiqscreenshare")&&this.isAudioCallAllowed(e)},handleAjaxReq:function(e,t,n,r,o){e=$Support.getApiURl()+"/"+e;var i=o?o.method:"POST",a=$Support.isSignature($Support.EmbedObj)?"emailsignature":"website";$.ajax({url:e,type:i,data:JSON.stringify(t),contentType:"application/json",beforeSend:function(e){e.setRequestHeader("X-SIQ-Channel",a)},success:function(e){n&&n(e)},error:function(e){r&&r(e)}})},handleAjaxGetReq:function(e,t,n,r){e=$Support.getApiURl(r)+"/"+e;var o=$Support.isSignature($Support.EmbedObj)?"emailsignature":"website";$.ajax({url:e,type:"GET",beforeSend:function(e){e.setRequestHeader("X-SIQ-Channel",o)},success:function(e){t&&t(e)},error:function(e){n&&n(e)}})},handleImgLoad:function(e,t,n){e=$(e),CommonUtil.setShrinkImageCSS(e,t,n),e.animate({opacity:1},150)},setShrinkImageCSS:function(e,t,n){var r=(e=$(e))[0],o=e.parent(),i=t||o.height(),a=n||o.width(),c=shrinkImage(r.naturalHeight,r.naturalWidth,i,a);e.css({height:c.HEIGHT,width:c.WIDTH})},wordCapitalize:function(e){return e.toLowerCase().replace(/\b\w/g,function(e){return e.toUpperCase()})},escapeSpecialNotation:function(e){if(""==e||null==e)return e;if(-1!==(e=""+e).indexOf("$")){index=-1,count=0;for(var t=e.split(""),n=0;n<=t.length;n++)if("$"===t[n])count++,index=parseInt(n);else if(1<count&&-1!=index){dollar="";for(var r=0;r<count-1;r++)dollar+="$";t.splice(index+1,0,dollar),index=-1,count=0}e=t.join("")}return e},handleEscape:function(e){$(e.target).parents(".editfields").length&&$UI.hideUserEditUI()},scrollIntoView:function(e,t){e.scrollTop(t[0].offsetTop-e[0].offsetTop)},getTextFromHeadToCaret:function(e){var t,n,r;(e=e[0]).isContentEditable&&document.selection?document.selection&&(e.focus(),(r=document.selection.createRange()).moveStart("character",-e.value.length),t=r.text):($(e).focus(),"number"==typeof(n=e.selectionEnd)?t=e.value.substring(0,n):document.selection&&((r=e.createTextRange()).moveStart("character",0),r.moveEnd("textedit"),t=r.text));return t},insertAtCaret:function(e,t){if(document.selection)e.focus(),document.selection.createRange().text=t,e.focus();else if(e.selectionStart||0===e.selectionStart){var n=e.selectionStart,r=e.selectionEnd,o=e.scrollTop;e.value=t+e.value.substring(r,e.value.length),e.focus();try{$Support.toggleSendOnSmileyEnter($(e))}catch(e){}return e.selectionStart=n+t.length,e.selectionEnd=t.length,void(e.scrollTop=o)}e.value+=t,e.focus()},handleAddDynamicKey:function(e,t,n){var r=CommonUtil.getTextFromHeadToCaret(t),o=r.lastIndexOf(e);n=r.slice(0,o+1)+n+e+" ",CommonUtil.insertAtCaret(t[0],n)},handleGridNavigation:function(e,t,n){CommonUtil.preventDefaultAndPropagation(t);var r,o=t.which,i=e.find(n+'[style*="block"]'),a=i.length,c=e.find(".sel"),s=i.index(c),l=Math.floor(e.width()/120);if(-1===s)r=i[0];else if(37===o)r=-1==--s?i[a-1]:i[s];else if(39===o)r=++s===a?i[0]:i[s];else if(38===o){if(s-l<=-1)r=a<=(s=(Math.ceil(a/l)-1)*l+s%l)?i[s-l]:i[s];else r=i[s-l]}else 40===o&&(r=a<=s+l?i[s%l]:i[s+l]);if(void 0!==r)return r=e.find(r),c.removeClass("sel"),r.addClass("sel"),CommonUtil.scrollToView(r,e),r},scrollToView:function(e,t){"string"==typeof t&&(t=$("#"+t)),"string"==typeof e&&(e=t.find("#"+e));var n=CommonUtil.getParentChildOffset(e,t),r=Math.ceil(t[0].scrollTop);n.elementtop<n.containertop?(r-=n.containertop-n.elementtop,t.scrollTop(r)):n.elementbottom>n.containerbottom&&(r+=n.elementbottom-n.containerbottom,t.scrollTop(r))},getParentChildOffset:function(e,t){var n={};return n.containertop=t.offset().top,n.containerbottom=n.containertop+t[0].clientHeight,n.elementtop=e.offset().top,n.elementbottom=n.elementtop+e.outerHeight(),n},preventDefaultAndPropagation:function(e){e.preventDefault(),e.stopPropagation()},handleFileUpload:function(t){var n=t.callbacks;$.ajax({xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",function(e){n.progress&&n.progress(e,t.msgid)},!1),e},url:$Support.getAjaxURL("upload",".ls"),type:"POST",data:t.formdata,contentType:!1,dataType:t.type,processData:!1,success:function(e){n.success&&n.success(e)},complete:function(e){n.complete&&n.complete(e)}})},v2handleFileUpload:function(e,t){var n=e.callbacks;$.ajax({url:e.url||$Support.getApiURl()+"/"+ZSIQConversationManager.getcurrchatwinobj().visitorID+"/messages"+(t&&t.replyurl||""),type:"POST",data:e.formdata,contentType:!1,dataType:e.type,processData:!1,success:function(e){n.success&&n.success(e)},complete:function(e){n.complete&&n.complete(e)}})},isIntegratedPortal:function(e){var t=$Support.EmbedObj.integid;if("null"==t||""==t)return!1;t=JSON.parse(t);var n=[LDINTEG_SDPONDEMAND,LDINTEG_ZOHOSUPPORT,LDINTEG_ZCREATOR];e&&(n=[e]);for(var r=0;r<t.length;r++){var o=t[r];if(-1!==$.inArray(o,n))return!0}return!1},getformattedtext:function(e,t){return e.length>=t?e+"<br>":e},addIfExists:function(e,t,n){if(n)return e[t]=n},isBot:function(e){if(e&&-1!=e)try{var t=e.split("_")[2];return/^b/.test(t)}catch(e){return!1}},getBotImageURL:function(){var e=$Support.getParent().$ZSIQChat.getWidgetData(),t=e.embedobj;e.commondata.isdev&&(t.schema,t.embedserverurl);return CommonUtil.getStaticURL("/salesiq/images/botagent_3ca887953d29000553d7b0c1657d495c_.svg")},stringToHTML:function(e){var t=document.createElement("div");return t.innerHTML=e,t},getStaticURL:function(e){return $Support.getParent().$ZSIQUtil.getStaticURL(e)},isSecuredSchema:function(){return-1<window.location.protocol.indexOf("https")},isAudiocallEnabledFromPortal:function(){return"true"==$Support.getParent().$ZSIQChat.getWidgetData().embedobj.isaudiocallallowed},isScreenshareEnabledFromPortal:function(){return"true"==$Support.getParent().$ZSIQChat.getWidgetData().embedobj.issiqscreenshare},decodeHTML:function(e){return e.replace(/&#x2F;/g,"/").replace(/&#39;|&#x27;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")},getScreenName:function(){return _SCREENNAME},isGroupChat:function(e){if(!e)return!0;var t=0,n=SUPPORT_REPS[e]||{};Object.keys(n);for(var r in n){if(1<t)return!0;0==n[r].ismonitor&&t++}return 1<t},convertMstoMinAndSec:function(e){var t=Math.floor(e/6e4),n=(e%6e4/1e3).toFixed(0);return 60==n&&(n=0),(t<10?"0":"")+t+":"+(n<10?"0":"")+n},SanitizeHtmlContent:function(t){try{return ZSEC.HTMLPurifier({ALLOWED_STYLE:"ALL",WHOLE_DOCUMENT:!0,GLOBAL_TAGS:["iframe"]}).sanitize(t)}catch(e){return t}},validateURL:function(e){return"string"==typeof e?0==e.indexOf("http")?e:"http://"+e:e},debounce:function(r,o,i){var a;return function(){var e=this,t=arguments,n=i&&!a;clearTimeout(a),a=setTimeout(function(){a=null,i||r.apply(e,t)},o),n&&r.apply(e,t)}},sanitizeObject:function(t){return Object.keys(t).forEach(function(e){void 0===t[e]&&delete t[e]}),t},getAttachementURL:function(e){return $Support.getAjaxURL("download",".ls")+"?fsize="+e.size+"&url="+escape(e.url)+"&fName="+encodeURIComponent(e.fName)},checkAndGetReadableTime:function(e){return e&&"string"==typeof e?-1!=e.indexOf(":")?e:MyDate.getHoursandMin(e,!0,"bclient"):""}},Licence=function(){var e;return window.parent.$ZSIQWidget?e=window.parent:window.opener&&opener.$ZSIQWidget&&(e=window.opener),e.$ZSIQLicence}();var SIGNATURE_CHAT="1",DN_UNSUPPORTED=-1,TRIGGER_SMILEY_KEY=":",THIS_WEEK="0",LAST_WEEK="1",THIS_MONTH="2",LAST_MONTH="3",TODAY="5",YESTERDAY="6",TOMORROW="8",NEXT_WEEK="9",NEXT_MONTH="10",LAST_TWO_WEEKS="11",NEXT_TWO_WEEKS="12",LAST_TWO_MONTHS="13",NEXT_TWO_MONTHS="14",THIS_QUARTER="15",LAST_QUARTER="16",NEXT_QUARTER="17",THIS_YEAR="18",ADDINFO_TRIGGER="8",TRIGGER_SEND_MESSAGE=2,TRIGGER_PLAY_TUNE=9,AVAILABLE="1",IDLE="4",ENGAGED="6",NFY_USER_ENTERED=110,PUSH_MSG=111,CT_NFY_MSG=112,NFY_ENDLIVESUPPORT="113",NFY_LS_OPERATIONS=114,NFY_PUSH_MSG=115,NFY_USER_CONTINUE=116,NFY_USER_TYPING=104,NFY_USER_IDLE=105,RESEND_AUTO="1",RESEND_MANUAL="2",CT_TXT_MSG=12,CT_NFY_USERSTATUS=13,CT_NFY_USERADD=14,CT_NFY_USERDELETE=15,CT_INF_MSG=16,CT_ATT_MSG=20,CT_NFY_LEAVESUPPORT="35",WM_DNAME_UPDATE=45,WM_WebRTC_MSG=59,WM_AV_MSG=29,CT_READ=71,CT_TXT_EDIT=64,CT_TXT_DELETE=63,WM_CUSTOM=2,L_FREE1=1,L_FREE2=7,L_FREE=12,ONLINE=1,OFFLINE=0,LDINTEG_ZOHOSUPPORT=1,LDINTEG_SDPONDEMAND=4,LDINTEG_ZCREATOR=5,LDINTEG_ZASSIST=13,VERTICAL=0,HORIZONTAL=1,AUDIOCALL=(TRIGGER_SEND_MESSAGE=2,TRIGGER_PLAY_TUNE=9,ADDINFO_TRIGGER="8",0),VIDEOCALL=1,AUDIOVIDEOCALL=2,AV_CONNECTED="connected",AV_FAILED="failed",UPSTREAM=1,DOWNSTREAM=2,AV_ACCEPTED=1,AV_REJECTED=2,AV_INITIATE=3,AV_CANDIDATE=4,AV_ENDCALL=5,AV_CONNECTWITHPEER=6,AV_INCOMINGCALL=1,AV_OUTGOINGCALL=2,AV_CONNECTING=3,AV_ONGOING=4,AV_RECONNECTING=5,AV_USERBUSY=6,AV_STARTRECORD=7,AV_RECORDING=8,AV_PLAY=9,OLDFORM_VIEW=2,CLASSIC_VIEW=1,CONVERSATION_VIEW=3;var myMsgObj={};Message=window.Message?window.Message:{},$.extend(Message,{trim:function(e){try{e=(e=(e=(e=(e=e.replace(/<p>/gi,"")).replace(/<\/p>/gi,"")).replace(/<a/gi,"<a target='_blank'")).replace(/\n/gi,"<br>")).replace(/^\s*$/gi,"")}catch(e){}return e},format:function(e){try{e=(e=(e=" "+e).replace(/((?:href|src)=["']?)?((https?:\/\/(?:www\.)?|www\.)[a-z0-9][^ \n\r]*?)(?=&quot;|&#x27;|&lt;|[\s"'<]|$)/gi,function(e,t,a,i){_SCHEMA,_EMBEDSERVERURL;return t?e:'<a href="'+getUnescapedText("www."===i?"http://"+a:a)+"\" target='_blank'>"+a+"</a>"})).replace(/(=(&#x27;|&#39;|&quot;|'|")*)?([a-z0-9]([a-z0-9_\-+\.]*)@([a-z0-9_\-\.]*)(\.[a-z]{2,22}(\.[a-z]{2}){0,2}))/gi,function(e,t,a,i){return t?e:'<a href="mailto:'+i+'" class="updatedata" purpose="email">'+i+"</a>"})}catch(e){}return e},getDisplayContent:function(e){return e=Smiley.replace(e),e=Message.trim(e)},isLocalUser:function(e){return e==myMsgObj.sender},isHeader:function(e,t){return t&&t!=Message.presender},isSameBrowser:function(e){return!e||e==LSMessanger.getSid()},updateLastMessagePostTime:function(){Message.lastMessagePostTime=(new Date).getTime()},getLastMessagePostTime:function(){return Message.lastMessagePostTime||0},send:function(e,t,a){var i=(new Date).getTime();Message.updateLastMessagePostTime(),this.displaySendMessage(e,t,a,i),a&&"credit_card"==a.type&&(t=a.rawmsg||t),LSMessanger.sendMessage(e,t,a,i)},displaySendMessage:function(e,t,a,i,n){t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),myMsgObj.chid=e,myMsgObj.msg=t,myMsgObj.scroll=!0,myMsgObj.uniqueid=i;var s=a&&"credit_card"==a.type;n&&(myMsgObj.reply_to=n),null==a||""==a||s||(myMsgObj.msg="<p style='"+a+"'>"+t+"</p>"),Message.formatAndDisplay(myMsgObj),delete myMsgObj.reply_to},formatAndDisplay:function(e){try{var t=$Support.chidmappinglist[e.chid]||e.chid,a=ZSIQConversationManager.getChatWinObjById(t),i=a.contentdiv,n=e.msg;"string"==typeof n&&(e.rawmsg=n);var s,r,o=n,l=e.sender,c=e.mod,g=e.istranslated,d="",u=e.msg&&e.msg.content&&-1!=e.msg.content.indexOf("audio"),p=e.msg&&e.msg.att_type&&"voice_note"==e.msg.att_type;if(u&&p){var m=Message.getAttachmentData(e);s=(r=ZSIQAudio.init(m,t)).getHTML()}if(null==e.scroll||e.scroll,n=Message.getDisplayContent(n),d=null!=c&&"att"==c?(n=Message.constructAttUrl(e,s),"chatwindow.sharing_a_file_with_you"):(e.msg=n,"cannedarticle"===e.mode&&(o=$FAQ.getHeaderMessage(e.msg)),n=Message.getMessageBlock(e,"",t,a),"common.says.msg"),i.find("#conversationoption").remove(),i.find("#skipquestion").remove(),ZSIQTranscript.updateTranscript({html:n,msgid:e.msgid,sender:e.sender},t),r&&r.init(),$Support.clearEndTimer(a),e.dname&&!Message.isLocalUser(l)){var f=LSResource.getRealValue(d,getUnescapedText(e.dname)+","+o);Message.handleBlinkTitle(f)}a.presender=l;var h=i.find("#consentbannerdiv");Message.isLocalUser(l)||e.convvisitorid&&("null"==l||$Support.Util.isAnnonUser(l))||g||0==h.length||$Support.hidetranslatebanner()}catch(e){}},updateMessageTime:function(e){try{var t=e.sender+"_"+e.msgid,a=($Support.chatdiv||$("#msgdiv")).find('div[msgid="'+t+'"]');if(0==a.length)return;var i=a.prev().attr("msgtime");if(i){var n=e.lmsgtime;if(i!=n&&3e3<n-i){var s=e.chid;return LSMessanger.transcript(s,$EmbedManger.getvwmsid()),LSDebugger.pushDebugInfo(e),void LSDebugger.postDebugInfo("Chat transcript mismatched | "+s+" | "+i+" | "+a.prev().text(),null,null,!0)}}var r=e.time;a.attr("msgtime",r)}catch(e){}},getAVMessageBlock:function(e,t){var a="string"==typeof e.media?JSON.parse(e.media):e.media,i=e.operation,n=JSON.parse(a.opruser),s=getEscapedText(n.dname),r=a.visitoraccess,o=MyDate.getHoursandMin(a.time,!0,"bclient"),l="none",c="",g=a.chatid?a.chatid:a.chid;t||$("#audiocall").is(":hidden")||(l="");var d="audio"==a.type,u=null==a.isConsentAllowed||a.isConsentAllowed,p=a.closedReason||"",m="screen_share"==a.type||"screen_view"==a.type;if(callagain_txt="<span class='sqico-call callagain-txt' style='display: "+l+"' id='audio_callagain' onclick='SiqAVRouter.container.audioImpl.startAudioCallAgain(\""+g+"\")'>"+LSResource.getRealValue("av.info.callagain")+"</span>","call_end"===i&&null!=a.duration&&""!=a.duration&&(d?c=LSResource.getRealValue("av.info.success"," "+a.duration)+callagain_txt:m&&(c=LSResource.getRealValue("screenshare.info.success"," "+a.duration)),!t)){var f={attenderemail:$Support.EmbedObj.attenderemail,duration:a.duration};$Support.Util.handleCallbacks("call.completed",f)}return"call_miss"===i&&(d?(c=LSResource.getRealValue("av.info.agent.missed")+callagain_txt,r&&(c=LSResource.getRealValue("av.info.visitor.missed",s)+callagain_txt)):m&&(c=LSResource.getRealValue("screenshare.info.agent.missed"),r&&(c=LSResource.getRealValue("screenshare.info.visitor.missed",s)))),"call_cancel"===i&&(d?(c=LSResource.getRealValue("av.info.visitor.cancelled",s)+callagain_txt,r&&(c=LSResource.getRealValue("av.info.agent.cancelled")+callagain_txt)):m&&(c=LSResource.getRealValue("ss.info.visitor.cancelled",s),r&&(c=LSResource.getRealValue("ss.info.agent.cancelled")))),"call_reject"===i&&(d?(c=LSResource.getRealValue("av.info.visitor.declined",s)+callagain_txt,r&&(c=u?LSResource.getRealValue("av.info.agent.declined")+callagain_txt:LSResource.getRealValue("av.info.agent.consentdeclined")+callagain_txt,c="mic_permission_blocked"==p?LSResource.getRealValue("av.info.agent.permissiondeclined")+callagain_txt:c)):m&&(c=LSResource.getRealValue("screenshare.info.visitor.declined",s),r&&(c="screen_permission_blocked"==p?LSResource.getRealValue("screenshare.info.agent.permissiondeclined"):LSResource.getRealValue("screenshare.info.agent.declined")))),"call_busy"===i&&(c=LSResource.getRealValue("av.info.visitor.declined",s)+callagain_txt),"call_failed"===i&&(d?c=LSResource.getRealValue("av.info.visitor.failed")+callagain_txt:m&&(c=LSResource.getRealValue("screenshare.info.visitor.failed"))),"monitor_join"===i&&(c=LSResource.getRealValue("av.info.monitor.join",s+","+o)),"monitor_end"===i&&(c=LSResource.getRealValue("av.info.monitor.left",s+","+o)),"<p title='"+o+"'>"+c+"</p>"},getMessageBlock:function(e,t,a,i){var n="";try{n=e.msg,sender=e.sender;var s=MyDate.getHoursandMin((new Date).getTime(),!0,"bclient");if("CT_INF_MSG"==sender)n='<div class="inf_msg">'+n+"</div>";else{var r=!1,o=getEscapedText(e.dname);i.presender&&i.presender===sender&&(r=!0);var l={sender:sender,dname:o,msg:n,time:s,previoussender:r,uniqueid:e.uniqueid,msgid:e.msgid,msguid:e.msguid,meta:$Widget.getMetaCardData(),chid:a};e.reply_to&&(l.reply_to=e.reply_to),"cannedarticle"===e.mode?(l.msg=n=ZSIQTranscript.getCustomArticleCard(e.msg),l.iscannedarticle=!0,l.cardheader=$FAQ.getHeaderMessage(e.msg),$Support.handleNewMessageInConversation(l)):"botrating"===e.mode&&(l.botrating=!0,l.ratinghtml=e.ratinghtml),e.bot_image&&(l.bot_image=e.bot_image),-1===a&&e.chid;var c=$.extend({},l);e.rawmsg&&(l.msg=e.rawmsg),$Support.updateChatCache(l,void 0,a),n=ZSIQTranscript.getTranscript(c,t,a)}}catch(e){}return n},displayInfo:function(e,t,a){ZSIQTranscript.updateTranscript({html:$UI.getInfoMsgHTML(e,t)},a)},getInfoHTML:function(e,t,a,i){var n=function(e,t){return t=t||"",LSResource.getRealValue(e,t)},s="",r=e.mode,o=($Support.EmbedObj,e&&e.opruser?e.opruser.dname:"");s={ACCEPT_TRANSFER:n("transcript.info.chattransfer",o=getEncodedText(o)),ACCEPT_FORWARD:n("transcript.info.acceptforward",o),FORWARD_SUPPORT:n("transcript.info.forwardsupport",o),JOIN_SUPPORT:n("transcript.info.joinsupport",o),REOPEN:n("transcript.info.reopen",o)}[r];if(-1<["ACCEPT_TRANSFER","ACCEPT_FORWARD","JOIN_SUPPORT"].indexOf(r)&&e){var l=ZSIQConversationManager.getChatWinObjById(e.chid);$BotImpl.enableComposer(),$UI.populateUserAction(l);var c=e.opruser;c.attendername=c.dname,!l.isBotChat||a||i||($Support.handleBotTransferAccept(e.chid),"JOIN_SUPPORT"===r&&!t&&l.setBotForwardedTime((new Date).getTime())),t||i||(l.attenderimagefkey=c.image_fkey,l.attender=c.lsuid,l.attenderaboutme=c.aboutme,delete l.isforwardchat,!$Support.isConversationUIFocussed()&&ZSIQConversationManager.isChatUIFocusses(l.chatID)&&$UI.setInnerHeader(c),l.attendername=getUnescapedText(c.dname),$Support.handleChatTransferInConversationListView(l)),$Support.updateChatCookie(l.chatID),$Support.setCookie(l);try{var g=ZSIQConversationManager.getChatWinObjById(l.chatID).RCHID;SiqAVRouter.container.detailsHandler.triggerIconCheck(g)}catch(e){}}else if("ACCEPT_FORWARD"==r)s=LSResource.getRealValue("transcript.info.acceptforward",o),$Support.setAttenderCookie(e.opruser,l.chatID);else if("FORWARD_SUPPORT"==r){var d=getEscapedText(e.info_message);s=(d=DynamicMsg.fillValues(d))||LSResource.getRealValue("transcript.info.forwardsupport",o)}else if("REOPEN"==r){var u=e.operation_user&&e.operation_user.name;u=ZSIQTranscript.isInValidVisitorName(u)?"You":getEscapedText(u),s=LSResource.getRealValue("transcript.info.reopen",u)}else if("JOIN_SUPPORT"==r)s=LSResource.getRealValue("transcript.info.joinsupport",o);else if("ADDSUPPORTREP"==r&&e)s=n("transcript.info.addrep",getEncodedText(e.userlist.dname));else if("bot_transfer_missed"==r)s=n("transcript.info.missed");else if("INVITE"==r){var p=e.type,m=e.opruser;o=getEscapedText(m.dname);if("audio"==p)s=n("transcript.info.visitor.requestaudiochat",o);else if("video"==p)s=n("transcript.info.visitor.requestvideochat",o);else if("meeting"==p){var f=e.opr;m.wmsid==$Support.EmbedObj.vwmsid?(s=n("transcript.info.sameuser.sharedesktop"),myMsgObj.sender&&(s+=" <a href='"+e.start_url+"' target='_blank' class='zsiq_ssjoinlink'>"+n("chatwindow.meeting.share.now")+"</a>")):s="request"==f?n("chatwindow.meeting.request",o)+(myMsgObj.sender?" <a href='"+e.start_url+"' target='_blank' documentclick='openmeeting' class='zsiq_ssjoinlink'>"+n("chatwindow.meeting.share.now")+"</a>":""):n("chatwindow.share.screen",o)+(myMsgObj.sender?" <a href='"+e.join_url+"' target='_blank' documentclick='openmeeting' class='zsiq_ssjoinlink'>"+n("chatwindow.meeting.joinnow")+"</a>":"")}}else if("MEDIA"===r)s=Message.getAVMessageBlock(e,a);else if("CHATMONITOR_JOIN"==r){l=ZSIQConversationManager.getChatWinObjById(e.chid);try{g=ZSIQConversationManager.getChatWinObjById(l.chatID).RCHID;SiqAVRouter.container.detailsHandler.triggerIconCheck(g)}catch(e){}s=n("transcript.info.addrep",o)}return s},getAttachmentData:function(e){var t=$Support.chidmappinglist[e.chid]||e.chid,a=ZSIQConversationManager.getChatWinObjById(t),i=e.sender,n=e.msg,s=($Support.EmbedObj,""!=a.presender&&a.presender==i);return{sender:i,dname:e.dname,msg:n,previoussender:s,file:{size:n.size,url:n.url,fName:n.fName,comment:n.comment},mode:"att",msgid:e.msgid,msguid:e.msguid,att_type:e.msg&&e.msg.att_type,reply_to:e.reply_to,time:MyDate.getHoursandMin(e.time,!0,"bclient")}},constructAttUrl:function(e,t){var a="";try{var i=$Support.chidmappinglist[e.chid]||e.chid,n=Message.getAttachmentData(e);e.msgid&&(n.file.msgid=e.msgid),$Support.updateChatCache(n,"",i),n.chid=i,a=ZSIQTranscript.getTranscript(n,"",i,t)}catch(e){}return a},display:function(e,t,a,i){if($("#msgdiv").length){var n,s=document.getElementById("msgmaindiv"),r=!0;if((s.scrollHeight-s.scrollTop==s.clientHeight||s.scrollHeight<s.clientHeight)&&(r=!1),ie||(e=util.optimizeFontForMozilla(e)),Message.isTypingShown()&&Message.isFirstMessageForTyping())if(Message.isLocalUser(i))ZSIQTranscript.removeTyping(!0);else{var o=!i;ZSIQTranscript.removeTyping(o);var l=$("<div/>").html(e).contents();if(l&&0<l.length)e=l.find(".msgbx").prop("outerHTML"),n=!0}var c=$Support.chatdiv.find('span[msgid="'+a+'"]');if(c.length)c.find(".filedet").replaceWith($(e).find(".filedet")),c.find(".fdload").replaceWith($(e).find(".fdload"));else{var g=$(".zsiq_transferdiv");0<g.length?(n||$(e).insertBefore(g),g.is(":visible")||g.show()):n||$Support.chatdiv.append(e),n&&$("#msgmaindiv .agntmsg").last().append(e)}var d=$("#msgdiv > .ziq_msg").last();if(!r||t)return void Message.scroll(s,d);Message.animate(d)}},animate:function(e,t,a){if(e){var i=t?{right:"auro",left:"-20px",opacity:"0"}:{right:"0",left:"0",opacity:"1"};e.animate(i,300,function(){a&&a(e)})}},isTypingShown:function(){return 0<$("#siq_bottype").length},isFirstMessageForTyping:function(){return $("#siq_bottype").parent().attr("frstmsg")},scroll:function(e,t){e&&$(e).animate({scrollTop:e.scrollHeight-e.offsetHeight},250,function(){Message.animate(t)})},handleBlinkTitle:function(e){$EmbedManger.isComposerFocused()||parent==self&&$EmbedManger.iswindowfocused()||Message.blinkTitle(e)},blinkTitle:function(e){var t=$Support;t.isblinking||(t.documenttitle=document.title,t.isblinking=!0),Message.startBlinking(e),$Support.getParent().$ZSIQUtil.blinkTitle(e)},startBlinking:function(e){if(!e)return!1;clearTimeout($Support.blinktimer);var t,a="";$Support.blinktimer=setInterval(function(){t="title"==t?(a=e,"chmsg"):(a=$Support.documenttitle,"title"),document.title=a},500)},stopBlinking:function(){$Support.getParent().$ZSIQUtil.stopBlinking(),$Support.isblinking&&(clearTimeout($Support.blinktimer),$Support.isblinking=!1,document.title=$Support.documenttitle)},checkCardMask:function(e){for(var t=e.split("").map(Number),a=0,i=t.length,n=i%2,s=0;s<t.length;s++){var r=t[s];s%2==n&&(r*=2),9<r&&(r-=9),a+=r}if(a%10==0){var o=e.split("");switch(i){case 13:return o.splice(0,9,"XXX-XXX-XXX-"),o.join("");case 14:return o.splice(0,10,"XXX-XXX-XXXX-"),o.join("");case 15:return o.splice(0,11,"XXX-XXXX-XXXX-"),o.join("");case 16:return o.splice(0,12,"XXXX-XXXX-XXXX-"),o.join("")}}return!1},checkMaskOccurance:function(e,t){var a=!1,i=[];if((i=e.match(/\b(((\d)+([-]|\s)*)+(\d)+)\b/g))&&i.length)for(var n=0;n<i.length;n++){var s=i[n].match(/\d+/g).join(""),r=s.length;if(!(r<13||16<r)){var o=Message.checkCardMask(s);o&&(a=!0,e=e.replace(i[n],o))}}return t?a:e},updateMsguid:function(e){var t=e.msgobj.msgid;e.chatdiv&&e.chatdiv.find("#"+t).attr("msg-id",e.msgobj.msguid);var a=$Support.getTranscriptFromSession(e.chatID)||[],i=a.length;if(i){for(var n=i-1;0<=n;n--){var s=a[n];if(t==(s.uniqueid||s.msgid)){s.msguid=e.msgobj.msguid;break}}$EmbedManger.updateChatCache(a,!0,e.chatID)}}});var dext=".ls",CURCONID=-1,SUPPORT_REPS={};_SUBDOMAIN="zoho.com",_JOINED=!1;var _AGENT_ONLINE=!(_WMSACK=!1),MONITOR_TIMER=0,IGNORE_ENCODE=[CT_TXT_MSG];function print(e){try{var t=document.getElementById("debug");t.innerHTML=e+"<br>"+t.innerHTML}catch(e){}}function printtime(){print(new Date)}function LSgetPrd(){return LSMessanger.getPrd()}function LSgetAuthType(){return 0}function LSgetUserName(){return LSMessanger.getUserName()}function LSgetNickName(){return LSMessanger.getNickName()}function LSgetUserId(){return LSMessanger.getUserId()}function LSgetSid(){return LSMessanger.getSid()}var lpt,pmonInterval=15e3;function LSplive(){lpt=new Date}function LSMessanger(){}LSMessanger.init=function(){this.rchid=-1},LSMessanger.setRCHID=function(e){LSMessanger.rchid=e},LSMessanger.getRCHID=function(){return LSMessanger.rchid},LSMessanger.deleteSid=function(){delete LSMessanger.sid},LSMessanger.register=function(e,t){try{setTimeout(function(){LSDebugger.postDebugInfo("Visitor Side before registor : "+t,null,"",!0)},1)}catch(e){}if(e){if(!t)return!1;this.prd=e,this.uname=t,LSMessanger.init(),_WMSPUBLICDOMAIN&&WmsLite.enablePreconnectToWMS(_WMSPUBLICDOMAIN),WmsLite.setNoDomainChange(),WmsLite.setAuthType(0),WmsLite.setJSStaticDomain(_WMSJSSTATICDOMAIN),WmsLite.forceDomainChange();var s=_SCHEMA+"://"+_EMBEDSERVERURL;WmsLite.allowCrossOrigin(s),WmsLite.setWmsContext("salesiq"),WmsLite.setConfig(79),WmsLite.registerAnnon(e,this.uname,this.nname)}else $EmbedManger.UI.showProcess(LSResource.getRealValue("common.serverconnectingerror")+" <a href='javascript:void(0)' onclick='window.location.reload()'>"+LSResource.getRealValue("common.reload")+"</a>")},LSMessanger.getUserName=function(){return this.uname},LSMessanger.getNickName=function(){return this.nname},LSMessanger.setNickName=function(e){this.nname=e},LSMessanger.getUserId=function(){return this.uid},LSMessanger.getPrd=function(){return this.prd},LSMessanger.getSid=function(){return this.sid},LSMessanger.disable=function(){WmsLite.disablewms=!0},LSMessanger.isdisablewms=function(){return WmsLite.disablewms},LSMessanger.push=function(t,e,s){try{var a=parseInt(t.mtype);0<a&&-1===IGNORE_ENCODE.indexOf(a)&&t.msg&&(t.msg=getEncodedObject(t.msg))}catch(e){}var n=$EmbedManger;try{var i=JSON.parse(JSON.stringify(t));setTimeout(function(){try{var t=$Support.getParent();SiqAVRouter.container.lsrouter.handleMessage(i),t.$zohosq.setValue("isInitialLoad",!1),t.$zohosq.setValue("initialLoadData","")}catch(e){!(t=$Support.getParent()).$zohosq.values.isMediaLibraryLoaded&&$Support.EmbedObj.staticfiles_delayloading_enabled&&($Support.getMediaLibraryJS(),t.$zohosq.setValue("isMediaLibraryLoaded",!0),t.$zohosq.setValue("isInitialLoad",!0),t.$zohosq.setValue("initialLoadData",i))}})}catch(e){}if(null!=t&&!_WMSDOWN)if(0==t.mtype){var r=null!=this.sid;(I=t.msg)&&(this.uid=I.uid,this.sid=I.sid),myMsgObj.sender=this.uname,myMsgObj.nname=this.nname,myMsgObj.dname=this.nname,SUPPORT_REPS={},_WMSACK=!0;var o=$Support.isChatExist(),d=($Support.getCookieValue("ZLD"+$Support.EmbedObj.livelsid)||{}).ongoingchats||"",p=$Support.getQueueingCookie().ongoingchats||{},g=n.getVisitorID();try{setTimeout(function(){LSDebugger.pushDebugInfo(WmsLite.getDebugInfo()),LSDebugger.postDebugInfo("Visitor Side after registor : "+myMsgObj.sender+" : "+myMsgObj.nname+g+" Join status-"+_JOINED+" RSID - "+I.sid,null,"",!0)},1)}catch(e){}if($Support.joinedchatkeys=[],o){var u=n.getWaitingCookie();if(!$NE&&u)return;$NE&&e&&$Support.removeCacheCookie(),u&&n.reJoin(),d&&$Support.makeJoinChat(e,s),p&&$Support.initiateJoinchat(e,s,p)}else-1!=g?($Support.joinedchatkeys=[],n.reJoin()):-1!=g||r||($Support.reopenobj?$Support.reOpenChat($Support.reopenobj):n.addVisitor());$Support.setTabOwner()}else if(-3==t.mtype||-4==t.mtype)$Support.joinedchatkeys=[],$Support.makeJoinChat(e,s);else if(10==t.mtype){var m=(I=t.msg).chid,c=$Support.chidmappinglist[m],S=ZSIQConversationManager.getChatWinObjById(c);LSMessanger.setRCHID(m);for(var l=SUPPORT_REPS[c]||{},h=0;h<I.users.length;h++){var f=I.users[h];l[f.uname]&&(l[f.uname].ismonitor=!1)}S.isBotChat&&1<Object.keys(l).length&&S.contentdiv.find(".zsiq_transferdiv").remove(),I.users.length&&n.UI.showAgentStatus(),LSMessanger.transcript(c,n.getvwmsid())}else if(t.mtype==CT_READ){var I=t.msg;$Support.updateRead(I.chid)}else if(t.mtype==CT_TXT_EDIT){var v=t.msg;$Support.updateMessageEdit(v)}else if(t.mtype==CT_TXT_DELETE){"true"==(v=t.msg).isdeleted&&$Support.updateMessageDelete(v)}else if(t.mtype==CT_TXT_MSG)try{(I=t.msg).msguid=$Support.formatMsgUid(I.msguid);var M=$Support.EmbedObj,C=$Support.chidmappinglist[I.chid];if(!(S=ZSIQConversationManager.getChatWinObjById(C)).reopenwaiting&&LSMessanger.joinchat(C,n.getvwmsid()),EmbedSound.isPlaying("endtimer")&&EmbedSound.stop(),"content_moderation"==I.module){var b=$Support.EmbedObj.curraddvistid;!$Support.chidmappinglist[I.chid]&&b&&(C=I.chid=b,S=ZSIQConversationManager.getChatWinObjById(b)),I=$Support.Util.handleAbusiveDetectionMsgObj(I,!0),ZSIQTranscript.removeTyping()}var y=I.sender;if(Message.isLocalUser(y))Message.isSameBrowser(I.sid)||Message.formatAndDisplay(I);else{var _=$BotImpl.isBotMessage(I),E=!1;try{E=SiqAVRouter.container.commonImpl.getActiveCallData()==I.chid}catch(e){}KeyHandler.isWindowFocused()||_||E||!S.isSoundOff()&&EmbedSound.play("smessage");var O=I.msg;if(I.msg=$Support.Util.sanitizeMessage(O),"content_moderation"!=I.module&&I.nname&&y&&y.split("_")[2]==S.attender&&(S.attendername=I.nname),_){var L=I.meta||{},T=L.handoff_config||{};if(T){if(L.hand_off)($Support.getDeptObjByID(S.department)||{}).ONLYBOTSAVAILABLE=!1,T.hand_off=L.hand_off;$Support.storeHandoffConfig(T,C)}$BotImpl.formatAndDisplay(I)}else I.meta&&"resource_share"==I.meta.type?(I=$Support.formatObjforResourceSharing(I),$Support.clearEndTimer(S),$BotImpl.formatAndDisplay(I)):Message.formatAndDisplay(I);O=O.replace(/<span[^>]*?>/gi,"").replace(/<\/span>/gi,"").replace(/<br>/gi,"\r\n");var U={visitid:S.VISITID,message:O,attendername:S.attendername,attenderemail:S.attenderemail};n.handleCallbacks("visitor.chatmessage",U),Self.status.clear(S),($Support.isFloat()&&$Support.getTabOwner()==LSMessanger.getSid()&&parent.$ZSIQWidgetUI.getWidgetState()==parent.$ZSIQWidgetUI.F_BUTTON||$Support.isConversationUIFocussed()||!ZSIQConversationManager.isChatUIFocusses(C)||$Support.isFAQUIFocussed())&&$Support.incrementUnreadCount(C),$Support.handleReadMessage(I),$Support.removeReadReciptUI(I.chid)}Message.isLocalUser(y)&&$Support.EmbedObj.ismessageopr_allowed&&Message.updateMsguid({msgobj:I,chatdiv:S.chatdiv,chatID:S.chatID}),Message.updateMessageTime(I),I.chid=$Support.chidmappinglist[I.chid]||I.chid,$Support.handleOnGoingchatActionsInConversation("newmsg",I)}catch(e){LSDebugger.pushDebugInfo("Exception stack: "+e.stack||e.stacktrace||""),LSDebugger.postDebugInfo("Failed in Message rendering | Exception "+e+" | chid - "+(t.msg&&t.msg.chid)+" | sid - "+LSMessanger.getSid(),null,null,!0)}else if(t.mtype==CT_NFY_USERSTATUS){I=t.msg,c=$Support.chidmappinglist[I.chid],l=SUPPORT_REPS[c]||{};try{l[I.uname]&&(I.ismonitor=0!=I.ismonitor,l[I.uname]=I),n.UI.showAgentStatus()}catch(e){}}else if(t.mtype==CT_NFY_USERADD){I=t.msg,c=$Support.chidmappinglist[I.chid],l=SUPPORT_REPS[c]||{};try{var R=I.users;for(h=0;h<R.length;h++)l[R[h].uname]=R[h];n.UI.showAgentStatus()}catch(e){}}else if(t.mtype===NFY_ENDLIVESUPPORT||t.mtype===CT_NFY_LEAVESUPPORT){I=t.msg,c=$Support.chidmappinglist[I.chid],O=I.msg,S=ZSIQConversationManager.getChatWinObjById(c)||{};var D=O&&O.total_typing_delay,A=S.isBotChat&&D&&parseInt(D)>parseInt(O&&O.typing_delay),N=I.msg&&I.msg.action;try{LSDebugger.postDebugInfo("Chat flow debug | End Chat notified to visitor session "+LSMessanger.getSid()+" | "+I.chid,null,null,!0)}catch(e){}parent.$ZSIQCookie.remove("isiframeenabled"),LSMessanger.disable();var j=$Support.joinedchatkeys,w=j.indexOf(c);if(-1!=w&&j.splice(w,1),S.callquitstatus)return;if($Support.EmbedObj.curraddvistid&&"content_moderation_end"==N&&$.isEmptyObject(S))return void(ZSIQConversationManager.getChatWinObjById($Support.EmbedObj.curraddvistid).abusiveendedchid=I.chid);if(!A&&n.updateChatCookie(S.chatID),S.isBotChat&&(ZSIQTranscript.removeTyping(!0),$Widget.removeComponent(S),O&&O.replies&&(O.sender=I.sender,$Support.showRepliesNow(O))),n.isNewEmbed){var P={msgObj:I,currwinobj:S,chatendmode:N};return A?(P.endactiondelay=D,void S.handleDelayEndAction(P)):void $Support.handleEndActionInCoversation(P)}n.setQuitStatus(!0),t.mtype===CT_NFY_LEAVESUPPORT?(Message.displayInfo(LSResource.getRealValue("visitorchat.supportchat.ended"),"chtend",S.chatID),n.UI.showFeedback(O)):(Message.displayInfo("","",S.chatID),n.UI.handleEndSupport(I)),n.handleChatEnded(I,S)}else if(t.mtype==NFY_LS_OPERATIONS){I=t.msg,c=$Support.chidmappinglist[I.chid];if("MEDIA"==(se=I.module)&&"string"==typeof I.msg&&(I.msg=JSON.parse(I.msg)),I.msg&&"cannedarticle"===I.msg.mode)Message.formatAndDisplay(I.msg),($Support.isFloat()&&$Support.getTabOwner()==LSMessanger.getSid()&&parent.$ZSIQWidgetUI.getWidgetState()==parent.$ZSIQWidgetUI.F_BUTTON||$Support.isConversationUIFocussed()||$Support.isFAQUIFocussed())&&$Support.incrementUnreadCount($Support.chidmappinglist[I.chid]),$Support.isFAQEnabled()&&$FAQ.updateMessageCount("newmsg");else if(I.msg&&"bot_progress_info"===I.msg.module)$Support.handleBotProgressInfo(I.msg.info);else if("mailchimp"==se){(W=I.msg).name&&n.setVisitorName(W.name),W.email&&n.setVisitorEmail(W.email),n.UI.updateVisitorName(W),$Support.storeInCookie("mailchimp",JSON.stringify({email:W.email,name:W.name}),31e4)}else if("desktopsharing"==se||"MEDIA"==se||"VISITORNAMECHANGE"==se||"acceptforward"==se||"forwardsupport"==se||"acctranschat"==se||"addsupportrep"==se||"deletemember"==se||"transchat"==se||"updatechatparticipant"==se||"joinsupport"==se||"missed"==se){if(("acctranschat"==se||"joinsupport"==se)&&$Support.checkAndRemoveBotattender(c),n.UI.formatAndDisplayInfo(c,I.msg,I.addinfo),n.updateChatCache({msg:I.msg},"",c),"joinsupport"==se)(B=ZSIQConversationManager.getChatWinObjById(c)).populateIcon(),$Support.handleJoinSupport(c);if("desktopsharing"===se)(B=ZSIQConversationManager.getChatWinObjById(c)).endtimer&&$Support.clearEndTimer(B);if("VISITORNAMECHANGE"===se){var W=I.msg.VISITORDATA;"[object Object]"===Object.prototype.toString.call(W)&&(W.name&&n.setVisitorName(W.name),W.email&&n.setVisitorEmail(W.email),W.phone&&n.setVisitorPhone(W.phone),n.UI.updateVisitorName(W)),n.UI.hideVisitorInfo()}if("acctranschat"==se){var B;n.UI.hideGroupIcon(),(B=ZSIQConversationManager.getChatWinObjById(c)).chatstatus="connected",B.populateIcon();U={visitid:n.getVisitID(),attendername:I.dname,department:I.deptname,attenderemail:I.attenderemail};n.handleCallbacks("agent.accepttransfer",U);document.querySelectorAll("#audio_callagain");B.attenderemail=I.attenderemail;var F=SUPPORT_REPS[c][I.uname];SUPPORT_REPS[c]={},SUPPORT_REPS[c][I.uname]=F,$Support.getWaitingHandlerCookie(B)&&($Support.removeWaitingStorages(B),$Support.handleOnGoingchatActionsInConversation("pickupchat",B),$Support.setCookie(B))}if("addsupportrep"==se){var k=I.msg&&I.msg.userlist||{};(l=SUPPORT_REPS[c]||{})[k.uname]=k,n.UI.showGroupIcon()}if("deletemember"==se){R=I.uname;delete(l=SUPPORT_REPS[c]||{})[R],n.UI.showAgentStatus()}if("transchat"==se){var Q=I.msg;U={visitid:n.getVisitID(),currentuser:Q.opruser.dname,transfertype:Q.type,transfername:Q.transferdetails.transfername};n.handleCallbacks("agent.transferchat",U)}else if("updatechatparticipant"==se){var V=ZSIQConversationManager.getChatWinObjById(c);"CHATMONITOR_JOIN"==(Q=I.msg).mode&&(SUPPORT_REPS[c][I.uname]={nnmae:I.nname},$Support.isBotChat&&V.contentdiv.find(".zsiq_transferdiv").remove())}else if("forwardsupport"==se){var Z=ZSIQConversationManager.getChatWinObjById(c),q=I.msg||{},x="queueing"==Z.chatstatus&&q.average_response_time&&q.current_position;Z.isforwardchat=!0,Z.setBotForwardedTime(q.time),!x&&$Support.hideTransferOption(c),$Support.storeHideTransfer(c),$Support.handleBotForwardQueue(Z,I.msg),$Support.deleteBotCookie(c,q.time)}}else if("blockip"==se){if(n.setIPBlockStatus(!0),"float"==n.getType()||"personal"==n.getType()){var H=ZSIQConversationManager.getChatWinObjById(c);SiqAVRouter.container.detailsHandler.endCall(t.msg.chid),$(parent.document.body).find(".siq_media").remove(),$Support.checkAbusiveChatEndOnWaiting(H),n.quit(H)}}else if("addsupportrep"==se){k=I.msg.userlist;(l=SUPPORT_REPS[c]||{})[k.uname]=k,n.UI.showAgentStatus()}else if("updatechatparticipant"==se){k=I.msg.userlist;(l=SUPPORT_REPS[c]||{})[k.uname]=k,n.UI.showAgentStatus()}else"bottransfer"===se&&$Support.handleBotTransfer(t.msg,c)}else if(t.mtype==NFY_USER_IDLE){(U=t.msg).msg="",Self.status.update(U),$Support.handleOnGoingchatActionsInConversation("typingstatus",U)}else if(t.mtype==NFY_USER_ENTERED){(U=t.msg).msg=n.isNewEmbed?"":LSResource.getRealValue("infomsg.enteredtext",U.dname),Self.status.update(U),$Support.handleOnGoingchatActionsInConversation("typingstatus",U)}else if(t.mtype==NFY_USER_TYPING){U=t.msg,c=$Support.chidmappinglist[U.chid],S=ZSIQConversationManager.getChatWinObjById(c);var G=n.isNewEmbed?"ne.infomsg.istyping":"infomsg.istyping",J=getEscapedText(U.nname);U.msg=LSResource.getRealValue(G,U.dname),Self.status.update(U),$Support.handleOnGoingchatActionsInConversation("typingstatus",U);M=$Support.EmbedObj;var z=U.sender?U.sender.split("_")[2]:"";if(S.attender==z&&$.trim(S.attendername)!=$.trim(U.nname)){var Y=$Support.getParent().$ZSIQUtil.getAvuid();$Support.LSDB.storeInSession(Y+"_conversation",""),$Support.convlistcontainer.find("#pastchatconv").html("");var K="";1==$Support.convlistcontainer.find("#currchatconv").find(".siqc_cntbody").length&&(K=$($Support.convlistcontainer.find("#currchatconv").find(".siqc_cntbody")[0]).attr("chid")),$Support.PopulateConversationList(function(e,t){if(e.length){var s="";e.forEach(function(e){K!=e.chid&&(e.question=getEscapedText(e.question),s+=$Temp.getConversationHistoryHTML(e))}),t?$Support.convlistcontainer.find("#pastchatconv").prepend($(s)):$Support.convlistcontainer.find("#pastchatconv").append(s)}}),S.attendername=U.nname,$("#attname").html(J),$("#convchatattendername").html(J),LSMessanger.transcript(c,LSMessanger.getUserId(),!0),$Support.removeCookie("ZLD"+M.livelsid)}}else if(t.mtype==CT_ATT_MSG){if(!(U=t.msg).msg||!U.msg.att_type||"recording"!=U.msg.att_type){M=$Support.EmbedObj,c=$Support.chidmappinglist[U.chid],S=ZSIQConversationManager.getChatWinObjById(c);if(U.msgid||(U.msgid=(new Date).getTime()),U.msguid=$Support.formatMsgUid(U.msguid),Message.formatAndDisplay(U),n.UI.clearProgress(),!Message.isLocalUser(U.sender)){KeyHandler.isWindowFocused()||!S.isSoundOff()&&EmbedSound.play("smessage");var X=U.msg,ee={visitid:n.getVisitID(),message:LSResource.getRealValue("chatwindow.sharing_a_file_with_you",U.dname),filesize:getMemSize(X.size),filename:X.fName,sender:U.sender,dname:U.dname,content:X.content,attendername:M.attendername,attenderemail:M.attenderemail};n.handleCallbacks("visitor.chatmessage",ee),($Support.isFloat()&&$Support.getTabOwner()==LSMessanger.getSid()&&parent.$ZSIQWidgetUI.getWidgetState()==parent.$ZSIQWidgetUI.F_BUTTON||$Support.isConversationUIFocussed()||!ZSIQConversationManager.isChatUIFocusses(c)||$Support.isFAQUIFocussed())&&$Support.incrementUnreadCount(c)}Message.isLocalUser(U.sender)&&M.ismessageopr_allowed&&Message.updateMsguid({msgobj:U,chatdiv:S.chatdiv,chatID:S.chatID}),Message.updateMessageTime(U),U.chid=c,$Support.handleOnGoingchatActionsInConversation("newmsg",U),$Support.handleReadMessage(U)}}else if(t.mtype==WM_CUSTOM){var te=t.msg,se=te.module,ae=$Support.chidmappinglist[te.rchid||te.chid]||te.chid,ne=ZSIQConversationManager.getChatWinObjById(ae);if("pickupsupport"===se){try{LSDebugger.postDebugInfo("Chat flow debug | Pickup chat notified to visitor session "+LSMessanger.getSid()+" | "+te.visitorid,null,null,!0)}catch(e){}if(LSMessanger.setRCHID(te.rchid),te.hand_off&&te.handoff_config){var ie=te.handoff_config;ie.hand_off=te.hand_off,$Support.storeHandoffConfig(ie,ae)}n.handlePickUp(te)}else if("audiovideo"===se)ZAudioVideo.handleStatus(te);else if("desktopsharing"===se)n.handleDesktopSharing(te),($Support.isFloat()&&$Support.getTabOwner()==LSMessanger.getSid()&&parent.$ZSIQWidgetUI.getWidgetState()==parent.$ZSIQWidgetUI.F_BUTTON||$Support.isConversationUIFocussed()||$Support.isFAQUIFocussed())&&$Support.incrementUnreadCount(ae);else if("actendsession"===se||"endsupport"==se)n.handleEndSession(te);else if("joinproactivechat"===se){t=te.data;Message.isSameBrowser(t.sid)||n.handleJoinProActive(t)}else"missed"===se?$Support.handleMissedVisitor(!0,"","","",ZSIQConversationManager.getChatWinObjById(ae)):"audiovideocall"===se||("skipoffline"===se?$Support.handleBotSkipOffline(ae):"botbusy"===se?$Support.handleBotBusy(ae):"bottransfermissed"===se?$Support.handleBotTransferMissed(ae):"vtranslanguage"===se?$Support.handleVTransLang(t.msg):"noagentsavailable"==se?$Support.handleAgentsOfflineForTransfer(ae):"current_queue_position"==se?ne.handleQueuePositionChange(te):"dequeue_chat"==se&&ne.handleDequeueChat(te))}else if(t.mtype==CT_NFY_MSG){(U=t.msg).sender!=myMsgObj.sender&&Message.formatAndDisplay(U)}else if(t.mtype==NFY_PUSH_MSG)($Support.isFloat()&&$Support.getTabOwner()==LSMessanger.getSid()&&parent.$ZSIQWidgetUI.getWidgetState()==parent.$ZSIQWidgetUI.F_BUTTON||$Support.isConversationUIFocussed()||$Support.isFAQUIFocussed())&&$Support.incrementUnreadCount();else if(t.mtype==CT_NFY_USERDELETE){for(R=(I=t.msg).users,c=$Support.chidmappinglist[I.chid],l=SUPPORT_REPS[c]||{},h=0;h<R.length;h++)delete l[R[h].uname];n.UI.showAgentStatus()}else if(t.mtype==CT_INF_MSG&&t.msg.msg&&"USER DELETED"==t.msg.msg.mode){var re=Object.keys(t.msg.msg.userslist)[0],oe=$Support.chidmappinglist[t.msg.chid];SUPPORT_REPS[oe][re]&&delete SUPPORT_REPS[oe][re],SiqAVRouter.container.detailsHandler.triggerIconCheck(t.msg.chid)}else if(t.mtype==WM_DNAME_UPDATE&&$Support.isChatExist()){var de=t.msg.dname;LSMessanger.setNickName(de),myMsgObj.dname=de,n.setVisitorName(de),n.setCookie()}else t.mtype==WM_WebRTC_MSG||t.mtype==WM_AV_MSG&&"AV_NRSCALLBACK"!=t.msg.module&&(t.msg.msg&&(t.msg.msg=JSON.parse(t.msg.msg)),t.msg.msg.media&&(t.msg.msg.media=JSON.parse(t.msg.msg.media)))},LSMessanger.getMediaObj=function(e){return avimpl.newflow?mediaAction:e.isConf?mediaAction:avaction},LSMessanger.joinchat=function(e,t,s,a){var n=ZSIQConversationManager.getChatWinObjById(e),i=n.visitorID,r=$Support.joinedchatkeys;if(e&&(!r||-1==r.indexOf(e))&&-1!=e){var o=$EmbedManger,d=lsnocachefix("json",!1);d.chid=e,d.sid=encodeURIComponent(LSMessanger.getSid()),o.getuvid()&&-1===i&&(d.uvid=o.getuvid()),t&&(d.wmsid=t),d.visitorid=encodeURIComponent(i),s&&(d.isntwrkreconnect=s),a&&(d.isserverupwithoutserverdown=a),n.proactive&&(d.isproactive=!0),$.ajax({url:$Support.getAjaxURL("joinchat",dext),type:"POST",data:d,dataType:"json",success:function(e){if(e){var t=e[0],s=t.objType,a=t.objString;if(a.chid&&!a.ERROR)return $Support.pushToJoinChat(a.chid),void(a.participantlist&&(SUPPORT_REPS[a.chid]=a.participantlist));if("object"==s&&"CHATENDED"==a.ERROR){var n=a.chid,i=ZSIQConversationManager.getChatWinObjById(n),r=a.CHATDETAILS;if($Support.chidmappinglist[i.abusiveendedchid]==n&&r.msg&&(r.msg.action="content_moderation_end",r.chid=i.winid,$Support.handleOnGoingchatActionsInConversation("missedchat",r)),i.callquitstatus)return;if(LSMessanger.disable(),o.isNewEmbed)return i.showChatUI(),$Support.checkAbusiveChatEndOnWaiting(i),o.handleChatEnded(r,i),o.updateChatCookie(n),void delete i.abusiveendedchid;o.setQuitStatus(!0),$("#waitingform").hide(),o.showChatUI("","",i),o.UI.handleEndSupport(r),o.handleChatEnded(r),o.updateChatCookie(n)}"error"===s&&(o.UI.resizequestion||o.UI.postMessage("size","shrink"),o.removeChatCookie(),document.location.reload())}}})}},LSMessanger.transcript=function(t,e,i){var s=ZSIQConversationManager.getChatWinObjById(t);if(-1!=t&&!$.isEmptyObject(s)){var r=$EmbedManger,a=r.getType();null!=a&&"null"!=a||(a="embed"),"personal"==a&&(a="float");var n="",o=s.visitorID;n+=-1!==o?"&visitorid="+o:"&uvid="+r.getuvid();var d=function(e){if($.trim(e)){$("#waitingform").hide();var t={},s=r.UI.embeddiv();if(-1!=e.indexOf("transcript.try.after.sometime"))return s.find("#embedcontainer").html(""),void r.UI.displayInfo(LSResource.getRealValue("transcript.try.after.sometime"));if(!$.isEmptyObject(e)){var a=e[0].chid;t=ZSIQConversationManager.getChatWinObjById(a)}if(t.proactive&&$Support.isSessionTranscriptEmpty(a)){r.updateChatCache(e,!0,a);var n=ZSIQConversationManager.getcurrchatwinobj();$Support.container.find('[proptype="siqform"]').remove(),$Support.container.find('[proptype="siqemptybg"]').remove(),n.contentdiv&&n.contentdiv.hide(),ZSIQConversationManager.resetLastViewd(),$Support.removeEndedChatInstanceAndElement(),$Support.Util.populateTriggerUI(t),t.chatmaindiv&&t.chatmaindiv.addClass("bot_chat"),t.chatstatus="connected"}else $Support.EmbedObj.embednewconfenabled&&ZSIQTranscript.isTypingShown(t.chatdiv)||r.showChatUI(e,i,t),r.updateChatCache(e,!0,a);r.isautotrigger()||r.UI.showVisitorInfo(),SiqAVRouter.container.detailsHandler.triggerIconCheck(t.RCHID),$Support.EmbedObj.allow_multiplechat&&$Support.isConversationUIFocussed()&&$Support.container.find("#showsiqchatui").show(),r.UI.resizeWindow(),LSMessanger.resendMessages(RESEND_AUTO,t.chatID),$Support.isFAQUIFocussed()&&$Support.incrementUnreadCount(t.chatID),t.queueTimer?$Support.handleOnGoingchatActionsInConversation("queueingchat",t):$Support.handleOnGoingchatActionsInConversation("newchat",t),$Support.updateReadMessageUI(e,t.chatID)}};if($Support.EmbedObj.ismessageopr_allowed){var p=$Support.getprefixURL()+"/visitor/v2/"+_SCREENNAME,g="limit=100&from=bottom";return p+=-1==o?"/visitors/"+r.getuvid()+"/messages?chat_id="+t+"&"+g:"/conversations/"+o+"/messages?"+g,void $.ajax({url:p,type:"GET",beforeSend:function(e){e.setRequestHeader("X-SIQ-Channel","website")},success:function(e){d($Support.formateVisitorTranscript(e,t))},error:function(){}})}var u=$Support.getAjaxURL("getvisitortranscript",dext);u+="?tzoffset="+_TZCOFFSET+"&uid="+e+"&type="+a+n+lsnocachefix(!0)+"&lang="+_LANG,_CCODE&&(u+="&ccode="+_CCODE);var m="";return r.isNewEmbed&&(m="json"),$.get(u,"",d,m),""}},LSMessanger.sendMessage=function(a,n,i,r,o){var e=ZSIQConversationManager.getChatWinObjById(a);if(_WMSDOWN||o&&-1==$Support.joinedchatkeys.indexOf(a))LSMessanger.handleResendFailed(a,n,i,r,o);else{var d=$EmbedManger;d.setCallbackargs(arguments);var t=-1!=["Editmsg","Deletemsg","Replymsg"].indexOf(i&&i.type),s=i&&"Deletemsg"==i.type;if(n&&$.trim(n)||s){var p=e.visitorID,g=$Support.getParent().$UTSHandler.getUTSSID();n=n.replace(/[\n\r]/gi,"\n");var u={text:getHtmlFreeText(n),session_id:LSMessanger.getSid(),client_message_id:r,timezone_offset:-1*(new Date).getTimezoneOffset()*6e4};if(!i||"credit_card"!=i.type&&"credit_card"!=i.msgtype||(u.type="credit_card"),i&&i.userid&&(u.user_id=i.userid),i&&i.botcommand&&(u.command=i.botcommand),g&&(u.uts_session_id=g),$Widget.getMetaData()){var m=$Widget.getMetaData();m.value="object"==typeof m.value?JSON.stringify(m.value):""+m.value,u.meta=JSON.stringify(m),$Widget.clearMetaData()}var c=p+"/messages",S="";t&&i&&(c+=i.url),S=t&&i?{method:i.method}:S,s&&(u=""),i&&"true"==i.iattach&&(u.comment=u.text,delete u.text),CommonUtil.handleAjaxReq(c,u,function(e){o&&(o==RESEND_AUTO?Message.displaySendMessage(a,n,i):o==RESEND_MANUAL&&($("#"+r).removeClass("resend"),$("#resendicon").hide(),$EmbedManger.UI.displayInfo(LSResource.getRealValue("infomsg.msgsent.success")),setTimeout(function(){$EmbedManger.UI.hideInfo()},2e3))),$Support.LSDB.getFromSession(a+"_failedmsg")&&LSMessanger.resendMessages(o,a)},function(e){var t=e.responseText&&JSON.parse(e.responseText)||{};t=t.error;var s=ZSIQConversationManager.getChatWinObjById(a);if(s.chatdiv.find("#"+r).find('[proptype="msgopr"]').remove(),t&&6001==t.code){if(s.callquitstatus)return;return s.showChatUI(),d.handleChatEnded({visitid:s.VISITID},s),void d.updateChatCookie(a)}LSMessanger.handleResendFailed(a,n,i,r,o)},S)}}},LSMessanger.handleResendFailed=function(e,t,s,a,n){$("#"+a).addClass("resend");var i=!!n;LSMessanger.storeFailedMessages(e,t,s,a,i),n==RESEND_MANUAL&&($EmbedManger.UI.displayInfo(LSResource.getRealValue("embed.msg.resendfail")),setTimeout(function(){$EmbedManger.UI.hideInfo()},2e3))},LSMessanger.storeFailedMessages=function(e,t,s,a,n){var i=$("#"+a),r=$Support.LSDB.getFromSession(e+"_failedmsg"),o={chid:e,msg:t,properties:s,uniqueid:a};r&&0<r.length?n?r.splice(0,0,o):r.push(o):(r=new Array(o),i&&i.find(".msgbx").append($EmbedManger.UI.getResendIcon())),$Support.LSDB.storeInSession(e+"_failedmsg",r)},LSMessanger.sendPredictMessage=function(e,t){if(t&&-1!==t.vid&&0!=$.trim(e).length){var s={session_id:LSMessanger.getSid(),message:e},a=t.vid+"/predictmessage";CommonUtil.handleAjaxReq(a,s,function(){})}},LSMessanger.setSubDomain=function(e){_SUBDOMAIN=e},LSMessanger.getSubDomain=function(){return _SUBDOMAIN},LSMessanger.resendMessages=function(e,t){var s=(t=t||ZSIQConversationManager.getcurrchatwinobj().chatID)+"_failedmsg",a=$Support.LSDB.getFromSession(s);if(a&&!(a.length<1)){var n=a.shift();$Support.LSDB.storeInSession(s,a),LSMessanger.sendMessage(n.chid,n.msg,n.properties,n.uniqueid,e)}};function DynamicMsg(){this.init()}DynamicMsg.init=function(){DynamicMsg.values={},DynamicMsg.labelsmap={"company.name":"clearbit_reveal_companyname","company.location":"clearbit_reveal_location","company.website":"clearbit_reveal_domain","company.employeecount":"clearbit_reveal_employees","company.annualrevenue":"clearbit_reveal_annualrevenue","company.marketcapital":"clearbit_reveal_marketcap","company.fundraised":"clearbit_reveal_raised","company.type":"clearbit_reveal_type","company.twitterfollowers":"clearbit_reveal_followers","company.facebooklikes":"clearbit_reveal_likes","company.industrytype":"clearbit_reveal_industry","company.sector":"clearbit_reveal_sector","employment.title":"clearbit_enrichment_title","employment.name":"clearbit_enrichment_name","employment.role":"clearbit_enrichment_role","employment.location":"clearbit_enrichment_location","employment.city":"clearbit_enrichment_city","employment.country":"clearbit_enrichment_country","employment.state":"clearbit_enrichment_state","employment.bio":"clearbit_enrichment_bio","attender.name":"attendername","attender.email":"attenderemail","visitor.name":"name","visitor.id":"visit_id","visitor.email":"email","visitor.phone":"phone","visitor.department":"department","visitor.question":"question","visitor.ip":"ip","visitor.country":"country","visitor.pagetitle":"title","visitor.pageurl":"currentpage","visitor.referrer":"referrer","visitor.timezone":"localtime","visitor.operating.system":"os","visitor.browser":"browser","visitor.browser.version":"browserversion","smart.timenow":"smart_timenow","screen.resolution":"screen","web.embed.name":"embed"},$EmbedManger.isNewEmbed&&(DynamicMsg.updateValues($EmbedManger.getAddinfo()),DynamicMsg.updateValues(Browser.getInfo()))},DynamicMsg.setValues=function(e){DynamicMsg.updateValues($EmbedManger.getAddinfo()),DynamicMsg.updateValues(Browser.getInfo()),DynamicMsg.updateValues(e);var t="undefined"!=typeof CommonUtil&&CommonUtil.parseToJSON?CommonUtil.parseToJSON(e.CUSTOMERINFO):$.parseJSON(e.CUSTOMERINFO);DynamicMsg.updateValues(t,"custom."),delete DynamicMsg.values.CUSTOMERINFO},DynamicMsg.updateValues=function(e,t){if(e){var a="";for(var i in e)a=t?t+i:i,DynamicMsg.values[a.toLowerCase()]=e[i]}else if("custom."==t)for(var n in DynamicMsg.values)""==n.split("custom.")[0]&&delete DynamicMsg.values[n]},DynamicMsg.getKeyFromMap=function(e){return"custom"===e.split(".")[0]?e.toLowerCase():DynamicMsg.labelsmap[e.toLowerCase()]},DynamicMsg.getValue=function(e){if(clientkey=DynamicMsg.getKeyFromMap(e),value=DynamicMsg.values[clientkey],"undefined"==typeof value)return"";if(!clientkey)return e;if("smart_timenow"===clientkey)return DynamicMsg.getSmartTimeNow();if("name"===clientkey){var t=value.split(" ");return"Visitor"===t[0]||/^\d+$/.test(t[0])?"":CommonUtil.wordCapitalize(value)}if("department"===clientkey){if("-1"==value)return"";for(var a=$EmbedManger.getDeptlist(),i=0;i<a.length;i++){var n=a[i];if(""+n.ID===value)return n.NAME}}return value},DynamicMsg.updateClearBitValues=function(e){if(e.Reveal)for(var t in e.Reveal)DynamicMsg.updateValue("clearbit_reveal_"+t,e.Reveal[t]);if(e.Enrichment)for(var t in e.Enrichment)DynamicMsg.updateValue("clearbit_enrichment_"+t,e.Enrichment[t])},DynamicMsg.updateValue=function(e,t){DynamicMsg.values[e.toLowerCase()]=t},DynamicMsg.getSmartTimeNow=function(){var e="",t=(new Date).getHours();return 5<=t&&t<12?e="morning":12<=t&&t<17?e="afternoon":17<=t&&t<21?e="evening":(21<=t||t<5)&&(e="night"),LSResource.getRealValue("smart.timenow."+e)},DynamicMsg.getSmartTimePeriod=function(e){var t=new Date;return(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+" "+LSResource.getRealValue("common.time.hours")},DynamicMsg.fillValues=function(e){if(!e)return"";var t=new Array,a="",i="",n="",r=0;for(-1===e.indexOf("&#x25;")&&-1===e.indexOf("&lt;br&#x2f;&gt;")||(e=(e=e.replace(/&#x25;/g,"%")).replace(/&lt;br&#x2f;&gt;/g," "));-1!=e.indexOf("%")&&(a="",strt=e.indexOf("%",r),last=e.indexOf("%",strt+1),-1!==strt&&-1!==last);)n=i=e.substring(strt+1,last),-1!==i.indexOf("|")&&(n=(t=(i=n).split("|"))[0],a=t[1]),val=DynamicMsg.getValue(n),val===n?(i=e.substring(strt+1,last),value="%"+i+"%"):(value=val||a,e=e.replace("%"+i+"%",CommonUtil.escapeSpecialNotation(value))),r=strt+value.length-1;return e};function $SupportConfig(e){var t=e.einfo,s=e.pinfo,i=t.embedstatus;this.setEmbedProps(CommonUtil.parseToJSON(t.props)),t.props.fieldlist&&($Support.fieldlist=CommonUtil.parseToJSON(t.props.fieldlist)),this.setPortalProps(s.pinfo),this.setReopenStatus(t.reopen_enabled),this.setAdditionalParams(e.params),this.setLicenceProps(e.linfo);var n=e.name?e.name:e.params&&e.params.name?e.params.name:void 0;this.setVisitorName(n);var o=e.email?e.email:e.params&&e.params.email?e.params.email:void 0;this.setVisitorEmail(o),this.setVisitorID(-1),this.setChatID(-1),this.setPrevCHID(-1),this.setSelectedDept(i.DEPARTMENTID),this.mappeddept=this.department,this.setLiveSupportID(t.embedid),this.setEmbedType(e.params.type),this.setRawAppID(t.lsid),this.setDepartmentList(i.DEPTLIST),this.setformRemovalStatus(i.formremoval),this.setEmbedName(e.einfo.uniquename),this.setWaitAction(),e.annonid&&this.setvwmsID(e.annonid),this.setEmbedWaitingTime(t.waitingtime),this.setPortalName(s.screenname),this.setSchema(e.schema),this.setProductCode(e.lsprdcode),this.setEmbedStatus(i.STATUS),this.setSoundConfig(!0),this.setCompanylogo(s.clogo_fkey),this.setCompanyWebsite(s.companywebsite),this.setConfigureMsg(t.props),this.setAddinfo(e.params),this.setBusnsHrStatus(i),this.setErrorFieldInfo(),this.setIntegId(s.integid),this.setReadReceipt(e.read_receipt),this.setMessageOperationConfig(e),this.setMessageReplyConfig(e),this.setIntegProps(e.integprops),this.isBetaPortal=s.isbetaportal,this.embed_newconfig_enabled=!1,this.setUserDetails(t.userdetails),this.setClientConf(s),this.setThanksMessage(e.ratingfeedbackrespmsgs),this.setChatConsentMsg(e.consent_banner_content),this.setismediarecordingallowed(i.ismediarecordingallowed),this.setIsVoiceNoteAllowed(i.isvoicenotesenabled),this.setCreditCardMaskingConf(t.props),this.setResourceBaseConfigs(t.props),this.setMultipleChatConf(t.props),this.setStaticFilesDelayLoading(i.staticfiles_delayloading_enabled),this.setEmbedLang(e.language),this.setCallRecording(i.call_recording),this.setIsMultiCategoryEnabled(s.multilevel_category_supported)}$SupportConfig.prototype={booleanprops:["icphoto","icsound","icfile","isscreenshare","issiqscreenshare","ispopout","icmail","icprint","iclogo","isconversation","isaudiocall","showsmiley"],objprops:["isname","isemail","isphoneno","feedback","reaction","color","isbotenabled","agentname","question","formtype"],setEmbedProps:function(e){this.eprops={};for(var t=0;t<this.booleanprops.length;t++){e[s=this.booleanprops[t]]&&(this.eprops[s]=this.getBooleanVal(JSON.parse(e[s])[0]))}for(t=0;t<this.objprops.length;t++){var s;e[s=this.objprops[t]]&&this.getBooleanValuesForObject(e,s)}this.eprops.ischannelscreenshare=e.siq_channels_screen_share_enabled,this.eprops.call_recording=e.call_recording,this.eprops.isvoicenotesenabled=e.voice_notes_enabled},setClientConf:function(e){var t=$Support.getParent().$zohosq||{};this.nonceval=t.nonce,this.uxclientconf=t.scrollenabled,this.xssdetectioneabled=t.xssdetectioneabled,this.embednewconfenabled=e.app_newconfig_enabled,this.screenRecordingEnabled=e.screen_recording_enabled,this.onlyCallEnabled=e.only_call_enabled,this.isScreenshareChatEnabled=e.screenshare_parallelchat,this.callMonitorEnabled=e.call_monitor_enabled},setThanksMessage:function(e){this.thanksmsgobj=e||{}},setChatConsentMsg:function(e){this.chatconsentmsg=e},setReadReceipt:function(e){this.read_receipt=e},setMessageOperationConfig:function(e){this.ismessageopr_allowed=e.message_operations_enabled||e.read_recipient_enabled},setMessageReplyConfig:function(e){var t=$Support.getParent().$zohosq||{};this.messagereply_allowed=e.reply_option_enabled&&t.ismessageoprallowed},setPortalProps:function(e){this.pprops=e},setAdditionalParams:function(e){this.eparams=e},setLicenceProps:function(e){this.linfo=e},setVisitorName:function(e){var t=this.visitorname;this.visitorname=isUndefined(e)?t:e},setVisitorEmail:function(e){this.visitoremail=!e||isUndefined(e)?this.visitoremail:e},setVisitorID:function(e){this.visitorID=isUndefined(e)?this.visitorID:e},setSelectedDept:function(e){this.department=isUndefined(e)?this.department:e},setChatID:function(e){this.chatID=isUndefined(e)?this.chatID:e},setPrevCHID:function(e){this.lchid=e},setRawAppID:function(e){this.appID=e},setLiveSupportID:function(e){this.livelsid=e},setvwmsID:function(e){this.vwmsid=isUndefined(e)?this.vwmsid:e},setEmbedType:function(e){this.type=e||"float"},setSchema:function(e){_SCHEMA=e},setPortalName:function(e){this.portalname=e},setDepartmentList:function(e){this.deptlist=e},setformRemovalStatus:function(e){this.isformremoval=e},setismediarecordingallowed:function(e){this.ismediarecordingallowed=e},setReopenStatus:function(e){!isUndefined(e)&&(this.isreopenenabled=e)},setMultipleChatConf:function(e){e&&(this.allow_multiplechat=e.allow_multiple_live_chat||!1)},setEmbedWaitingTime:function(e){this.embedwaitingtime=e},setEmbedName:function(e){this.embedname=e},setWaitAction:function(e){this.waitaction="text"},setAttender:function(e){this.attender=e},setVisitID:function(e){this.VISITID=e},setProductCode:function(e){$Support.Util.productCode=e},setAttenderZUID:function(e){this.attenderZUID=e},setAttenderUserAgent:function(e){this.attenderuseragent=e},setVisitorPhone:function(e){this.visitorphone=isUndefined(e)?this.visitorphone:e},setEmbedStatus:function(e){this.status=JSON.parse(e)},setSoundConfig:function(e){this.soundval=e},setCompanylogo:function(e){this.clogo_key=e,this.clogo=_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/clogo/"+e+"/photo.ls",this.clogo=$Support.getParent().$ZSIQUtil.getCompanyLogo(this.clogo)},setConfigureMsg:function(e){var t=function(e){return e=getDecodedText(e),"string"==typeof(e=getHtmlFreeText(e))&&(e=$.trim(Message.format(e))),e=Smiley.replace(e)};this.waitmsg=t(JSON.parse(e.waitingmsg)[1].msg)||LSResource.getRealValue("ne.waitmsg");var s=JSON.parse(e.offlinemsg)[1];this.offlinemessage=t(s.msg)||"",this.offlinerespmsg=t(s.resmsg)||LSResource.getRealValue("ne.offlinerespmsg");var i=JSON.parse(e.busymsg)[1];this.missedmessage=t(i.msg)||LSResource.getRealValue("embed.busymsg"),this.missedrespmsg=t(i.resmsg)||LSResource.getRealValue("ne.offlinerespmsg"),this.thanksmsg=t(JSON.parse(e.thanksmsg)[1].msg)||"";var n=JSON.parse(e.engagedmsg)[1];this.engagedmessage=t(n.msg)||"",this.engagedrespmsg=t(n.resmsg)||LSResource.getRealValue("ne.offlinerespmsg");var o=JSON.parse(e.deptmsg)[1];this.deptofflinemsg=t(o.msg)||"",this.deptofflinerespmsg=t(o.resmsg)||"",this.feedbackcomplete=t(JSON.parse(e.feedback)[1].msg)||"";var a=JSON.parse(e.reaction)[1];this.feedbackcompletesad=t(a.sad)||"",this.feedbackcompleteneutral=t(a.neutral)||"",this.feedbackcompletehappy=t(a.happy)||"",this.windowsize=JSON.parse(e.size)[1].val||2,this.faqaccess=t(JSON.parse(e.faqaccess))||""},setAddinfo:function(e){var t=this.addinfo||{};this.addinfo={name:e.name||t.name,email:e.email||t.email,question:e.question||t.question,autochat:e.autochat||t.autochat,deptname:e.deptname||t.deptname,phone:e.phone||t.phone,country:e.country||t.country,embed:e.embedname||t.embedname,forcefloatingwindow:e.forcefloatingwindow||null}},setBusnsHrStatus:function(e){this.bushrstatus=e.BUSINESSHOURSTATUS},setErrorFieldInfo:function(){this.errorinfo={visname:LSResource.getRealValue("ne.errorinfo.name"),visemail:LSResource.getRealValue("ne.errorinfo.email"),visphone:LSResource.getRealValue("ne.errorinfo.phone"),msgarea:LSResource.getRealValue("ne.errorinfo.question")}},setIntegId:function(e){this.integid=e},setIntegProps:function(e){this.integprops=e},setCompanyWebsite:function(e){e&&(this.companywebsite=-1==e.indexOf("http")?"http://"+e:e)},setUserDetails:function(e){e&&(this.userdetails=e)},getBooleanVal:function(e){return 1==e?"true":"false"},getBooleanValuesForObject:function(e,t){this.eprops[t]={};var s=JSON.parse(e[t]);if(this.eprops[t][0]=this.getBooleanVal(s[0]),"isname"==t||"isemail"==t||"isphoneno"==t){var i=s[1];i.ismandatory=this.getBooleanVal(i.ismandatory),this.eprops[t][1]=i}else if("color"==t){var n=s[1];n.code||(n.code="#0066cc"),this.eprops[t][1]=n}else-1!=["isbotenabled","question","agentname","formtype"].indexOf(t)&&(this.eprops[t][1]=s[1]);"reaction"==t?$Support.israting=JSON.parse(this.eprops.reaction[0]):"feedback"==t&&($Support.isfeedback=JSON.parse(this.eprops.feedback[0]))},setIsVoiceNoteAllowed:function(e){this.isvoicenotesallowed=e},setCreditCardMaskingConf:function(e){var t=e.credit_card_masking;e&&t&&(this.creditcardmask_enabled=t.enabled,this.creditcardbanner_content=t.consent_banner_content)},setStaticFilesDelayLoading:function(e){this.staticfiles_delayloading_enabled=e},setEmbedLang:function(e){this.embedlang=e},setResourceBaseConfigs:function(e){this.resourcebaseconfigs=e.resourcebaseconfigs||{allow_visitor_to_like_article:{enabled:!0},show_creator_image:!0}},setCallRecording:function(e){this.call_recording=e||{}},getVisitorName:function(){if(!ZSIQTranscript.isInValidVisitorName(this.visitorname))return this.visitorname},setIsMultiCategoryEnabled:function(e){this.ismulti_categoryenabled=e}};var ZSIQTranscript=function(){"use strict";var P="",t="",G=function(e){if(e.deleted||!e.msgid||!e.intime||!($Support.EmbedObj&&$Support.EmbedObj.messagereply_allowed)||-1==e.chid)return"";var t='<span class="sqico-reply replyicon" documentclick="replymsg" proptype="msgopr" title="'+LSResource.getRealValue("chat.reply")+'"></span>';return parseInt(e.msgid)>parseInt(e.intime)&&!e.isquestion&&!e.isbotchat&&parseInt(e.msgid)>parseInt(e.forwardtime)&&e.isvisitor?t+'<span class="sqico-more siq-menu msgactn" documentclick="showmsgactions" id="msgactn" proptype="msgopr"></span>':t},K=function(e,t){if($Widget.isPreview()||!$Support.EmbedObj.read_receipt||!e.chid||!$Support.isVisitorID(e.sender)||-1==t.chatID||b(e.msgid))return"";var i=e.file&&"voice_note"!=e.att_type?" dn":"";return $Support.removeReadReciptUI(e.chid),'<div class="readrec'+i+'" proptype="readrec"><span>'+(e.time||MyDate.getHoursandMin((new Date).getTime(),!0,"bclient"))+'</span><em class="sqico-tick" title="'+LSResource.getRealValue("common.sent")+'"></em></div>'},X=function(e){try{var t=e.meta.card_data;if("contact"!=t.type)return"";var i="string"==typeof t.value?JSON.parse(t.value):t.value,a="",s=0;for(var n in i){if(2==s)break;a+='<span class="txtelips">'+i[n]+"</span>",s++}return'<div class="vcard"><span class="sqico-user"></span><span class="vcard_dtl">'+a+'</span><span class="sqico-dwnld" documentclick="downloadvcard"></span></div>'}catch(e){return""}},Y=function(e){try{return e.meta.display_card?e.meta.display_card.type:e.meta.input_card.type}catch(e){return""}},ee=function(e){try{var t=["suggestions","relatedphrases"],i=e.meta[$Widget.display_card]||{},a=i.type,s=e.meta[$Widget.display_card]&&e.meta[$Widget.input_card];if(a||(e.meta.related_phrases?a="relatedphrases":i.actions&&(a="textwithaction")),!s&&(-1!=["links","articles","video","multiple-product","single-product","textwithaction"].indexOf(a)||-1!=t.indexOf(a))){e.time=e.widgettime;var n=$Widget.getWidgetHTML(e);-1!=t.indexOf(a)?e.suggestionhtml=n:e.msg=n,e.is_ignoreformat=!0,e.bot_image="","resource-share"==i.subtype&&(a="resource-share"),e.widget_class={links:"",articles:"artcle-vw","resource-share":"artcle-vw article-share"}[a]||""}}catch(e){}return e},te=function(e){var t=$Support.EmbedObj,i=t?t.eprops:"";if(t&&!JSON.parse(i.showsmiley))return"";var a=document.createElement("DIV");return a.innerHTML=Smiley.replace(e),(a.textContent||a.innerText).trim()?"":" smily_msg"},ie=function(e,t){return e=t?e:Message.format(e),Smiley.replace(e)},ae=function(e){return(e.meta&&e.meta.msgid?e.meta.msgid:e.file&&e.file.msgid?e.file.msgid:e.msgid)||""},n=function(e){if(e&&(e.typing_delay||0==e.typing_delay))return 1e3*parseInt(e.typing_delay)},se=function(e,t){var i=e.file,a=e.convvisitorid,s=e.convchid,n=-1!=e.msg.content.indexOf("image"),r=(e.time,$Support.EmbedObj),d=i.fName||i.name;d=getEscapedText(d);var o=r&&r.vwmsid?"&wmsid="+r.vwmsid:"",c=$Support.getAjaxURL("download",".ls");c+="?fsize="+i.size+"&url="+escape(i.url)+"&fName="+encodeURIComponent(d);var m=t||i.chatid;c+=a?"&visitorid="+a+"&chid="+s+"&isconversation=true":r?"&chid="+m+o:"&chid="+m;var l=i.purl||c,g=i.msgid?'msgid="'+i.msgid+'"':"",p=getMemSize(i.size),u=(i.progress,i.progress?" fprgs":""),v=e.is_edited?ne():"",f=$.trim(i.comment)?'<code proptype="filecomment">'+getEscapedText(i.comment)+v+"</code>":"",h=f?" imgcmt":"",y=r&&r.nonceval?"":' onload="$Support.handleUploadImageLoad( this )"',b=n?'documentclick="imagepreview"':"";return['<span class="fileattch siq-file-attach'+u+h+'" '+g+' data-ftype="'+getEncodedText(e.msg.content)+'" data-filesize="'+p+'" data-bubble="true" '+b+">",n?'<img src="'+l+'" height="75" width="75" class="siq-attach-image" chatmsgtype="image" '+y+' style="display: none;">':'<span class="filedet" documentclick="imagepreview"><em class="txtelips">'+d+'</em><em class="size" size="'+p+'">( '+p+" )</em></span>",_(i,l),"</span>"+Smiley.replace(f)].join("")},_=function(e,t){return'<div class="file_alin"><div class="file_pmain"><div class="file_prgs" msgid="'+(e.msgid||"")+'"><div class="pie"></div><div class="pie fill"></div></div></div>'+(t='<a target="_blank" class="fdload" href="'+t+'"><span class="sqico-dwnld siq-file-progress"></span></a>')+"</div>"},ne=function(){return' <span proptype="edited">('+LSResource.getRealValue("common.edited")+")</span>"},re=function(e){return!(!e||-1==e.indexOf("$"))},de=function(e){return!!$Support.EmbedObj&&(!(e=e||$Support.EmbedObj.visitorname)||e&&(0===e.lastIndexOf("Visitor ",0)||0===e.lastIndexOf("Guest",0)))},l=function(e,t){var i=le(t),a=ae(e);if(!a||!b(a,t)){var s,n=e.html,r=e.ispopulate,d=e.sender,o=$Support.Util.isMessageDIVScrolled(i.chatmaindiv),c=e.meta||{};if(i.chatdiv.find('[proptype="flowresetter"]').remove(),T()&&C())if(oe(d))E(!0);else{E(!d);var m=$("<div/>").html(n).contents();if(m&&0<m.length)n=m.find(".msgbx").prop("outerHTML"),s=!0}var l=i.chatdiv.find('span[msgid="'+a+'"]');if(l.length)l.find(".filedet").replaceWith($(n).find(".filedet")),l.find(".fdload").replaceWith($(n).find(".fdload"));else{var g=i.chatdiv.find(".zsiq_transferdiv"),p=i.chatdiv.find("[proptype='feedbackcontainer']");0<p.length&&-1==i.chatID?$(n).insertBefore(p):0<g.length?(s||$(n).insertBefore(g),g.is(":visible")||g.show()):s||i.chatdiv.append(n),s&&$("#msgmaindiv .agntmsg").last().append(n)}var u=i.contentdiv.find(".ziq_msg").last(),v=u.find('[chatmsgtype="image"]'),f=$Support.EmbedObj;v.length&&f&&f.nonceval&&$Support.handleUploadImageLoad(v),q(),h(e,i),e.meta&&y({messageobj:c,chatobj:i}),o||r||w("",i.chatmaindiv),r||$Support.Util.handleUnReadChatUI(e,i.chatmaindiv),S(u,e.callback)}},h=function(e,t){var i=-1!=t.chatID?t.chatID:t.winid,a=le(i)||{},s=e.handoff_config;a.isBotChat&&!a.hidetransfer&&s&&(t.contentdiv.find("#agenttransfer").remove(),$UI.appendTransferDiv(a,s.text,s.ack))},y=function(e){if(!$Widget.isPreview()&&-1!=e.chatobj.chatID){var t=e.chatobj.chatdiv,i=e.messageobj;t.find('[proptype="flowresetter"]').remove(),t.find('[data-field="message"]').last().find('[proptype="msgbx"]').append($BotImpl.checkAndGetBotResetterHTML({chatobj:e.chatobj,config:CommonUtil.sanitizeObject({rollback:i.rollback_command,restart:i.restart_command})}))}},b=function(e,t){var i=le(t).chatdiv;return!i||!!i.find('[data-msgid="'+e+'"]').length},w=function(e,t,i){try{e=e||0;var a=t||le().chatmaindiv||$("#msgmaindiv");a=a&&a[0];$("#msgdiv > .ziq_msg").last();if(!a||$("#unreadarrow").length)return;var s=$(a).find('[data-field="message"]').last(),n=s.next(".siq-info-message").length;if(!i&&!n&&s.hasClass("siq-agntmsg")&&r(s,a,e))return;$(a).animate({scrollTop:a.scrollHeight-a.offsetHeight+10},e)}catch(e){}},r=function(e,t,i){if(!$Support.EmbedObj||!$Support.EmbedObj.uxclientconf)return!1;var a=t.offsetHeight,s=$(t).find('[sendertype="agent"]').last().parent(),n=0,r=s.nextAll('[data-field="message"]');1<r.length?r.each(function(){n+=$(this).outerHeight(!0)}):n=r.outerHeight(!0);var d=s.outerHeight()||0,o=$(t).find(".zsiq_transferdiv").outerHeight(!0)||$(t).find("#siq_bottype").parent().outerHeight(!0)||0,c=n+o+d-a;return 0<c&&($(t).animate({scrollTop:t.scrollHeight-(a+c)},i),!0)},S=function(e,t,i){if(e){var a=t?{right:"auro",left:"-20px",opacity:"0"}:{right:"0",left:"0",opacity:"1"};e.animate(a,300,function(){i&&i(e)})}},q=function(){var s=$Support.container.find(".ziq_msg");s.each(function(e){var t=$(this);t.removeClass("single_msg lst_msg"),d(t);var i=$(s[e-1]),a=$(s[e+1]);!a.length&&!i.length||!a.length&&t.hasClass("agntmsg")&&i.hasClass("vismsg")||!a.length&&t.hasClass("vismsg")&&i.hasClass("agntmsg")||t.hasClass("agntmsg")&&a.hasClass("vismsg")&&i.hasClass("vismsg")||t.hasClass("vismsg")&&a.hasClass("agntmsg")&&(i.hasClass("agntmsg")||!i.length)?t.addClass("single_msg"):(!a.length||t.hasClass("agntmsg")&&a.hasClass("vismsg")||t.hasClass("vismsg")&&a.hasClass("agntmsg"))&&t.addClass("lst_msg")})},d=function(e){var t=e.find(".hr"),i=t.length;!i||i<=e.find("br").length||t.closest('[proptype="reply_msg"]').length||e.addClass("hr_line")},T=function(e){return 0<(e?e.find("#siq_bottype"):$("#siq_bottype")).length},C=function(){return $("#siq_bottype").parent().attr("frstmsg")},oe=function(e){return e==myMsgObj.sender},E=function(e){var t=$("#siq_bottype"),i=t.parent().prev().hasClass("agntmsg");if(t.length){if(e||i)return void t.parent().remove();t.remove()}},g=function(){return'<div class="type-loadr textC"><span></span><span></span><span></span></div>'},ce=function(e,t){var i=e?"vismsg":"agntmsg";return!(t=t||$("#msgdiv")).find(".ziq_msg").last().hasClass(i)},me=function(e){return e.isvisitor?t:t=!(!e.meta||!e.meta.hand_off)||!!e.hand_off},le=function(e){try{return e?ZSIQConversationManager.getChatWinObjById(e):ZSIQConversationManager.getcurrchatwinobj()}catch(e){return{chatdiv:$("#msgdiv"),contentdiv:$("body").find(".siq_content"),attendername:$Support.EmbedObj&&$Support.EmbedObj.attendername?$Support.EmbedObj.attendername:Bot?Bot.getBotOBJ().name:"",presender:Message.presender,presendername:P,waitTimer:$Support.waitTimer,chatmaindiv:$("#msgmaindiv"),composer:$("#msgarea"),checkAndFocusMessageArea:function(){$("#msgarea").focus()}}}};return{getTranscript:function(e,t,i,a){var s=e.isbotmessage,n=le(i)||{};e=t&&s?ee(e):e;var r=$Support.EmbedObj,d=(r&&r.eprops,e.convvisitorid),o=oe(e.sender)||d&&("null"==e.sender||re(e.sender))||e.isvisitor,c=r&&o&&!d?r.visitorname||e.name:e.dname,m=(s=e.isbotmessage,e.meta&&e.meta.input_card&&e.meta.input_card.isuseredit),l=n.presendername&&n.presendername==c;m?l=!0:(n.presendername=c,P=c);var g="agntmsg siq-agntmsg",p="siq-user-name",u="siq-user-message",v=' sendertype="agent"',f="",h=e.deleted?" msgdel":"";(o||e.isques)&&(g="vismsg siq-visitmsg",p="siq-visitor-name",u="siq-visitor-message",v=' sendertype="visitor"'),c=getEscapedText(c);var y=e.msg;if(e.mtype==CT_ATT_MSG&&(e.file=y),!e.file&&"object"==typeof y)return"";e.iscannedarticle&&(g+=" msg-card");var b="";e.reply_to&&!h&&(b=MessageOperation.getReplyMsgHTML(e.reply_to));var _="",$='purpose="name"';!de(c)&&c||s||(c=LSResource.getRealValue("common.you")),r&&-1<g.indexOf("vismsg")&&$Support.Util.CheckAllDefaultFieldsDisabled()&&!d&&(-1==n.chatID||n.waitTimer||ZSIQConversationForm.checkContextInitiated()||n.queueTimer||(_='<em class="sqico-edit" title="'+LSResource.getRealValue("ne.title.edit")+'"></em>',f='documentclick="userdetails"'));var w=m?"":e.time||"",S=e.uniqueid?e.uniqueid:e.msgid?e.msgid:"";S=e.file&&e.file.msgid?e.file.msgid:S;var q=e.reply_to?"":te(y),T="",C="";e.file&&(T=" file_msg",C='isimage="'+(-1!=e.msg.content.indexOf("image"))+'"');var E=e.ratinghtml?e.ratinghtml:"",x=e.meta&&e.meta.card_data&&e.meta.card_data.value?e.meta.card_data.value.image:null,M=x?e.meta.card_data.value:null,I="";M&&M.lat&&(I=" lat="+M.lat+" lng="+M.lng+' documentclick="openmapfromimage" ');var O=e.bot_image||x,j=r&&r.nonceval?"":' onload="$Support.handleUploadImageLoad( this )"',R=O?'<div class="cmpnt-sldimg mB10" documentclick="imagepreview"><img src="'+O+'" '+I+' chatmsgtype="image" '+j+' style="display: none;"> </div>':"",k=O?"msg-botimg":"",L=e.widget_class?" "+e.widget_class:"",H=e.att_type&&"voice_note"==e.att_type,U=H?"voicenote-audio":"";H&&e.msg&&e.msg.comment&&(U+=" att_cmt "),g=t?g+" rm_anim":g,(l||o&&!d&&!ce(o,n.chatdiv))&&(g+=" mrgT2",c=_=$=v=""),g+=e.iswidget?" siq_widget":"";var B=Y(e),D=B?"":' title="'+w+'"';B=B?'data-wtype="'+B+'"':"";var z=e.widget_cname?" widget_cname = "+e.widget_cname:"",V=e.suggestionhtml||"",A='data-msgid="'+ae(e)+'"';o||(y=Markdown.apply(y)),y=e.is_ignoreformat?y:ie(y);var W=X(e);g+=W?" buble_bg":"";var N=e.is_edited&&!e.deleted?ne():"";y=W||'<span class="siq-message '+u+h+'" proptype="msgholder">'+y+N+"</span>",(e.isvisitor=o)&&e.file&&e.att_type&&"voice_note"==e.att_type&&n.chatdiv&&n.chatdiv.find("#"+S).length&&(n.chatdiv.find("#"+S).remove(),ce(o,n.chatdiv)&&(c=r&&o&&!d?r.visitorname||e.name:e.dname,c=getEscapedText(c),!de(c)&&c||s||(c=LSResource.getRealValue("common.you"))));var F=e.msguid?" msg-id="+$Support.formatMsgUid(e.msguid):"",J={isvisitor:o,deleted:e.deleted,msgid:S,intime:n.intime||n.chatintime,isbotchat:n.isBotChat,chid:"pastconv"==n.chatstatus?-1:n.chatID,isquestion:e.isques};J.forwardtime=n.forwardtime||0;var Q=G(J),Z=Q?' ondblclick="replymsg"':"";return["<div "+(S?'id="'+S+'"':"")+'" '+C+' class="ziq_msg '+g+q+T+'" data-field="message" '+A+' hand-off="'+me(e)+'" '+B+z+F+' docanimationend="handleMsgAnimationEnd"'+Z+">","<div "+$+v+' class="'+p+'" '+f+">"+c+_+"</div>",'<div class="msgbx '+k+U+L+'"'+D+' proptype="msgbx">'+b+R,e.file?a||se(e,i):y+E,Q,"</div>"+V+K(e,n),"</div>"].join("")},updateTranscript:l,removeTyping:E,showTyping:function(e){var t=e.chid||e.enc_chid,i=le(t)||{};if(e.isautotyping||clearTimeout($Support.autotyping),!$.isEmptyObject(i)&&i.chatdiv.length&&0==i.contentdiv.find("#siq_bottype").length){var a=e.isuseredit,s=$Support.EmbedObj?e.dname||i.attendername:Bot.getBotOBJ().name,n=!ce("",i.chatdiv)||i.presender==e.sender&&!oe(i.presender)?"":s,r=e.msglist&&e.msglist[0]?e.msglist[0].msgid:"",d=n?getEncodedText(n):" ",o="";$.trim(d)&&(o=' sendertype="agent"');var c='<div frstmsg="true" class="ziq_msg agntmsg siq-agntmsg mrgT2 siq_widget" id="bottype_msg" data-msg-usrname-id="'+r+'"><div purpose="name"'+o+' class="siq-user-name dib-mid mB5">'+d+'</div><div class="msgbx" id="siq_bottype">'+g()+"</div></div>",m=(e.meta||{}).handoff_config||{};l({html:c,sender:e.sender||" ",istyping:!0,handoff_config:m},t),a||(i.presendername=s,P=s)}},getCustomArticleCard:function(d){if(!d)return"";if("resource-share"==d.subtype)return $Temp.getResourceSharingHTML(d);var e=$Support.EmbedObj,t=e&&e.nonceval?"":' onload="$Support.handleUploadImageLoad( this )"',i=d.owner_imgkey?'<img src="'+_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/userimg/"+d.owner_imgkey+'/photo.ls?nocache=1">':"";return'<div class="posrel"><div class="cmpnt-wrap">'+(d.image?'<div class="cmpnt-sldimg" documentclick="imagepreview"><img src="'+d.image+'" chatmsgtype="image" '+t+' style="display: none;"></div>':"")+'<div class="cmpnt-body-cont cmpnt-artl-cont"><div class="cmpnt-hdln">'+(d.title?getEncodedText(d.title):"")+'</div><div class="cmpnt-desc lH20">'+getEncodedText(d.description||"")+"</div>"+(d.owner_name?'<div class="mT15"><div class="dib-mid cmpnt-atrlimg">'+i+'</div><div class="dib-mid cmpnt-artl-desc">'+LSResource.getRealValue("article.by")+" <em>"+getEncodedText(d.owner_name)+"</em></div></div>":"")+(d.articles&&d.articles.length?function(e,t){var i="";for(var a in e){var s=Object.keys(e[a])[0],n=e[a][s]||"";i+='<nav class="cmpnt-art-list"><em class="sqico-faqarticle dib-mid"></em><div class="dib-mid"><span class="lH20" article-id="'+s+'" iscard="true" title="'+(n=getEncodedText(n.replace(/<br\s*\/?>/gi," ")))+'">'+n+"</span></div></nav>"}var r=t?"":'<div class="cmpnt-arthd sbold">'+LSResource.getRealValue("faq.relatedarticles")+" :</div>";return'<div class="mT10" id="rel-articles-'+d.id+'">'+r+i+"</div>"}(d.articles,d.hide_label):"")+"</div></div></div>"},getVideoCard:function(e){return e?'<div class="video-frame-container"><div class="video-frame"><div class="video-box"><iframe frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" class="video-iframe" auto="" src="'+e.url+'"></iframe></div></div></div>':""},reSetPreviousSender:function(e){e.presendername=""},scroll:w,setMessageClass:q,isMessageExist:b,getMessageID:ae,getFormatedHTML:ie,getImageURL:function(e){if(!e.sender||"-1"==e.sender)return"";var t=e.sender.split("_");return t=t[2]||t[0],_SCHEMA+"://"+_EMBEDSERVERURL+"/"+CommonUtil.getScreenName()+"/userimg/"+t.replace("b","")+"/photo.ls?nocache=1"},getMessageDelay:function(e){var t=n(e.meta);if(null==t){var i=e.msglist;if(i&&0<i.length){var a=i[0];t=n(a.meta)}}var s=(t=null!=t?t:2e3)-((new Date).getTime()-Message.getLastMessagePostTime());return 0<s?s:0},isLocalUser:oe,isInValidVisitorName:de,getChatWindowOBJ:le,getFileAttachHTML:se,isAnnonUser:re,checkMardownClass:d,parseTextMessage:function(e){if(e.isfileatt)return e.msg.comment;var t=e.msg;return t=oe(e.sender)?t:Markdown.apply(t),t=ZSIQTranscript.getFormatedHTML(t)},getEditMsgHTML:ne,isTypingShown:T,removeBotResetter:function(e){e.chatdiv.find('[proptype="flowresetter"]').remove()}}}();$Support={LSDB:parent.$ZSIQLSDB?parent.$ZSIQLSDB:opener?opener.$ZSIQLSDB:void 0,convlistindex:0,convlistlimit:{1:5,2:6,3:7},unReadChat:{},isallconvlistfetched:!1,getParent:function(){return window.parent.$ZSIQWidget?window.parent:window.opener&&opener.$ZSIQWidget?window.opener:void 0},DEPT_ONLINESTATUES:"1",DEPT_OFFLINESTATUES:"2",DEPT_ENGAGESTATUES:"3",chidmappinglist:{},joinedchatkeys:[],ismore_message_available:[],init:function(e){try{$Support.EmbedObj=new $SupportConfig(e),this.setTheme(e),this.isscript="script"===e.params.src,$Support.Util.updateParentFontFamily(),this.Util.setBrowserValues(),DynamicMsg.init();try{Self.status.init()}catch(e){}if(this.cachearr={},ZSIQConversationForm&&this.EmbedObj.isformremoval&&(ZSIQConversationForm.isOldFormView()||$Support.Util.isPreview()))return void ZSIQConversationForm.fetchAllFields();this.handleChatWindowUI()}catch(e){}},handleChatWindowUI:function(){this.checkAndShowUI(),$Support.setLoadContentClass(),$Support.Util.isPreview()&&($Support.enableHeaderImage(),$CWPreview.init(),parent.parent&&parent.parent.onloadChatWindow&&parent.parent.onloadChatWindow()),window.parent.$ZSIQChatWindow.handleESCEvent(window),window.parent.$UTSHandler.getUTSCachedata(),$Support.verifyChatDomain()&&($Support.Util.setDStorageIframe(),$Support.Util.loadPostMessage())},setTheme:function(e){this.theme="theme"+e.theme},isFloat:function(){return"float"===$Support.type},checkAndShowUI:function(e,t){$Support.appendMetaTag();var i=$Support.EmbedObj;$UI.setContainer();var o=$Support.getParent().$ZSIQUtil.getAPIValues();(o.floatwindowfields||o.customfield)&&$Support.handleFieldVisibility(o.floatwindowfields,o.customfield),!$Support.Util.isPreview()&&$Support.initiateConversationDB(t);var n=this.getCookieValue("ZLD"+i.livelsid);if(this.getWaitingCookie(),this.getTriggerCookie(),window.parent.$ZSIQWidget.getWidgetObject().isshowcallbubble)return $Support.container.append($Support.contentdiv=CallUIHandler.getInitialHtml()),void handleDrag();if($Support.Util.updateViewAttribute("msgarea"),$Support.Util.isPreview()){$Support.fieldlist&&ZSIQConversationForm.setFormFieldsInEobj($Support.fieldlist),i.status?$UI.init():$Support.showOfflineUI(),this.Util.setTextareaHeight(),$Support.handleApiData(o);var a=$Support.getParent().$zohosq||{};"function"==typeof a.previewReady&&a.previewReady()}else clearTimeout($Support.Util.jsdownloadtimer),n&&n.cid&&"-1"!=n.cid&&$Support.getParent().$ZSIQWidgetUI.getWidgetState()==$Support.getParent().$ZSIQWidgetUI.F_WINDOW?$Support.Util.downloadAdditionalFiles():$Support.Util.jsdownloadtimer=setTimeout($Support.Util.downloadAdditionalFiles,1e4),$Support.isConversationAllowed()||$Support.removeConvListStorage(),-1!=e&&$Support.handleApiData(o),this.Util.bindUtilEvents(),$Support.Util.calculateContentHeight()},showOfflineUI:function(){$Support.Util.isPreview()&&($Support.contentdiv="",ZSIQConversationManager.resetConvDb()),$UI.updateOfflineUI(),$Support.isFloat()||this.Util.showOfflineBanner()},initiateConversationDB:function(e){var t="",i=$Support.EmbedObj,o=$Support.LSDB.getFromSession("ZLD"+$Support.EmbedObj.livelsid+"lastview"),n=$Support.getCookieValue("ZLD"+i.livelsid)||{};!$.isEmptyObject(n)&&$Support.updateCommonKeys(n);var a=n.ongoingchats||{};t=a[o]||{},!e&&$Support.processChatCookie(a,"connected",o),!$.isEmptyObject(t)&&(t.status="connected");var r=$Support.getWaitingCookie()||{};!$.isEmptyObject(r)&&$Support.updateCommonKeys(r);var s=r.ongoingchats||{};!e&&$Support.processChatCookie(s,"waiting",o),s[o]&&((t=s[o]).status="waiting");var p=$Support.getTriggerCookie();if(p){var d=p.isbottrigger;e||d?$Support.Util.handleBotTriggers(p.message,!0,o):$Support.Util.handleChatTrigger(p,!0,o),$Support.handleCallbackForchatContinue(ZSIQConversationManager.getChatWinObjById(p.winid),"Chat triggered")}var c=$Support.getQueueingCookie()||{};!$.isEmptyObject(c)&&$Support.updateCommonKeys(c);var u=c.ongoingchats||{};!e&&$Support.processChatCookie(u,"queueing",o),u[o]&&((t=u[o]).status="queueing");var l=!(p&&p.winid==ZSIQConversationManager.getcurrchatwinChid())&&$Support.isConversationAllowed();$Support.chidmappinglist[t.rcid]=t.cid||t.chid,$.isEmptyObject(t)?$Support.checkAndShowConvView(l):ZSIQConversationManager.init(t,t.status,o),delete ZSIQConversationManager.chidbeforereload,($.isEmptyObject(a)&&$.isEmptyObject(s)&&$.isEmptyObject(p)&&$.isEmptyObject(u)||e)&&(ZSIQConversationManager.populateInitialScreen(),ZSIQConversationForm.checkAndGetFormTranscript()),$Support.getQueuePositions(u)},processChatCookie:function(e,t,i){for(var o in e)if(e.hasOwnProperty(o)&&o!==i){var n=e[o];$Support.chidmappinglist[n.rcid]=n.cid||n.chid,ZSIQConversationManager.init(n,t,i)}},checkAndShowConvView:function(e){if(e)$Support.container.find("#showsiqconv").click();else{var t=$Support.getRecentLiveChatid();t&&$Support.Util.showMessageAreaUI("convmsg","",$("<div></div>").attr("chid",t))}},handleFieldVisibility:function(e,t){var i=$Support.EmbedObj,n=[];if(i.status&&e&&e.online?n=e.online.split(","):!i.status&&e&&e.offline&&(n=e.offline.split(",")),t&&0!=t.length)try{$.each(t,function(e,t){t.index=e;var i=t.name;if(n.length,/^_default./.test(i)){var o=i.replace("_default.","");0<=["name","email","phone"].indexOf(o)&&-1==n.indexOf(o)&&n.push(o)}})}catch(e){}if(n.length){i.eprops.isname[0]=!1,i.eprops.isemail[0]=!1,i.eprops.isphoneno[0]=!1;for(var o=0;o<n.length;o++){"contactnumber"!=n[o]&&"phone"!=n[o]||(n[o]="phoneno");var a="is"+n[o];i.eprops[a]&&(i.eprops[a][0]="true")}}},setAttenderCookie:function(e,t){var i=$Support.EmbedObj,o=$Support.getCookieValue("ZLD"+i.livelsid)||{};((o.ongoingchats||{})[t]||{}).attender=e.attender,this.LSDB.setCookie("ZLD"+i.livelsid,o,31e4)},startChat:function(){ZSIQConversationManager.init({winid:(new Date).getTime()},"startchat")},getFormContainer:function(){return $("#siqform").length?$("#siqform"):$Support.container},updateInputValues:function(e){var o=e||{};$Support.getFormContainer().find("[purpose]").each(function(){var e=$(this),t=e.attr("purpose"),i=e.val()||e.attr("val");if(isUndefined(i)||""==i)return!0;"question"==t||"department"==t?o[t]=i:$Support.EmbedObj[t]=i}),$Support.updateVisitorName()},updateVisitorName:function(){var t=$Support.EmbedObj;if(!t.visitorname){var e=t.visitoremail;if(e)t.setVisitorName(e.split("@")[0]);else try{var i=$Support.getParent().$UTSHandler.getUTSName();i.name==i.token&&i.name.match(/^[0-9]/)?t.setVisitorName("Visitor "+i.name):i.name!=i.token&&i.name?t.setVisitorName(i.name):t.setVisitorName("Visitor "+Math.round(1e5*Math.random()))}catch(e){t.setVisitorName("Visitor "+Math.round(1e5*Math.random()))}}},storeInCookie:function(e,t,i){var o=parent.$ZSIQCookie?parent.$ZSIQCookie:opener?opener.$ZSIQCookie:void 0;e=_SCREENNAME+"-"+e,o.set(e,t,i)},populateChatKeysFromJSAPI:function(e){var t={referer:"referrer",cpage:"currentpage"},i=$Support.getParent()&&$Support.getParent().$zv;if(i)for(var o in e=e||{},t)i[o]&&(e[t[o]]=i[o])},addVisitor:function(){var u=this,l=u.EmbedObj,e=$Support.getParent(),t=e.$ZSIQUtil.getAPIValues(),i=ZSIQConversationManager.getChatWinObjById(l.curraddvistid),o="";parent.$zohosq._directcall&&(i.question=LSResource.getRealValue("av.info.callquesmsg",l.visitorname),l.isaudiocall=!0);var n=lsnocachefix("json");$Support.populateChatKeysFromJSAPI(n),void 0===i.question&&(i.question=$.trim(i.composer.val())),i.getComposer().val(""),$.extend(n,Browser.getInfo(),{referrer:processInput("trimlength",n.referrer,3e3),currentpage:processInput("trimlength",n.currentpage,950),name:l.visitorname,lsid:l.livelsid,email:processInput("emailid",l.visitoremail),ques:i.question,deptid:i.department,annonid:l.vwmsid,platform:navigator.platform,embeduniquename:l.embedname,autotrigger:i.istrigmsg}),$.extend(n,$Support.getCaptcha),l.uvid&&(n.uvid=l.uvid),i.istrigmsg&&$Support.Util.handleCallbacks("visitor.triggerresponded",{});var a=i.attender||l.lastattender,r=this.LSDB.get("ZLDPERSONALIZE");null!=a&&""!=a?(n.attender=a,i.isbottrigmsg&&(i.isBotChat=!0)):$Support.getParent().$ZSIQChat.getWidgetData().widgettype==$Support.getParent().SIQ_PERSONALIZE&&r&&(n.attender=r),l.visitorphone&&(n.phone=l.visitorphone);var s=i.attenderemail||l.lastattenderemail;!s&&t.agent&&(s=l.attenderemail),s&&(n.attenderemail=s);var p=e.$ZSIQUtil.getAvuid();p&&(n.avuid=p);var d=e.$ZSIQUtil.getAPIVisitorID();d&&(n.cvuid=d);var c=e.$ZSIQUtil.getZldp(l.embedname);c&&(n._zldp=c);var g=t.seclocation;g&&(n.address=$Support.getSecLocationAPIObj(g));var m=l.cinfo;if($Support.getParent().$ZSIQChat.getWidgetData().embedobj.ismailchimpenabled&&!$Support.getParent().$ZSIQChat.istrackedfrommailchimp){if(n.mc_cid=$Support.getParent().$ZSIQUtil.getURLParameterByName("mc_cid"),n.mc_eid=$Support.getParent().$ZSIQUtil.getURLParameterByName("mc_eid"),null!=n.mc_cid&&""!=n.mc_cid&&null!=n.mc_eid&&""!=n.mc_eid)$Support.storeInCookie("mc_cid",n.mc_cid,864e5),$Support.storeInCookie("mc_eid",n.mc_eid,864e5);else if(h=$Support.getCookieValue("mailchimp")){var v=h;"string"==typeof h&&(h=JSON.parse(v)),v.name&&(n.name=v.name),v.email&&(n.email=v.email)}else n.mc_cid=$Support.getCookieValue("mc_cid"),n.mc_eid=$Support.getCookieValue("mc_eid");null!=n.mc_cid&&""!=n.mc_cid&&null!=n.mc_eid&&""!=n.mc_eid||(n.mc_cid=void 0,n.mc_eid=void 0)}else{var h;(h=$Support.getCookieValue("mailchimp"))&&("string"==typeof(v=h)&&(h=JSON.parse(v)),v.name&&(n.name=v.name),v.email&&(n.email=v.email))}var S=l.exid;S&&(n.exid=S),m&&("object"==typeof m&&(m=JSON.stringify(m)),n.cinfo=m),$Support.Util.isCampaignEnabled()&&$Support.subscribe&&(n.subscribe="true");var f=$Support.getParent().$ZSIQUtil.getAPIValues();(f.mtrigger||f.triggermsg)&&i.pmsg&&!i.isbottrigmsg&&(n.prevtrigg=i.pmsg),f.waitime&&(n.custom_waitime=f.waitime);var C=$Support.getParent().$UTSHandler.getUTSSID();C&&(n.uts_session_id=C),ZSIQConversationForm.checkContextInitiated()&&ZSIQConversationForm.getFormType()==CLASSIC_VIEW&&(n.form_response=ZSIQConversationForm.getFormatedResponse()),f.e_name&&(n.siq_name=f.e_name),f.e_email&&(n.siq_email=f.e_email),parent.$zohosq._directcall?(n.isaudiocall=!0,n.conversationtype=0):n.includebots=!0,n.sid=LSMessanger.getSid(),n.questionasmessage=!0,Message.updateLastMessagePostTime(),n.tzoffset=-1*(new Date).getTimezoneOffset()*6e4;var b=$Widget.getMetaData();b&&(b.value="object"==typeof b.value?JSON.stringify(b.value):""+b.value,n.meta=JSON.stringify(b),$Widget.clearMetaData());var I=$Support.getParent().$ZSIQChat.getScriptSource();I&&1<I.split("?").length&&(o="?"+I.split("?")[1]),this.handleAjax("addvist",n,function(e){var t=e.objString,i="chat_queue"==e.module,o=ZSIQConversationManager.getChatWinObjById(l.curraddvistid||t.CHID),n=$Support.cachearr[l.curraddvistid];if(n&&($Support.cachearr[t.CHID]=n,delete $Support.cachearr[l.curraddvistid]),"EMBED_NOT_ALLOWED"==t.exception)return $Support.getParent().$ZSIQUtil.preserveBlockIP(),void $Support.removeWidget();if($Support.updateDynamicKeys(t),ZSIQConversationForm.clearSessionStorage(),t.CLEARBITINFO&&(DynamicMsg.updateClearBitValues(JSON.parse(t.CLEARBITINFO)),delete t.CLEARBITINFO),DynamicMsg.setValues(t),$Support.EmbedObj.feedbackcomplete=DynamicMsg.fillValues($Support.EmbedObj.feedbackcomplete),"object"!==e.objType||"EMBEDOFFLINE"!==t.ERROR){var a=t.ATTENDER;if(a&&o.attender!=a&&(o.attendername=o.attenderemail),$Support.chidmappinglist[t.RCHID]=t.CHID,o.attender=a,o.VISITID=t.VISIT_ID,o.RCHID=t.RCHID,o.chatID=t.CHID,o.visitorID=t.CU_ID,o.setBotChatStatus&&o.setBotChatStatus(t.ISBOTCHAT),l.curraddvistid&&o.updateChatInfoinInstanceDom(),delete $Support.EmbedObj.curraddvistid,l.isaudiocall||$UI.hideCaptcha(),u.deleteTriggerCookie(),u.handleTrigAddVist(t,o),!i)if(o.istriggeredchat||"connected"===o.chatstatus)u.setCookie(o);else{var r=(new Date).getTime()-parseInt(t.DIFFTIME)-o.intime;o.latency=r/(o.remwaitingtime+r)*o.stepinterval,u.setWaitingCookie(o),LSDebugger.postDebugInfo("Waiting time latency - splitted the addvist delay into equal intervals chid: "+o.chatID+"; Latency:"+o.latency+"; currentwaittime:"+o.waitingtime,null,"",!0)}delete o.rating;var s={name:l.visitorname,email:l.visitoremail,question:o.question,visitid:o.VISITID,department:$Support.getDeptName(o.department)};if(s.phone=o.visitorphone?o.visitorphone:"",s.customfields=l.cinfo?l.cinfo:"",o.istriggeredchat?u.Util.handleCallbacks("visitor.triggeredchat",s):u.Util.handleCallbacks("visitor.chat",s),l.isaudiocall||$Support.handleOnGoingchatActionsInConversation("newchat",o),t.media){var p=JSON.parse(t.media);for(var d in p){var c=p[d];c.isCallQueued="call_queue"==e.module,SiqAVRouter.container.audioImpl.onDirectCallStarted(c),$Support.audioid=c.id}}i||!o.wait_div||o.wait_div.length||JSON.parse(t.ISBOTCHAT)||o.istriggeredchat||(o.handleWaitingDisplay(),$UI.populateVisitorQuestion()),delete l.isaudiocall,o.abusiveendedchid==o.RCHID&&LSMessanger.joinchat(o.chatID,l.vwmsid,"","",o.visitorID),i&&o.handleQueueDisplay({average_response_time:t.average_response_time,position:t.current_position})}else u.handleAddVisitStatusChange(t,o.winid)},function(e){e=e||{},LSDebugger.postDebugInfo("Visitor Side add visitor failed - error status: "+e.status+" ; date: "+new Date+"; vwmsid:"+l.vwmsid,null,"",!0),u.addVisitErrorHandling(e),delete l.curraddvistid,$Support.LSDB.removeSessionStore("ZLD"+l.livelsid+"lastview"),delete l.isaudiocall,ZSIQConversationForm.clearSessionStorage()},"",!0,o)},addVisitErrorHandling:function(e){if(/module/.test(e.responseText))try{var t=JSON.parse(e.responseText)[0].objString.digest;return void(t?setTimeout(function(){$UI.showCaptcha(t)},300):$UI.updateOfflineUI())}catch(e){}},updateAddVistObj:function(e){var t=this.EmbedObj,i=e.NAME;t.setVisitorName(i),t.setVisitorEmail(e.EMAIL),t.setVisitorID(e.CU_ID),LSMessanger.setNickName(i)},handleTrigAddVist:function(e,t){var i=e.ADDINFO;i&&(i=JSON.parse(i),t.istrigmsg&&i[ADDINFO_TRIGGER]&&(t.istriggeredchat=!0,delete t.istrigmsg,t.chatID=e.CHID),t.isBotChat&&($UI.appendTransferDiv(t),delete t.istriggeredchat))},isOfflineChat:function(e){var t=ZSIQConversationManager.getChatWinObjById(e);return-1==t.chatID&&-1!=t.visitorID&&t.isofflinechat},handlePickUp:function(e){var t=this.EmbedObj,i=$Support.isOfflineChat(e.visitorid);if($Support.chidmappinglist[e.rchid]=e.chid,t.curraddvistid||i){var o=t.curraddvistid||e.visitorid,n=ZSIQConversationManager.getChatWinObjById(o);$Support.removeWtimeCookie(t.curraddvistid),n.chatID=e.chid,n.attender=e.attender,n.attendername=e.attendername,n.attenderzuid=e.attenderzuid,n.attenderimagefkey=e.image_fkey,n.isBotChat=1==e.isbotpickup,n.RCHID=e.rchid,n.visitorID=e.visitorid,n.updateChatInfoinInstanceDom(),delete t.curraddvistid}(n=ZSIQConversationManager.getChatWinObjById(e.chid)).isBotChat=""+e.isbotpickup=="true",""+e.isbotpickup=="true"&&(e.isBotChat=!0),n.botchatprops={status:"connected"},n.chatstatus="connected",n.attender=e.attender,n.isBotChat&&(n.contentdiv.stop(!1,!1,!0),n.chatmaindiv&&n.chatmaindiv.addClass("bot_chat")),!n.isBotChat&&ZSIQTranscript.removeTyping(!0),this.removeWaitingCookie(n.chatID),$Support.removeWtimeCookie(n.chatID),this.removeBroadCast(),n.composer&&n.composer.removeAttr("disabled"),$UI.removeCWaitHandler(),n.removeWaitingTimeValues(),n.handlePaste(),n.chatID=e.chid,n.visitorID=e.visitorid,n.attenderZUID=e.attenderzuid,n.attenderuseragent=e.attender_useragent,t.chatintime=$Support.intime;var a=CallImpl.isCallWithChat;!a&&n.hideBanner(),n.attenderimagefkey=e.image_fkey,!a&&$UI.setInnerHeader(e);try{SiqAVRouter.container.detailsHandler.triggerIconCheck(n.RCHID)}catch(e){}n.attendername=getUnescapedText(e.attendername),n.attenderemail=e.attenderemail,n.attenderaboutme=e.aboutme,DynamicMsg.updateValue("attendername",t.attendername),DynamicMsg.updateValue("attenderemail",t.attenderemail),LSMessanger.joinchat(e.chid,t.vwmsid,"","",n.visitorID),this.setCookie(n),n.removeQueueCookie(),!a&&$UI.populateUserAction(n),!a&&n.populateIcon();var r=parseInt(e.pickuptime)-parseInt(n.intime),s={attendername:n.attendername,attenderemail:n.attenderemail,visitid:n.VISITID,waitingduration:r};$Support.Util.handleCallbacks("visitor.attend",s),$Support.handleOnGoingchatActionsInConversation("pickupchat",n),$EmbedManger.setQuitStatus(!1)},sendMessage:function(e,t,i){var o=t.attr("txtarea-id"),n=ZSIQConversationManager.getChatWinObjById(o);if(!n.isbottrigmsg||!$Support.checkAndShowMandatoryFields(t,n)){if(n.isBotChat&&($Support.clearBotQuestionTimeout(),$Support.updateSIQFields({value:e})),"reply"==t.attr("msgtype"))return MessageOperation.sendReplyMessage({msg:e,visitorid:n.visitorID,composer:t,contentdiv:n.contentdiv,chid:n.chatID,msgreply_to:n.msgreply_to}),void delete n.msgreply_to;this.EmbedObj;var a=n.chatID,r=ZSIQConversationForm.checkContextInitiated();if(-1!==n.visitorID)return t.val(""),n.checkAndFocusMessageArea(),Message.send(a,e,i),n.isBotChat&&($TH.checkAndShowBotTyping&&$TH.checkAndShowBotTyping(n.department,!0),$Support.autotyping=setTimeout(function(){ZSIQTranscript.removeTyping(),$BotImpl.enableComposer()},1e4)),!1;r||(-1!==a?this.joinProactiveChat(e,n):n.isbottrigmsg&&this.handleBotTriggerReply(e,t))}},handleBotTriggerReply:function(e,t,i){if($Support.EmbedObj,i=i,t){t.val(""),this.enableTextarea(t);var o=t.closest("section [data-id]").attr("data-id");i=ZSIQConversationManager.getChatWinObjById(o)}i&&(i.istriggeredchat=!0,i.question=e,$Support.updateVisitorName(),$Support.Util.removeSendClickAction(),i.getComposer().attr("dockeyup","sendmessage"),i.initiateChat())},handleSendMessage:function(e,t,i,o,n){try{var a=e&&e.attr("txtarea-id"),r=ZSIQConversationManager.getChatWinObjById(a);r.endtimer&&this.clearEndTimer(r),16!=t&&!o&&Self.status.active(i)}catch(i){}if(this.Util.handlePredictMsg(e),13==t&&i.shiftKey)return!o&&this.Util.calculateTextareaHeight(r),!0;if("function"==typeof n?n(e):this.toggleSendButton(e),13==t){if(!Smiley.handleInSertSmiley(null,i.target))return!o&&this.Util.calculateTextareaHeight(r),!1;"function"==typeof o?o(e):this.triggerSendMessage(e),i.preventDefault()}var s=$Support.EmbedObj.eprops;JSON.parse(s.showsmiley)&&Smiley.checkAndTriggerSmiley(i,t),!o&&this.Util.calculateTextareaHeight(r)},toggleSendButton:function(e,t){var i=(e=e||$Support.getComposer()).attr("txtarea-id")||e.closest("section [fdbkarea-id]").attr("fdbkarea-id");if(i||e){var o=ZSIQConversationManager.getChatWinObjById(i);if(!t){var n=$.isEmptyObject(o)?$Support.contentdiv:o.contentdiv;if(!n)return;!(t=n.find('[proptype="sqico-send"]')).length&&(t=$Support.container.find("footer").find('[proptype="sqico-send"]'))}""===$.trim(e.val())?$Support.Util.removeSendClickAction():(t.attr("documentclick",e.attr("dockeyup")),!$Support.isNewHeader()&&t.attr("chatid",i),$Support.isNewHeader()&&$Temp.handleStartChatBTN(o),n&&n.find('[proptype="action_icons"]').addClass("show_send"))}},triggerSendMessage:function(e){var t=this.Util,i=$Support.EmbedObj,o="undefined"!=e.attr("chatid")?e.attr("chatid"):"";o=o||e&&e.closest("section [data-id]").attr("data-id");var n=ZSIQConversationManager.getChatWinObjById(o);clearTimeout(t.prdcttimer),e=n&&n.getComposer();var a=$.trim(e.val());if(""!=a){var r=Licence.verify("creditmask")&&Message.checkMaskOccurance(a,!0);if(i.creditcardmask_enabled&&r)if(i.embednewconfenabled)this.getUserConsent(1,n.winid);else{$UI.appendConsentDiv(!1,n),$Support.disableTextarea();var s=document.getElementById("msgmaindiv");Message.scroll(s)}else this.getUserConsent(0,n.winid)}},getUserConsent:function(e,t){var i=ZSIQConversationManager.getChatWinObjById(t),o=1==e,n=this.Util;clearTimeout(n.prdcttimer);var a=i.composer||$Support.getComposer(),r=$.trim(a.val()),s=r,p="";o&&(r=Message.checkMaskOccurance(r,!1),p={rawmsg:s,type:"credit_card"}),i.endtimer&&$Support.clearEndTimer(i),this.sendMessage(r,a,p),$Support.Util.removeSendClickAction(),$UI.removeConsentDiv(),$Support.enableTextarea(),$Support.Util.calculateTextareaHeight(i),n.enablepmsg=!1},getChatUserConsent:function(e,t,i,o){var n=ZSIQConversationManager.getChatWinObjById(o);$UI.removeChatConsentDiv();var a={module:"chat_consent",value:0!=e};if($Support.getParent().$ZSIQUTS.notifyCustomEvent(a),0==e)return ZSIQConversationForm.clearSessionStorage(),this.closeChatConsentCallBk(i,n),void this.checkAndPopulateLastMessage();if(!$Support.EmbedObj.status)return $Support.EmbedObj.offlinedeptid=n.department,void $Support.handleLeaveMessage(n.question);if($Support.LSDB.storeInSession(_SCREENNAME+"_gdpr_chatconsent",!0),i&&n.proactivedata)return $UI.populateUserAction(n),n.populateIcon(),handlePaste(),void $Support.startProactiveChat(n);var r=n.attender;if(!r){var s=this.LSDB.get("ZLDPERSONALIZE");r=$Support.getParent().$ZSIQChat.getWidgetData().widgettype==$Support.getParent().SIQ_PERSONALIZE&&s?s:void 0}var p=$Support.getBotUser(n.department),d=!p||r&&-1==p.indexOf(r);!n.istriggeredchat&&d?$Support.startWaitingTimer(n,!0):p&&!n.isbottrigmsg||$Support.showVisitorQuestion(n),"true"==t||LSMessanger.sid?$Support.addVisitor():this.EmbedObj.vwmsid?LSMessanger.register($Support.Util.productCode,this.EmbedObj.vwmsid):$Support.getAnnonID($Support.EmbedObj.visitorname),$TH.checkAndShowBotTyping&&$TH.checkAndShowBotTyping(n.department,!0)},startWaitingTimer:function(e,t){e.showWaitingUI("",t),e.stepinterval||(e.stepinterval=500),e.waitTimer=setTimeout(function(){e.handleWaitingDisplay(!0,null)},e.stepinterval)},startProactiveChat:function(i){var e=i.proactivedata;this.EmbedObj,i.getComposer().val(""),Message.displaySendMessage(i.chatID,i.question,"",e.msgid),$Support.handleAjax("joinproactive",e,function(e){if($Support.Util.handleUpdateBTN(),ZSIQConversationForm.clearSessionStorage(),"error"!=e.objType){var t=$Support.joinedchatkeys.indexOf(i.chatID);-1!=t&&$Support.joinedchatkeys.splice(t,1),$Support.handleJoinProActive(e.objString,i),LSMessanger.joinchat(i.chatID,$Support.EmbedObj.vwmsid,"","",i.visitorID),$Support.Util.handleCallbacks("visitor.triggerresponded",{})}}.bind(i))},closeChatConsentCallBk:function(e,t){if(e||t.istriggeredchat)return t.istriggeredchat&&t.getComposer().attr("dockeyup","triggermsg"),t.getComposer().val(""),$("#msgarea").val(""),void $Support.getParent().$ZSIQChatWindow.closeChatWindow();$Support.getParent().$ZSIQChatWindow.closeChatWindow(),setTimeout(function(){$Support.Util.closeEmbed(t)}.bind(t))},chatWindowUICallBk:function(e){if(e){var t=ZSIQConversationManager.getChatWinObjById(e),i=t.composer,o=$Support.getParent().$ZSIQUtil.getCookieValue("state");i.val(""),-1!=t.chatID&&t.chatID||t.isofflinechat||$UI.populateVisitorQuestion("",e),this.handleComposerEvents(t);var n=t.istrigmsg;if(t.proactive||n)return n||(t.updateTranscriptFromSession(),i.attr("dockeyup","sendmessage")),2==o&&$Support.getParent().$ZSIQChatWindow.expandChatWindow(),void(n&&!t.isbottrigmsg&&i.attr("dockeyup","triggermsg"));var a=this.EmbedObj.addinfo.autochat;a&&""+a=="true"&&$Support.getParent().$ZSIQChatWindow.expandChatWindow()}},handleComposerEvents:function(e){e&&e.composer.on("focus.blinktitle keyup.blinktitle click.blinktitle",function(){$Support.iscomposerfocus=!0,Message.stopBlinking()}),e&&e.composer.bind("blur.blinktitle",function(){$Support.iscomposerfocus=!1})},reJoin:function(){var e=($Support.getWaitingCookie()||{}).ongoingchats;$Support.rejoinchats(e)},rejoinchats:function(e){for(var t in e)if(e.hasOwnProperty(t)){var i=e[t],n=this,a=n.EmbedObj,o=(ZSIQConversationManager.getChatWinObjById(t),lsnocachefix("json"));o.visitorid=i.visitorID||i.vid,$.ajax({url:$Support.getAjaxURL("rejoinvisitor",dext),type:"POST",data:o,dataType:"json",success:function(e){if("error"!=e.objType){var t=e&&e[0]?e[0].objString:"",i=t.chid,o=ZSIQConversationManager.getChatWinObjById(i);if(o.chatID=i,t.visitid&&(o.VISITID=t.visitid),!t.ispickup||o.isforwardchat&&o.attender==t.attender){if(LSMessanger.joinchat(i,a.vwmsid),o.queueTimer||"queueing"==o.chatstatus)return void o.handleDequeueChat();$Support.handleCallbackForchatContinue(o,"Waiting")}else o.removeQueueCookie(),($Support.getCookieValue("ZLD"+a.livelsid).ongoingchats||{})[i]||(t.visitorid=o.visitorID,n.handlePickUp(t),$Support.handleCallbackForchatContinue(o,"Ongoing"))}}})}},handleMissed:function(e,t,i,o){$UI.removeCWaitHandler(),this.missedVisitorAction(e,t,i,o)},missedVisitorAction:function(o,e,t,i){lsnocachefix("json");var n=$Support.EmbedObj;if(-1!=i.visitorID){var a=i.visitorID+"/missed";CommonUtil.handleAjaxReq(a,"",function(e){try{var t=(e&&e.data||{}).chat_id,i=ZSIQConversationManager.getChatWinObjById(t);$Support.handleMissedVisitor(!0,o,"","",i)}catch(e){}},function(e){e=e||{};var t=JSON.parse(e.responseText)||{};t=t.error||{},LSDebugger.postDebugInfo("Visitor Side missed visitor failed - error status : "+e.status+" ; errcode : "+t.code+"; date: "+new Date+"; visitorID:"+i.visitorID,null,"",!0)})}else LSDebugger.postDebugInfo("Missed visitor not triggered - date: "+new Date+"; vwmsid:"+n.vwmsid+"; wmsstatus:"+_WMSACK+"; visitorname:"+n.visitorname+"; visitoremail:"+n.visitoremail,null,"",!0)},handleMissedVisitor:function(e,t,i,o,n){if(clearTimeout(n.waitTimer),n.queueTimer&&(n.removeQueueCookie(),n.chatdiv.find("#leavemsgonqueue").remove()),n.contentdiv.find('[proptype="msgopr"]').remove(),n.chatmaindiv&&n.chatmaindiv.removeClass("bot_chat"),e){if($Support.updateChatCookie(n.chatID),ZSIQTranscript.removeBotResetter(n),n.callquitstatus=!0,LSMessanger.disable(),t&&"ONHAS"==t)$Support.init($Support.getParent().$ZSIQWidget.getEmbedObject()),$Support.getParent().$ZSIQChatWindow.constructIframe();else if(!n.waitingtime||n.waitingtime<=0){var a=$Support.EmbedObj;if($Support.resetChatAndShowOfflineUI(o,"",n.chatID),!i){var r={name:a.visitorname,email:a.visitoremail,question:n.question,visitid:n.VISITID};r.phone=a.visitorphone?a.visitorphone:"",r.customfields=a.cinfo?a.cinfo:"",$Support.Util.handleCallbacks("visitor.missed",r)}}var s={};s.chid=n.lchid,$Support.handleOnGoingchatActionsInConversation("missedchat",s)}},handleBotBusy:function(e){var t=ZSIQConversationManager.getChatWinObjById(e);$UI.removeTransferDiv("",t),$Support.updateChatCookie(t.chatID),$Support.resetChatAndShowOfflineUI(!0,!0,e)},handleBotTransferMissed:function(e){var t=ZSIQConversationManager.getChatWinObjById(e);$UI.removeTransferDiv("",t),delete t.isforwardchat,$Support.removeWaitingStorages(t,!0),$Support.handleMissedVisitor(!0,"AGENTS_REJECTED","","",t)},handleAgentsOfflineForTransfer:function(e){$Support.LSDB.set("ZLD"+e+"transfer_state",{state:"offline"}),$UI.showOperatorOffline(ZSIQConversationManager.getChatWinObjById(e))},resetChatAndShowOfflineUI:function(e,t,i){$Support.EmbedObj;var o=ZSIQConversationManager.getChatWinObjById(i);$Support.removeWaitingCookie(i),$Support.removeWtimeCookie(i),$UI.showMissedVisitorBanner(e,t,o),o.lchid=i,o.chatID=-1,o.chatstatus="missed",o.composer&&o.composer.after($Temp.handleMissedChatBtns(o)),$BotImpl.resetDisableComposerTimer(),$Support.isNewHeader()?$("#sqico-send").attr("title",LSResource.getRealValue("embed.submit")):o.composer&&o.composer.after($Temp.getSendIcon(!0).replace(/{SQICOSEND}/g,i))},transferMissedLeaveMessage:function(e){$Support.callquitstatus=!0,LSMessanger.disable(),$Support.removeChatCookie();var t=$Support.EmbedObj;t.setPrevCHID(t.chatID),t.setChatID(-1),$BotImpl.resetDisableComposerTimer();var i=!1;"offline"==e.attr("purpose")&&(i=!0),$TH.handleMissedStatus(i)},handleLeaveMessage:function(e,t){$Support.sendOfflineMsg(e,t)},getComposer:function(){return $Support.composer||$("#msgarea")},sendOfflineMsg:function(e,r){var t={},s=$Support,p=s.EmbedObj,d=s.getComposer(),c=$.trim(d.val())||e;if(!c){var i=ZSIQConversationManager.getcurrchatwinobj();c=i.composer&&i.composer.val()}$Support.populateChatKeysFromJSAPI(t),$.extend(t,Browser.getInfo(),{referrer:processInput("trimlength",t.referrer,3e3),currentpage:processInput("trimlength",t.currentpage,950),lsid:p.livelsid,email:processInput("emailid",p.visitoremail),name:p.visitorname,msg:c,deptid:p.offlinedeptid||p.department,isengaged:s.engaged||!1}),this.updateDynamicKeys(t),p.visitorphone&&(t.phone=p.visitorphone),p.uvid&&(t.uvid=p.uvid);var o=$Support.getParent().$ZSIQUtil.getAvuid();o&&(t.avuid=o);var n=$Support.getParent().$ZSIQUtil.getZldp(p.embedname);n&&(t._zldp=n);var a=$Support.getParent().$ZSIQUtil.getAPIVisitorID();a&&(t.cvuid=a);var u=p.exid;u&&(t.exid=u);var l=p.cinfo;l&&("object"==typeof l&&(l=JSON.stringify(l)),t.cinfo=l),$Support.Util.isCampaignEnabled()&&$Support.subscribe&&(t.subscribe="true");var g=$Support.getParent().$ZSIQUtil.getAPIValues(),m=g.seclocation;m&&(t.address=$Support.getSecLocationAPIObj(m)),g.e_name&&(t.siq_name=g.e_name),g.e_email&&(t.siq_email=g.e_email);var v,h,S=this.LSDB.get("ZLDPERSONALIZE");if($Support.getParent().$ZSIQChat.getWidgetData().widgettype==$Support.getParent().SIQ_PERSONALIZE&&S){t.attender=S;var f=$Support.getParent().$ZSIQWidgetUI.getUserObj(S);v=f.name,h=f.image_fkey}var C=p.attenderemail;C&&(t.attenderemail=C),t.includebots=!0,$Support.LSDB.storeInSession(_SCREENNAME+"_gdpr_chatconsent",!0),$UI.removeOfflineConsentDiv(),s.handleAjax("leavemsg",t,function(e){if("EMBED_NOT_ALLOWED"==e.objString.exception)return ZSIQConversationForm.clearSessionStorage(),$Support.getParent().$ZSIQUtil.preserveBlockIP(),void $Support.removeWidget();if("error"!=e.objType&&"leavemsg"==e.module){var t=e.objString;if("object"===e.objType&&"EMBEDONLINE"===t.ERROR)return ZSIQConversationForm.clearSessionStorage(),void s.handleLeaveMessageStatusChange(t,r);$EmbedManger.setQuitStatus(!0);var i=$Support.getAggregateStatus(p.deptlist),o=s.engaged?p.engagedrespmsg:i[0]&&p.deptofflinerespmsg?p.deptofflinerespmsg:p.offlinerespmsg;DynamicMsg.updateValue("visit_id",t.visit_id),$Support.Util.removeSendClickAction(),$Support.bannertimeout=setTimeout(function(){$UI.showBanner(DynamicMsg.fillValues(o),!0,$Support.Util.handleMinimizeinBannerTimeout,5e3),$("#info_banr").removeClass("relate"),$Support.Util.setTextareaHeight()},700),d.val("");var n={name:p.visitorname,email:p.visitoremail,question:c,visitid:t.visit_id};n.phone=p.visitorphone?p.visitorphone:"",n.customfields=p.cinfo?p.cinfo:"",$Support.Util.handleCallbacks("visitor.offline",n);var a={};a.question=getEscapedText(c),a.endtime=t.servertime,a.name=t.name,a.visitorid=t.encvisitorid,a.department=t.deptid,v&&(a.attender=v,a.attender_imgkey=h),r&&$Support.convlistcontainer.find("[chid="+r+"]").remove(),$Support.handleOnGoingchatActionsInConversation("leavemsg",a)}},"","",!0)},setInfoCookie:function(e){var t=$Support.EmbedObj,i=$Support.container,o={question:e};CommonUtil.addIfExists(o,"name",i.find('[info = "name"]').val()),CommonUtil.addIfExists(o,"email",i.find('[info = "email"]').val()),CommonUtil.addIfExists(o,"phone",i.find('[info = "phone"]').val()),this.LSDB.set("ZLD"+t.livelsid+"VISITORINFO",o,6e4)},handleTriggerMsg:function(e,t,i){if(13==t&&i.shiftKey)return!0;$Support.toggleSendButton(e),13===t&&this.startTriggerChat(e)},checkAndShowMandatoryFields:function(e,t){return!(-1!=t.department&&!$Support.Util.IsMandatoryFieldsAvailable()||(t.disableTextarea(e),t.showUserEditUI("","","trigger"),ZSIQConversationForm.isOldFormView()&&$Support.container.find('[documentclick="updateuserdetails"]').attr("callback","trigger"),0))},startTriggerChat:function(e,t){if(e||t){var i=(e=e)?e.attr("txtarea-id")||e.attr("chatid"):"";if(e=(t=i?ZSIQConversationManager.getChatWinObjById(i):t).getComposer(),""===$.trim(e.val()))return!1;if(t.istriggeredchat=!0,!$Support.checkAndShowMandatoryFields(e,t)){var o=t.chatID;if(t.isbottrigmsg&&(!o||"-1"==o)){var n=$.trim(e.val());return e.val(""),t.question=n,ZSIQTranscript.updateTranscript({html:ZSIQTranscript.getTranscript({msg:n,sender:$Support.EmbedObj.vwmsid},"",i),ispopulate:!0},i),void $Support.handleBotTriggerReply(n)}$Support.enableTextarea(e),$Support.updateVisitorName(),$Support.Util.removeSendClickAction(),t.getComposer().attr("dockeyup","sendmessage"),t.initiateChat()}}},showVisitorQuestion:function(e){$Support.EmbedObj,void 0===e.question&&(e.question=$.trim(e.composer.val()),e.composer.attr("dockeyup","sendmessage").val("")),e.istrigmsg=!1,e.hideUserEditUI(),$UI.populateVisitorQuestion("",e.winid),e.istrigmsg=!0},disableTextarea:function(e){(e=e||$Support.getComposer()).attr("disabled","true")},enableTextarea:function(e){(e=e||$Support.getComposer()).removeAttr("disabled")},missedLeaveMsg:function(e,t,i){var o=$Support;o.ismissed=!0;var n=e&&(e.attr("txtarea-id")||e.attr("chatid"))||t,a=ZSIQConversationManager.getChatWinObjById(n);a.chatstatus&&delete a.chatstatus;var r=(e=a.composer).parent()[0].querySelector("#zsiq-voicenote");r&&(r.style="display:none"),eobj=o.EmbedObj;var s=$.trim(e.val());if(s=i?"":s,Licence.verify("creditmask")&&Message.checkMaskOccurance(s,!0)){$UI.appendConsentDiv(!0,a),a.disableTextarea(e);var p=a.contentdiv.find('[proptype="msgmaindiv"]');Message.scroll(p)}else this.getMissedUserConsent(0,a.winid,i)},getMissedUserConsent:function(e,t,i){var o=ZSIQConversationManager.getChatWinObjById(t),n=1==e,a=o,r=o.composer||$("#msgarea"),s=$Support.EmbedObj,p=o.lchid,d=$.trim(r.val());d=i?"":d,o.lchid=-1,n&&(d=Message.checkMaskOccurance(d,!1)),d&&Message.send(p,d,{userid:s.vwmsid}),$UI.removeConsentDiv(),$Support.Util.calculateTextareaHeight(o),a.hideUserEditUI();var c={};(c=lsnocachefix("json")).lsid=s.livelsid,c.visitorid=o.visitorID,c.dname=s.visitorname,c.email=s.visitoremail,c.vwmsid=s.vwmsid,d&&(c.msg=d),s.visitorphone&&(c.phone=s.visitorphone),$Support.updateDynamicKeys(c),o.disableTextarea(r),$Support.handleAjax("missedleavemsg",c,function(e){if("error"!=e.objType&&"unattleavemessage"==e.module){a.isBotChat&&ZSIQTranscript.removeTyping(!0),a.disableTextarea(r),r.val(""),delete $Support.ismissed,DynamicMsg.updateValue("visit_id",e.objString.VISITID),$Support.bannertimeout=setTimeout(function(){a.showBanner(DynamicMsg.fillValues($Support.EmbedObj.missedrespmsg),!0,function(){$Support.Util.closeEmbed(a)}),$("#info_banr").removeClass("relate"),$Support.Util.setTextareaHeight(o)},1e3);var t={};t.msg=d,t.currwinobj=a,$Support.handleOnGoingchatActionsInConversation("missedleave",t)}})},setCookie:function(e){var t=this.EmbedObj,i=$Support.getCookieValue("ZLD"+t.livelsid)||{},o=i.ongoingchats||{};if(clearTimeout($Support.timer),i.name=t.visitorname,i.email=t.visitoremail,i.phone=t.visitorphone,i.vwmsid=t.vwmsid,e){var n=e.visitorID;if(e.waitingtime||-1===e.chatID&&-1===n||"pastconv"==e.chatstatus)return;var a={cid:e.chatID,rcid:e.RCHID,did:e.department,vid:e.visitorID,vwmsid:t.vwmsid,attender:e.attender,attenderzuid:e.attenderZUID,attenderuseragent:e.attenderuseragent,uvid:t.uvid,ques:e.question,visitid:e.VISITID,imagefkey:e.attenderimagefkey},r=e.chatintime||e.intime;r&&(a.chatintime=r),e.forwardtime&&(a.forwardtime=e.forwardtime);var s=$Support.getCookieValue("ZLD"+t.livelsid),p=s&&s["aboutme_"+n],d=s&&s["attname_"+n];a["aboutme_"+n]=p||e.attenderaboutme,a["attname_"+n]=d||e.attendername,CommonUtil.addIfExists(a,"attenderemail",e.attenderemail),e.proactive&&(a.isproactive=!0),e.istriggeredchat&&(a.istriggeredchat=!0),e.isBotChat&&(a.isbotchat=!0,e.botchatprops&&(a.botchatprops=e.botchatprops)),o[e.chatID]=a,i.ongoingchats=o}this.LSDB.setCookie("ZLD"+t.livelsid,i,31e4),$Support.handleDomainStorage("updatecorsdata","localstorage"),$Support.timer=setTimeout(function(){$Support.setCookie()},3e5)},setWaitingCookie:function(e){var t=this.EmbedObj;if(t.type&&"embed"!=t.type){var i=$Support.getCookieValue("ZLD"+t.livelsid+"WAITING")||{},o=i.ongoingchats||{},n=t.embedwaitingtime;if(i.name=t.visitorname,i.email=t.visitoremail,i.phone=t.visitorphone,i.vwmsid=t.vwmsid,e){var a={vid:e.visitorID,waitinghandlerprops:{intime:e.intime,latency:e.latency},chatintime:e.intime,did:e.department,chid:e.chatID,rcid:e.RCHID,ques:e.question,visitid:e.VISITID};e.attender&&(a.attender=e.attender),e.isforwardchat&&(a.isforwardchat=!0),o[e.winid||e.chatID]=a,i.ongoingchats=o}this.LSDB.setCookie("ZLD"+t.livelsid+"WAITING",i,1e3*n)}},updateChatCookie:function(e){clearTimeout($Support.timer);var t=this.EmbedObj,i=$Support.getCookieValue("ZLD"+t.livelsid)||{},o=i.ongoingchats||{},n=Object.keys(o).length;if(1==n&&o[e]){var a={name:t.visitorname,email:t.visitoremail,phone:t.visitorphone};return this.LSDB.setCookie("ZLD"+t.livelsid,a,31e4),void $Support.handleDomainStorage("updatecorsdata","localstorage")}1<n&&(delete o[e],i.ongoingchats=o,i.name=t.visitorname,i.email=t.visitoremail,i.phone=t.visitorphone,this.LSDB.setCookie("ZLD"+t.livelsid,i,31e4),$Support.handleDomainStorage("updatecorsdata","localstorage"),$Support.timer=setTimeout(function(){$Support.setCookie()},3e5))},removeCacheCookie:function(e){this.LSDB.removeSessionStore(e+"_transcript")},getCookieValue:function(e){return e?this.LSDB.get(e):""},isSessionTranscriptEmpty:function(e){var t=e||this.EmbedObj.chatID,i=$Support.getTranscriptFromSession(t);return!(i&&0<i.length)},getWaitingCookie:function(){var e=this.getCookieValue("ZLD"+this.EmbedObj.livelsid+"WAITING");try{if("window"==PersonalSupport.type)return""}catch(e){}return e},getWaitingHandlerCookie:function(e){var t="ZLD"+this.EmbedObj.livelsid+"WTIME",i=((this.LSDB.get(t)||{}).ongoingchats||{})[e.winid];if(e.latency||(e.latency=0),!i)return!1;var o=(new Date).getTime()-i.previouscalltime;return i.remwaitingtime=i.remwaitingtime+parseInt(e.latency)-o,i.previouscalltime=(new Date).getTime(),this.updateWaitingCookie(i,e.winid),i},removeWtimeCookie:function(e){var t=this.EmbedObj;if(e){var i="ZLD"+t.livelsid+"WTIME",o=this.LSDB.get(i);if(o){var n=o.ongoingchats||{};delete n[e],Object.keys(n).length?(o.ongoingchats=n,this.LSDB.setCookie("ZLD"+t.livelsid+"WTIME",o,12e4)):this.removeCookie("ZLD"+t.livelsid+"WTIME",!0)}}},removeWaitingCookie:function(e){var t=this.EmbedObj;if(e){var i="ZLD"+t.livelsid+"WAITING",o=this.LSDB.get(i);if(o){var n=o.ongoingchats||{};delete n[e],Object.keys(n).length?(o.ongoingchats=n,this.LSDB.setCookie("ZLD"+t.livelsid+"WAITING",o,12e4)):this.removeCookie("ZLD"+t.livelsid+"WAITING",!0)}}},updateWaitingCookie:function(e,t){var i=this.EmbedObj;e=e||{remwaitingtime:1e3*i.embedwaitingtime,previouscalltime:(new Date).getTime()},cookieobj=this.getCookieValue("ZLD"+this.EmbedObj.livelsid+"WTIME")||{};var o=cookieobj.ongoingchats||{};o[t]=e,cookieobj.ongoingchats=o,this.LSDB.setCookie("ZLD"+i.livelsid+"WTIME",cookieobj,12e4)},removeChatCookie:function(){clearTimeout($Support.timer),this.removeCookie("ZLD"+this.EmbedObj.livelsid)},getTriggerCookie:function(){if(this.isFloat())return this.getCookieValue("ZLDTRIGGER"+this.EmbedObj.livelsid)},setTriggerCookie:function(e,t){if(!$Support.getTriggerCookie()||t){var i=this,o=i.EmbedObj;clearTimeout(i.triggercookietimer);var n=o.visitorname,a=o.visitoremail,r=e.message,s={isbottrigger:e.isbottrigger,sendername:e.sendername,message:r,uvid:o.uvid,name:n,email:a,cinfo:o.cinfo};e.attenderdetails&&(s.attenderdetails=e.attenderdetails),e.departments&&(s.departments=e.departments),s.winid=e.winid||e.time,r&&(s.lsid=r.lsid),this.LSDB.setCookie("ZLDTRIGGER"+o.livelsid,s,31e4),i.triggercookietimer=setTimeout(function(){i.setTriggerCookie(e,!0)},3e5)}},deleteTriggerCookie:function(){clearTimeout(this.triggercookietimer),this.removeCookie("ZLDTRIGGER"+this.EmbedObj.livelsid,!0)},removeCookie:function(e,t){this.LSDB.remove(e,t)},updateCommonKeys:function(e){var t=this.EmbedObj;t.setVisitorName(e.name),t.setVisitorEmail(e.email),t.setvwmsID(e.vwmsid),t.setVisitorPhone(e.phone)},quitChat:function(i){i.contentdiv.find("#conversationoption").remove();var e,t=this.EmbedObj,o=i.visitorID;-1!==o&&(lsnocachefix("json"),e={chid:i.chatID,lsid:t.livelsid,uname:LSMessanger.getUserId(),visitorid:encodeURIComponent(o),deptid:i.department,tzoffset:CommonUtil.TZOFFSET},ZSIQConversationManager.getChatWinObjById(i.chatID).RCHID,$BotImpl.resetMessageSequence(),$BotImpl.resetDisableComposerTimer(),this.handleAjax("leavesupport",e,function(e){var t=e.objString;$Support.isipblocked&&"error"==e.objType||($Support.handleChatEnded(t,i),i.convongoingchatobj&&(i.convongoingchatobj.find(".siqc_eletype")[0].className="siqc_eletype",i.convongoingchatobj.attr("status","end")))}.bind(i)))},getAnnonID:function(e){var t={},i=$Support.getParent().$ZSIQUtil.getAPIVisitorID();(t=lsnocachefix("json",!1)).name=e,i&&(t.cvuid=i),this.handleAjax("getannonid",t,function(e){if("getannonid"==e.module){var t=e.objString.ANNONID;$Support.EmbedObj.vwmsid=t;var i=$Support.getParent().$ZSIQChat.getWidgetData();i.embedobj.annonid=t,$Support.getParent().$ZSIQUtil.storeDetails(i),LSMessanger.register($Support.Util.productCode,t)}})},checkAndRegisterWms:function(){var e=$Support.EmbedObj;e.vwmsid?LSMessanger.register($Support.Util.productCode,e.vwmsid):$Support.getAnnonID(e.visitorname)},removeWaitingStorages:function(e,t){!t&&e.hideBanner(),$Support.removeWaitingCookie(e.chatID),$Support.removeWtimeCookie(e.chatID),e.removeWaitingTimeValues()},handleChatEnded:function(e,t){if(t){if(clearTimeout(t.endactiondelay),t.callquitstatus)return delete SUPPORT_REPS[t.chatID],void($Support.isipblocked&&($Support.getParent().$ZSIQUtil.preserveBlockIP(),setTimeout(function(){$Support.removeWidget()},3e3)));var i=t.isBotChat?"Botchatend":"Agentchatend";ZSIQTranscript.removeBotResetter(t);var o=!1;"content_moderation_end"==(e.msg&&e.msg.action)&&(o=!0,$Support.checkAbusiveChatEndOnWaiting(t),i="Abusivechatend"),t.chatmaindiv&&t.chatmaindiv.removeClass("bot_chat"),MessageOperation.removeMessagoprPopups(t),$Support.cacheCurrentChat(t),$Support.clearEndTimer(t),t.composer&&t.composer.off("paste"),delete t.chatstatus,$Widget.clearLastMessage(),$UI.updateChatEndMsg(t),$Support.Util.handleResize(t);var n={visitid:e.visitid||t.VISITID,chatduration:e.chatduration,attendername:t.attendername,attenderid:t.attender,eventtype:i};t.attenderemail&&(n.attenderemail=t.attenderemail);var a=this.EmbedObj,r=a.thanksmsg;if(r)r=DynamicMsg.fillValues(r);else{var s=a.thanksmsgobj;r=$Support.israting&&$Support.isfeedback?s.feedback_and_rating||LSResource.getRealValue("embed.thanksmsg.ratingandfeedback"):$Support.israting?s.rating||LSResource.getRealValue("embed.thanksmsg.rating"):$Support.isfeedback?s.feedback||LSResource.getRealValue("embed.thanksmsg.feedback"):LSResource.getRealValue("embed.thanksmsg.noratingandfeedback")}!o&&t.showBanner(r,!0,null,2500),this.LSDB.remove(t.chatID+"_sound"),this.LSDB.remove(a.chatID+"_translate"),t.removeQueueCookie(),$Support.removeCookie("ZLD"+t.chatID+"transfer_state"),$Support.hidetranslatebanner(t),t.removeSmileyIcon(),delete t.abusiveendedchid,t.populateFeedbackHTML(o),Message.scroll(t.chatdiv[0]),$Support.storePrechatVal(t),Message.stopBlinking(),t.lchid=t.chatID,$Support.updateChatCookie(t.chatID),$Support.removeCacheCookie(t.chatID),$Support.getWaitingHandlerCookie(t)&&$Support.removeWaitingStorages(t),$Support.Util.handleCallbacks("visitor.chatcomplete",n),t.chatID=-1,$BotImpl.resetDisableComposerTimer(),t.callquitstatus=!0,t.isBotChat&&(t.botchatprops&&t.botchatprops.status&&"waiting"==t.botchatprops.status&&($Support.removeWaitingCookie(chid),$UI.removeCWaitHandler(),clearTimeout(t.waitTimer),delete t.waitingtime),$UI.removeTransferDiv("",t)),delete $Support.ischatdisabled,t.isBotattendedchat=t.isBotChat,delete t.isBotChat,delete t.hidetransfer,delete t.botchatprops,delete t.pmsg,$Support.isipblocked&&($Support.getParent().$ZSIQUtil.preserveBlockIP(),setTimeout(function(){$Support.removeWidget()},3e3));try{var p=ZSIQConversationManager.getChatWinObjById(t.chatID).RCHID;-1==t.chatID?SiqAVRouter.container.detailsHandler.triggerIconCheck(-1):SiqAVRouter.container.detailsHandler.triggerIconCheck(p),ZSIQFileUpload.closeFilePreview()}catch(e){}}},storePrechatVal:function(e){$Support.EmbedObj.isreopenenabled||(e.lastdeptid=e.department,e.lastattender=e.attender,e.lastattenderemail=e.attenderemail,e.lastattendername=e.attendername,e.lastattenderaboutme=e.attenderaboutme)},deletePrechatVal:function(e){var t=$Support.EmbedObj;delete t.lastattender,delete t.lastattenderemail,delete t.lastattendername,delete t.lastattenderaboutme},retainPrechatVal:function(e){var t=$Support.EmbedObj;t.lastdeptid=e.lastdeptid,t.lastattender=e.lastattender,t.lastattenderemail=e.lastattenderemail,t.lastattendername=e.lastattendername,t.lastattenderaboutme=e.lastattenderaboutme},resetUIandShowFormPage:function(){this.showPreFormPage()},restartchat:function(e){if(!$Support.Util.isPreview()){$Support.retainPrechatVal(ZSIQConversationManager.getcurrchatwinobj()),ZSIQConversationManager.getcurrchatwinobj().contentdiv.hide();var t=this.EmbedObj;this.resetUIandShowFormPage(),$Support.getParent().$ZSIQChatWindow.showIframeLoading(),$Support.callquitstatus=!1,t.setVisitorID(-1),t.setChatID(-1),t.setVisitID(-1),_JOINED=!1,Message.presender="",$BotImpl.resetDisableComposerTimer(),this.checkAndHandleTriggerOnRestart(e),$UI.setFooter(),$Support.toggleSendButton()}},checkAndHandleTriggerOnRestart:function(e){var t=$EmbedManger.getuvid();if(t&&!e){var i=$Support.getprefixURL()+"/visitor/v2/"+_SCREENNAME+"/visitors/"+t+"/trigger";$.ajax({url:i,type:"POST",success:function(e){var t=e.data||{};$.isEmptyObject(t)?$Support.showPreFormPage():$Support.handleTriggerOnRestart(t)},error:function(){$Support.showPreFormPage()}})}else this.showPreFormPage()},handleTriggerOnRestart:function(e){$($Support.getParent().$ZSIQChatWindow.getChatWindowDiv()).removeClass("siq_showload");var t=e.triggers,i=JSON.parse(t.type);if(-1!=[2,16].indexOf(i)){var o=$Support.EmbedObj,n=JSON.parse(t.value),a=(n.attenderdetails,$Support.getParent().$ZSIQUTSAction);return $Support.isfeedbacksent=!1,delete o.lastattender,delete o.lastattenderemail,delete o.lastattenderimagefkey,delete o.lastattendername,n.time="0 Seconds",t.value=JSON.stringify(n),a.rechattrigger=!0,void a.handle(t)}this.showPreFormPage()},showPreFormPage:function(){$($Support.getParent().$ZSIQChatWindow.getChatWindowDiv()).removeClass("siq_showload"),$Support.isConversationAllowed()&&$Support.container.find("#showsiqconv").click(),$Support.Util.showMessageAreaUI("restartchat")},sendMail:function(e){var t=e.parent(),i=t.find("input"),o=i.val(),n=e.parents(".siq_content").attr("data-id");if(ZSIQConversationManager.getChatWinObjById(n),!i.attr("disabled")&&""!=o){if(!this.Util.validateFields(t))return!1;t.fadeOut(150,function(){t.remove()}),$UI.populateSendMailConfirm(o,n)}},sendMailConfirm:function(e){var t=e.parents(".siq_content").attr("data-id"),i=ZSIQConversationManager.getChatWinObjById(t),o=i.contentdiv,n=o.find("#consentbannerdiv"),a=!1;if(o.find(".infomsg.chtend").length&&(a=!0),e.hasClass("gltr-no"))$UI.hideUtilityDiv(n,!0,a,i);else{var r=e.attr("cattr");$UI.hideUtilityDiv(n,!0,a,i);var s=e.attr("chid")||t,p=i.visitorID,d={chid:s,fformat:"mail",toemail:$.trim(r),cmode:"live",visitorid:encodeURIComponent(p),oprname:"chat",user:$Support.EmbedObj.vwmsid,tzoffset:_TZCOFFSET};this.handleAjax("visdataexport",d,function(){i.showBanner(LSResource.getRealValue("infomsg.mailsended"),!0),$Support.Util.handleCallbacks("chat.mail",{})},function(){$UI.showBanner(LSResource.getRealValue("ne.sendmail.failed"),!0)},LSResource.getRealValue("ne.mail.progress"))}},updateTranslateCookie:function(){var e=ZSIQConversationManager.getcurrchatwinobj(),t=e.contentdiv.find("#consentbannerdiv"),i=($Support.EmbedObj,e.chatID+"_translate");this.LSDB.setCookie(i,!0),$UI.hideUtilityDiv(t,!0)},hidetranslatebanner:function(e){var t=e.contentdiv.find("#consentbannerdiv");$UI.hideUtilityDiv(t,!0)},printPreview:function(){var e=ZSIQConversationManager.getcurrchatwinobj(),t=($Support.EmbedObj,e.chatID),i=e.visitorID,o=_TZCOFFSET;if(-1!=t){if(null==t||null==t)return;var n=parseInt(80*screen.width/100),a=parseInt(77*screen.height/100),r=(screen.width-n)/2,s=(screen.height-a)/2,p=$Support.getAjaxURL("embedprintchat",".ls");p+="?chid="+encodeURIComponent(t)+"&visitorid="+encodeURIComponent(i)+"&tzoffset="+o+"&cross_domain=true",p+=lsnocachefix(),window.open(p,(new Date).getTime(),"height="+a+", width="+n+",status=yes,toolbar=no,top="+s+", left="+r+", menubar=no,location=no,scrollbars=yes,resizable=yes"),$Support.Util.handleCallbacks("chat.print",{})}$Support.Util.hideMoreActionDiv()},setRating:function(e,n){n.rating=e.attr("data-reaction");var t=n.visitorID,i={},o=$Support.getApiURl()+"/"+t+"/feedback";i.rating=n.rating,delete n.isBotattendedchat,$.ajax({url:o,type:"POST",data:JSON.stringify(i),beforeSend:function(e){e.setRequestHeader("X-SIQ-Channel","website")},dataType:"json",contentType:"application/json",success:function(e){var t=n.rating;if(CallImpl.isCallWithChat){avUIhandler&&avUIhandler.implementRatingFdbkUI(n);var i={visitid:n.VISITID,rating:n.rating,agent:n.attenderemail};return $Support.Util.handleCallbacks("visitor.rating",i),void n.contentdiv.find('[proptype = "fdbkarea"]').slideDown(250,function(){$(this).focus()})}var o=$Support.getReactionIndex(t);n.showBanner(o,!0,null,2500),i={visitid:n.VISITID,reaction:n.rating,agent:n.attenderemail},$Support.Util.handleCallbacks("visitor.rating",i),n.contentdiv.find('[proptype = "fdbkarea"]').slideDown(250,function(){$(this).focus(),ZSIQTranscript.scroll("",n.chatmaindiv)}),$("#sqico-send").show(),!(0<n.contentdiv.find('[proptype = "feedback_res"]').length&&n.contentdiv.find("#feedback_res").hasClass("lstmsg_strs"))&&n.isfeedbacksent&&$UI.showFdbkResponse(n)}.bind(n)})},handleAjax:function(o,e,t,n,i,a,r){if(!$Support["requestRunning_"+o]){r=r||"",$Support["requestRunning_"+o]=!0;var s=setTimeout(function(){i&&$UI.showBanner(i)},500),p=$Support.isSignature($Support.EmbedObj)?"emailsignature":"website",d=$Support.getAjaxURL(o,dext)+r;$.ajax({url:d,type:"POST",data:e,dataType:"json",async:!0,beforeSend:function(e){a&&e.setRequestHeader("X-SIQ-Channel",p)},success:function(e){clearTimeout(s),t&&(t(e&&e[0]),delete $Support["requestRunning_"+o])},error:function(e,t,i){clearTimeout(s),n&&(n(e),delete $Support["requestRunning_"+o])}})}},sendFeedback:function(i,e,t){if(i){var o=i.closest("section [data-id]").attr("data-id")||i.attr("chatid")||CallImpl.isCallWithChat,n=ZSIQConversationManager.getChatWinObjById(o);i=t?i:n.contentdiv&&n.contentdiv.find("#fdbkarea");var a=$Support.isfeedback;if($Support.israting,!(a&&n.isfeedbacksent||a&&i.val().length<1)||e){var r=encodeURIComponent(n.visitorID),s={};if($Support.EmbedObj,a&&!e){var p=i.val();s.feedback=p}CallImpl.isCallWithChat&&avUIhandler&&avUIhandler.implementFdbkSuccessUI(n);var d=$Support.getApiURl()+"/"+r+"/feedback";$.ajax({url:d,type:"POST",data:JSON.stringify(s),beforeSend:function(e){e.setRequestHeader("X-SIQ-Channel","website")},dataType:"json",contentType:"application/json",success:function(e){if(CallImpl.isCallWithChat){var t={visitid:n.VISITID,rating:n.rating,agent:n.attenderemail};$Support.Util.handleCallbacks("visitor.rating",t)}else n.disableTextarea(i),n.isfeedbacksent=!0,$UI.showFdbkResponse(n),t={visitid:n.VISITID,feedback:p,agent:n.attenderemail},$Support.Util.handleCallbacks("visitor.feedback",t),delete n.isratingedit}.bind(n),error:function(e){n.hideMaskDiv(),$Support.container.find("footer .floatrg").remove()}.bind(n)})}}},handleEndSession:function(e,t,i){var o=i;if(clearTimeout(o.timervar),o.endtimer=!0,o.callquitstatus&&$Support.clearTimer(o),(n={}).timer=--e,n.isstart=t,n.currwinobj=i,$Support.handleOnGoingchatActionsInConversation("endtimerupdate",n),0<e){var n,a=$("#endtimer");a.length?(a.html(e+" sec"),(n={}).timer=e,n.currwinobj=i,$Support.handleOnGoingchatActionsInConversation("endtimerupdate",n)):Message.displayInfo(LSResource.getRealValue("ne.chatend.timer",""+e),"",i.chatID),o.timervar=setTimeout(function(){$Support.handleEndSession(e,!1,o)},1e3)}else $Support.clearEndTimer(o)},clearEndTimer:function(e){e&&(clearTimeout(e.timervar),e.endtimer&&(e.contentdiv&&e.contentdiv.find("#endtimer").parents(".infomsg").fadeOut(function(){$(this).remove()}),EmbedSound.stop(),$Support.handleOnGoingchatActionsInConversation("endtimerclear",e)))},updateVisitorInfo:function(o,n,a,r){if(o||n||a){var e=$Support.EmbedObj,t=ZSIQConversationManager.getChatWinObjById(e.curreditwinid),i=lsnocachefix("json");i.visitorid=t.visitorID,o&&(i.lastname=o),n&&(i.email=n),a&&(i.phone=a),i.isnamefromemail=!!t.isnamefromemail&&t.isnamefromemail,this.handleAjax("updatevistdata",i,function(e){var t=$Support.EmbedObj,i=ZSIQConversationManager.getChatWinObjById(t.curreditwinid);delete t.curreditwinid,$Support.Util.handleUpdateBTN(),"error"!=e.objType&&(t.visitoremail=n,t.visitorname=o,t.visitorphone=a,$UI.updateVisitorName({name:o}),"function"==typeof r&&r(),i.composer.removeAttr("disabled"),i.hideUserEditUI(),$Support.setCookie(i))})}},checkAndUpdateInfo:function(t){var i=$("#siqformsave"),o=ZSIQConversationManager.getcurrchatwinobj();$Support.EmbedObj.curreditwinid=o.chatID;var n={"missed-leave":$Support.missedLeaveMsg,trigger:$Support.startTriggerChat,proactive:$Support.joinProactiveChat},a=ZSIQConversationForm.isOldFormView()?o.contentdiv.find("div.editfields"):$("#siqform");if(!$Support.checkCustomFields(o.contentdiv)||!this.Util.validateFields(a))return e.preventDefault(),!1;if($Support.checkCustomFields(o.contentdiv),!this.Util.validateFields(a))return e.preventDefault(),!1;$Support.Util.handleUpdateBTN(!0);var r=a.find('input[purpose="visitorname"]'),s=a.find('input[purpose="visitoremail"]'),p=a.find('input[purpose="visitorphone"]'),d=$.trim(r.val()),c=$.trim(s.val()),u=$.trim(p.val()),l=t.attr("callback");!d&&c&&(d=c?c.split("@")[0]:d,$Support.EmbedObj.isnamefromemail=!0);var g=$Support.EmbedObj;if(c&&(g.visitoremail=c),d&&(g.visitorname=d),u&&(g.visitorphone=u),DynamicMsg.setValues({name:g.visitorname,email:g.visitoremail,phone:g.visitorphone}),"proactive"===l)return n[l]("",o),o.hideUserEditUI(),void $Support.setCookie();if("trigger"!==l)$Support.updateVisitorInfo(d,c,u,n[l]);else{if($Support.updateInputValues(o),i.removeAttr("documentclick"),o.isbottrigmsg&&(!o.chatID||"-1"==o.chatID)){o.hideUserEditUI();var m=$Widget.getLastMessage()||o.getComposer().val();if(!m)return;return o.question=m,void $Support.handleBotTriggerReply(m,"",o)}n[l]("",o)}},joinProactiveChat:function(e,i,t){if($Support.Util.IsMandatoryFieldsAvailable())return i.disableTextarea(),i.showUserEditUI("","","proactive"),void(ZSIQConversationForm.isOldFormView()&&$('[documentclick="updateuserdetails"]').attr("callback","proactive"));var o=$Support.getParent().$ZSIQChat.getWidgetData().widgetobj,n=$Support.EmbedObj,a=n.pprops,r=$Support.LSDB.getFromSession(_SCREENNAME+"_gdpr_chatconsent"),s=!(1!=o.isgdprenabled||!JSON.parse(a.isgdprenabled)||1!=JSON.parse(a.chatprivacyconfig)||r),p=a.chatcookiepolicyurl,d=Browser.getInfo(),c=(new Date).getTime();$Support.populateChatKeysFromJSAPI(d);var u=i.getComposer();$Support.enableTextarea(u),e=e||$.trim(u.val()),LSMessanger.setNickName(n.visitorname),$.extend(d,{referrer:processInput("trimlength",d.referrer,3e3),currentpage:processInput("trimlength",d.currentpage,950),chid:i.chatID,uvid:n.uvid,vwmsid:n.vwmsid,msg:e,sid:LSMessanger.getSid(),name:n.visitorname}),n.visitorphone&&(d.phone=n.visitorphone),n.visitoremail&&(d.email=processInput("emailid",n.visitoremail));var l=lsnocachefix("json");for(var g in l)d[g]=l[g];n.cinfo&&("object"==typeof n.cinfo&&(n.cinfo=JSON.stringify(n.cinfo)),d.cinfo=n.cinfo);var m=$Support.getParent().$ZSIQUtil.getAvuid();m&&(d.avuid=m);var v=$Support.getParent().$ZSIQUtil.getZldp(n.embedname);v&&(d._zldp=v);var h=$Support.getParent().$ZSIQUtil.getAPIVisitorID();if(h&&(d.cvuid=h),t&&(d.form_response=t),i.question=e,d.msgid=c,s)return i.proactivedata=d,$UI.appendChatConsentDiv(!1,!0,p,i),void ZSIQTranscript.scroll("","",!0);u.val(""),$("#msgarea").val(""),!ZSIQConversationForm.checkContextInitiated()&&Message.displaySendMessage(i.chatID,e,"",c),$UI.populateUserAction(i),i.populateIcon(),handlePaste(),$Support.handleAjax("joinproactive",d,function(e){if(ZSIQConversationForm.clearSessionStorage(),$Support.Util.handleUpdateBTN(),"error"!=e.objType){var t=$Support.joinedchatkeys.indexOf(i.chatID);-1!=t&&$Support.joinedchatkeys.splice(t,1),$Support.handleJoinProActive(e.objString,i),LSMessanger.joinchat(i.chatID,$Support.EmbedObj.vwmsid,"","",i.visitorID),$Support.Util.handleCallbacks("visitor.triggerresponded",{})}}.bind(i))},handleJoinProActive:function(e,t){if(t){$Support.EmbedObj,t.visitorID=e.CUID,t.VISITID=e.VISITID;var i=e.ATTENDER;i&&t.attender!==i&&(t.attender=i),delete t.proactive,this.setCookie(t),t.chatmaindiv&&t.chatmaindiv.removeClass("bot_chat")}},handleApiData:function(e,t){var i=$Support.EmbedObj,o=ZSIQConversationManager.getcurrchatwinobj();if(e){i.setAddinfo(e),i.uvid=e.uvid||i.uvid,i.visitorname=e.name||i.visitorname,i.visitoremail=e.email||i.visitoremail,i.visitorphone=e.phone||i.visitorphone,i.question=e.question||i.question,i.attenderemail=e.agent||i.attenderemail,i.messagehint=e.messagehint||"";var n="-1";if(null!=e.department){var a=e.department;"online.department"!=e.department&&(e.department=[],e.defaultdepartment&&-1!=e.defaultdepartment&&-1==a.indexOf(e.defaultdepartment)&&a.push(e.defaultdepartment));for(var r=i.deptlist.length,s=0;s<r;s++)-1==a.indexOf(getDecodedText(i.deptlist[s].NAME))?i.deptlist[s].isClient=!1:"online.department"!=e.department&&e.department.push(i.deptlist[s].NAME),"object"==typeof a&&1==a.length&&a[0]==i.deptlist[s].NAME&&(n=i.deptlist[s].ID);if(0!=e.department.length){var p=a;a=e.department,"personal"==$Support.type&&$Support.status?PersonalSupport.handleDeptChange(a):this.Util.handleDeptApiChange(a,p)}}e.agent&&$.validateField("email",e.agent)&&(i.attenderemail=e.agent),e.info&&(i.cinfo=e.info);var d=e.requestid;null==d||isNaN(d)||(i.exid=d),!e.defaultdepartment&&e.department&&1==e.department.length&&(e.defaultdepartment=e.department[0]);var c=e.defaultdepartment;if(c&&-1!=c){if($Support.status&&"personal"==$Support.type)PersonalSupport.defaultdept=c;else{var u=$("#sqico-drpdwn").find('li[uniname="'+c+'"]');u.length&&(u.trigger("click",[!0]),$Support.isFloat()||$Support.Util.showOfflineBanner())}c&&e.department&&1==e.department.length&&e.department[0]==c&&($Support.container.find("#sqico-drpdwn").hide(),$Support.EmbedObj.department=n,$Support.Util.setTextareaHeight())}if(void 0!==e.forward&&($Support.nochatforward=e.forward),e["chat.waitinghandler"]&&!t&&($Support.isapiwaitinghandler=e["chat.waitinghandler"]),e.callback){var l=e.callback;if("chat.waitinghandler"in l){var g=l["chat.waitinghandler"];if("-1"==g&&(g=null),$Support.cwaitmsg=g,$Support.waitingtime&&$UI.populateCWaitHandler(),t)return}}if(e.chatstart&&!$Support.isChatExist()&&t&&!$Support.getTriggerCookie()){if($Support.requestRunning_fetchvisitorconfigurations)return;$Support.getParent().$ZSIQWidgetUI.removeCallClass(),i.addinfo.autochat=!0,$Support.resetUIandShowFormPage(),$Support.EmbedObj.status&&$Support.getParent().$ZSIQChatWindow.openChatWindow(),$Support.getComposer().trigger("keyup")}($Support.isChatExist()||$Support.getTriggerCookie()||$Support.proactive)&&e.chatstart&&$Support.getParent().$ZSIQChatWindow.openChatWindow(),e.showchatui&&($Support.getParent().$ZSIQChatWindow.openChatWindow(),($Support.isChatExist()||$Support.getTriggerCookie())&&$Support.convongoingchatobj&&$Support.convongoingchatobj.trigger("click")),e.chatend&&$Support.isChatExist()&&t&&$Support.quitConnetcedChats();var m=e.chatmessages;if(m&&"object"==typeof m){for(i.waitmsg=m.waiting||i.waitmsg,i.offlinemessage=m.offline||i.offlinemessage,i.missedmessage=m.busy||i.missedmessage,i.offlinerespmsg=m.offlinecomplete||i.offlinerespmsg,i.thanksmsg=m.complete||i.thanksmsg,i.missedrespmsg=m.busycomplete||i.missedrespmsg,i.engagedmessage=m.engaged||i.engagedmessage,i.engagedrespmsg=m.engagedcomplete||i.engagedrespmsg,i.feedbackcomplete=m.feedbackcomplete,i.ratingcomplete=m.ratingcomplete,i.ratingtitle=getEncodedText(m.ratingtitle),s=1;s<=5;s++)m["feedbackcomplete"+s]&&(i["feedbackcomplete"+s]=m["feedbackcomplete"+s]);m.chatend&&(i.chatendmessage=m.chatend)}var v=e.customfield,h=e.clearcustomfield||e.clearfield;if((v||h)&&(v&&(this.customobj=v,this.Util.handleCustomHTML()),h&&this.Util.checkAndRemoveCustomField(h),$Support.Util.setTextareaHeight()),e.chatprivacycontent&&ZSIQConversationForm.isOldFormView()){var S=$Support.container.find('[proptype="siqform"]');S.find('[proptype="chtprivacy"]').remove(),S.append('<div class="infomsg chtend siq-info-message" proptype="chtprivacy">'+e.chatprivacycontent+"</div>"),this.Util.setTextareaHeight()}e.title&&(document.title=e.title);var f=e["rating.visible"],C=e["feedback.visible"];if((f||C)&&(f&&($Support.israting="hide"!=f),C&&($Support.isfeedback="hide"!=C)),e.clogo){var b=$("#complogo"),I=$("#compurl"),D=e.cwebsite;b.length&&b.attr("src",e.clogo),D&&(D=-1==D.indexOf("http")?"http://"+D:D,I.length?I.attr("href",D):b.wrapAll("<a id='compurl' target='_blank' href='"+D+"'>"))}if($Support.EmbedObj.status&&e.floatwindowonlinetitle&&!o.attender&&!$Support.getTriggerCookie()&&$("#attname").text(e.floatwindowonlinetitle),$Support.EmbedObj.status||!e.floatwindowofflinetitle||o.attender||$("#attname").text(e.floatwindowofflinetitle),$Support.isConversationAllowed()&&e.defaultview&&"Classic"==e.defaultview&&this.openClassicUI(),e.pastchatvisible&&$Support.setPastChatVisibility(e.pastchatvisible),e.callstart&&t){$Support.updateVisitorName();var w=LSResource.getRealValue("av.info.callquesmsg",i.visitorname);$Support.container.find('[info = "question"]').val(w),i.isaudiocall=!0,i.question=w,$Support.updateInputValues(),$Support.startChat()}e.waitime&&($Support.EmbedObj.embedwaitingtime=e.waitime),this.updateValuesFromVisitorInfoCookie(),this.Util.fillApiValues()}try{$Support.isChatExist()||1!=e.initiatecall||$Support.getParent().$zoho.salesiq.call.start()}catch(e){}},handleAPIFunctionalities:function(e,t){var i=$Support.EmbedObj;"chatstart"==e?(i.addinfo.autochat=!0,$Support.getComposer().trigger("keyup")):"chatend"==e&&$Support.isChatExist()&&$Support.quitChat()},updateValuesFromVisitorInfoCookie:function(){var e=$Support.EmbedObj,t=this.getCookieValue("ZLD"+e.livelsid+"VISITORINFO");t&&(e.setVisitorName(t.name),e.setVisitorEmail(t.email),e.setAddinfo(t),t.phone&&e.setVisitorPhone(t.phone),this.removeCookie("ZLD"+e.livelsid+"VISITORINFO"))},getOfflineMessage:function(){var e=$Support.EmbedObj;if(e.bushrstatus)return $UI.getBusinessHrInfo();var t=e.deptlist,i=$Support.getAggregateStatus(t),o=i[1],n=i[0];return o?(this.engaged=!0,e.engagedmessage?DynamicMsg.fillValues(e.engagedmessage):LSResource.getRealValue(1<t.length&&n?"ne.engagedmsg_multidept":"ne.engagedmsg")):1<t.length&&n?e.deptofflinemsg?DynamicMsg.fillValues(e.deptofflinemsg):LSResource.getRealValue("ne.offlinemsg_multidept"):e.offlinemessage?DynamicMsg.fillValues(e.offlinemessage):LSResource.getRealValue("ne.offlinemsg")},getAggregateStatus:function(e){for(var t=!1,i=!1,o=$Support.EmbedObj.department,n=0;n<e.length;n++){var a=e[n];""+a.STATUS=="true"&&(i=!0),"-1"!==o&&a.ID!==o||""+a.ENGAGED!="true"||(t=!0)}return[i,t]},updateDynamicKeys:function(e){(e.phone||e.PHONE)&&DynamicMsg.updateValue("phone",e.phone);var t=e.name||e.dname||e.NAME,i=e.email||e.EMAIL;DynamicMsg.updateValue("name",t),DynamicMsg.updateValue("email",i),e.msg&&DynamicMsg.updateValue("question",e.msg),e.deptid&&DynamicMsg.updateValue("department",e.deptid)},updateChatCache:function(e,t,i){t?($.isEmptyObject(e[e.length-1])&&e.splice(e.length-1,1),$Support.cachearr[i]=e):($Support.cachearr[i]||($Support.cachearr[i]=[]),$Support.cachearr[i].push(e)),i=i||e.chid||e[0]&&e[0].chid,this.LSDB.storeInSession(i+"_transcript",$Support.cachearr[i])},isParentIframe:function(){return window.location!=window.parent.location},broadcastVisitor:function(e,n){$Support.EmbedObj;var t={};t.visitorid=n.visitorID,t.module=e||"addvisitor",$Support.LSDB.get("ZLD_ApiAVCall")&&(t.isaudiocall=$Support.LSDB.get("ZLD_ApiAVCall")),this.handleAjax("broadcastvisitor",t,function(e){if("broadcastvisitordata"==e.module&&e.objString.isagentsavailable){var t=n.attendername;t||(t=$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.userdetails.find(function(e){return e.lsuid==n.attender}).name);var i=LSResource.getRealValue("chatwindow.personalchat.transfer",t),o=i||getUnescapedText(Support.waitmsg);o=DynamicMsg.fillValues(o),n.contentdiv.find("#info_banr span").first().text(o).show()}}.bind(n))},handleStatusCallback:function(){var e="chat.offline";$Support.EmbedObj&&$Support.EmbedObj.status&&(e="chat.online"),$Support.Util.handleCallbacks(e,{})},handleAudioCallback:function(){-1<window.location.protocol.indexOf("https")&&(-1<navigator.userAgent.indexOf("Chrome")||-1<navigator.userAgent.indexOf("Firefox"))&&$Support.Util.handleCallbacks("call.isavsupported",{})},checkCustomFields:function(e){if(!$Support.contentdiv&&!e)return!0;var t=e||$Support.contentdiv,l=$Support.EmbedObj,i=t.find('[purpose="custom"]');if(!i.length)return!0;var g=$Support.EmbedObj.cinfo||{};return $.each(i,function(e,t){var i=$(t),o=i.attr("type"),n="true"==i.attr("mandatory"),a=i.attr("custom"),r=i.attr("visibility");if(l.status&&"offline"==r)return!0;if(!l.status&&"online"==r)return!0;if(i.removeClass("errfield"),"radio"==o||"checkbox"==o){var s=i.find("input:checked");a=i.attr("name");var p=[];return $.each(s,function(e,t){p.push($(t).attr("id"))}),p.length?(i.removeAttr("data-validate"),g[a]=p.join(";")):n?i.addClass("errfield"):l.cinfo&&l.cinfo[a]&&delete l.cinfo[a],!0}var d=i.val();if("selectbox"==o&&(d=i.find("#dropheader").attr("val")),!d)return!0;var c=i.attr("maxlength"),u=i.attr("minlength");if(d.length>c||d.length<u)return i.addClass("errfield"),!0;g[a]=d}),l.cinfo=g,0==t.find(".errfield").length},rejoinVisitorInUTS:function(e){var t=lsnocachefix("json");t.visitorid=e,this.handleAjax("utsrejoin",t,function(e){})},isSignature:function(e){return parent.window._IS_SIGNATURE_CHAT},handleDesktopSharing:function(e){if(e.msg){var t=e.msg.opruser.dname,i=decodeURIComponent(e.link),o="",n="";n="request"==e.msg.opr?(o="chatwindow.requestdesktop","common.share"):(o="chatwindow.sharedesktop","common.join");var a=LSResource.getRealValue(o,t)+'&nbsp;&nbsp;<a href="'+i+'" target="_blank" documentclick=openmeeting>'+LSResource.getRealValue(n)+"</a>";this.Util.displayInfo(a)}$("#mraction").find("#sharedesktop").addClass("cmn_disable")},handleMeetingJoinCB:function(){this.Util.hideInfo(),$("#mraction").find("#sharedesktop").removeClass("cmn_disable")},shareDesktop:function(e){if(!$(e).hasClass("cmn_disable")){var t=ZSIQConversationManager.getChatWinObjById($EmbedManger.getChatID()),i=t.visitorID+"/integrations/zohoassist/authenticatescreenshare";CommonUtil.handleAjaxReq(i,"",function(){$Support.Util.hideMoreActionDiv()},"",{method:"PUT"}),t.endtimer&&$Support.clearEndTimer(t)}},isHandHeldDevice:function(){return!!$Support.Util.isSIQMobilePreview()||!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB10|IEMobile|Opera Mini/i.test(navigator.userAgent)},isMobileWidth:function(){return $Support.getParent().document.body.offsetWidth<555||this.isHandHeldDevice()},setUVID:function(e){$Support.EmbedObj.uvid=e},setTabOwner:function(){var e="ZLD"+$Support.getParent().$ZSIQUtil.getLiveLSID()+"tabowner";this.LSDB.setCookie(e,LSMessanger.getSid())},getTabOwner:function(){var e="ZLD"+$Support.getParent().$ZSIQUtil.getLiveLSID()+"tabowner";return this.LSDB.get(e)},incrementUnreadCount:function(e){var t="ZLD"+$Support.EmbedObj.livelsid+"unreadcount",i=this.LSDB.get(t)||{},o=i[e];o?o+=1:o=1,i[e]=o,this.LSDB.set(t,i),$Support.getParent().$ZSIQWidgetUI.updateCount(this.getUnreadCountOnWidget(i))},getUnreadCountOnWidget:function(e){var t=0;for(var i in e)e.hasOwnProperty(i)&&(t+=e[i]);return t},getUnreadCount:function(e){var t="ZLD"+$Support.EmbedObj.livelsid+"unreadcount",i=this.LSDB.get(t)||{};return e?i[e]||"":this.getUnreadCountOnWidget(i)},removeUnreadCookie:function(e){var t="ZLD"+$Support.EmbedObj.livelsid+"unreadcount";if(e){var i=this.LSDB.get(t)||{};delete i[e],Object.keys(i).length?this.LSDB.set(t,i):this.LSDB.remove(t)}else this.LSDB.remove(t)},isAllowFreeLogo:function(){return!$Support.Util.isPreview()&&!CommonUtil.isIntegratedPortal()&&(Licence.isFreePlan()||$Support.EmbedObj.isBetaPortal)},handleDeptBasedStatusChange:function(e,t){for(var i=$Support.EmbedObj.deptlist,o=i.length,n=0;n<o;n++)if(i[n].ID==e){i[n].STATUS=t;break}},getOnlineDeptCount:function(){for(var e=$Support.EmbedObj.deptlist,t=e.length,i=0,o=0;o<t;o++)1==e[o].STATUS&&i++;return i},handleAddVisitStatusChange:function(e,t){var i=ZSIQConversationManager.getChatWinObjById(t),o=$Support.EmbedObj;clearTimeout(i.waitTimer),delete i.waitingtime,i.hideBanner(),i.contentdiv.remove(),delete o.curraddvistid,$Support.LSDB.removeSessionStore("ZLD"+o.livelsid+"lastview"),$Support.removeWaitingCookie(t),$Support.removeWtimeCookie(t),o.setDepartmentList(e.DEPTLIST),o.setEmbedStatus(e.STATUS),$Support.container.find(".msgbox textarea").stop(),ZSIQConversationManager.removeFromConvDB(t);var n=ZSIQConversationManager.getcurrchatwinobj();$.isEmptyObject(n)||(n.contentdiv.hide(),ZSIQConversationManager.resetLastViewd());try{SiqAVRouter.container.detailsHandler.triggerIconCheck(-1)}catch(e){}if($Support.container.find("#showsiqchatui").click(),$Support.Util.showMessageAreaUI("showsiqchatui"),!ZSIQConversationForm.isOldFormView()){var a=$Support.composer||$("#msgarea");a.parent().find("#sqico-send").remove(),a.after($Temp.getSendIcon(!0)),a.attr("dockeyup","leavemessage"),$Support.convlistcontainer.find("#currchatconv").find("#conv"+t).remove(),ZSIQConversationForm.clearSessionStorage()}i.contentdiv=void 0,i.composer=void 0,$Support.container.addClass("outerwin"),$Support.Util.showOfflineBanner(),$UI.setDepartment(i.department),i.question&&$("#sqico-send").attr("documentclick","leavemessage");var r=$Support.getParent().$ZSIQWidget.getWidgetObject();r.status=e.STATUS,r.onlysticker=!0,$Support.getParent().$ZSIQWidgetUI.drawWidget(r),r.hideoffline&&1==r.hideoffline[0]&&($Support.disableTextarea($Support.getComposer()),setTimeout(function(){$Support.getParent().$ZSIQChatWindow.handleChatWindowVisible("hide"),$Support.getParent().$ZSIQWidgetUI.handleWidgetVisible("hide")},3e3)),$Support.Util.handleResize(i)},handleLeaveMessageStatusChange:function(e,t){var i=$Support.EmbedObj;i.setDepartmentList(e.DEPTLIST),i.setEmbedStatus(e.STATUS),$Support.container.find(".msgbox textarea").stop(),$Support.contentdiv&&$Support.contentdiv.remove(),$Support.contentdiv=void 0,$Support.composer=void 0;var o=ZSIQConversationManager.getcurrchatwinobj();$.isEmptyObject(o)||(o.contentdiv.hide(),ZSIQConversationManager.resetLastViewd()),ZSIQConversationManager.removeFromConvDB(t);try{SiqAVRouter.container.detailsHandler.triggerIconCheck(-1)}catch(e){}$Support.container.find("#showsiqchatui").click(),$Support.Util.showMessageAreaUI("showsiqchatui"),ZSIQConversationForm.isOldFormView()||($Support.convlistcontainer.find("#currchatconv").find("#conv"+t).remove(),ZSIQConversationForm.clearSessionStorage()),$Support.container.addClass("outerwin"),$Support.Util.showOnlineBanner(),$UI.setDepartment(i.department),i.question&&$("#sqico-send").attr("documentclick","textarea")},getAjaxURL:function(e,t){return url=_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/"+e+t},getApiURl:function(e){var t=(e=e||{}).isv3api?"v3":"v2",i=e.isresourceapi?"":"/conversations";return url=_SCHEMA+"://"+_EMBEDSERVERURL+"/visitor/"+t+"/"+_SCREENNAME+i},appendMetaTag:function(){$("head").append('<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">')},getValuesForDynamicMsg:function(){var e=$Support.EmbedObj,t={};CommonUtil.addIfExists(t,"name",e.visitorname),CommonUtil.addIfExists(t,"email",e.visitoremail),CommonUtil.addIfExists(t,"phone",e.visitorphone),CommonUtil.addIfExists(t,"department",e.department);var i=e.question?e.question:$Support.composer?$.trim($Support.composer.val()):"";return CommonUtil.addIfExists(t,"question",i),CommonUtil.addIfExists(t,"visit_id",e.VISITID),CommonUtil.addIfExists(t,"attendername",e.attendername),CommonUtil.addIfExists(t,"attenderemail",e.attenderemail),t},transferChat:function(e,i){var o=ZSIQConversationManager.getChatWinObjById(i);if($BotImpl.enableComposer("",i),$Support.areUsersAvailable(o.department)){delete $Support.SIQFieldname,$Support.clearBotQuestionTimeout(),o.contentdiv.find("#conversationoption").remove();var t={};e&&e.msg&&"DEPARTMENT"!=e.msg.type&&e.msg.userid&&(t.operator_id=e.msg.userid),t.department_id=o.department,t.show_alert=!0,o.contentdiv.find(".zsiq_transferdiv").remove(),ZSIQTranscript.removeBotResetter(o),t.queue_support=!0,CommonUtil.handleAjaxReq(o.visitorID+"/transfer",t,function(e){var t=e&&e.data||{};$Support.storeHideTransfer(i),o.setBotForwardedTime((new Date).getTime()),$Support.deleteBotCookie(i,o.forwardtime),o.isforwardchat=!0,delete o.isBotChat,$Support.handleBotForwardQueue(o,t)}.bind(o),function(e){var t=JSON.parse(e.responseText)||{};6e3==(t.error&&t.error.code)&&$Support.handleAgentsOfflineForTransfer(i)},{method:"PUT"})}else $UI.showOperatorOffline(o)},handleBotForwardQueue:function(e,t){var i=t.average_response_time&&t.current_position;i&&e.contentdiv.find(".usractions").remove().end(),ZSIQTranscript.removeBotResetter(e),i&&"queueing"!=e.chatstatus&&($Support.updateChatCookie(e.chatID),e.handleQueueDisplay({average_response_time:t.average_response_time,position:t.current_position}),e.chatstatus="queueing",ZSIQTranscript.scroll())},deleteBotCookie:function(e,t){var i=$Support.EmbedObj,o=$Support.getCookieValue("ZLD"+i.livelsid),n=(o.ongoingchats||{})[e]||{};n.isforwardchat=!0,t&&(n.forwardtime=t),delete n.botchatprops,delete n.isbotchat,this.LSDB.setCookie("ZLD"+i.livelsid,o,31e4)},storeHandoffConfig:function(e,t){t||(t=$Support.EmbedObj.chatID),$Support.LSDB.storeInSession(t+"_handoffconfig",JSON.stringify(e))},getHandoffConfig:function(e){var t=$Support.LSDB.getFromSession(e+"_handoffconfig");return t?JSON.parse(t):{}},handleTransferMissed:function(e){var t=ZSIQConversationManager.getChatWinObjById(e.parents(".siq_content").attr("data-id"));$UI.removeTransferDiv(e,t);var i=t.visitorID+"/missed",o=!1;"offline"==e.attr("purpose")&&(o=!0),$Support.LSDB.remove("ZLD"+t.chatID+"transfer_state"),CommonUtil.handleAjaxReq(i,"",function(e){ZSIQConversationForm.clearSessionStorage(),$Support.handleMissedVisitor(!0,null,!0,o,t)},function(){})},hideTransferOption:function(e){$UI.removeTransferDiv("",ZSIQConversationManager.getChatWinObjById(e)),this.setCookie()},storeHideTransfer:function(e){$Support.LSDB.storeInSession(e+"_handoff",!0);var t=ZSIQConversationManager.getChatWinObjById(e);t.hidetransfer=!0,$UI.populateUserAction(t)},areUsersAvailable:function(e){var t=$Support.EmbedObj;for(var i in t.deptlist)if(t.deptlist[i].ID==e)return!t.deptlist[i].ONLYBOTSAVAILABLE;return!1},getDeptName:function(e){var t=$Support.EmbedObj;for(var i in t.deptlist)if(t.deptlist[i].ID==e)return t.deptlist[i].DNAME||t.deptlist[i].NAME},getBotUser:function(e){try{var t=$Support.EmbedObj;for(var i in e=e||t.department,t.deptlist)if(t.deptlist[i].ID==e)return t.deptlist[i].BOTUSER}catch(e){}return null},isConversationAllowed:function(){if($Support.Util.isPreview())return!1;var e=$Support.EmbedObj;return JSON.parse(e.eprops.isconversation)&&Licence.verify("conversationallowed")},bindScrollForConversationListContainer:function(){$Support.convlistcontainer.scroll(function(e){var t=e.target;if($Support.convongoingchatobj&&0==t.scrollTop&&$Support.removeConversationPopupMessage(),t.scrollHeight-t.scrollTop===t.clientHeight){if($Support.convlistindex<$Support.convlistlimit[$Support.EmbedObj.windowsize])return;$Support.PopulateConversationList(function(e,t){if(e.length){var i="";e.forEach(function(e){i+=$Temp.getConversationHistoryHTML(e)}),t?$Support.convlistcontainer.find("#pastchatconv").prepend($(i)):$Support.convlistcontainer.find("#pastchatconv").append(i),$Support.Util.showConversationListUI()}},$Support.convlistindex+1)}})},PopulateConversationList:function(o,n){var a,e={},r=$Support.getParent().$ZSIQUtil.getAvuid();if(e=lsnocachefix("json"),r){var t=this.LSDB.getFromSession(r+"_conversation");if(t&&t.length&&!n){o(t);var i=t[0];(a=i.endtime)&&(e.fromtime=a),$Support.convlistindex=t.length}e.avuid=r;var s=$Support.getParent().$ZSIQUtil.getAPIVisitorID();if(s&&(e.cvuid=s),e.limit=$Support.convlistlimit[$Support.EmbedObj.windowsize],n){if(0!=(e.index=n)){if(0!=$Support.convlistcontainer.find("#convlistloading").length||$Support.isallconvlistfetched)return;$Support.convlistcontainer.find("#pastchatconv").append($Temp.getConversationListLoadingHTML())}}else{var p=this.LSDB.get(r+"_accesstime");p&&(e.clientsynctime=p)}e.version=1;var d=$Support.getApiURl(),c=s?"&cvuid="+encodeURIComponent(s):"";d+="?avuid="+encodeURIComponent(r)+c,$.ajax({url:d,type:"GET",beforeSend:function(e){e.setRequestHeader("X-SIQ-Channel","website")},success:function(e){var t=$Support.formatConversationObject(e.data||[]);if($Support.isConversationAllowed()){if(!t.length)return a||($Support.isallconvlistfetched=!0),void($Support.Util.checkToShowConversationEmptyPage()&&$Support.Util.showConversationEmptyPage());n||$Support.LSDB.setCookie(r+"_accesstime",t[0].endtime,864e5);var i=!!a;$Support.updateConversationCache(t,r,i),o(t,i),$Support.convlistindex+=t.length}}.bind(),error:function(){}})}},formatConversationObject:function(e){for(var t=[],i=!1,o=0;o<e.length;o++){var n=e[o],a=n.attender||{},r=n.department||{},s=n.visitor||{},p=n.chat_status||{},d={};if(1!=p.state&&2!=p.state)d.attender=a.name,d.attenderid=a.id,d.attender_imgkey=a.image_key,d.chat_attended=4==p.state,d.chid=n.chat_id,d.department=r.id,d.departmentname=r.name,d.endtime=n.end_time||n.missed_time||n.start_time,d.isbotattender=a.is_bot,d.name=s.name,d.question=n.question,d.visitorid=n.id,d.wms_chat_id=n.wms_chat_id,t.push(d);else{if(1==p.state)continue;$Support.getTriggerCookie()||$Support.isChatExist()||($Support.handleLiveChatsInStorage(n,p.state),i=!0)}}if(i){delete $Support.convlistcontainer;var c=$Support.EmbedObj.curraddvistid;if(c){var u=ZSIQConversationManager.getChatWinObjById(c);$.isEmptyObject(u)||(u.checkPreviouslyInitiatedChat(),$Support.LSDB.removeSessionStore("ZLD"+$Support.EmbedObj.livelsid+"lastview"))}$Support.checkAndShowUI()}return t},handleLiveChatsInStorage:function(e,t){2!=t?"chat"==e.queue_type?$Support.setQueueingChatCookie($Support.getFormattedObjectForStorage(e)):$Support.setWaitingCookie($Support.getFormattedObjectForStorage(e)):$Support.setCookie($Support.getFormattedObjectForStorage(e))},getFormattedObjectForStorage:function(e){var t=e.attender||{},i=e.department||{},o=e.visitor||{},n=t.is_bot?{status:"connected"}:"",a={chatID:e.chat_id,visitorID:e.id,attender:t.id,attenderemail:t.email,attendername:t.name,question:e.question,attenderimagefkey:t.image_key,department:i.id,attenderuseragent:e.attenderuseragent,chatintime:e.start_time,VISITID:e.visitid,proactive:e.proactive||e.isproactive,istriggeredchat:e.istriggeredchat,isBotChat:t.is_bot,isbottrigmsg:e.isbottrigmsg,botchatprops:n,waitinghandlerprops:e.waitinghandlerprops,RCHID:e.wms_chat_id,isofflinechat:!(e.cid||e.chid||!e.vid),attenderaboutme:e.attenderaboutme};return $Support.EmbedObj.setVisitorName(o.name),a},updateConversationCache:function(e,t,i){if(e&&e.length){e=$Support.checkDuplicateInConversationList(e,t);var o=this.LSDB.getFromSession(t+"_conversation");o&&o.length&&(e=i?e.concat(o):o.concat(e)),this.LSDB.storeInSession(t+"_conversation",e)}},checkDuplicateInConversationList:function(e,t){try{var i=this.LSDB.getFromSession(t+"_conversation");if(!i||!i.length)return e;for(var o=e.length-1;0<=o;o--)for(var n=e[o],a=0;a<i.length;a++){var r=i[a];if(n.visitorid==r.visitorid){e.splice(o,1);break}}}catch(e){}return e},getConversationChatTranscript:function(t,i){var e=-1!==t?t:i,o=ZSIQConversationManager.getChatWinObjById(e),n=o.presender;$("#conversioncontainer").hide(),o.chatdiv.html($Temp.getLoadingHTML()).show();var a=$Support.getTranscriptFromSession(t);$Support.Util.showConversationTranscriptUI(i,t);var r,s=!1;if(a&&(r=a[0],s=$("#attname").html()==r.attendername),!t||-1===t){var p=$Support.getParent().$ZSIQUtil.getAvuid(),d=$Support.LSDB.getFromSession(p+"_conversation"),c={};for(var u in d){var l=d[u];if(l.visitorid==i){c=l;break}}var g={};g.question=getEscapedText(c.question),g.dname=c.name,g.mode="info",c.attender&&(g.attendername=c.attender,g.userimg=c.attender_imgkey);var m=[];return m.push(g),void $Support.Util.populateChatUI(m,i,t)}if(a&&a.length&&s)return $Support.Util.populateChatUI(a,i,t),o.presender=n,void $Support.updateReadMessageUI(a,t,!0);var v=function(e){$.trim(e)&&-1==e.indexOf("transcript.try.after.sometime")&&($.isEmptyObject(e[e.length-1])&&e.splice(e.length-1,1),e.length&&($Support.storeConversationChatTranscriptInSession(t,e),$Support.Util.populateChatUI(e,i,t),$Support.updateReadMessageUI(e,t)))};if($Support.EmbedObj.ismessageopr_allowed){var h=$Support.getprefixURL()+"/visitor/v2/"+_SCREENNAME+"/conversations/"+i+"/messages?limit=100&from=top";$.ajax({url:h,type:"GET",beforeSend:function(e){e.setRequestHeader("X-SIQ-Channel","website")},success:function(e){v($Support.formateVisitorTranscript(e,t))},error:function(){}})}else{var S=$Support.getAjaxURL("getvisitortranscript",dext);S+="?tzoffset="+_TZCOFFSET+"&visitorid="+i+lsnocachefix(!0)+"&lang="+_LANG+"&conversation=true",_CCODE&&(S+="&ccode="+_CCODE),$.get(S,"",function(e){v(e)},"json")}},getAttenderNamFromChatID:function(e){var t=$Support.getParent().$ZSIQUtil.getAvuid(),i=$Support.LSDB.getFromSession(t+"_conversation");for(var o in i)if(i[o].chid==e)return i[o].attender},formateVisitorTranscript:function(e,t){var i=e.data;for(var o in i){var n=i[o],a=n.meta,r=n.message,s=r.operation_user||{};if(a&&a.is_question)i[o]={visitorname:n.sender.name,mode:"info",intime:n.time,question:r.text,attendername:$Support.getAttenderNamFromChatID(t),chid:t,aboutme:"",is_read:n.is_read,msgid:n.client_message_id,msguid:n.id,sender:n.sender.id,time:n.time,dname:n.sender.name,is_edited:n.edited||!1,deleted:n.deleted||!1};else if("trigger"!=r.mode||"triggermsg"!=r.type)if(r.form_type)i[o]={msg:{form_type:r.form_type,msglist:r.msglist,title:r.title},time:n.time};else if("file"!=n.type||n.deleted)if("conversation"!=r.form_type&&"classic"!=r.form_type)if("info"!=n.type)i[o]={msg:n.message.text,sender:n.sender.id,meta:n.deleted?"":n.meta,msgid:n.client_message_id,msguid:n.id,time:n.time,dname:n.sender.name,is_read:n.is_read||!1,is_edited:n.edited||!1,deleted:n.deleted||!1,reply_to:n.reply_to};else{var p={acceptforward:"ACCEPT_FORWARD",accepttransfer:"ACCEPT_TRANSFER",addsupportrep:"ADDSUPPORTREP",botmessage:"BOT_MESSAGE",bottransfermissed:"bot_transfer_missed",bottrigger:"BOT_TRIGGER",chatmonitorjoin:"CHATMONITOR_JOIN",forwardsupport:"FORWARD_SUPPORT",invite:"INVITE",joinsupport:"JOIN_SUPPORT",media:"MEDIA",reopen:"REOPEN",trigger:"TRIGGER",question:"QUESTION",rejecttransfer:"REJECT_TRANSFER",transfer:"TRANSFER",endsupport:"END_SUPPORT",visitornamechange:"VISITOR_NAME_CHANGE"};if("media"==r.mode){i[o]={msg:{media:r.media,mode:p[r.mode],module:p[r.mode],operation:r.operation},time:n.time};continue}if("invite"==r.mode){r.mode=p[r.mode],i[o]={msg:r,time:n.time},r.opruser={dname:s.name,wmsid:s.id},delete r.operation_user;continue}i[o]={msg:{mode:p[r.mode]||"",msg:r.message,opruser:{dname:s.name,lsuid:s.id},time:r.time},time:n.time,is_read:n.is_read},r.user_list&&(i[o].msg.userlist={uname:r.user_list.id,dname:r.user_list.name,lsuid:r.user_list.id})}else i[o]={msg:{form_type:r.form_type,title:r.title,msglist:r.msglist},time:n.time,is_read:n.is_read};else i[o]={msg:{att_type:r.file.att_type,fName:r.file.name,size:r.file.size,url:r.file.url,content:r.file.type,fileId:r.file.id,dim:r.file.dimensions,blurimg:r.file.blur_image,comment:r.comment},mode:"att",sender:n.sender.id,meta:n.meta,msgid:n.client_message_id,msguid:n.id,time:n.time,dname:n.sender.name,is_read:n.is_read,is_edited:n.edited,reply_to:n.reply_to};else i[o]={msg:{msg:r.message,mode:"TRIGGER",time:n.time,dname:r.dname,type:"TRIGGERMSG"},msguid:n.id,msgid:n.time,sender:r.dname,time:n.time}}return i[0].chid=t,$Support.ismore_message_available[t]=e.more_data_available,i},handleReadMessage:function(e){Message.isLocalUser(e.sender)||($Support.unReadChat[e.chid]=$Support.formatMsgUid(e.msguid),$Support.sendReadCall())},formatMsgUid:function(e){return"string"==typeof e?e.replace("%","_"):e},sendReadCall:function(){var e=ZSIQConversationManager.getcurrchatwinobj();if(e.isBotChat)delete $Support.unReadChat[e.RCHID];else{var t=$Support.unReadChat[e.RCHID]||$Support.unReadChat[e.chatID];if(t&&!$("#unreadarrow").length){var i=$Support.getprefixURL()+"/visitor/v2/"+_SCREENNAME+"/conversations/"+e.visitorID+"/messages/"+t+"/read";$.ajax({url:i,type:"PUT",success:function(e){},error:function(){}}),delete $Support.unReadChat[e.RCHID]}}},removeReadReciptUI:function(e){var t=ZSIQConversationManager.getChatWinObjById($Support.chidmappinglist[e]||e).chatdiv;t&&t.find(".readrec").remove()},updateRead:function(e){var t=ZSIQConversationManager.getChatWinObjById($Support.chidmappinglist[e]).chatdiv;t&&t.find(".readrec .sqico-tick").removeClass("sqico-tick").addClass("sqico-seen").attr("title",LSResource.getRealValue("common.seen"))},updateReadMessageUI:function(e,t,i){var o=e[e.length-1],n=o.meta&&$Support.isAbusivemsgwarning(o.meta.meta_type);if(this.isVisitorID(o.sender)&&$Support.EmbedObj.read_receipt&&!n){var a=o.question?o.intime:o.time;$Support.removeReadReciptUI(t);var r=o.is_read?"sqico-seen":"sqico-tick",s=o.is_read?"common.seen":"common.sent";$('[msg-id="'+o.msguid+'"]').append('<div class="readrec" proptype="readrec"><span>'+MyDate.getHoursandMin(a,!0,"bclient")+'</span><em class="'+r+'" title="'+LSResource.getRealValue(s)+'"></em></div>'),!i&&ZSIQTranscript.scroll()}},updateMessageEdit:function(e){var t=$Support.chidmappinglist[e.chid],i=ZSIQConversationManager.getChatWinObjById(t),o=e.msg&&e.msg[0],n=$Support.formatMsgUid(e.msguid),a=(o=o.msg||{}).msg;if(o.time&&MyDate.getHoursandMin(o.time,!0,"bclient"),i.chatdiv){var r=i.chatdiv.find('[msg-id="'+n+'"]'),s="att"==MessageOperation.getMsgObj(n,t).mode;a=ZSIQTranscript.parseTextMessage({isfileatt:s,msg:a,sender:e.sender});var p=r.find('[proptype="msgholder"]');s?$Support.handleFileCommentEdit({msgcontainer:r,new_msg:a}):(p.html(a),p.find('[proptype="edited"]').length||p.append(ZSIQTranscript.getEditMsgHTML())),$Support.updateCommonDOMChangesOnMsgEdit({msgcontainer:r,chatobj:i}),$Support.updateLatestMessageOprInStorage({chatID:t,msguid:n,opr:"is_edited",convongoingchatobj:i.convongoingchatobj,editmsg:s?a:o.msg,edittime:o.time})}},updateMessageDelete:function(e){var t=$Support.chidmappinglist[e.chid],i=ZSIQConversationManager.getChatWinObjById(t),o=$Support.formatMsgUid(e.msguid),n=LSResource.getRealValue("chat.messagedelete");if(i.chatdiv){var a=i.chatdiv.find('[msg-id="'+o+'"]');0<i.contentdiv.find('[msgidval="'+o+'"]').length&&MessageOperation.removeReplymsgdiv(i),MessageOperation.removeBindedEvents(a);var r=a.find('[proptype="msgholder"]');r.length?(r.text(n).addClass("msgdel"),r.parent().removeClass("artcle-vw article-share")):(a.find(".msgbx").html('<span class="siq-user-message msgdel" proptype="msgholder">'+n+"</span>"),a.removeClass("file_msg")),$Support.updateCommonDOMChangesOnMsgEdit({msgcontainer:a}),r.find('[proptype="edited"]').remove(),$Support.updateLatestMessageOprInStorage({chatID:t,msguid:o,opr:"deleted",convongoingchatobj:i.convongoingchatobj,editmsg:n,edittime:e.time})}},updateLatestMessageOprInStorage:function(e){var t=e.chatID,i=$Support.getTranscriptFromSession(t)||[],o=i.length;if(o){for(var n=0;n<o;n++){var a=i[n];if(a.msguid==e.msguid){var r="att"==a.mode;a[e.opr]=!0,delete a.meta;var s=a.question?"question":"msg";r?a.msg&&(a.msg.comment=e.editmsg):a[s]=e.editmsg,n!=o-1||r&&"is_edited"==e.opr||$Support.handleOnGoingchatActionsInConversation("newmsg",{chid:t,msg:e.editmsg,sender:a.sender,dname:a.dname});break}}$EmbedManger.updateChatCache(i,!0,e.chatID)}},updateCommonDOMChangesOnMsgEdit:function(e){e.msgcontainer.removeClass("hr_line"),e.msgcontainer.removeClass("smily_msg"),$Support.clearEndTimer(e.chatobj),ZSIQTranscript.checkMardownClass(e.msgcontainer)},handleFileCommentEdit:function(e){var t=e.msgcontainer.find('[proptype="filecomment"]'),i=e.msgcontainer.find('[proptype="voiceplayer"]');i.length&&i.closest('[proptype="msgbx"]').addClass("att_cmt"),t.length||(t=e.msgcontainer.find("[data-ftype]").after('<code proptype="filecomment"></code>').addClass("imgcmt").next(),ZSIQTranscript.scroll()),t.html(Smiley.replace(e.new_msg)),t.find('[proptype="edited"]').length||t.append(ZSIQTranscript.getEditMsgHTML())},isVisitorID:function(e){return ZSIQTranscript.isLocalUser(e)||$Support.Util.isAnnonUser(e)},isAbusivemsgwarning:function(e){return"content_moderation_close"==e||"content_moderation_warning"==e||"content_moderation_block"==e},storeConversationChatTranscriptInSession:function(e,t){this.LSDB.storeInSession(e+"_transcript",t)},isConversationUIFocussed:function(){try{return $Support.convlistcontainer.is(":visible")||$Support.convtranscontainer.is(":visible")}catch(e){}return!1},formatMessage:function(e,t,i){e=e?e.replace("<br>","\n"):e,e=t?e:getEscapedText(e);var o=Message.getDisplayContent(e);return i||(o=Markdown.apply(o,!0)),o=Message.format(o)},isConversationTransUIFocussed:function(){try{return $Support.convtranscontainer.is(":visible")}catch(e){}return!1},handleOnGoingchatActionsInConversation:function(e,t){var i=$Support.isConversationAllowed();!i&&$Support.container.find("#showsiqconv").hide(),(!$Support.isFAQEnabled()||($FAQ.updateMessageCount(e),"newchat"!==e&&"triggerchat"!==e||!$Support.isFAQUIFocussed()))&&i&&!CallImpl.isCallWithChat&&{newchat:function(){$Support.handleNewChatInConversation(t)},pickupchat:function(){$Support.handlePickupChatInConversation("",t)},wtime:function(){$Support.handleWaitingTimeUpdateInConversation(t)},newmsg:function(){$Support.handleNewMessageInConversation(t)},triggerchat:function(){$Support.handleTriggerChatInConversation(t)},typingstatus:function(){$Support.handleAgentTypingStatusInConversation(t)},missedchat:function(){$Support.handleMissedChatInConversation(t)},missedleave:function(){$Support.handleMissedLeaveInConversation(t)},endtimerupdate:function(){$Support.handleChatEndTimerUpdateInConversation(t)},endtimerclear:function(){$Support.handleChatEndTimerClearInConversation(t)},endchat:function(){$Support.handleChatEndInConversation(t)},leavemsg:function(){$Support.handleOfflineChatInConversation(t)},formchat:function(){$Support.handleOnGoingFormInConversation(t)},queueingchat:function(){$Support.handleOnGoingQueueInConversation(t)}}[e]()},handleNewChatInConversation:function(e){try{var t=$Support.EmbedObj,i=LSResource.getRealValue("conversation.pleasewait.toconnect"),o=!1,n=!1;if(-1!=e.chatID){var a=$Support.getRecentMessageOfOngoingChat(e);i=a.recentmsg||e.pmsg,o=a.isattachment,n=a.isvisitormsg}if(e.convongoingchatobj){if(e.convongoingchatobj.attr("id")=="conv"+e.chatID){var r=$Support.formatMessage(i,o,n);return e.convongoingchatobj.find("#convmsg").html(r),e.convongoingchatobj.find("#convwtime").removeClass("dN"),e.convongoingchatobj.trigger("click"),e.convongoingchatobj.removeAttr("status"),void(e.istriggeredchat&&(e.convongoingchatobj.attr("id","conv"+e.chatID),e.convongoingchatobj.attr("visitorid",e.visitorID),e.convongoingchatobj.attr("chid",e.chatID),e.convongoingchatobj.find("#convchatattendername").text(e.attendername?e.attendername:LSResource.getRealValue("conversation.awaitingtoconnect"))))}e.proactive&&(i=t.pmsg),e.convongoingchatobj.find(".siqc_eletype").show().html(d)[0].className="siqc_eletype",e.convongoingchatobj.attr("documentclick","fetchconvtranscript"),e.applyOngoingChatClass("siqc_cntbody",e.convongoingchatobj),e.convongoingchatobj=void 0,i=e.proactive?i:LSResource.getRealValue("conversation.pleasewait.toconnect")}!$Support.isConversationAllowed()||$Support.isConversationUIFocussed()||$Support.container.find("#showsiqconv").is("visible")||$Support.container.find("#showsiqconv").show(),!i&&e.proactive&&(i=t.pmsg,$Support.container.find("#showsiqchatui").hide()),r=$Support.formatMessage(i,o,n);var s="";$Support.isUserLogoEnabled("",e)&&e.attenderimagefkey&&(s=$Support.Util.getPhotoURL(e.attenderimagefkey,e.attender)),(!e.convongoingchatobj||e.convongoingchatobj&&!e.istriggeredchat)&&$Support.convlistcontainer.find("#currchatconv").prepend(e.convongoingchatobj=$($Temp.getchatWaitingUIinConversation({chatID:e.chatID,question:e.question,visitorID:e.visitorID}))),e.convongoingchatobj.find("#convchatattendername").text(e.attendername?e.attendername:LSResource.getRealValue("conversation.awaitingtoconnect")),e.convongoingchatobj.find("#convchatattenderimg").attr("src",s),e.attender||e.convongoingchatobj.find(".sqico-user").addClass("convrstn-wait"),e.convongoingchatobj.find("[propval='convmsg']").html(r);var p=e.intime||e.chatintime;e.convongoingchatobj.find("#convwtime").attr("convmtime",p).html(MyDate.timeDifference(p));var d=$Support.getUnreadCount(e.chatID),c="siqc_cntbody";d?(c+=" siqc_newchat",e.convongoingchatobj.find(".siqc_eletype").show().html(d)[0].className="siqc_eletype"):e.convongoingchatobj.find(".siqc_eletype")[0].className="siqc_eletype sqico-chat2",$Support.applyOngoingChatClass(c,e.convongoingchatobj);var u=ZSIQConversationManager.isChatUIFocusses(e.winid);$Support.isConversationUIFocussed()||u||!e.proactive||$Support.isFAQUIFocussed()||($Support.isConversationTransUIFocussed()||!u||$Support.convlistcontainer.scrollTop()>e.convongoingchatobj.height())&&($Support.removeConversationPopupMessage(),$Support.container.append($Temp.getPopUpMessageInconversation(e.attendername,i,s,e.chatID)))}catch(e){}},handleOnGoingFormInConversation:function(e){if(e){var t=e.currwinobj;t.convongoingchatobj||($Support.convlistcontainer.find("#currchatconv").prepend(t.convongoingchatobj=$($Temp.getchatWaitingUIinConversation({chatID:t.winid,question:t.question,visitorID:t.visitorID}))),$Support.convlistcontainer.find("#currchatconv").find("#convwtime").addClass("dN"),t.convongoingchatobj.find("#convchatattendername").text(getDecodedText(ZSIQConversationForm.getOperatorName())),!$Support.isConversationAllowed()||$Support.isConversationUIFocussed()||$Support.container.find("#showsiqconv").is("visible")||$Support.container.find("#showsiqconv").show()),t.convongoingchatobj.find(".siqc_eletype")[0].className="siqc_eletype sqico-chat2";var i=e&&e.msglist?e.msglist.length:"",o=i?e.msglist[i-1]:e,n=o.meta||{},a=n.input_card?n.input_card.type:n.field_name,r="classic"==e.form_type?e.title||LSResource.getRealValue("ne.operator.question",""):o.msg;r=""==r?ZSIQConversationForm.getDefaultMessage(a.replace("_","")):getEncodedText(r),r=Markdown.apply(r,!0),r=Message.format(r),t.convongoingchatobj.find("#convmsg").html(r)}},handleTriggerChatInConversation:function(e){e.isbottrigger||e.isbottrigmsg,$Support.EmbedObj,$Support.convlistcontainer.find("#currchatconv").html(e.convongoingchatobj=$($Temp.getchatWaitingUIinConversation({chatID:e.winid,question:e.question,visitorID:e.visitorID}))),e.convongoingchatobj.find("#convchatattendername").text(e.triggername);var t="",i=$Support.getRecentMessageOfOngoingChat(e),o=i.recentmsg||e.pmsg;i.isattachment&&(o=i.rawmsg),o="string"==typeof o&&o.split("<br>").join(" "),o=getEscapedText(o),e.attenderimagefkey&&$Support.isUserLogoEnabled("",e)?t=$Support.Util.getPhotoURL(e.attenderimagefkey,e.attender):e.convongoingchatobj.find(".sqico-user").addClass("convrstn-wait"),e.convongoingchatobj.find("#convchatattenderimg").attr("src",t);var n=Markdown.apply(o,!0);e.convongoingchatobj.find("#convmsg").html(n);var a=e.time||(new Date).getTime();e.convongoingchatobj.find("#convwtime").attr("convmtime",a).html(MyDate.timeDifference(a)),$Support.container.find("#showsiqchatui").hide();var r=$Support.getUnreadCount(e.chatID),s="siqc_cntbody";r?(s+=" siqc_newchat",e.convongoingchatobj.find(".siqc_eletype").show().html(r)[0].className="siqc_eletype"):e.convongoingchatobj.find(".siqc_eletype")[0].className="siqc_eletype sqico-chat2",$Support.applyOngoingChatClass(s,e.convongoingchatobj),!$Support.isConversationAllowed()||$Support.isConversationUIFocussed()||$Support.container.find("#showsiqconv").is("visible")||$Support.container.find("#showsiqconv").show();var p=ZSIQConversationManager.isChatUIFocusses(e.winid);!$Support.isConversationUIFocussed()&&p||($Support.isConversationTransUIFocussed()||!p||$Support.convlistcontainer.scrollTop()>e.convongoingchatobj.height())&&($Support.removeConversationPopupMessage(),$Support.container.append($Temp.getPopUpMessageInconversation(e.triggername,o,t,e.winid)))},handleWaitingTimeUpdateInConversation:function(e){if(e){var t=ZSIQConversationManager.getChatWinObjById(e.winid);if(-1!=t.chatID&&t.convongoingchatobj){var i=e.wtime;$Support.applyOngoingChatClass("siqc_cntbody siqc_time",t.convongoingchatobj),t.convongoingchatobj.find(".siqc_eletype").html("").show()[0].className="siqc_eletype sqico-timer",t.convongoingchatobj.find("[propval='convwtime']").html(i)}}},handleMissedChatInConversation:function(e){var t=ZSIQConversationManager.getChatWinObjById(e.chid);if(t.convongoingchatobj){$Support.applyOngoingChatClass("siqc_cntbody siqc_chatend",t.convongoingchatobj);var i=LSResource.getRealValue("conversation.missedmsg"),o=$Support.EmbedObj;t.convongoingchatobj.find("#convchatattendername").text(o.attendername?o.attendername:"Missed Chat"),t.convongoingchatobj.find("[propval='convmsg']").html(i);var n=t.intime||t.chatintime;t.convongoingchatobj.find("[propval='convwtime']").attr("convmtime",n).html(MyDate.timeDifference(n)),t.convongoingchatobj.find(".siqc_eletype")[0].className="siqc_eletype",t.convongoingchatobj.find(".sqico-user").removeClass("convrstn-wait"),t.convongoingchatobj.find(".siqc_usrimg").addClass("sqico-missed"),t.convongoingchatobj.attr("status","end");var a=ZSIQConversationManager.isChatUIFocusses(t.winid);$Support.isConversationUIFocussed()||a||($Support.removeConversationPopupMessage(),$Support.container.append($Temp.getPopUPInfoMessageInConversation(DynamicMsg.fillValues(getUnescapedText($Support.EmbedObj.missedmessage)),t.winid)))}},handleMissedLeaveInConversation:function(e){var t=e.currwinobj;t.convongoingchatobj&&(t.convongoingchatobj[0].className="siqc_cntbody",t.convongoingchatobj.find("[propval='convmsg']").html(getEscapedText(e.msg)))},handlePickupChatInConversation:function(e,t){if(t.convongoingchatobj){$Support.EmbedObj;var i="";$Support.isUserLogoEnabled("",t)&&t.attenderimagefkey&&(i=$Support.Util.getPhotoURL(t.attenderimagefkey,t.attender)),$Support.applyOngoingChatClass("siqc_cntbody",t.convongoingchatobj),e||t.convongoingchatobj.find("[propval='convmsg']").html(getEscapedText(t.question)),t.convongoingchatobj.find("#convchatattendername").text(t.attendername?t.attendername:"Awaiting agent"),t.convongoingchatobj.find("#convchatattenderimg").attr("src",i);var o=t.intime||t.chatintime;t.convongoingchatobj.find("#convwtime").attr("convmtime",o).html(MyDate.timeDifference(o)),t.convongoingchatobj.find(".siqc_eletype")[0].className="siqc_eletype sqico-chat2",t.convongoingchatobj.find(".sqico-user").removeClass("convrstn-wait")}},handleOnGoingQueueInConversation:function(e){try{var t=$Support.EmbedObj,i=e.attendername;!$Support.isConversationAllowed()||$Support.isConversationUIFocussed()||$Support.container.find("#showsiqconv").is("visible")||$Support.container.find("#showsiqconv").show(),e.convongoingchatobj&&!e.convongoingchatobj.find("#queueinfo").length&&(e.convongoingchatobj.remove(),delete e.convongoingchatobj);var o="",n=t.clogo_key&&"0"!=t.clogo_key.split("_")[0];!e.attender&&JSON.parse(t.eprops.iclogo)&&n?o=t.clogo+"?nps=202":$Support.isUserLogoEnabled("",e)&&e.attenderimagefkey&&(o=$Support.Util.getPhotoURL(e.attenderimagefkey,e.attender)),e.convongoingchatobj||$Support.convlistcontainer.find("#currchatconv").prepend(e.convongoingchatobj=$($Temp.getchatQueueingUIinConversation({chatID:e.chatID,visitorID:e.visitorID}))),e.convongoingchatobj.find("#convchatattendername").text(i||$Support.getDeptName(e.department)),e.convongoingchatobj.find("#convchatattenderimg").attr("src",o),e.convongoingchatobj.find("[propval='convmsg']").html("You are in Queue no. 8 - 2:45 mins")}catch(e){}},handleNewMessageInConversation:function(e){var t=ZSIQConversationManager.getChatWinObjById(e.chid);if(t.convongoingchatobj){$Support.EmbedObj;var i=e.filename,o=e.content;i||(i=e.msg,"object"==typeof e.msg&&(i=e.msg.fName,o=e.msg.content)),i=e.iscannedarticle?e.cardheader:i;var n=$Support.Util.isAnnonUser(e.sender),a=Message.getDisplayContent(i);n||(a=Markdown.apply(a,!0)),a=Message.format(a);var r=$Support.Util.getFileClassType(o);a=r?'<em class="'+r+'">'+a+"</em>":a;var s="siqc_cntbody";t.convongoingchatobj.find("[propval='convmsg']").html(a);var p=$Support.getUnreadCount(t.chatID);if(p){s+=" siqc_newchat",t.convongoingchatobj.add("#conv-tab").find(".siqc_eletype").show().html(p)[0].className="siqc_eletype",$("#conv-tab").addClass("count");var d=ZSIQConversationManager.isChatUIFocusses(t.winid);if(($Support.isConversationUIFocussed()||!d)&&!Message.isLocalUser(e.sender)&&!$Support.isFAQUIFocussed()){if(!$Support.isConversationUIFocussed()&&!d||$Support.convlistcontainer.scrollTop()>t.convongoingchatobj.height()){$Support.removeConversationPopupMessage();var c="";-1!=e.sender.indexOf(t.attender)&&$Support.isUserLogoEnabled("",t)&&(c=$Support.Util.getPhotoURL(t.attenderimagefkey,t.attender)),$Support.container.append($Temp.getPopUpMessageInconversation(e.dname,a,c,t.chatID))}if(!d){var u=$Support.container.find("#showsiqconv");0==u.find("#siqnoticon").length&&u.prepend("<em id='siqnoticon'chid='"+t.chatID+"' class='siqc_prochtcls' documentclick='showchatui'></em>")}}}else t.convongoingchatobj.find(".siqc_eletype")[0].className="siqc_eletype sqico-chat2";$Support.applyOngoingChatClass(s,t.convongoingchatobj)}},removeConversationPopupMessage:function(){$Support.container.find("#convpopupmsg").remove(),$Support.container.find("#convpopupmsg").remove()},handleAgentTypingStatusInConversation:function(e){var t=$Support.chidmappinglist[e.chid],i=ZSIQConversationManager.getChatWinObjById(t);if(i.convongoingchatobj){$Support.EmbedObj;var o=e.msg,n=$Support.getUnreadCount(i.chatID),a="siqc_cntbody";if(o)a+=" siqc_type",i.convongoingchatobj.find("#convmsg").html(LSResource.getRealValue("conversation.agent.typing")),i.convongoingchatobj.find(".siqc_usrimg").addClass("sqico-typing");else{var r=$Support.getRecentMessageOfOngoingChat(i),s=r.recentmsg,p=Message.getDisplayContent(s);r.isvisitormsg||(p=Markdown.apply(p,!0)),p=Message.format(p),p=getEscapedText(p),i.convongoingchatobj.find("#convmsg").html(p),i.convongoingchatobj.find(".siqc_usrimg").removeClass("sqico-typing")}n?(a+=" siqc_newchat",i.convongoingchatobj.find(".siqc_eletype").show().html(n)[0].className="siqc_eletype"):i.convongoingchatobj.find(".siqc_eletype")[0].className="siqc_eletype sqico-chat2",$Support.applyOngoingChatClass(a,i.convongoingchatobj)}},handleChatEndTimerUpdateInConversation:function(e){var t=e.currwinobj;if(t.convongoingchatobj){var i=e.isstart,o=LSResource.getRealValue("conversation.endtimer.secs",""+e.timer);$Support.applyOngoingChatClass("siqc_cntbody siqc_goend",t.convongoingchatobj),t.convongoingchatobj.find("#convwtime").html(o).show();var n=LSResource.getRealValue("conversation.chat.goingtoend");t.convongoingchatobj.find("#convmsg").html(n),t.convongoingchatobj.find(".siqc_eletype").html("").show()[0].className="siqc_eletype sqico-alert";var a=ZSIQConversationManager.isChatUIFocusses(t.winid);if(($Support.isConversationUIFocussed()||!a)&&($Support.isConversationTransUIFocussed()||$Support.convlistcontainer.scrollTop()>t.convongoingchatobj.height())){var r=$Support.Util.getPhotoURL(t.attenderimagefkey,t.attender);if(i)$Support.container.append($Temp.getPopUpAlertInconversation(t.attendername,LSResource.getRealValue("conversation.chatsess.goingtoend"),o,r));else{var s=$Support.container.find("#convpopupmsg");0!=s.length&&s.find("#alerttimer").html(o)}if($Support.isConversationTransUIFocussed()||!a){var p=$Support.container.find("#showsiqconv");p.find("#siqnoticon").remove(),p.prepend("<em id='siqnoticon' class='sqico-alert' documentclick='showchatui'></em>")}}}},handleChatEndTimerClearInConversation:function(e){if(e.convongoingchatobj){$Support.EmbedObj;var t=$Support.getRecentMessageOfOngoingChat(e),i=t.recentmsg,o=Message.getDisplayContent(i);t.isvisitormsg||(o=Markdown.apply(o,!0)),o=Message.format(o);var n="siqc_cntbody";e.convongoingchatobj.find("#convwtime").html(MyDate.timeDifference(e.intime||e.chatintime)),e.convongoingchatobj.find("#convmsg").html(o);var a=$Support.getUnreadCount(e.chatID);a?(n+=" siqc_newchat",e.convongoingchatobj.find(".siqc_eletype").show().html(a)[0].className="siqc_eletype"):e.convongoingchatobj.find(".siqc_eletype")[0].className="siqc_eletype sqico-chat2",$Support.container.find("#showsiqconv").find("#siqnoticon").remove(),$Support.applyOngoingChatClass(n,e.convongoingchatobj),$Support.removeConversationPopupMessage()}},handleChatEndInConversation:function(e){var t=e.currwinobj;if(t.convongoingchatobj){$Support.EmbedObj;var i=$Support.Util.isAnnonUser(e.sender)?"siqc_cntbody":"siqc_cntbody siqc_chatend";$Support.applyOngoingChatClass(i,t.convongoingchatobj);var o=LSResource.getRealValue("converation.chat.ended");t.convongoingchatobj.find("[propval='convmsg']").html(o);var n=t.intime||t.chatintime;t.convongoingchatobj.find("[propval='convwtime']").attr("convmtime",n).html(MyDate.timeDifference(n)),t.convongoingchatobj.find(".siqc_eletype").html("").show()[0].className="siqc_eletype",t.convongoingchatobj.attr("status","end"),$Support.removeConversationPopupMessage();var a=ZSIQConversationManager.isChatUIFocusses(t.winid);if(!$Support.isConversationUIFocussed()&&!a){var r=e.msg&&e.msg.opruser&&e.msg.opruser.dname?LSResource.getRealValue("converation.agent.chat.ended","<b>"+e.msg.opruser.dname+"</b>"):LSResource.getRealValue("converation.chat.ended");$Support.container.append($Temp.getPopUPInfoMessageInConversation(r,t.winid))}$Support.handleDomainStorage("updatecorsdata","localstorage")}},handleOfflineChatInConversation:function(e){if($Support.isConversationAllowed()){var t=[];t.push(e);var i=$Support.getParent().$ZSIQUtil.getAvuid();$Support.updateConversationCache(t,i,!0);var o=$Temp.getConversationHistoryHTML(e);$Support.convlistcontainer.find("#pastchatconv").prepend(o),!$Support.isConversationAllowed()||$Support.isConversationUIFocussed()||$Support.container.find("#showsiqconv").is("visible")||$Support.container.find("#showsiqconv").show()}},handleChatTransferInConversationListView:function(e){if(e.convongoingchatobj){$Support.EmbedObj;var t="";$Support.isUserLogoEnabled("",e)&&e.attenderimagefkey&&(t=$Support.Util.getPhotoURL(e.attenderimagefkey,e.attender)),e.convongoingchatobj.find("#convchatattenderimg").attr("src",t),e.convongoingchatobj.find("#convchatattendername").text(e.attendername)}},getRecentMessageOfOngoingChat:function(e){$Support.EmbedObj;var t=e.question,i=!1,o=!1,n=-1!=e.chatID?e.chatID:e.winid,a=$Support.cachearr[n]||[],r="";if(a.length){var s=a[a.length-1];if(s.msg)if(o=$Support.Util.isAnnonUser(s.sender),"object"!=typeof s.msg)t=s.iscannedarticle?s.cardheader:s.msg;else if("object"==typeof s.msg)if(s.msg.fName){t=s.msg.fName;var p=$Support.Util.getFileClassType(s.msg.content);r=t,t=p?'<em class="'+p+'">'+t+"</em>":t,i=!0}else if("cannedarticle"===s.msg.mode)t=$FAQ.getHeaderMessage(s.msg.msg);else{var d=s.msg.msglist||[],c=d.length;s.msg.form_type&&d&&c&&(t=d[c-1].msg||"",o=!0)}}return{recentmsg:t,isattachment:i,isvisitormsg:o,rawmsg:r}},applyOngoingChatClass:function(e,t){t&&(t[0].className=e)},cacheCurrentChat:function(e){if($Support.isConversationAllowed()){$Support.EmbedObj;var t=[],i={};i.attender=e.attendername,i.attenderid=e.attender,i.attender_imgkey=e.attenderimagefkey,i.question=e.question,i.chid=e.chatID,i.visitorid=e.visitorID,i.endtime=(new Date).getTime(),i.isbotattender=e.isBotChat,i.department=e.department;var o=$Support.cachearr[e.chatID]||[],n=o[o.length-1];n&&(n.iscannedarticle&&(n.msg=n.cardheader),i.lastmsg=JSON.stringify(n)),t.push(i);var a=$Support.getParent().$ZSIQUtil.getAvuid();$Support.updateConversationCache(t,a,!0)}},handleNewsLetter:function(){$Support.Util.isPreview()&&$CWPreview.handleNewsLetter()},getEmbedSize:function(){var e=$Support.getParent().$ZSIQWidget.getEmbedSize();return 1==e?2:e},getEmbedSizeClass:function(){return $Support.isMobileWidth()?"":" zsiq_size"+$Support.getEmbedSize()},removeWidget:function(){try{$Support.getParent().$zoho.salesiq.tracking.off()}catch(e){}var e=$Support.getParent().$ZSIQChatWindow.getChatWindowDiv(),t=$Support.getParent().$ZSIQWidgetUI.getWidgetDiv();e&&e.remove(),t&&t.remove()},handleBotTransferAccept:function(e){var t=ZSIQConversationManager.getChatWinObjById(e);$Support.removeCookie("ZLD"+$Support.EmbedObj.livelsid+"WAITING"),$UI.removeCWaitHandler(),clearTimeout(t.waitTimer),$UI.removeTransferDiv("",t),delete t.waitTimer,delete t.waitingtime,delete t.isBotChat,delete t.botchatprops,$Support.handlePickupChatInConversation(!0,t);var i=$TH.getHeader();$Support.isUserLogoEnabled("",t)&&i.find(".cmplogo").attr("data-chttype","agent"),$UI.populateUserAction(t)},isChatExist:function(){var e=($Support.getCookieValue("ZLD"+$Support.EmbedObj.livelsid)||{}).ongoingchats||{},t=($Support.getWaitingCookie()||{}).ongoingchats||{},i=$Support.getQueueingCookie().ongoingchats||{};return 0<Object.keys(e).length||0<Object.keys(t).length||0<Object.keys(i).length},isOnlineChat:function(){return $Support.EmbedObj.status},isMacOS:function(){return!!navigator.platform.match(/Mac/i)},openClassicUI:function(){$Support.isChatExist()||0<$Support.convlistcontainer.find("#pastchatconv").find(".siqc_cntbody").length&&$Support.container.find("#showsiqchatui").click()},isFAQEnabled:function(){var e=$Support.EmbedObj.faqaccess;return!!Licence.verify("faqallowed")&&!!e.length&&1==$Support.EmbedObj.faqaccess[0]},getConversationData:function(){var e=$Support.getParent().$ZSIQUtil.getAvuid();return $Support.LSDB.getFromSession(e+"_conversation")},isShowConversationArrow:function(e){return $Support.getConversationData()||e.convongoingchatobj||$Support.isChatExist()},getRecentLiveChatid:function(){var e=($Support.getWaitingCookie()||{}).ongoingchats||{};if(Object.keys(e)[0])return Object.keys(e)[0];var t=($Support.getCookieValue("ZLD"+$Support.EmbedObj.livelsid)||{}).ongoingchats||{};if(Object.keys(t)[0])return Object.keys(t)[0];var i=$Support.getTriggerCookie()||{};return i?i.winid:void 0},showConversation:function(e){if(e.addClass("sel").next(".sel").removeClass("sel"),$("#conv-tab").removeClass("count").find(".siqc_eletype").hide(),$FAQ.checkandSetHeaderUserClass(),!$Support.getConversationData()||$Support.isChatExist()||$Support.getTriggerCookie()){if(!$Support.Util.checkToShowConversationEmptyPage()){var t=ZSIQConversationManager.getcurrchatwinobj();t.contentdiv&&t.contentdiv.hide(),$Support.contentdiv&&$Support.contentdiv.hide(),ZSIQConversationManager.resetLastViewd();var i=$Support.getRecentLiveChatid(),o=i?$("<div>",{chid:i}):"";return i?$Support.Util.showMessageAreaUI("","",o):$Support.Util.showMessageAreaUI("showsiqchatui"),void(i&&$Support.Util.calculateTextareaHeight(ZSIQConversationManager.getChatWinObjById(i)))}$Support.Util.showConversationEmptyPage(e)}else $Support.Util.showConversationListUI(e)},isFAQUIFocussed:function(){try{return"faqview"===$Support.container.attr("cwview")}catch(e){}return!1},handleVTransLang:function(e){var t=$Support.getParent(),i=t.$ZSIQChat.getWidgetData().widgetobj,o=t.$ZSIQWidget.getEmbedObject().pinfo,n=i.privacyconfig||{};n=n.notifygt||{};var a=1==i.isgdprenabled,r=$Support.chidmappinglist[e.chid],s=ZSIQConversationManager.getChatWinObjById(r),p=!1,d=n.url||o.pinfo.gtpolicyurl;if(o&&o.pinfo){var c=o.pinfo;p=JSON.parse(c.isgdprenabled)}if(p){if(a||(2==e.GDPRStatus&&$Support.handleVTransLangStatus(1,e.lang,s),e.GDPRStatus=0),1==JSON.parse(e.GDPRStatus)){var u=d||_GT_ATTRIBUTIONLINK;u=CommonUtil.validateURL(u);var l=$UI.getTranslateBannerHTML(getUnescapedText(s.attendername),d);s.contentdiv.find(".chtcont").after(l),s.contentdiv.find("#gtconsenturl").attr("href",u),$Support.Util.calculateTextareaHeight(s)}else 2==JSON.parse(e.GDPRStatus)&&$UI.appendGTConsentDiv(d,e.lang,s.chatdiv);ZSIQTranscript.scroll()}},handleVTransLangStatus:function(e,t,i){i=i||ZSIQConversationManager.getcurrchatwinobj(),$UI.removeGTConsentDiv();var o=$Support.getAjaxURL("setvtranslang",dext),n=lsnocachefix("json");n.chid=i.chatID,n.visitorid=i.visitorID,n.gdprstatus=e,n.attender=i.attender,n.lang=t,$.ajax({url:o,data:n,type:"POST"})},handleBotSkipOffline:function(e){var t=ZSIQConversationManager.getChatWinObjById(e);clearTimeout(t.waitTimer),delete t.waitingtime,$UI.hideBanner(),this.removeWaitingCookie(t.chatID),t.contentdiv.find(".msgbox textarea").stop(),$UI.updateOfflineUI(!0),$Support.container.addClass("outerwin"),$Support.Util.showOfflineBanner(),t.contentdiv.find(".zsiq_transferdiv").remove()},handleBotTrigger:function(e,t){var i=e.msg,o=i.lsid;if(!o||o==$Support.EmbedObj.livelsid){i.msglist;var n={isbottrigger:!0,attenderdetails:{attender:i.attender},message:i,sendername:i.dname,time:i.time},a=i.departments;a&&(n.departments=a),$Support.setTriggerCookie(n),!t.repopulate&&$Support.getParent().$ZSIQChatWindow.openChatWindow(!0),t.department=1==a.length?a[0]:t.department,t.pmsg=e.msg,!t.repopulate&&$BotImpl.formatAndDisplay(e,t.winid),$Support.Util.updateHeader(e.msg),$Support.Util.updateViewAttribute("msgarea"),$('[data-chttype="agent"]').removeClass("sqico-chat"),$Support.container.find("#showsiqchatui").hide(),$Support.handleOnGoingchatActionsInConversation("triggerchat",t),!$Support.isConversationAllowed()&&$Support.container.find("#showsiqconv").hide()}},getOrderedDepartmentList:function(){var e=$Support.getApiDepartment(),t=$Support.EmbedObj.deptlist,i=[];if(!e.length)return t;for(var o in e)for(var n in t){var a=t[n];if(a.NAME==getEncodedText(e[o])){i.push(a);break}}return i},getEmbedDepartments:function(){var e=$Support.getOrderedDepartmentList(),t=ZSIQConversationManager.getcurrchatwinobj();if($Support.getParent().$ZSIQChat.isAgentSpcificSignatureChat()&&(e=$Support.convertDeptStatus(e)),!t.isbottrigmsg)return e;var i=$Support.getTriggerCookie();if(i&&i.departments){for(var o=i.departments,n=[],a=0;a<e.length;a++){var r=e[a],s=r.ID;-1!=o.indexOf(s)&&n.push(r)}return n}return e},convertDeptStatus:function(e){for(var t=e.length,i=$Support.EmbedObj.status,o=0;o<t;o++)e[o].STATUS=i;return e},updateSIQFields:function(e){var t=e.name;if(t){var i=t.split("_");"siq"===i[0]&&(i=i.splice(1),$Support.SIQFieldname=i.join("_"))}else if($Support.SIQFieldname&&e.value){var o=$Support.SIQFieldname;delete $Support.SIQFieldname,$Support.updateVisitorData(o,e.value)}},updateVisitorData:function(e,t){if(-1!=["name","email","phone"].indexOf(e)){var i={};i[e]=t;var o=$Support.EmbedObj,n=i.name||o.visitorname,a=i.email||o.visitoremail,r=i.phone||o.visitorphone;$Support.updateVisitorInfo(n,a,r)}},handleBotTransfer:function(e,t){$Support.transferChat(e,t)},handleBotProgressInfo:function(e){var t=$("#typgstatus");t.text(e.text),t.attr("title",e.text)},showRepliesNow:function(e){var t=e.replies;if(t&&0<t.length)for(var i in t){var o=t[i];Message.formatAndDisplay({sender:e.sender,time:e.time,dname:e.dname,msg:o.text,image:o.image})}},getBroadcastText:function(){return this.LSDB.get("ZSIQ"+$Support.EmbedObj.chatID+"BROATCAST")},removeBroadCast:function(){var e=$Support.EmbedObj;return delete $Support["broadcasted_"+e.visitorID],this.LSDB.remove("ZSIQ"+e.chatID+"BROATCAST")},getprefixURL:function(){return _SCHEMA+"://"+_EMBEDSERVERURL},handleBotContextTimeout:function(){$Widget.skipQuestion()},clearBotQuestionTimeout:function(){$Support.BOT_TIMER&&clearTimeout($Support.BOT_TIMER)},getSkipObj:function(){delete $Support.SIQFieldname;var e=$Support.EmbedObj;return{chatid:e.chatID,url:$Support.getprefixURL()+"/visitor/v2/"+_SCREENNAME+"/chat/"+e.chatID+"/skip?sender="+e.vwmsid+"&visitor_id="+e.visitorID,data:{sender:e.vwmsid,visitor_id:e.visitorID},bottimer:$Support.BOT_TIMER,vwmsid:e.vwmsid,visitorID:e.visitorID}},getZMapKeys:function(){var e=$Support.getParent().$ZSIQWidget.getWidgetObject();return{zmapapicss:e.zmapapicss,zmapstaticurl:e.zmapstaticurl,zmapapiurl:e.zmapapiurl,zmapapikey:e.zmapapikey,mapboxgl:$Support.getParent().mapboxgl}},getThemeID:function(){return parseInt($Support.theme.replace("theme",""))},isNewHeader:function(){return-1!=[4,8,9,10].indexOf($Support.getThemeID())},isUserLogoEnabled:function(e,t){t=t||{};var i=$Support.EmbedObj;return!(e||!t.isBotChat&&!t.isbotpickup)||!i||e&&e.isbotattender||JSON.parse(i.eprops.icphoto)},hideBotEditUICB:function(){$Support.isbottrigmsg&&($Support.chatWindowUICallBk(),$BotImpl.resetDisableComposerTimer(),$BotImpl.resetMessageSequence())},getDStorageIframe:function(){try{var e=document.getElementById("dstorageframe");return e.contentWindow||e.contentDocument.document||e.contentDocument}catch(e){return null}},dCookieCallbackHandler:function(e){if(e){var t=parseInt(e[$Support.zohopublickeys.cookie[0]]),i=e[$Support.zohopublickeys.cookie[1]];0!=t&&1!=t||$Support.getParent().$ZSIQUtil.updateCookieForTracking(t,i)}},dStorageCallbackHandler:function(e){for(var t in e)e[t]&&(t===$Support.zohopublickeys.localstorage[1]&&($Support.updateCommonKeys(e[t]),e[t].time=(new Date).getTime()),$Support.LSDB.storeInLocalStorage(t,e[t]));if(-1!=$Support.EmbedObj.chatID){var i=$Support.getParent();$Support.deleteTriggerCookie(),i.$ZSIQChat.init(),i.$ZSIQChatWindow.openChatWindow()}},setValueInDStorage:function(e,t,i,o,n){var a={};a.key=e,a.value=t,a.expiry=o,a.domain=n,a.operation={localstorage:"setvalue",cookie:"setcookie"}[i],$Support.getDStorageIframe().postMessage(CommonUtil.toJSON(a),$Support.postMesaageUrl)},getValueFromDStorage:function(e,t){var i={};i.keys=CommonUtil.toJSON(e),i.operation="get"+t+"values",e&&$Support.getDStorageIframe().postMessage(CommonUtil.toJSON(i),$Support.postMesaageUrl)},handleDomainStorage:function(e,t){var i={localstorage:$Support.LSDB.getFromLocalStorage,cookie:$Support.getParent().$ZSIQCookie.get};if($Support.verifyChatDomain())if($Support.getDStorageIframe())if("updatecorsdata"===e)for(var o in $Support.zohopublickeys[t]){var n=$Support.zohopublickeys[t][o];$Support.setValueInDStorage(n,i[t](n),t)}else"getcorsdata"===e&&("cookie"!=t||$Support.isCookieExists($Support.zohopublickeys[t])?"localstorage"==t&&$Support.getValueFromDStorage($Support.zohopublickeys[t],t):$Support.getValueFromDStorage($Support.zohopublickeys[t],t));else"updatecorsdata"==e&&"cookie"==t&&($Support.__queue__=!0)},verifyChatDomain:function(){return"true"==$Support.getParent().$zv.enablecrossdomain},synchronizeDomainStorage:function(){var e=$Support.EmbedObj.livelsid,t=$Support.getParent().$ZSIQUtil.getGDPRBannerCookieKey();$Support.zohopublickeys={localstorage:["ZLD"+e+"tabowner","ZLD"+e,"ZLD"+$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.lsid+"avuid"],cookie:[t+"__donottrack",t+"_trackingconfig"]},$Support.postMesaageUrl=_SCHEMA+"://"+_EMBEDSERVERURL+"/setsiqval.ls";var i=$Support.__queue__?"updatecorsdata":"getcorsdata";$Support.LSDB.get("ZLD"+e+"WTIME")||-1!=$Support.EmbedObj.chatID||(1==$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.isgdprenabled&&($Support.handleDomainStorage(i,"cookie"),delete $Support.__queue__),$Support.handleDomainStorage("getcorsdata","localstorage"))},isCookieExists:function(e){for(var t in e){var i=e[t];if($Support.getParent().$ZSIQCookie.get(i))return!0}return!1},reload:function(){setTimeout(function(){var e=$Support.EmbedObj;$Support.callquitstatus=!1,e.setVisitorID(-1),e.setChatID(-1),e.setVisitID(-1),e.setPrevCHID(-1),$BotImpl.resetDisableComposerTimer(),ZSIQConversationManager.resetLastViewd(),$Support.deletePrechatVal(),e.setAttender(""),e.setAttenderZUID(""),$Support.EmbedObj.attenderemail="",Message.presender="",delete e.lastdeptid,$Support.checkAndShowUI()},500)},getChatID:function(){return ZSIQConversationManager.getcurrchatwinobj().chatID||-1},isSeasonalTheme:function(){return parent.$ZSIQChat.isSeasonalTheme()&&!$Support.Util.isPreview()},getApiDepartment:function(){return $Support.getParent().$zv.department||[]},getCustomFields:function(){return $Support.getParent().$ZSIQUtil.getAPIValues().customfield},setLoadContentClass:function(){parent.$ZSIQChatWindow.setLoadContentClass()},getFreeLogo:function(e){var t=e.parent().find("#siqfreelogo");return 0!=t.length&&t.parent().is(":visible")||(t=$("footer").find("#siqfreelogo")),t},isIframeContentLoaded:function(){return $("body").hasClass("loadframe")},enableHeaderImage:function(){var e=$("#complogo");e.attr("src")?e.removeAttr("data-src"):e.attr("src",e.attr("data-src")).removeAttr("data-src")},handlePostLoadScript:function(){!$Support.isMobileWidth()&&$(document).ztooltip&&$(document).ztooltip(),$Support.enableHeaderImage(),$Support.isConversationAllowed()?$Support.container.find("#showsiqconv").click():($Support.PopulateConversationList(),$Support.Util.checkToShowConversationEmptyPage()&&$Support.Util.showConversationEmptyPage())},handleJoinSupport:function(e){var t=ZSIQConversationManager.getChatWinObjById(e);$Support.clearBotQuestionTimeout(),$Support.deleteBotCookie(e),delete t.isBotChat,t.contentdiv.find("#conversationoption").remove()},getTranscriptFromSession:function(e){var t=$Support.LSDB.getFromSession(e+"_transcript");try{t&&"string"==typeof t&&(t=JSON.parse(t))}catch(e){}return t},getChatWindowTitle:function(e,t){var i=$Support.EmbedObj,o=$Support.getParent().$ZSIQUtil.getAPIValues()||{};return(t?{1:!0,2:!1}[t]:-1==i.department||o.agent?i.status:ZSIQConversationForm.getSelectedDeptstatus())?e||o.floatwindowonlinetitle||LSResource.getRealValue("ne.chatwithus"):e||o.floatwindowofflinetitle||LSResource.getRealValue("ne.offlinemessage")},handleUploadImageLoad:function(e){try{var t=$(e);if("msgarea"!=$Support.container.attr("cwview"))return void t.show();if(!$Support.Util.isMessageDIVScrolled())return t.show(),void ZSIQTranscript.scroll();t.show()}catch(e){LSDebugger.pushDebugInfo("Exception stack: "+e.stack||e.stacktrace||""),LSDebugger.postDebugInfo("handleUploadImageLoad failed - date: "+new Date+"; vwmsid:"+$Support.EmbedObj.vwmsid+"; visitoremail:"+$Support.EmbedObj.visitoremail,null,"",!0)}},isBotAvailable:function(e){var t=$Support.getBotUser(e);return t&&t.length},handleCallbackForchatContinue:function(e,t){var i=$Support.EmbedObj;if(e&&"function"==typeof $Support.getParent().$zcb["chat.continue"]){t=e.proactive?"Operator initiated chat":t,t=e.istriggeredchat?"Waiting":t;var o={attendername:e.attendername,attenderemail:e.attenderemail,department:$Support.getDeptName(e.department),visitorname:i.visitorname,visitoremail:i.visitoremail,visitorphone:i.visitorphone,question:e.question,"start-time":e.intime||e.chatintime,visitid:e.VISITID||"-",chatstatus:t};$.each(o,function(e,t){null==t&&delete o[e]}),$Support.Util.handleCallbacks("chat.continue",o)}},checkAndPopulateLastMessage:function(){try{var e=$Support.getTriggerCookie(),t=e.message;if(!$BotImpl.isBotMessage(t))return;if(t.message)t.message.msglist[0].meta=$BotImpl.setTypingandSoundConfig(t.message.msglist[0].meta);else{var i=t.msglist;1<i.length?t.disablesound=!0:t.msglist[0].meta=$BotImpl.setTypingandSoundConfig(i[0].meta)}ZSIQConversationManager.getcurrchatwinobj().chatdiv.html(""),$UI.populateVisitorQuestion(t,e.winid)}catch(e){}},getJSAPIMessageHint:function(){var e=$Support.EmbedObj.messagehint;if(e)return e;var t=$Support.getParent().$ZSIQUtil.getAPIValues();return t?t.messagehint:""},getReactionIndex:function(e){return $Support.EmbedObj["feedbackcomplete"+e]||LSResource.getRealValue("embed.rating."+e)},toggleDirectCall:function(e){e?($("body").addClass("calltheme"),$($Support.getParent().document.body).find(".siqembed").addClass("siq-calthememin")):($("body").removeClass("calltheme"),$($Support.getParent().document.body).find(".siqembed").removeClass("siq-calthememin"))},handleSSChatView:function(){$(parent.document.body).find(".siqembed").addClass("zsiqchatwithss"),$("body").addClass("ssview")},closeSSChatView:function(){SiqAVRouter.container.mediaUIHandler.closeChatWindow(ZSIQConversationManager.getcurrchatwinobj().RCHID)},removeSSChatView:function(){$(parent.document.body).find(".siqembed").removeClass("zsiqchatwithss"),$("body").removeClass("ssview")},checkAndRemoveBotattender:function(e){var t=ZSIQConversationManager.getChatWinObjById(e),i=$Support.getBotUser(t.department),o=SUPPORT_REPS[e]||{};i&&"object"==typeof i&&-1!=i.indexOf($Support.EmbedObj.attender)?delete o[LSMessanger.getPrd()+"_"+$Support.getParent().$ZSIQWidget.getEmbedObject().pinfo.soid+"_b"+t.attender]:delete o[LSMessanger.getPrd()+"_"+$Support.getParent().$ZSIQWidget.getEmbedObject().pinfo.soid+"_"+t.attender]},handleReopenWaitingUI:function(e,t){var i=e.val();if($Support.EmbedObj,t&&13!=t||""===$.trim(i))t?e.removeClass("errfield"):e.addClass("errfield");else{e.val("");var o=e.attr("txtarea-id"),n=ZSIQConversationManager.getChatWinObjById(o);if(n.composer.show(),n.composer.attr("disabled","true"),n.reopenques=getEscapedText(i),n.showReopenWaitingUI(),$TH.checkAndShowBotTyping&&$TH.checkAndShowBotTyping(n.department,!0),!LSMessanger.sid)return $Support.updateVisitorName(),$Support.checkAndRegisterWms(),void($Support.reopenobj=n);$Support.Util.hideConversation(),$Support.Util.updateViewAttribute("msgarea"),$Support.reOpenChat(n)}},reOpenChat:function(d){delete $Support.reopenobj;var e={},t=d.visitorID,i=Browser.getInfo()||{};LSMessanger.setNickName($Support.EmbedObj.visitorname);var o=$Support.getParent().$ZSIQUtil.getAPIValues();d.reopenwaiting=!0,e.visitor={user_id:$Support.EmbedObj.vwmsid,avuid:$Support.getParent().$ZSIQUtil.getAvuid(),platform:navigator.platform,color_code:i.color,cookie_enabled:i.cookie,current_page:i.currentpage,java_enabled:i.java,js_version:i.jsversion,screen:i.screen,page_title:i.title,country_code:i.ccode,flash_version:i.flashversion,local_time_zone:i.localtime,referrer:i.referrer},o.waitime&&(e.custom_wait_time=o.waitime),e.visitor.cvuid=$Support.getParent().$ZSIQUtil.getAPIVisitorID(),e.message=d.reopenques,e.uvid=$EmbedManger.getuvid();var n=t+"/reopen";CommonUtil.handleAjaxReq(n,e,function(e){var t=e.data||{},i=t.chat_status||{},o="chat"==t.queue_type;if(3!=i.state){var n=t.visitor||{},a=t.attender||{},r=$Support.getParent().$ZSIQUtil.getAvuid();d.visitorname=n.name,d.visitoremail=n.email,d.visitorphone=n.phone,d.RCHID=t.wms_chat_id,d.chatID=t.chat_id,d.setBotChatStatus&&d.setBotChatStatus(a.is_bot),"pastconv"==d.chatstatus&&delete d.chatstatus,$Support.chidmappinglist[d.RCHID]=d.chatID,d.intime=t.start_time,"connected"===d.chatstatus||o||$Support.setWaitingCookie(d),d.composer&&d.composer.removeAttr("disabled"),$Support.convlistcontainer.find("#pastchatconv").find("[chid = "+d.chatID+"]").remove();var s=$Support.LSDB.getFromSession(r+"_conversation"),p=s.map(function(e){return e.chid}).indexOf(t.chat_id);d.isofflinechat&&(p=s.map(function(e){return e.visitorid}).indexOf(t.id)),s.splice(p,1),$Support.LSDB.storeInSession(r+"_conversation",s),d.isofflinechat&&($Support.EmbedObj.setEmbedStatus(!0),-1==$Support.EmbedObj.department&&$Support.handleDeptBasedStatusChange(d.department,!0),d.updateChatInfoinInstanceDom(),$Support.convlistcontainer.find("[visitorid="+d.visitorID+"]").remove(),delete d.isofflinechat),!o&&$Support.handleOnGoingchatActionsInConversation("newchat",d),o&&d.getChatQueuePosition(),d.contentdiv&&d.contentdiv.removeClass("nofdbk"),LSMessanger.joinchat(d.chatID,$Support.EmbedObj.vwmsid,"","",d.visitorID)}else $Support.handleReopenStatusChange(d)}.bind(d),function(){})},handleReopenStatusChange:function(e){var t=$Support.EmbedObj;$Support.removeWaitingCookie(e.chatID),$Support.removeWtimeCookie(e.chatID),clearTimeout(e.waitTimer),(e.chatID=-1)==t.department&&$Support.handleDeptBasedStatusChange(e.department,!1),ZSIQTranscript.removeTyping(!0);var i=!!$Support.getOnlineDeptCount();t.setEmbedStatus(i),clearTimeout(e.bnrtimer),delete e.waitingtime,e.contentdiv.find('[proptype="info_banr"]').remove(),e.hideMaskDiv(),e.chatmaindiv.after(e.chatendmsg=$($Temp.getChatEndHTML(!0))),e.composer.hide(),e.contentdiv.find("div.usrinpt").hide(),e.showBanner(LSResource.getRealValue("ne.offlinerespmsg"),!0),e.convongoingchatobj&&e.convongoingchatobj.find(".siqc_eletype").attr("class","siqc_eletype")},makeJoinChat:function(e,t){var i=($Support.getCookieValue("ZLD"+$Support.EmbedObj.livelsid)||{}).ongoingchats||{};$Support.initiateJoinchat(e,t,i)},initiateJoinchat:function(e,t,i){for(var o in i)if(i.hasOwnProperty(o)){var n=i[o]||{},a=n.cid||n.chid;LSMessanger.joinchat(a,$EmbedManger.getvwmsid(),e,t),-1==$Support.joinedchatkeys.indexOf(a)&&i[o].attender&&$Support.handleCallbackForchatContinue(ZSIQConversationManager.getChatWinObjById(a),"Ongoing")}},removeEndedChatInstanceAndElement:function(){$Support.convlistcontainer&&$Support.convlistcontainer.find("#currchatconv").find('[status="end"]').each(function(){var e=$(this);ZSIQConversationManager.removeFromConvDB(e.attr("chid")),e.remove(),$Support.convlistcontainer.find("#pastchatconv").empty()})},handleWidgetCustomAction:function(e,t){var i=($Support.getParent().$zohosq||{}).clientactions||{};i[e]&&"function"==typeof i[e]&&i[e](t)},pushToJoinChat:function(e){-1==$Support.joinedchatkeys.indexOf(e)&&$Support.joinedchatkeys.push(e)},quitConnetcedChats:function(){var e=$Support.EmbedObj,t=($Support.getCookieValue("ZLD"+e.livelsid)||{}).ongoingchats||{},i=ZSIQConversationManager.getChatWinObjById(Object.keys(t)[0]);!$.isEmptyObject(i)&&$Support.quitChat(i)},getSecLocationAPIObj:function(e){var t={country_code:e.countrycode,latitude:e.latitude,longitude:e.longitude,city:e.city,zip:e.zipcode,state:e.state,country:e.country};return JSON.stringify(t)},formatObjforResourceSharing:function(e){var t=e.meta,i={};i[t.article]=t.title;var o={display_card:{type:"articles",articles:[i],articlename:t.title,articleid:t.article},subtype:"resource-share"};return e.meta=o,e.msg="",e},getDeptObjByID:function(e){var t=$Support.EmbedObj.deptlist;if(t)for(var i in t)if(t[i].ID==e)return t[i]},setPastChatVisibility:function(e){var t=$Support.EmbedObj.eprops;"show"==e?t.isconversation="true":"hide"==e&&(t.isconversation="false",$Support.removeConvListStorage())},removeConvListStorage:function(){var e=$Support.getParent().$ZSIQUtil.getAvuid();$Support.LSDB.removeSessionStore(e+"_conversation")},checkAbusiveChatEndOnWaiting:function(e){if(!$.isEmptyObject(e)){var t=e.chatID;$Support.removeWaitingCookie(t),$Support.removeWtimeCookie(t),e.removeWaitingTimeValues(),e.hideBanner()}},setQueueingChatCookie:function(e){var t=this.EmbedObj;if(t.type&&"embed"!=t.type){var i=$Support.getCookieValue("ZLD"+t.livelsid+"QUEUEINGCHATS")||{},o=i.ongoingchats||{};if(t.embedwaitingtime,i.name=t.visitorname,i.email=t.visitoremail,i.phone=t.visitorphone,i.vwmsid=t.vwmsid,e){var n={vid:e.visitorID,chatintime:e.intime,did:e.department,chid:e.chatID,rcid:e.RCHID,ques:e.question,visitid:e.VISITID,queueposition:e.position,avgresptime:e.avgresponsetime};e.attender&&(n.attender=e.attender),e.isforwardchat&&(n.isforwardchat=!0),o[e.winid||e.chatID]=n,i.ongoingchats=o}var a=31e4<e.avgresponsetime?e.avgresponsetime:31e4;this.LSDB.setCookie("ZLD"+t.livelsid+"QUEUEINGCHATS",i,a)}},removeQueueingCookie:function(e){var t=this.EmbedObj;if(e){var i="ZLD"+t.livelsid+"QUEUEINGCHATS",o=this.LSDB.get(i);if(o){var n=o.ongoingchats||{};delete n[e],Object.keys(n).length?(o.ongoingchats=n,this.LSDB.setCookie("ZLD"+t.livelsid+"QUEUEINGCHATS",o,31e4)):this.removeCookie("ZLD"+t.livelsid+"QUEUEINGCHATS",!0)}}},getQueueingCookie:function(){return $Support.getCookieValue("ZLD"+this.EmbedObj.livelsid+"QUEUEINGCHATS")||{}},getQueuePositions:function(e){if(e&&!$.isEmptyObject(e))if(1!=Object.keys(e).length){var u={},t=[];for(var i in e){var o=e[i];u[o.vid]=o.chid,t.push(o.vid)}t={conversation_ids:t},CommonUtil.handleAjaxReq("queue/position",t,function(e){var t=e.data||{},i=t.queue,o=t.not_in_queue;for(var n in i){var a=i[n],r=u[a.id];ZSIQConversationManager.getChatWinObjById(r).handleQueueDisplay({average_response_time:a.average_response_time,position:a.position})}for(var n in o){var s=o[n],p=u[s],d=ZSIQConversationManager.getChatWinObjById(p),c={};c[p]={visitorID:d.visitorID},$Support.rejoinchats(c)}},function(){})}else{var n=e[Object.keys(e)[0]].chid;ZSIQConversationManager.getChatWinObjById(n).getChatQueuePosition()}},getMediaLibraryJS:function(){var e=$Support.getParent(),t=e.document.getElementById("siqiframe"),i=(t.contentWindow||t.contentDocument.document||t.contentDocument).document,o=e.$ZSIQChat.getWidgetData(),n=o.commondata,a=n.schema+"://"+o.embedobj.embedserverurl,r=e.iscdnenabled?n.jscdnstaticserver+"/salesiq/js/embedmedia-rtc_fc18cfedc721dd27c710129f7011ed4b_.js":a+"/salesiq/js/embedmedia-rtc_fc18cfedc721dd27c710129f7011ed4b_.js";if(i.children[0]&&i.children[0].querySelector("head")){var s=document.createElement("script");s.src=r,i.children[0].querySelector("head").appendChild(s)}},handleEndActionInCoversation:function(e){var t=e.msgObj,i=e.currwinobj;if($EmbedManger.handleChatEnded(t,i),t.currwinobj=i,"content_moderation_end"==e.chatendmode&&t.sender==$Support.EmbedObj.vwmsid)return t.chid=i.winid,void $Support.handleOnGoingchatActionsInConversation("missedchat",t);$Support.handleOnGoingchatActionsInConversation("endchat",t)},storeBotResetconfig:function(e){var t=e.metaobj;(t.hasOwnProperty("rollback_command")||t.hasOwnProperty("restart_command"))&&$Support.LSDB.storeInSession(e.chid+"_botflowresetter",JSON.stringify({rollback:t.rollback_command,restart:t.restart_command}))},getBotResetconfig:function(e){var t=$Support.LSDB.getFromSession(e+"_botflowresetter");return t?JSON.parse(t):{}},toggleSendOnSmileyEnter:function(e){var t=e.attr("proptype");"msgarea"==t?$Support.toggleSendButton(e):"editorarea"==t&&MessageOperation.handleEditMessage(e)}};var ZSIQConversationManager=function(){var a={},n=-1,o=function(t){this.winid=t.winid||t.cid||t.chid||t.vid,this.chatID=t.cid||t.chid||-1,this.visitorID=t.vid||-1,this.attender=t.attender,this.attenderemail=t.attenderemail,this.attendername=t["attname_"+this.visitorID]||t.attendername,this.question=t.ques,this.attenderimagefkey=t.imagefkey||t.attender_imagefkey,this.department=t.did||$Support.EmbedObj.department||-1,this.attenderuseragent=t.attenderuseragent,this.chatintime=t.chatintime,this.VISITID=t.visitid,this.isforwardchat=t.isforwardchat,this.forwardtime=t.forwardtime,this.proactive=t.proactive||t.isproactive,this.istriggeredchat=t.istriggeredchat,this.isBotChat=t.isbotchat,this.isbottrigmsg=t.isbottrigmsg,this.botchatprops=t.botchatprops,this.waitinghandlerprops=t.waitinghandlerprops,this.RCHID=t.RCHID||t.rcid,this.isofflinechat=!(t.cid||t.chid||!t.vid),this.msglist=t.msglist,this.pmsg=t.pmsg,this.triggername=t.triggername,this.istrigmsg=t.istrigmsg,this.attenderaboutme=t["aboutme_"+this.visitorID]||t.attenderaboutme||t.aboutme,this.repopulate=t.repopulate};return o.prototype={populateChatArea:function(){var t=$Support.EmbedObj;$Support.updateVisitorName(),LSMessanger.setNickName(t.visitorname),$Support.checkAndRegisterWms(),$UI.setInnerHeader(this),this.isBotChat&&"-1"!=this.chatID&&(this.hidetransfer=$Support.LSDB.getFromSession(this.chatID+"_handoff")),this.chatstatus="connected",this.updateTranscriptFromSession(this),this.checkAndUpdateContentdivView(),this.proactive&&ZSIQConversationForm.checkAndGetFormTranscript(this),this.proactive&&this.chatmaindiv.addClass("bot_chat");try{var e=ZSIQConversationManager.getChatWinObjById(this.chatID).RCHID;SiqAVRouter.container.detailsHandler.triggerIconCheck(e)}catch(t){}},updateTranscriptFromSession:function(){var e=$Support.EmbedObj;try{var t=$Support.getTranscriptFromSession(this.winid);t&&t.length&&(myMsgObj.sender=e.vwmsid,myMsgObj.dname=e.visitorname,this.showChatUI(t))}catch(t){throw LSDebugger.pushDebugInfo("Exception stack: "+t.stack||t.stacktrace||""),LSDebugger.postDebugInfo("Failed in updateTranscriptFromSession | Exception "+t+" | chid - "+this.winid+" | VISITID - "+this.VISITID+" | visitorID - "+this.visitorID+" | vwmsid - "+e.vwmsid+" | sid - "+LSMessanger.getSid(),null,null,!0),t}},showChatUI:function(t){this.contentdiv||(this.updateInnerBody(),$UI.setFooter(),n===this.winid&&$Support.Util.hideFooter(),$Support.Util.handleResize(this));try{$Support.Util.populateChatUI(t),SiqAVRouter.container.detailsHandler.triggerIconCheck(this.RCHID)}catch(t){var e=$Support.EmbedObj;LSDebugger.pushDebugInfo("Exception stack: "+t.stack||t.stacktrace||""),LSDebugger.postDebugInfo("Failed in populateChatUI | Exception "+t+" | chid - "+this.chatID+" | VISITID - "+this.VISITID+" | visitorID - "+this.visitorID+" | vwmsid - "+e.vwmsid+" | sid - "+LSMessanger.getSid(),null,null,!0)}},updateInnerBody:function(){$Support.container.append(this.contentdiv=$($Temp.getChatAreaHTML(this).replace(/{CONTENTDIV}/g,this.winid).replace(/{TXTAREAID}/g,this.winid))).append($Support.convlistcontainer?"":$Support.convlistcontainer=$($Temp.getConversationContainerHTML())).append($Support.convtranscontainer?"":$Support.convtranscontainer=$($Temp.getConversationTranscriptContainerHTML())),this.chatdiv=this.contentdiv.find('[proptype="msgdiv"]'),this.chatmaindiv=this.contentdiv.find('[proptype="msgmaindiv"]'),this.composer=this.contentdiv.find('[proptype="msgarea"]'),this.handlePaste(),$Support.bindScrollForConversationListContainer(),this.checkAndUpdateContentdivView()},updateWaitingTime:function(){var t=this.wait_div,e=MyDate.formatMS(1e3*this.waitingtime);t&&t.html(e);var i={};i.wtime=e,i.winid=this.winid,$Support.handleOnGoingchatActionsInConversation("wtime",i)},handleWaitingDisplay:function(t,e,i,n){if(!this.istriggeredchat){var s=$Support.getWaitingHandlerCookie(this);if(!s)return $Support.removeWaitingCookie(this.winid),$Support.removeWtimeCookie(this.winid),clearTimeout(this.waitTimer),void(this.isBotChat&&this.attender||$Support.restartchat(!0));if(n)return this.waitingtime=$Support.EmbedObj.embedwaitingtime,void this.showWaitingUI(!0);clearTimeout(this.waitTimer);var o=this.remwaitingtime=s.remwaitingtime,a=Math.round(o/1e3),r=$Support.EmbedObj;this.waitingtime=a;var h=void 0===$Support.nochatforward||$Support.nochatforward;if(this.isforwardchat||!this.attender||!h||this.waitingtime!=Math.floor(r.embedwaitingtime/2)||e||this.reopenwaiting||$Support["broadcasted_"+this.visitorID]||s.broadcasted||this.handelBroadCastFlow(s),o<=0)if($Support.removeWtimeCookie(this.chatID),delete this.reopenwaiting,$Support.removeBroadCast(),e){this.botchatprops.status="missed",$Support.setCookie(),$UI.showTransferMissed(this);var d={};d.chid=this.chid,$Support.handleOnGoingchatActionsInConversation("missedchat",d)}else $Support.handleMissed("CWTOUT","2",!0,this);else{if($Support.Util.isApiWaitHandler())try{$Support.Util.handleCallbacks("chat.waitinghandler",{WTIME:r.embedwaitingtime,CURRENTTIME:a,waitingtime:r.embedwaitingtime,currenttime:a})}catch(t){}t?this.updateWaitingTime():this.showWaitingUI(i),this.stepinterval||(this.stepinterval=500),this.waitTimer=setTimeout(function(){this.handleWaitingDisplay(!0,e)}.bind(this),this.stepinterval)}}},handelBroadCastFlow:function(t){$Support.broadcastVisitor("",this),t.remwaitingtime=1e3*$Support.EmbedObj.embedwaitingtime,$Support["broadcasted_"+this.visitorID]=t.broadcasted=!0,$Support.updateWaitingCookie(t,this.winid),this.showBanner(LSResource.getRealValue("chatqueue.infobanner.msg"),!0,function(){$Support.getWaitingHandlerCookie(this)&&this.showWaitingUI()}.bind(this),500)},initiateChat:function(t){var e=$Support.EmbedObj;e.curraddvistid=this.winid,!(e.isreopenenabled||!e.lastdeptid||this.department&&-1!=this.department)&&(this.department=e.lastdeptid),this.intime=(new Date).getTime(),$Support.removeBroadCast(),delete $Support.SIQFieldname;var i=$Support.getBotUser(this.department),n=this.attender;if(!n){var s=$Support.LSDB.get("ZLDPERSONALIZE");n=$Support.getParent().$ZSIQChat.getWidgetData().widgettype==$Support.getParent().SIQ_PERSONALIZE&&s?s:void 0}var o=!i||n&&-1==i.indexOf(n),a=1==$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.isgdprenabled,r=$Support.EmbedObj.pprops,h=$Support.LSDB.getFromSession(_SCREENNAME+"_gdpr_chatconsent"),d=r.chatcookiepolicyurl,p=!(!a||!JSON.parse(r.isgdprenabled)||1!=JSON.parse(r.chatprivacyconfig)||h);if($Support.updateWaitingCookie("",this.winid),this.handleWaitingDisplay(null,null,!o,p),LSMessanger.setNickName($Support.EmbedObj.visitorname),p){var c=this.contentdiv;return c.find(".sqico-edit").remove(),c.find("div[purpose=name]").attr("documentclick",""),this.hideUserEditUI(),$UI.appendChatConsentDiv(t,!1,d,this),void ZSIQTranscript.scroll("","",!0)}this.istriggeredchat&&!ZSIQConversationForm.checkContextInitiated()&&$Support.showVisitorQuestion(this),t||LSMessanger.sid?$Support.addVisitor():$Support.EmbedObj.vwmsid?LSMessanger.register($Support.Util.productCode,$Support.EmbedObj.vwmsid):$Support.getAnnonID($Support.EmbedObj.visitorname),$TH.checkAndShowBotTyping&&$TH.checkAndShowBotTyping(this.department,!0)},updateFooter:function(){$Support.container.find("footer").remove().end().append($Temp.getFooterHTML()),$Support.isConversationUIFocussed()&&!$Support.isFAQEnabled()&&$Support.container.find("footer").hide(),$Support.container.append($Temp.getConversationCreateChatIConHTML()),$TH.populateSendBtn(),$Support.Util.handleResize(this),$Support.Util.isCampaignEnabled()&&($Support.subscribe=!1,$("#newsletter").on("change",function(){$Support.subscribe=$(this).is(":checked")}));var t=$("#chatconsent");$Support.Util.getChatConsentStatus()&&1==t.length&&$("#chatconsent").on("change",function(){1==$(this).is(":checked")?$Support.toggleSendButton($Support.getComposer()):$Support.Util.removeSendClickAction()})},showBanner:function(t,e,i,n,s,o){if(0!=t.length){var a=this.contentdiv,r=!1;a.find('[proptype="info_banr"]').length||(r=!0,a.prepend($Temp.getBannerHTML(t,e,s,o)),t=""),this.showInfoBanner(t,e,r,i,n)}},showInfoBanner:function(t,e,i,n,s){var o=this;clearTimeout(o.bnrtimer);var a=this.contentdiv.find('[proptype="info_banr"]');a.removeClass("dN"),$Support.container.hasClass("outerwin")?a.addClass("relate"):a.removeClass("relate"),$Support.EmbedObj.bushrstatus?a.addClass("bsnshrs"):a.removeClass("bsnshrs"),t?$Support.Util.handleBannerSlide(t,a):i&&a.hide().slideDown(500,function(){}),e&&(s=s&&5e3<=s?s:5e3,o.bnrtimer=setTimeout(function(){o.hideBanner(n)},s))},removeSmileyIcon:function(){this.contentdiv.find("#smiley").remove(),this.contentdiv.find('[proptype="action_icons"]').remove()},populateIcon:function(){this.removeSmileyIcon(),this.contentdiv.find('[proptype="smilelist"]').after($Temp.getIconHTML&&$Temp.getIconHTML(this.chatstatus).replace(/{SMILEY}/g,this.winid).replace(/{FILEUPLOAD}/g,this.winid).replace(/{SQICOSEND}/g,this.winid))},hideBanner:function(t){this.contentdiv.find('[proptype="info_banr"]').slideUp(500,function(){$(this).remove(),"function"==typeof t&&t()})},showWaitingUI:function(t,e){$Support.Util.removeSendClickAction(),!ZSIQConversationForm.isOldFormView()&&ZSIQConversationForm.checkContextInitiated()||this.showChatArea(t,e);var i=$Support.getBroadcastText();i?this.showBanner(DynamicMsg.fillValues(i)):t||this.showWaitingDialog()},handleWaitingCookie:function(){if(!$Support.isFloat())return!1;var t=$Support.EmbedObj;$Support.checkAndRegisterWms(),LSMessanger.setNickName(t.visitorname),$UI.setHeader(),$UI.setBody(!0),$UI.setFooter(),DynamicMsg.setValues($Support.getValuesForDynamicMsg()),this.handleWaitingDisplay(""),this.checkAndUpdateContentdivView(),this.chatID&&this.updateTranscriptFromSession()},showChatArea:function(t,e,i){var n=$Support,s=n.container,o=n.EmbedObj,a=s.find("[type="+this.winid+"msgdiv]").find(".siq-user-message"),r=$Support.getParent().$ZSIQUtil.getAPIValues();if(0!=a.length&&-1===this.chatID&&n.istrigmsg&&r.mtrigger){var h=a.html();if(h){var d=h.split("<br>");for(var p in d)d[p]=getEscapedText(d[p]);o.pmsg=d.join("<br>")+"<br>"+getEscapedText(o.pmsg);var c=$Support.getTriggerCookie();c.message=o.pmsg,$Support.setTriggerCookie(c,!0)}}else if(this.pmsg&&"BOT_MESSAGE"!=this.pmsg.mode){var u=o.pmsg?o.pmsg.split("<br>"):[];for(var p in u)u[p]=getEscapedText(u[p]);o.pmsg=u.join("<br>")}7==$Support.getThemeID()&&s.removeClass("outerwin"),this.contentdiv||(n.contentdiv?(n.contentdiv.replaceWith(this.contentdiv=$($Temp.getChatAreaHTML().replace(/{CONTENTDIV}/g,this.winid).replace(/{TXTAREAID}/g,this.winid))),n.contentdiv.hide()):this.contentdiv=$($Temp.getChatAreaHTML(this).replace(/{CONTENTDIV}/g,this.winid).replace(/{TXTAREAID}/g,this.winid)).insertAfter($Support.container.find("header")),this.chatdiv=this.contentdiv.find('[proptype="msgdiv"]'),this.chatmaindiv=this.contentdiv.find('[proptype="msgmaindiv"]'),this.composer=this.contentdiv.find('[proptype="msgarea"]'),n.Util.handleResize(this),this.contentdiv=n.container.find("[data-id="+this.winid+"]"),this.checkAndUpdateContentdivView()),!e&&n.chatWindowUICallBk(this.winid);var m=$Support.getBroadcastText();m&&!i?this.showBanner(DynamicMsg.fillValues(m)):t||i||this.showWaitingDialog()},showWaitingDialog:function(){if(!(!this.waitingtime||0<this.contentdiv.find("#wait_div").length||this.isBotChat||this.proactive&&-1!=this.winid)){clearTimeout($Support.Util.bnrtimer);var t=this;return{text:function(){t.contentdiv.prepend($Temp.getWaitingTextHTML(t.waitingtime)),t.wait_div=$("#wait_div")},video:function(){$(".content").prepend($Temp.getWaitingTextHTML()).animate({top:"auto"},400)}}[$Support.EmbedObj.waitaction]()}},hideUserEditUI:function(){this.composer.removeAttr("disabled"),this.hideMaskDiv()},hideMaskDiv:function(){var t=this.contentdiv.find(".maskdiv").addClass("hidemaskanim");$Support.Util.removeDiv(t),this.contentdiv.removeClass("feedback_popup siq_popup")},updateValAndStartChat:function(){var t=$Support.EmbedObj;$Support.updateInputValues(this),DynamicMsg.setValues({name:t.visitorname,email:t.visitoremail,phone:t.visitorphone}),this.initiateChat()},getComposer:function(){return this.composer||$("#msgarea")},checkAndUpdateLastView:function(){ZSIQConversationManager.chidbeforereload||-1!=n&&n!=this.winid||$Support.isConversationUIFocussed()||ZSIQConversationManager.updateLastviewed(this.chatID)},updateChatInfoinInstanceDom:function(){function t(t){var e=t.ongoingchats||{};return e[this.chatID]=e[this.winid],delete e[this.winid],t.ongoingchats=e,t}var e=$Support.EmbedObj,i=this.contentdiv;i.attr("data-id",this.chatID),this.composer.attr("txtarea-id",this.chatID),i.find('[proptype="action_icons"]').find('[proptype="sqico-send"]').attr("txtarea-id",this.chatID);var n=a[this.winid];delete a[this.winid],a[this.chatID]=n;var s=$Support.getCookieValue("ZLD"+e.livelsid+"WTIME")||{};s=t.call(this,s),$Support.LSDB.setCookie("ZLD"+e.livelsid+"WTIME",s,12e4);var o=$Support.getCookieValue("ZLD"+e.livelsid+"WAITING");o=t.call(this,o),$Support.LSDB.setCookie("ZLD"+e.livelsid+"WAITING",o,1e3*e.embedwaitingtime),$Support.convlistcontainer&&$Support.convlistcontainer.find("#currchatconv").find('[chid="'+this.winid+'"]').attr("chid",this.chatID).attr("id","conv"+this.chatID),this.checkAndUpdateLastView(),this.winid=this.chatID},checkAndUpdateContentdivView:function(){ZSIQConversationManager.chidbeforereload?ZSIQConversationManager.chidbeforereload!=this.winid?this.contentdiv.hide():ZSIQConversationManager.updateLastviewed(this.winid):-1!=n&&n!=this.winid?this.contentdiv.hide():ZSIQConversationManager.updateLastviewed(this.winid)},isAllowMessageAreaFocus:function(){return!("true"==this.composer.attr("disabled")||$Support.isHandHeldDevice()&&this.isBotChat)},checkAndFocusMessageArea:function(){this.isAllowMessageAreaFocus()&&this.composer.focus()},handlePaste:function(){CommonUtil.isAllowPasteImage()&&this.composer.on("paste",function(t){PasteImage.onPaste(t,this),t.stopImmediatePropagation()})},disableTextarea:function(t){this.composer.attr("disabled","true")},hideReopenMaskDiv:function(){this.hideMaskDiv(),this.contentdiv&&this.contentdiv.find("div.usrinpt").hide();var t="msgarea"!=$Support.container.attr("cwview");!this.chatendmsg&&this.chatmaindiv.after(this.chatendmsg=$($Temp.getChatEndHTML(t)))},showUserEditUI:function(t,e,i){if(ZSIQConversationForm.isOldFormView()){var n="",s=$Support.getParent().$ZSIQUtil.getAPIValues(),o=this.contentdiv.find(".editfields");if(o.length&&!o.hasClass("hidemaskanim"))return;i&&s.chatprivacycontent&&(n='<div class="infomsg chtend siq-info-message" proptype="chtprivacy">'+s.chatprivacycontent+"</div>"),this.contentdiv.find(".maskdiv").remove().end().prepend($Temp.getUserEditHTML(t,this).replace(/{T&CBANNER}/g,n)),-1==this.department&&$UI.populateDropDown(),e||$Support.Util.handleCustomHTML(!0),$Support.Util.calculateTextareaHeight();var a=$("#edituserdetails");return a.length&&a.find(".siq-input-text-box").first().focus(),void a.find("#newsletter").on("change",function(){$Support.subscribe=$(this).is(":checked")})}!ZSIQConversationForm.checkContextInitiated()&&ZSIQConversationForm.fetchFieldsToEdit(e,i,this)},updateVisitorNameinCW:function(t){var e=getEscapedText(t.name);if(e){var i=$Support.Util.CheckAllDefaultFieldsDisabled()?'<em class="sqico-edit" documentclick="userdetails" title="'+LSResource.getRealValue("ne.title.edit")+'"></em>':"";this.contentdiv.find('.vismsg div[purpose="name"]').html(e+i)}},populateFeedbackHTML:function(t){var e=this.contentdiv;e.find(".sqico-edit").remove(),e.find('[proptype="msgopr"]').remove();var i=JSON.parse($Support.EmbedObj.eprops.feedback[0]),n=$Support.israting,s=$Support.isfeedback;if(t||!(i||n||s)||0==n&&0==s)this.emptyFeedback();else{0==s&&(this.isfeedbacksent=!0),e.removeClass("feedback_popup").addClass("feedback_popup");var o=!1===$Support.israting?$Temp.getFeedbackOnlyHTML().replace(/{FDBKAREAID}/g,this.winid):$Temp.getFeedbackHTML(!s).replace(/{FDBKAREAID}/g,this.winid).replace(/{CHATID}/g,this.winid);e.find(".maskdiv").remove().end(),e.find("#msgdiv").append(o),this.emptyFeedback(n),ZSIQTranscript.scroll("",this.chatmaindiv)}},isAudioCallAllowed:function(){return"connected"==this.chatstatus&&!this.isBotChat&&!this.istriggeredchat&&!this.isforwardchat},handleFeedbackBtn:function(){$TH.populateSendBtn(LSResource.getRealValue("ne.submit"),this.winid),$("footer #sqico-send").before('<em documentclick="hidefeedback" class="hidemask" chatid='+this.winid+">"+LSResource.getRealValue("common.cancel")+"</em>")},emptyFeedback:function(t){var e=this.contentdiv;e.find("div.usrinpt").hide(),$("footer #sqico-send").remove(),e.addClass("nofdbk"),$Support.container.find("footer").show(),t&&$("#fdbkarea + .sqico-send").hide()},getConversationChatTranscript:function(){!this.contentdiv&&(this.contentdiv=$($Temp.getChatAreaHTML(this).replace(/{CONTENTDIV}/g,this.winid).replace(/{TXTAREAID}/g,this.winid)).insertAfter($Support.container.find("header"))),this.chatdiv=this.contentdiv.find('[proptype="msgdiv"]'),this.chatmaindiv=this.contentdiv.find('[proptype="msgmaindiv"]'),this.composer=this.contentdiv.find('[proptype="msgarea"]'),this.contentdiv.find("div.usrinpt").hide(),this.chatstatus="pastconv",this.contentdiv.show(),this.chatmaindiv&&this.chatmaindiv.attr("ctype","hstrycntnt"),$Support.getConversationChatTranscript(this.chatID,this.visitorID);var t=$Support.Util.checkToShowReopenButton();t&&(!this.chatendmsg&&this.chatmaindiv.after(this.chatendmsg=$($Temp.getChatEndHTML(!0)))),$Support.isFAQEnabled()&&$Support.container.find("footer").show(),t&&this.chatdiv.removeClass("convview"),t||($Support.container.find("footer").show(),$Support.container.find("footer").find("#sqico-send").hide(),this.chatdiv.addClass("convview"))},reOpenChatUI:function(){-1==this.chatID&&!this.isofflinechat&&(this.chatID=this.winid);var t=-1!=this.chatID?this.chatID:this.winid;this.chatendmsg.remove(),$Support.Util.hideFeedback(this),this.chatmaindiv.removeAttr("ctype"),this.contentdiv.find('[proptype="feedback_res"]').closest("div .fd_lastmsg").remove(),this.chatendmsg="";var e=this.contentdiv.find("div.usrinpt");e.show(),e.find("div.usractions").hide(),this.composer.removeAttr("disabled"),delete this.callquitstatus,this.contentdiv.find(".maskdiv").remove().end().prepend($Temp.getReOpenMsgArea().replace(/{TXTAREAID}/g,t)),this.contentdiv.find(".maskdiv").find(".fdbk_cnt > textarea").focus(),clearTimeout(this.bnrtimer),this.contentdiv.find('[proptype="info_banr"]').remove()},showReopenWaitingUI:function(){ZSIQTranscript.scroll("",this.chatmaindiv);var t={sender:$Support.EmbedObj.vwmsid,dname:$Support.EmbedObj.visitorname,msg:Message.getDisplayContent(getEscapedText(this.reopenques)),isques:!0};delete this.isfeedbacksent,delete this.isratingsent,$BotImpl.formatAndDisplay(t,this.winid),$Support.updateWaitingCookie("",this.winid);var e=$Support.getBotUser(this.department);this.handleWaitingDisplay(null,null,e),this.composer.attr("dockeyup","sendmessage"),$Support.Util.hideFooter(),this.hideMaskDiv()},handleBotTriggers:function(){ZSIQConversationForm.getFormType()==CLASSIC_VIEW&&ZSIQConversationForm.clearSessionStorage(),this.checkPreviouslyInitiatedChat();$Support.EmbedObj,$Support.getParent().$ZSIQUtil.getAPIValues();delete this.waitingtime,delete this.question,$Support.Util.populateTriggerUI(this),$Support.handleBotTrigger({msg:this.pmsg},this),ZSIQConversationForm.checkAndGetFormTranscript(this)},checkPreviouslyInitiatedChat:function(){var t=$Support.EmbedObj.curraddvistid;if(t){var e=ZSIQConversationManager.getChatWinObjById(t).contentdiv;e&&e.remove(),ZSIQConversationManager.removeFromConvDB(t),delete $Support.EmbedObj.curraddvistid,delete $Support.requestRunning_addvist,ZSIQConversationManager.resetLastViewd()}},handleChatTrigger:function(){this.checkPreviouslyInitiatedChat(),delete this.question,delete this.waitingtime,$Support.Util.populateTriggerUI(this),$Support.handleOnGoingchatActionsInConversation("triggerchat",this),ZSIQConversationForm.checkAndGetFormTranscript(this)},populateFormChatArea:function(){$Support.updateInputValues(this),this.showChatArea(),!$Support.isNewHeader()&&$TH.populateSendBtn(LSResource.getRealValue("ne.send"),this.winid);var t=$Support.getParent().$ZSIQUtil.getAPIValues();$Support.handleApiData(t),t.floatwindowfields&&$Support.handleFieldVisibility(t.floatwindowfields),$Support.Util.setMessageClass(),$Support.Util.isPreview()||(ZSIQConversationForm.checkContextInitiated()?ZSIQConversationForm.checkAndGetFormTranscript(this):ZSIQConversationForm.fetchConfigurations(this))},setSoundConfig:function(){var t=$Support.getCookieValue(this.chatID+"_sound");this.soundval=t},isSoundOff:function(){return"-1"==this.soundval},removeWaitingTimeValues:function(){clearTimeout(this.waitTimer),delete this.istriggeredchat,delete this.proactive,delete this.waitingtime,delete this.waitTimer,delete this.reopenwaiting},handleMultiTrigger:function(){var t=$Support,e=(t.container,t.EmbedObj,this.contentdiv&&this.contentdiv.find(".siq-user-message")),i=$Support.getParent().$ZSIQUtil.getAPIValues();if(0!=e.length&&-1===this.chatID&&this.istrigmsg&&i.mtrigger){var n=e.html();if(n){var s=n.split("<br>");for(var o in s)s[o]=getEscapedText(s[o]);this.pmsg=s.join("<br>")+"<br>"+getEscapedText(this.pmsg);var a=$Support.getTriggerCookie();a.message=this.pmsg,$Support.setTriggerCookie(a,!0),e.html(this.pmsg)}}},getChatQueuePosition:function(){var t=this.visitorID+"/position";CommonUtil.handleAjaxGetReq(t,function(t){var e=t.data||{};this.handleQueueDisplay(e)}.bind(this),function(t){var e=JSON.parse(t.responseText)||{},i=e.error&&e.error.code;if(6162==i||6161==i){var n={};n[this.chatID]={visitorID:this.visitorID},$Support.rejoinchats(n)}}.bind(this))},handleQueueDisplay:function(t){clearTimeout(this.waitTimer),delete this.waitingtime,delete this.waitTimer,this.clearQueuetimer(),t.chid=this.chatID,t.average_response_time=this.calculatAvgWaitingTime(t.average_response_time);var e=$Temp.getQueueBannerHTML(t);this.position=t.position,this.avgresponsetime=this.currentqueuetime=t.average_response_time*t.position,this.contentdiv&&!this.contentdiv.find("#queuetime").length&&(this.hideBanner(),this.contentdiv.prepend(this.queuebanner=$(e))),this.appendQueueHandOffHtml(t),$Support.handleOnGoingchatActionsInConversation("queueingchat",this),this.updateQueueTimer(),$Support.setQueueingChatCookie(this)},appendQueueHandOffHtml:function(t){var e=$Temp.getQueueHandOffHtml(t);this.chatdiv.find("#leavemsgonqueue").length||this.chatdiv.append(e)},updateQueueTimer:function(){if(this.queuebanner){var t=CommonUtil.convertMstoMinAndSec(this.currentqueuetime);this.queuebanner.find("#queuepos").text(LSResource.getRealValue("chatqueue.queueno",""+this.position)),this.queuebanner.find("#queuetime").text(LSResource.getRealValue("chatqueue.agent.connect",t)),this.convongoingchatobj&&this.convongoingchatobj.find("#queueinfo").text(LSResource.getRealValue("chatqueue.position",this.position+","+t))}this.currentqueuetime-=1e3,this.currentqueuetime<=1e3?this.resetQueueTimer():(this.clearQueuetimer(),this.queueTimer=setTimeout(function(){this.updateQueueTimer()}.bind(this),1e3))},resetQueueTimer:function(){this.clearQueuetimer(),this.hideBanner(function(){this.showBanner(LSResource.getRealValue("chatqueue.infobanner.msg"),!0,function(){this.handleQueueDisplay({average_response_time:this.avgresponsetime,position:this.position})}.bind(this),2e3)}.bind(this))},handleQueuePositionChange:function(t){this.position=t.current_position,this.avgresponsetime=this.currentqueuetime=this.calculatAvgWaitingTime(t.average_response_time)*t.current_position,this.clearQueuetimer(),this.updateQueueTimer(),$Support.setQueueingChatCookie(this)},calculatAvgWaitingTime:function(t){return!t||t<6e4?6e4:t},handleDequeueChat:function(){this.removeQueueCookie(),this.convongoingchatobj&&this.convongoingchatobj.remove(),delete this.convongoingchatobj,delete this.chatstatus,$Support.handleOnGoingchatActionsInConversation("newchat",this),$Support.setWaitingCookie(this),$Support.updateWaitingCookie("",this.chatID),this.hideQueueBanner(),this.handleWaitingDisplay()},handleLeavemsgforQueue:function(){this.removeQueueCookie(),this.hideQueueBanner(),$Support.handleOnGoingchatActionsInConversation("missedchat",{chid:this.chatID}),$Support.handleMissed("CWTOUT","2",!0,this)},hideQueueBanner:function(){this.hideBanner(),this.chatdiv.find("#leavemsgonqueue").remove()},removeQueueFromConvList:function(){this.convongoingchatobj&&(this.convongoingchatobj.find('[proptype="queuetitle"]').remove(),this.convongoingchatobj.find('[propval="siqduration"]').removeClass("dn"))},removeQueueCookie:function(){this.clearQueuetimer(),$Support.removeQueueingCookie(this.chatID),this.removeQueueFromConvList()},handleQueueingCookie:function(){var t=$Support.EmbedObj;$Support.checkAndRegisterWms(),LSMessanger.setNickName(t.visitorname),$UI.setHeader(),$UI.setBody(!0),$UI.setFooter(),!ZSIQConversationForm.isOldFormView()&&ZSIQConversationForm.checkContextInitiated()||this.showChatArea("","",!0),DynamicMsg.setValues($Support.getValuesForDynamicMsg()),this.chatstatus="queueing",this.chatID&&this.updateTranscriptFromSession(),this.checkAndUpdateContentdivView()},clearQueuetimer:function(){clearTimeout(this.queueTimer),delete this.queueTimer,"queueing"==this.chatstatus&&delete this.chatstatus},setBotChatStatus:function(t){""+t=="true"?this.isBotChat=!0:(this.isBotChat=!1,$BotImpl.enableComposer())},handleDelayEndAction:function(t){clearTimeout(this.endactiondelay),this.endactiondelay=setTimeout(function(){$Support.handleEndActionInCoversation(t)}.bind(t),1e3*t.endactiondelay)},setBotForwardedTime:function(t){this.forwardtime=t,this.chatmaindiv&&this.chatmaindiv.removeClass("bot_chat")}},{init:function(t,e,i){var n=new o(t);a[n.winid]=n,ZSIQConversationManager.chidbeforereload=i;var s={connected:"populateChatArea",startchat:"updateValAndStartChat",waiting:"handleWaitingCookie",trigger:"handletrigger",pastconv:"getConversationChatTranscript",bottrigger:"handleBotTriggers",chattrigger:"handleChatTrigger",formview:"populateFormChatArea",bottrigger:"handleBotTriggers",queueing:"handleQueueingCookie"}[e];s&&n[s](),$Support.contentdiv=""},resetLastViewd:function(){n=-1},resetConvDb:function(){a={}},populateInitialScreen:function(){$Support.EmbedObj.status?$UI.init():$Support.showOfflineUI()},getChatWinObjById:function(t){return a[t]||{}},getVisitorId:function(t){return(a[t]||{}).visitorID},getConvDB:function(){return a},removeFromConvDB:function(t){delete a[t],n==t&&(n=-1)},getcurrchatwinobj:function(){return a[n]||{}},getcurrchatwinChid:function(){return(a[n]||{}).winid||-1},updateLastviewed:function(t,e){if(!$Support.isFAQUIFocussed()&&(n=t,$Support.LSDB.storeInSession("ZLD"+$Support.EmbedObj.livelsid+"lastview",t),(!e||-1!=e.chatid||!e.chatendmsg)&&$Support.Util.hideFooter(),!$Support.isFAQEnabled()&&!$Support.isNewHeader())){var i=$Support.container.find("footer");i.show(),i.find("#sqico-send").show()}},isChatUIFocusses:function(t){return this.getcurrchatwinChid()==t},getConnectedCount:function(){Object.keys(a).length;var t=0;for(var e in a)a.hasOwnProperty(e)&&-1!=a[e].chatID&&"pastconv"!=a[e].chatstatus&&t++;return t}}}();var MessageOperation=function(){var c=function(e,t){e=$Support.formatMsgUid(e);for(var a=$Support.cachearr[t]||$Support.LSDB.getFromSession(t+"_transcript"),r=a&&a.length,s=0;s<r;s++){var i=a[s];if($Support.formatMsgUid(i.msguid)==e)return i}},s=function(e){var t=e.attr("msgidval"),a=e.parents('[proptype="msgdiv"]').find('[msg-id="'+t+'"]'),r=ZSIQConversationManager.getcurrchatwinobj();(a=a[0]?a:r.chatdiv.find('[msg-id="'+t+'"]'))[0]?i(a):o({type:"scrolltop",target:r.chatmaindiv,chatobj:r,routemsgelem:e},s)},i=function(e){e.addClass("replymsge_anim"),e[0].scrollIntoView()},n=function(e){var t=e.dname||e.msg&&e.msg.dname;if(t!=$Support.EmbedObj.vwmsid&&e.sender!=$Support.EmbedObj.vwmsid)return t;var a=$Support.EmbedObj.visitorname;return ZSIQTranscript.isInValidVisitorName(a)?LSResource.getRealValue("common.you"):a},d=function(e){var t=e.chatID,a=$Support.cachearr[t];(a||($Support.cachearr[t]=a=$Support.LSDB.getFromSession(t+"_transcript"),a))&&($Support.cachearr[t]="prepend"==e.type?e.newtranscript.concat(a):a.concat(e.newtranscript))},o=function(i,n){var e=i.chatobj.chatID;if(!i.chatobj.transcriptloading&&0!=$Support.ismore_message_available[e]){var o="function"==typeof n,t=o?"scrolltop":i.type,a=i.target,r=i.chatobj;r.transcriptloading=!0;var s=r.visitorID+"/messages?limit=100&",m=a.find('[data-field="message"]'),p="scrolltop"==t?"to_time="+c(m.first().attr("msg-id"),e).time:"from_time="+c(m.last().attr("msg-id"),e).time;CommonUtil.handleAjaxGetReq(s+p,function(e){if(e=$Support.formateVisitorTranscript(e,i.chatobj.chatID),delete i.chatobj.transcriptloading,"scrolltop"==i.type)return t=e,a=i,$Support.Util.populateChatUI(t,"","",function(e){var t=e.chatdiv.find('[data-field="message"]').first();e.chatdiv.prepend(e.html),e.chatdiv.parents('[proptype="msgmaindiv"]').scrollTop(t.position().top)}),d({chatID:a.chatobj.chatID,newtranscript:t,type:"prepend"}),void(o&&n(i.routemsgelem));var t,a,r,s;r=e,s=i,$Support.Util.populateChatUI(r,"","",function(e){e.chatdiv.append(e.html)}),d({chatID:s.chatobj.chatID,newtranscript:r,type:"append"})})}},m=function(e){if("att"!=e.mode)return e;var t=$.extend({},e),a=e.msg||{};return t.msg=a.comment||"",t.att_url=CommonUtil.getAttachementURL(a),t},p=function(e){(e||ZSIQConversationManager.getcurrchatwinobj()).chatdiv.find('[purpose="msgaction"]').remove()},g=function(e){var t=e.targetmsgelem,a=t.attr("msg-id"),r=c(a,e.chid);r=u(r);var s={msgtype:"message",msg:l(r),time:CommonUtil.checkAndGetReadableTime(r.time),dname:n(r),msguid:a,sender:r.sender},i=t.find("[data-ftype]");return("att"==r.mode||r.resourceshare)&&(s.msgtype=r.resourceshare||-1==i.attr("data-ftype").indexOf("image")?"file_att":"img_att",s.file_url=t.find("[chatmsgtype]").attr("src"),s.att_comment=r.msg&&(r.msg.comment||r.msg.fName||r.msg)),s},l=function(e){var t="object"==typeof e.msg?e.msg.msg||e.msg:e.msg||e.question;return t=Message.getDisplayContent(t),e.sender!=$Support.EmbedObj.vwmsid&&(t=Markdown.apply(t)),t},u=function(e){var t=e.meta||{};if($BotImpl.iswidgetobj(e)&&"resource-share"==t.subtype||"resource_share"==t.type){var a=$.extend({},e),r=t.display_card&&t.display_card.articlename||t.title;return a.msg={att_type:"chat_attachment",comment:r,fName:r},a.resourceshare=!0,a}return e},v=function(e){var t=e||ZSIQConversationManager.getcurrchatwinobj();t.getComposer().parents("#msgbox_main").find('[proptype="reply_msg"]').remove(),delete t.msgreply_to,t.getComposer().removeAttr("msgtype")};return{navigateRepliedMessage:s,getReplyMsgHTML:function(e){!e.msg&&e.message&&((e=$Support.formateVisitorTranscript({data:[e]})[0]).isvisitor=$Support.isVisitorID(e.sender)),!e.msg&&(e.msg=e.question),"TRIGGER"==e.msg.mode&&(e.dname=e.msg.dname,e.msg=e.msg.msg,delete e.sender),e.dname=n(e);var t="message",a="",r=e.msg,s=e.msg;return e.msg.att_type&&(r=s.comment||s.fName,t=-1!=(t=s.extn||s.content||"").indexOf("image")?"img_att":"file_att",a=CommonUtil.getAttachementURL(s)),t=e.meta&&"resource_share"==e.meta.type?"file_att":t,$Temp.getReplyMessageHTML({msg:l(e),ignoreclose:!0,file_url:a,att_comment:r,msgtype:t,msguid:e.msguid,dname:e.dname,time:e.time,sender:e.sender})},handleMsgDivScroll:function(e){var t=ZSIQConversationManager.getChatWinObjById(e.parent().attr("data-id")),a=Math.ceil(e.scrollTop())<10?"scrolltop":e.scrollTop()+e.innerHeight()>=e[0].scrollHeight?"scrollbottom":"";!a||"pastconv"==t.chatstatus&&"scrolltop"==a||"connected"==t.chatstatus&&"scrollbottom"==a||o({type:a,target:e,chatobj:t})},editMessage:function(e){var t=e.parents('[data-field="message"]'),a=ZSIQConversationManager.getcurrchatwinobj(),r=t.attr("msg-id"),s=m(c(r,a.chatID));a.chatdiv.find('[proptype="msgeditor"]').remove();var i=(s.msg||s.question||"").replace(/<br\/>/gi,"\n");a.chatdiv.append($Temp.getVisitorEditMsgHTML({chid:a.chatID,msg:i,msguid:r,iattach:0<t.find("[data-ftype]").length,att_url:s.att_url})).find('[proptype="editorarea"]').focus().val(i),$Support.Util.hideMoreActionDiv(),$Clickoutside.bindclick(p,"","","",!0)},sendeditmsg:function(e){var t=e.parents('[proptype="msgeditor"]'),a=t.find('[proptype="editorarea"]');if(!$Support.Util.validateFields(a.parent()))return!1;var r=a.val(),s=Licence.verify("creditmask")&&Message.checkMaskOccurance(r,!0),i=$Support.EmbedObj.creditcardmask_enabled&&s,n={type:"Editmsg",iattach:t.attr("isattachement"),url:"/"+t.attr("msguid"),method:"PUT"};i&&(n.msgtype="credit_card"),$.trim(a.attr("preval"))!=$.trim(r)&&LSMessanger.sendMessage(t.attr("data-id"),r,n,(new Date).getTime()),p()},closeMsgActionPopup:p,deleteMessage:function(e){var t=e.parents('[data-field="message"]'),a=ZSIQConversationManager.getcurrchatwinobj();a.chatdiv.find('[proptype="deletecotainer"]').remove(),a.chatdiv.append($Temp.getVisitorDeleteMsgHTML({chid:a.chatID,msguid:t.attr("msg-id")})),$Support.Util.hideMoreActionDiv(),$Clickoutside.bindclick(p,"","","",!0)},senddeletemsg:function(e){var t=e.parents('[proptype="deletecotainer"]');LSMessanger.sendMessage(t.attr("data-id"),"",{type:"Deletemsg",url:"/"+t.attr("msguid"),method:"DELETE"},(new Date).getTime()),p()},showmsgactions:function(e){var t=e.parents('[data-field="message"]');ZSIQConversationManager.getcurrchatwinobj().chatdiv.find('[proptype="mraction"]').remove();var a=t.find('[proptype="msgbx"]').width()<180?" allin_lft":"";t.find("#msgactn").after($Temp.getMessageActionsHTML({leftaligncls:a}));var r=function(){t.find('[proptype="mraction"]').remove()}.bind(t);$Clickoutside.bindclick(r,"msgactnlist","msgactn")},replyMessage:function(e,t){var a=t?e:e.parents('[data-field="message"]'),r=ZSIQConversationManager.getcurrchatwinobj();if(!r.isBotChat&&!r.proactive){var s=r.getComposer().parents("#msgbox_main");v(),r.msgreply_to=g({targetmsgelem:a,chid:r.chatID}),s.prepend($Temp.getReplyMessageHTML(r.msgreply_to)),$Clickoutside.bindclick(v,"","","",!0),p(),r.composer.attr("msgtype","reply"),r.composer.focus()}},sendReplyMessage:function(e){var t=e.contentdiv.find('[proptype="msgbox_main"]').find('[proptype="reply_msg"]').attr("msgidval"),a=(new Date).getTime(),r=e.msgreply_to||g({targetmsgelem:e.contentdiv.find('[msg-id="'+t+'"]'),chid:e.chid});Message.displaySendMessage(e.chid,e.msg,"",a,r),LSMessanger.sendMessage(e.chid,e.msg,{type:"Replymsg",method:"POST",url:"/"+t+"/reply"},a),v(),e.composer.val("")},getReplymsgObj:g,removeReplymsgdiv:v,removeBindedEvents:function(e){e.find('[proptype="msgopr"]').remove(),e.find('[proptype="reply_msg"]').remove(),e.removeAttr("ondblclick")},removeMessagoprPopups:function(e){var t=e||ZSIQConversationManager.getcurrchatwinobj();p(t),v(t),t.chatdiv.find("#msgactnlist").remove()},handleEditMessage:function(e){var t=e.closest('[proptype="msgeditor"]').find('[proptype="editsave"]');if(!$Support.Util.validateFields(e.parent()))return t.addClass("elem_disable"),!1;var a=$.trim(e.val());e.removeClass("errfield"),a&&$.trim(e.attr("preval"))!=a?t.removeClass("elem_disable"):t.addClass("elem_disable")},getMsgObj:c}}();$UI={init:function(e){this.populateUI(e)},populateUI:function(e){this.setHeader(),this.setBody(null,e),this.setFooter()},setContainer:function(){$TH=$Support.isNewHeader()?$ThemeHandler.theme:$ThemeHandler[$Support.theme],$TH.updateContainer(),$Support.Util.updateParentFontFamily()},setHeader:function(){$TH.updateHeader()},setInnerHeader:function(e){$TH.updateInnerHeader(e)},setBody:function(e,t){$TH.updateBody(e,t),(t||!e&&-1==$Support.EmbedObj.department)&&this.populateDropDown()},setFooter:function(){$TH.updateFooter()},populateDropDown:function(){$TH.updateDeptDropdown()},showBanner:function(e,t,n,o,i,a){$TH.showBanner(e,t,n,o,i,a)},hideBanner:function(e,t){$TH.hideBanner(e,t)},showTimerBanner:function(e){$TH.showTimerBanner()},populateSendMail:function(e){$Support.Util.isPreview()||$TH.populateSendMail(e)},populateSendMailConfirm:function(e,t){$TH.populateSendMailConfirm(e,t)},populateSmiley:function(e){$TH.populateSmiley(e)},showUserEditUI:function(e,t,n){$TH.showUserEditUI(e,t,n)},hideUserEditUI:function(){$TH.hideUserEditUI()},showCaptcha:function(e){$TH.showCaptcha(e)},hideCaptcha:function(){$TH.hideCaptcha()},showMissedVisitorBanner:function(e,t,n){$TH.handleMissedStatus(e,t,n)},populateVisitorQuestion:function(e,t){$TH.populateVisitorQuestion(e,t)},getInfoMsgHTML:function(e,t){return $TH.getInfoMsgHTML(e,t)},populateUserAction:function(e){$TH.populateUserAction(e)},setChatStatus:function(e,t){e=$.trim(e),JSON.parse($Support.EmbedObj.pprops.showtyping)&&(t.contentdiv&&t.contentdiv.find("#typgstatus").text(e),$Support.Util.toggleFreeLogo())},updateOfflineUI:function(e,t){$TH.handleOfflineStatus(e,t)},updateOnlineUI:function(e,t){$Support.Util.handleOnlineStatus(e,t)},showFeedback:function(){$TH.populateFeedbackHTML()},showFdbkResponse:function(e){$TH.showFdbkResponse(e)},hideUtilityDiv:function(e,t,n,o){$TH.hideUtilityDiv(e,t,n,o)},getInfoMsgContent:function(e,t,n,o){return $TH.getInfoMsgContent(e,t,n,o)},showDragDropUI:function(){$Support.Util.isDragNotAllowed()||$TH.showDragDropUI()},hideDragDrop:function(){$TH.hideDragDrop()},getPreviewHTML:function(){return $TH.getPreviewHTML()},getCustomHTML:function(e){return $TH.getCustomHTML(e)},showUploadProgress:function(e,t){return $TH.showUploadProgress(e,t)},hideUploadProgress:function(e){return $TH.hideUploadProgress(e)},updateCloseIcon:function(){$TH.updateCloseIcon()},updateParentFontFamily:function(){return $TH.updateParentFontFamily()},populateIcon:function(){$TH.populateIcon()},removeSmileyIcon:function(){$TH.removeSmileyIcon()},updateQuesArea:function(){$TH.updateQuesArea()},updateChatEndMsg:function(e){$TH.updateChatEndMsg(e)},updateVisitorName:function(e){$TH.updateVisitorName(e)},getBusinessHrInfo:function(){return $TH.getBusinessHrInfo()},getSoundHTML:function(e,t){return $TH.getSoundHTML(e,t)},setSoundConfig:function(){$TH.setSoundConfig()},addGroupIcon:function(){},removeGroupIcon:function(){},populateCWaitHandler:function(){$TH.populateCWaitHandler()},removeCWaitHandler:function(){$TH.removeCWaitHandler()},displayInfo:function(e){$TH.displayInfo(e)},setDepartment:function(e){$("#dropcontent").find("[val='"+e+"']").trigger("click")},showCloseAlert:function(){-1!=$Support.EmbedObj.chatID&&1==confirm(LSResource.getRealValue("ne.reload.alert"))&&retrun},focusComposer:function(){window.outerWidth<555||$Support.Util.isPreview()||$("#msgarea").focus()},appendTransferDiv:function(e,t,n){var o=$Support.LSDB.get("ZLD"+e.chatID+"transfer_state");if(o&&"offline"===o.state)$UI.showOperatorOffline(e);else{var i=e.chatdiv;if(!(0<i.find(".zsiq_transferdiv").length||e.hidetransfer||-1==e.chatID)){var a=$Support.getHandoffConfig(e.chatID);if(a.hand_off){t=t||a.text,n=n||a.ack,t=t||LSResource.getRealValue("ne.agent.transfer"),n=n||LSResource.getRealValue("common.yes");var s='<div class="zsiq_transferdiv fnt13" id="agenttransfer">'+getEncodedText(t)+'<span documentclick="transferchat" class="bot_opt">'+getEncodedText(n)+"</span></div>";i.append(s)}}}},appendConsentDiv:function(e,t){var n,o=e?"$Support.getMissedUserConsent":"$Support.getUserConsent",i=t.chatdiv||$("#msgdiv");t.composer||$Support.getComposer(),n='<div class="zsiq_transferdiv fnt13" id="creditcardconsent">'+($Support.EmbedObj.creditcardbanner_content||LSResource.getRealValue("ne.agent.cardmask"))+'<span onclick="'+o+"(1, '"+t.winid+'\')" class="bot_opt">'+LSResource.getRealValue("common.yes")+'</span><span onclick="'+o+"(0, '"+t.winid+'\')" class="bot_opt">'+LSResource.getRealValue("common.no")+"</span></div>",0==$(" #creditcardconsent ").length&&i.append(n)},appendChatConsentDiv:function(e,t,n,o){if(o){this.removeTransferDiv("",o);var i=o.chatdiv||$("msgdiv"),a=LSResource.getRealValue("common.gdpr.agent.chatconsent2");n&&(n=-1==n.indexOf("http")?"http://"+n:n,a="<a class='siq-lnmor sbold' id='chatconsenturl' target='_blank'>"+a+"</a>");var s=$Support.EmbedObj.chatconsentmsg||LSResource.getRealValue("common.gdpr.agent.chatconsent1")+" "+a+" "+LSResource.getRealValue("common.gdpr.agent.chatconsent3"),r=LSResource.getRealValue("common.gdpr.agent.accept"),c=LSResource.getRealValue("common.gdpr.agent.decline"),d=$Support.getParent().$ZSIQUtil.getAPIValues(),u=o.winid;if(d.textbannerobj&&d.textbannerobj.online){var l=d.textbannerobj.online;if(s=l.description&&0!=l.description.trim().length?l.description:s,r=l.acceptbutton&&0!=l.acceptbutton.trim().length?l.acceptbutton:r,c=l.declinebutton&&0!=l.declinebutton.trim().length?l.declinebutton:c,l.policytextandlink){var p=l.policytextandlink,f=p.text&&0!=p.text.trim().length?p.text:"",g=p.link&&0!=p.link.trim().length&&$Support.getParent().$ZSIQUtil.isValidURL(p.link)?p.link:"";s=$Support.getParent().$ZSIQUtil.hyperLinksSubString(s,f,g)}}chatconsenthtml='<div class="zsiq_transferdiv fnt13 chatconsent" id="chatconsentdiv">'+s+'<div class="mT10"><span type=1 isproactive ='+t+" skipregister="+e+" winid="+u+' documentclick="getChatUserConsent" class="bot_opt gltr-srno">'+r+"</span><span type=0 isproactive ="+t+" winid="+u+' documentclick="getChatUserConsent" class="bot_opt gltr-srno gltr-no">'+c+"</span></div></div>",0==i.find(" #chatconsentdiv ").length&&(i.append(chatconsenthtml),i.find("#chatconsenturl").attr("href",n))}},removeTransferDiv:function(e,t){var n=(t=t||{}).contentdiv&&t.contentdiv.find(".zsiq_transferdiv");n.fadeOut("slow",function(){n.remove(),e&&"missed"==t.botchatprops.status&&"Continue with Bot"==e[0].innerHTML&&(t.botchatprops.status="connected",$Support.setCookie(t))})},removeConsentDiv:function(){var e=$("#creditcardconsent");e.fadeOut("slow",function(){e.remove()})},removeChatConsentDiv:function(){$("#chatconsentdiv").remove()},removeOfflineConsentDiv:function(){var e=$("#offlineconsent");e.fadeOut("slow",function(){e.remove(),$Support.Util.setTextareaHeight()})},appendGTConsentDiv:function(e,t,n){n=n||$("msgdiv"),e=-1==(e=e||_GT_ATTRIBUTIONLINK).indexOf("http")?"http://"+e:e;var o="<a class='siq-lnmor sbold' target='_blank' id='gtconsenturl'> "+LSResource.getRealValue("helplink.learnmore")+"</a>",i=LSResource.getRealValue("common.gdpr.agent.translateinfo")+o,a=LSResource.getRealValue("common.gdpr.agent.accept"),s=LSResource.getRealValue("common.gdpr.agent.decline");gtconsenthtml='<div class="zsiq_transferdiv fnt13 chatconsent" id="gtconsentdiv">'+i+'<div class="mT10"><span onclick="$Support.handleVTransLangStatus(1,\''+t+'\')" class="bot_opt gltr-srno">'+a+"</span><span onclick=\"$Support.handleVTransLangStatus(0,'"+t+'\')" class="bot_opt gltr-srno gltr-no">'+s+"</span></div></div>",0==$(" #gtconsentdiv ").length&&(n.append(gtconsenthtml),n.find("#gtconsenturl").attr("href",e))},removeGTConsentDiv:function(){var e=$("#gtconsentdiv");e.fadeOut("slow",function(){e.remove()})},showTransferMissed:function(e){e.contentdiv.find(".zsiq_transferdiv").remove();var t='<div class="zsiq_transferdiv zsiq_transmissed fnt13" id="transfermissed">'+LSResource.getRealValue("ne.agent.transfermissed")+'<div><span documentclick="removetransfer" class="bot_opt">'+LSResource.getRealValue("ne.chatwindow.continuewithbot")+'</span><span documentclick="transfermissed" class="bot_opt">'+LSResource.getRealValue("settings.embed.offline")+"</span></div></div>";(e.chatdiv||$("#msgdiv")).append(t);var n=e.chatmaindiv||document.getElementById("msgmaindiv");n.scrollHeight-n.scrollTop==n.clientHeight||n.scrollHeight<n.clientHeight||Message.scroll(n)},showOperatorOffline:function(e){(e=e||{}).contentdiv.find(".zsiq_transferdiv").remove();var t='<div class="zsiq_transferdiv fnt13" ><span documentclick="transfermissed" purpose="offline" class="bot_opt">'+LSResource.getRealValue("ne.chatwindow.dropmessage")+"</span></div>";(e.chatdiv||$("#msgdiv")).append(t);var n=e.chatmaindiv||$("#msgmaindiv");n.scrollHeight-n.scrollTop==n.clientHeight||n.scrollHeight<n.clientHeight||Message.scroll(n)},getTranslateBannerHTML:function(e,t){return $TH.getTranslateBannerHTML(e,t)},reSetHeaderClass:function(){$TH.reSetHeaderClass()}};var $NE=!1;$EmbedManger={isNewEmbed:$NE=!("undefined"==typeof $Support),setChatID:function(t){return $NE?$Support.EmbedObj.chatID=t:Support.setChatID(t)},getChatID:function(){return $NE?$Support.getChatID():Support.getChatID()},setPrevCHID:function(t){return $NE?$Support.EmbedObj.lchid=t:Support.setPrevCHID(t)},getPrevCHID:function(){return $NE?$Support.EmbedObj.lchid:Support.getPrevCHID()},getWaitingCookie:function(){return $NE?$Support.getWaitingCookie():SupportUI.getCookieValue("ZLD"+Support.getLiveSupportID()+"WAITING")},getVisitorID:function(){return $NE?$Support.EmbedObj.visitorID:Support.getVisitorID()},getLiveSupportID:function(){return $NE?$Support.EmbedObj.livelsid:Support.getLiveSupportID()},getAttenderID:function(){return $NE?$Support.EmbedObj.attender:Support.getAttender()},showChatUI:function(t,e,o){try{SiqAVRouter.container.detailsHandler.triggerIconCheck(o.RCHID)}catch(t){}if($NE&&t){var r=$Support.getTranscriptFromSession(o.chatID);if($.isEmptyObject(t[t.length-1])&&t.splice(t.length-1,1),e)return void o.showChatUI(t);if($Support.LSDB.isSessionStorageAvail()&&r&&r.length==t.length){var n=r.length;if(r[n-1].msg==t[n-1].msg)return}o.showChatUI(t)}else Support.showChatUI()},isautotrigger:function(){return $NE?$Support.istrigmsg:Support.isautotrigger},getAddinfo:function(){return $NE?$Support.EmbedObj.addinfo:Support.addinfo},getDeptlist:function(){return $NE?$Support.EmbedObj.deptlist:Support.deptlist},updateChatCookie:function(t){$NE?$Support.updateChatCookie(t):Support.updateChatCookie()},handleChatEnded:function(t,e){if(!$NE)return Support.handleChatEnded(t);$Support.handleChatEnded(t,e)},setVisitorName:function(t){$NE?$Support.EmbedObj.setVisitorName(t):Support.setVisitorName(t)},getVisitorName:function(){return $NE?$Support.EmbedObj.visitorname:Support.getVisitorName()},setVisitorEmail:function(t){$NE?$Support.EmbedObj.setVisitorEmail(t):Support.setVisitorEmail(t)},setVisitorPhone:function(t){$NE?$Support.EmbedObj.setVisitorPhone(t):Support.setVisitorPhone(t)},handleCallbacks:function(t,e){if(!$NE)return Support.handleCallbacks(t,e);$Support.Util.handleCallbacks(t,e)},handlePickUp:function(t){$NE?$Support.handlePickUp(t):Support.handlePickUp(t)},handleDesktopSharing:function(t){return $NE?$Support.handleDesktopSharing(t):Support.handleDesktopSharing(t)},handleEndSession:function(t){if($NE){EmbedSound.stop();var e=ZSIQConversationManager.getChatWinObjById($Support.chidmappinglist[t.chid]);return!e.isSoundOff()&&EmbedSound.play("endtimer",t.timer),void $Support.handleEndSession(t.timer,!0,e)}return Support.handleEndSession(t)},handleJoinProActive:function(t){$NE?$Support.handleJoinProActive(t):Support.handleJoinProActive(t)},reJoin:function(){$NE?$Support.reJoin():Support.reJoin()},addVisitor:function(){$NE?$Support.addVisitor():Support.addVisitor()},quit:function(t){if($NE)return $Support.quitChat(t);Support.quit()},setCookie:function(){$NE?$Support.setCookie():Support.setCookie()},removeChatCookie:function(){$NE?$Support.removeChatCookie():Support.removeChatCookie()},getType:function(){return $NE?$Support.type:Support.type},getuvid:function(){return $NE?$Support.EmbedObj.uvid:Support.uvid},getvwmsid:function(){return $NE?$Support.EmbedObj.vwmsid:Support.vwmsid},getWaitTimer:function(){return $NE?$Support.waitTimer:Support.waitTimer},setCallbackargs:function(t){$NE?$Support.callbackargs=t:Support.callbackargs=t},setQuitStatus:function(t){$NE?$Support.callquitstatus=t:Support.callquitstatus=t},getQuitStatus:function(){return $NE?$Support.callquitstatus:Support.callquitstatus},setIPBlockStatus:function(t){$NE?$Support.isipblocked=t:Support.isipblocked=t},getVisitID:function(){return $NE?$Support.EmbedObj.VISITID:Support.visitorinfo.VISITID},isComposerFocused:function(){return $NE?$Support.iscomposerfocus:Support.iscomposerfocus},iswindowfocused:function(){return $NE?$Support.iswindowfocused:Support.iswindowfocused},isSoundOff:function(){return $NE?"-1"==$Support.EmbedObj.soundval:!SupportUI.sound},updateChatCache:function(t,e,o){return $NE?$Support.updateChatCache(t,e,o):""},getChatStatus:function(){return $NE?$Support.ischatdisabled:SupportUI.ischatdisabled},getMessageLength:function(){return $NE?$.trim(" "+$("#msgarea").val()).length:$.trim(" "+$("#lstxteditor").val()).length},handleApiData:function(){return $NE?$Support.handleApiData():SupportUI.handleApiData()},isCrossDomainReq:function(){return!0}},$EmbedManger.UI={isNewEmbed:$EmbedManger.isNewEmbed,displayInfo:function(t,e){$NE?$UI.showBanner(t):SupportUI.displayInfo(t,e)},hideInfo:function(){$NE?$UI.hideBanner():SupportUI.hideInfo()},showProcess:function(t){$NE||SupportUI.showProcess(t)},showAgentStatus:function(){$NE||SupportUI.showAgentStatus()},resizequestion:function(){if(!$NE)return SupportUI.resizequestion},postMessage:function(t,e){$NE?$Support.postMessage(t,e):SupportUI.postMessage(t,e)},embeddiv:function(){return $NE?$Support.container:SupportUI.embeddiv},showVisitorInfo:function(){$NE||SupportUI.showVisitorInfo()},resizeWindow:function(){$NE||SupportUI.resizeWindow()},getCaptchaValue:function(){return $NE?$Support.Util.getCaptchaValue():SupportUI.getCaptchaValue()},showCaptcha:function(t){$NE?$UI.showCaptcha(t):SupportUI.showCaptcha(t)},hideCaptcha:function(){$NE?$UI.hideCaptcha():SupportUI.hideCaptcha()},showFeedback:function(t,e){$NE?$UI.showFeedback(t,e):SupportUI.showFeedback(t,e)},handleEndSupport:function(t){$NE||SupportUI.handleEndSupport(t)},hideVisitorInfo:function(){$NE||SupportUI.hideVisitorInfo()},clearProgress:function(){$NE||SupportUI.clearProgress()},getDragDropHtml:function(){if(!$NE)return SupportUI.getDragDropHtml()},setChatStatus:function(t,e){$NE?$UI.setChatStatus(t,e):SupportUI.setChatStatus(t)},formatAndDisplayInfo:function(t,e,o){if($NE){e.chid=t;var r=$UI.getInfoMsgContent(e);if(!r)return;ZSIQTranscript.updateTranscript({html:r},t)}else Message.formatAndDisplayInfo(t,e,o)},getPrevHTML:function(){return $NE?$UI.getPreviewHTML():PasteImage.getEmbPrevHTML()},showPasteUI:function(){if($NE)return $Support.Util.showPasteUI();PasteImage.showEmbedUI()},hidePasteUI:function(){if($NE)return $Support.Util.hidePasteUI();PasteImage.hideUI()},updateVisitorName:function(t){$NE&&$UI.updateVisitorName(t)},showGroupIcon:function(){},hideGroupIcon:function(){},getResendIcon:function(){return $NE?'<em id="resendicon" class="sqico-resend" documentclick="resendmsg" title="'+LSResource.getRealValue("embed.msg.resend")+'" ></em>':'<em id="resendicon" class="sqico-resend spritebg" onclick="LSMessanger.resendMessages('+RESEND_MANUAL+')" title="'+LSResource.getRealValue("embed.msg.resend")+'" ></em>'}};var _ZLDReq=function(){};_ZLDReq.samples="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_ZLDReq.getC=function(e,s){var t=e.charCodeAt(s);if(255<t)throw"error";return t},_ZLDReq.btoa=function(e){if(!e)return"";var s,t,a=[],r=e.length-e.length%3;for(s=0;s<r;s+=3)t=_ZLDReq.getC(e,s)<<16|_ZLDReq.getC(e,s+1)<<8|_ZLDReq.getC(e,s+2),a.push(_ZLDReq.samples.charAt(t>>18)),a.push(_ZLDReq.samples.charAt(t>>12&63)),a.push(_ZLDReq.samples.charAt(t>>6&63)),a.push(_ZLDReq.samples.charAt(63&t));switch(e.length-r){case 1:t=_ZLDReq.getC(e,s)<<16,a.push(_ZLDReq.samples.charAt(t>>18)+_ZLDReq.samples.charAt(t>>12&63)+"==");break;case 2:t=_ZLDReq.getC(e,s)<<16|_ZLDReq.getC(e,s+1)<<8,a.push(_ZLDReq.samples.charAt(t>>18)+_ZLDReq.samples.charAt(t>>12&63)+_ZLDReq.samples.charAt(t>>6&63)+"=")}return a.join("")};$Support.Util={jsdownloadtimer:-1,ispostloaddone:!1,isbotconversation:!1,handleTextClear:function(e,t){e.parent().find('input[type="text"]').val("")},minimizeEmbed:function(){$("body").hasClass("ssview")?$Support.closeSSChatView():$Support.getParent().$ZSIQChatWindow.minimizeChatWindow()},handleMinimizeinBannerTimeout:function(){ZSIQConversationForm.clearSessionStorage(),ZSIQConversationForm.isOldFormView()?ZSIQConversationManager.getConnectedCount()||$Support.Util.minimizeEmbed():$Support.Util.closeEmbed(),$Support.convongoingchatobj&&$Support.convongoingchatobj.remove()},maximizeEmbed:function(){this.postMessage("newEmaximize",{width:"371",height:"460"})},closeEmbed:function(e,t){if(e=e||{},ZSIQConversationManager.getConnectedCount()){e.callquitstatus=!1,e.chatID=-1;var i=$Support.joinedchatkeys,n=i.indexOf(e.winid),a=e.contentdiv;return-1!=n&&i.splice(n,1),e.presender="",a&&(a.find('[proptype="action_icons"]').removeClass("show_send"),a.find("div.usrinpt").hide()),void(e.chatmaindiv&&e.chatmaindiv.after(e.chatendmsg=$($Temp.getChatEndHTML(!0))))}$Support.getParent().$ZSIQChatWindow.closeChatWindow(),$Support.enableTextarea(),$Support.contentdiv=null;var r=$Support.EmbedObj;$Support.callquitstatus=!1,r.setVisitorID(-1),r.setChatID(-1),$BotImpl.resetDisableComposerTimer(),r.setVisitID(-1),$Support.joinedchatkeys=[],Message.presender="",$Support.init($Support.getParent().$ZSIQWidget.getEmbedObject()),$Support.getParent().$ZSIQChatWindow.constructIframe(!0)},setThemeInFloat:function(e){this.postMessage("settheme",e)},triggerAdditionalFileDownload:function(){var e=$Support.Util;e.ispostloaddone||(clearTimeout(e.jsdownloadtimer),e.downloadAdditionalFiles())},downloadAdditionalFiles:function(){if(!$Support.Util.ispostloaddone){var e=$Support.getParent().$ZSIQWidget.getEmbedObject(),t=$Support.getParent().$ZSIQChat.getWidgetData().commondata,i=t.schema+"://"+e.embedserverurl,n=document.querySelectorAll("head");if(0==n.length&&((n=[])[0]=document.createElement("head"),document.insertBefore(document.body,n[0])),e.ucomp){var a=document.createElement("script"),r=$Support.getParent().$zohosq.nonce,o="/salesiq/js/embedpostload_d62fdd276a2d2d28125db7b872efb274_.js",s=t.jsstaticserver+o;t.isCDNEnabled&&(s=t.jscdnstaticserver+o),a.src=s,r&&a.setAttribute("nonce",r),n[0].appendChild(a);var d="/salesiq/styles/embedpostload_b08f1e6aa9116b31b91b3d87dff43aa0_.css",p=$Support.getParent().$ZSIQWidget.getWidgetObject().cssstaticserver+d;t.isCDNEnabled&&(p=$Support.getParent().$ZSIQWidget.getWidgetObject().csscdnstaticserver+d),(m=document.createElement("link")).type="text/css",m.rel="stylesheet",m.href=p,r&&m.setAttribute("nonce",r),n[0].appendChild(m)}else{for(var c=["/js/embed/new/chatwindow/jquery.ztooltip.js","/js/cw/lsdragdrop.js","/js/cw/pasteimage.js","/js/cw/validator.js","/js/cw/clickoutside.js"],l=0;l<c.length;l++){var u=document.createElement("script");u.src=i+c[l],n[0].appendChild(u)}var g=["/styles/cw/smiley.css","/styles/cw/ui.ztooltip.css"];for(l=0;l<g.length;l++){var m;(m=document.createElement("link")).type="text/css",m.rel="stylesheet",m.href=i+g[l],n[0].appendChild(m)}}$Support.Util.ispostloaddone=!0}},loadExternalFiles:function(){var e=document.querySelectorAll("head");0==e.length&&((e=[])[0]=document.createElement("head"),document.insertBefore(document.body,e[0]));var t=document.createElement("script"),i=$Support.getParent().$zohosq.nonce;t.src="https://js.zohocdn.com/zohosecurity/v5_0/js/security-html-sanitizer.min.js",i&&t.setAttribute("nonce",i),e[0].appendChild(t);var n=document.createElement("script");i=$Support.getParent().$zohosq.nonce;n.src="https://js.zohocdn.com/zohosecurity/v5_0/js/security-url-validator.min.js",i&&n.setAttribute("nonce",i),e[0].appendChild(n)},showMoreAction:function(e,t){var i=e.closest("section [data-id]").attr("data-id"),n=ZSIQConversationManager.getChatWinObjById(i);$Clickoutside.bindclick($Support.Util.hideMoreActionDiv,"mraction","moreaction");var a=e.parents(".usractions"),r=a.find(".mraction");r.addClass("shwact"),r.find('li[purpose="sound"]').replaceWith($UI.getSoundHTML("",n.soundval)),a.removeClass("showmore")},hideMoreActionDiv:function(){var e=ZSIQConversationManager.getcurrchatwinobj();e&&e.contentdiv.find("ul.mraction").removeClass("shwact").parents(".usractions").addClass("showmore")},getKeyCode:function(e){return(e=null==e?window.event:e).keyCode||e.which},handleBannerSlide:function(e,t){var i=t;i.removeClass("timer");var n=i.outerHeight();if(i.html(e),i.is(":animated"))i.css("height","auto");else{var a=i.outerHeight();i.css({height:n+"px"}).animate({height:a},"5000",function(){i.height("auto")})}},showInfoBanner:function(e,t,i,n,a){var r=this;clearTimeout(r.bnrtimer);var o=$Support.contentdiv||ZSIQConversationManager.getcurrchatwinobj().contentdiv,s=ZSIQConversationManager.getcurrchatwinChid(),d=o.find("#info_banr");d.removeClass("dN"),$Support.container.hasClass("outerwin")?d.addClass("relate"):d.removeClass("relate"),$Support.EmbedObj.bushrstatus?d.addClass("bsnshrs"):d.removeClass("bsnshrs"),e?r.handleBannerSlide(e,d):i&&d.hide().slideDown(500,function(){}),t&&(a=a&&5e3<=a?a:5e3,r.bnrtimer=setTimeout(function(){$UI.hideBanner(n,s)},a))},sendMail:function(e,t){if(e&&13==this.getKeyCode(e))return $Support.sendMail(t)},validateFields:function(e){if(!$Support.Util.isPreview()){var t,i=!0,n=0;return e.find("[data-validate]").each(function(){$(this).validateInput()||(i=!1,t=$(this),n++)}),this.showErrorInfo(n,t),i}},showErrorInfo:function(e,t){var i=t?ZSIQConversationManager.getChatWinObjById(t.parents(".siq_content").attr("data-id")):"";if(!(e<1||CallImpl.isCallWithChat)){var n=LSResource.getRealValue("ne.errorinfo.all");if(1===e){var a=t.attr("info");n=/^number|email|url|percentage|decimal|name|email|phone$/.exec(a)?LSResource.getRealValue("ne.errorinfo."+a):n}"question"!=a&&!ZSIQConversationForm.isOldFormView()&&"smailbx"!=t.parent().attr("id")||"editorarea"==t.attr("proptype")||(i&&i.showBanner?i.showBanner(n,!0):$UI.showBanner(n,!0)),$("#info_banr").removeClass("relate")}},populateChatUI:function(e,t,i,n){var a=e.length;if(e&&a&&!CallImpl.isCallWithChat){var r=e[0]&&e[0].chid||t,o=ZSIQConversationManager.getChatWinObjById(r);delete o.waitTimer,e=CommonUtil.parseToJSON(e);var s,d,p=0,c="",l="",u="",g=$Support.getParent().$ZSIQUtil.getAvuid(),m=t?o.chatdiv:o.chatdiv||$("#msgmaindiv");!n&&m.html(""),ZSIQTranscript.reSetPreviousSender(o);for(var h=[];p<a;p++){var v=e[p];if(p==a-1&&!getObjectSize(v))break;if(v.deleted&&(v.msg=LSResource.getRealValue("chat.messagedelete"),delete v.mode),"att"!=v.mode||!v.msg.att_type||"recording"!=v.msg.att_type){if(v.msg&&v.msg.form_type){var f={chattrasncript:e,fieldtranscript:("classic"==v.msg.form_type?ZSIQConversationForm.updateAndGetClassicFormData(v):v.msg.msglist)||[],currindex:p};return ZSIQConversationForm.formatAndPopulateTranscript(f,t,i,n),void(c="")}var S=(v=$Support.Util.handleAbusiveDetectionMsgObj(v)).sender,C={},b=v.dname,I=v.msg,w=v.time||v.intime||v.mtime||"",y=v.mode;if(w=w.toString(),"object"!=typeof(I=$Support.Util.sanitizeMessage(I))&&v.formattedmsg&&(I=v.formattedmsg),"ACCEPT_TRANSFER"==(y=y||("object"==typeof I?I.mode:y))?(I.opruser.dname=e[0].attendername,I.opruser.attendername=e[0].attendername):"BOT_MESSAGE"==y&&(I=v),0===p&&!n||n&&v.question){o.isBotChat&&o.chatmaindiv&&o.chatmaindiv.addClass("bot_chat");var U=ZSIQConversationManager.getcurrchatwinChid()==r||-1==ZSIQConversationManager.getcurrchatwinChid();if(U=!$Support.EmbedObj.isreopenenabled||U,S=o.presender=S||$Support.EmbedObj.vwmsid,v.attendername&&(o.attendername=v.attendername),b=v.visitorname||v.dname,!t&&!$Support.isConversationUIFocussed()&&(v.isBotChat=o.isBotChat,U)){var E=JSON.parse($Support.EmbedObj.eprops.iclogo)?$Support.EmbedObj.clogo:"",T=$Support.isUserLogoEnabled("",o)&&o.attenderimagefkey?$Support.Util.getPhotoURL(o.attenderimagefkey,o.attender):"";E=(E=o.attendername?T:E)||!o.isBotChat&&!o.isBotattendedchat?E:ZSIQTranscript.getImageURL({sender:o.attender}),v.attendername=o.attendername,v.aboutme=o.attenderaboutme,$UI.setInnerHeader(v),$Support.Util.updateUserImage(E,o)}if(I=v.question||v.ques||v.msg,I=Message.getDisplayContent(I),!t&&!ZSIQConversationForm.checkContextInitiated()){var _=o.queueTimer||"queueing"==o.chatstatus,k=o.waitingtime||_;k||-1===o.visitorID||o.istriggeredchat||!o.attender||$UI.populateUserAction(o),!k&&o.populateIcon(),_&&o.appendQueueHandOffHtml({chid:o.chatID})}if(isUndefined(I)||""==I)continue}if("BOT_MESSAGE"!=y&&(I.chid=r,I.time=v.time,l=$UI.getInfoMsgContent(I,t,i,!0)),y)if("TRIGGER"==y)b=I.dname,I=I.msg;else if("att"===y)C.file=I;else if("cannedarticle"===y)I=$FAQ.getCustomCard(I.msg),C.iscannedarticle=!0;else if("BOT_MESSAGE"==y||"BOT_TRIGGER"==y){var q=(I=I.msg).msglist;if(q)for(var O in q){S=I.sender;var x=(M=(v=q[O]).meta)&&M[$Widget.display_card]&&!M[$Widget.input_card]?M[$Widget.display_card].image:"";c+=ZSIQTranscript.getTranscript($.extend(C,{dname:I.dname,msg:v.msg,time:I.time,sender:S,previoussender:u==S,convvisitorid:t,convchid:i,iscannedarticle:v.iscannedarticle,ratinghtml:v.ratinghtml,bot_image:x,isbotmessage:$BotImpl.isBotMessage(v),msgid:v.msgid||v.uniqueid,meta:M||{}}),!0,r),o.presender=S}}else if(I.mode&&!l)continue;!v.meta||"resource_share"!=v.meta.type&&"resource-share"!=v.meta.subtype||((v=v.meta.display_card?v:$Support.formatObjforResourceSharing(v)).resourcearticle=!0,I=""),w=CommonUtil.checkAndGetReadableTime(w);var M;x=(M=v.meta)&&M[$Widget.display_card]&&!M[$Widget.input_card]?M[$Widget.display_card].image:"";S=!S&&v.msg&&"TRIGGER"==v.msg.mode?b:S;var j=C&&C.file&&-1!=C.file.content.indexOf("audio"),Q=$.extend(C,{dname:b,msg:I,time:w,widgettime:v.time,sender:S,previoussender:u==S,convvisitorid:t,convchid:i,iscannedarticle:v.iscannedarticle,ratinghtml:v.ratinghtml,bot_image:x,isvisitor:v.isvisitor||g==v.sender,isques:v.isques,isbotmessage:$BotImpl.isBotMessage(v)||v.resourcearticle,msgid:v.msgid||v.uniqueid,msguid:v.msguid,meta:M||{},att_type:v.msg&&v.msg.att_type&&v.msg.att_type,is_edited:v.is_edited,deleted:v.deleted,reply_to:v.reply_to,isques:v.question}),A=v.msg&&v.msg.att_type&&"voice_note"==v.msg.att_type;j&&A&&(d=(s=ZSIQAudio.init(Q,r))&&s.getHTML(),h.push(s)),c+=l||ZSIQTranscript.getTranscript(Q,!0,r,d),d="",u=o.presender=S}}if("function"!=typeof n){if(t?(ZSIQTranscript.updateTranscript({html:c,ispopulate:!0},r),o.contentdiv.find('[chatmsgtype="image"]').show(),ZSIQTranscript.setMessageClass()):(ZSIQTranscript.updateTranscript({html:c,ispopulate:!0},r),o.contentdiv.find('[chatmsgtype="image"]').show(),ZSIQTranscript.scroll()),0<h.length)for(p=0;p<h.length;p++)h[p].init();var D=e[a-1],Z=m.find(".msgbx").last(),F=o.botchatprops&&o.botchatprops.status,R=D.meta||{};if(($BotImpl.iswidgetobj(D)||R.suggestions)&&o.chatID==e[0].chid&&"connected"==F&&0===m.find("#cmpnt"+D.time).length){var B=R[$Widget.display_card]&&R[$Widget.input_card],P=Z.parent();P[0]&&P[0].id==D.msgid&&P.remove(),2!==a&&D.dname===e[a-2].dname||ZSIQTranscript.reSetPreviousSender(o),D.chid=o.chatID,B?$BotImpl.handleInputAndDisplayWidgetsObj(D):$Widget.showBotReply(D),D.meta&&(D.meta[$Widget.input_card]||"wait_for_user_input"==D.meta.behaviour)&&$BotImpl.disableComposer("","",r)}if(o.showWaitingDialog(),o.isBotChat&&o.botchatprops){var L=o.botchatprops.status;"connected"==L?$UI.appendTransferDiv(o):"missed"==L&&$UI.showTransferMissed(o),$BotImpl.checkAndScheduleComposerDisable(r)}var H=o.chatmaindiv||$("#msgmaindiv");H&&H[0]&&!i&&!t&&ZSIQTranscript.scroll("",H);var V=SUPPORT_REPS[r]||{};Object.keys(V).length;t||(o.showWaitingDialog(),$Support.setCookie(),delete o.waitTimer)}else n({html:c,chatdiv:m})}},getPhotoURL:function(e,t){$Support.EmbedObj;return e?_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/userimg/"+e+"/photo.ls?nocache=1":ZSIQTranscript.getImageURL({sender:t})},getUserImageWithNPS:function(e){return e&&-1==e.indexOf("nps=202")?e+(-1!=e.indexOf("?nocache")?"&nps=202":"?nps=202"):e},updateUserImage:function(e,t){$Support.Util.updateHeaderBotType("",t),$("#complogo").attr("src",$Support.Util.getUserImageWithNPS(e))},handleKeyDown:function(e,t,i){try{if(13==t&&i.shiftKey)return!0}catch(i){}0==e.parent().find(".smileli").length||-1==[39,37,38,40,13].indexOf(t)?13==t&&(i.preventDefault?i.preventDefault():i.returnValue=!1):i.preventDefault?i.preventDefault():i.returnValue=!1},handlePredictMsg:function(e){var t=e.attr("txtarea-id"),i=ZSIQConversationManager.getChatWinObjById(t);if(-1!=i.chatID&&"sendmessage"===e.attr("dockeyup")){var n=$.trim(e.val()),a=this;if(Licence.verify("creditmask")&&(n=Message.checkMaskOccurance(n,!1)),""!=n&&!a.enablepmsg){a.enablepmsg=!0;var r={chid:i.chatID,vid:i.visitorID};a.prdcttimer=setTimeout(function(){LSMessanger.sendPredictMessage(n,r),a.enablepmsg=!1},3e3)}}},handleRating:function(e){if(!$Support.Util.isPreview()&&!e.hasClass("sel")){var t=e.closest("section [data-id]").attr("data-id"),i=ZSIQConversationManager.getChatWinObjById(t);$(".sqico-star").removeClass("sel"),e.addClass("sel"),i.composer.focus(),i.feedbacksent||$Support.setRating(e,i)}},handleFeedback:function(e,t,i){var n=e.parent('[proptype="fdbk_wrapper"]').find("#sqico-send");if(n=n.length?n:"",$Support.toggleSendButton(e,n),13===t){if(!this.validateFields(e.parent()))return i.preventDefault(),!1;$Support.sendFeedback(e)}},submitFile:function(e,t){try{var i=$(e)[0];if(0===i.files.length)return}catch(e){}this.hideMoreActionDiv();try{this.handleDropEvent(ZSIQConversationManager.getcurrchatwinChid(),t,i.files)}catch(e){}return!1},handleSendMail:function(e,t,i){var n=e.parent();1<=e.val().length?n.addClass("icoclr"):n.removeClass("icoclr"),13===t&&n.find('[documentclick="triggermail"]').trigger("click")},postMessage:function(e,t){if(null!=t){var i={type:$Support.type,operation:e,value:t};sendPostMessage(i)}},loadPostMessage:function(){window.addEventListener?addEventListener("message",$Support.Util.handlePostMessage):attachEvent("onmessage",$Support.Util.handlePostMessage)},handlePostMessage:function(e){var t;try{t=JSON.parse(e.data)}catch(e){return}var i=t.operation,n=t.value;$Support.Util;if("apivalues"==i)$Support.handleApiData(n);else if("broadcast"==i)$Support.handleApiData(n,!0);else if("sound"==i)$UI.setSoundConfig();else{if("dstoragevalues"==i)return $Support.dStorageCallbackHandler(n);if("dcookievalues"==i)return $Support.dCookieCallbackHandler(n);if("initiframe"==i)return $Support.synchronizeDomainStorage()}},handleTriggers:function(e,t){var i=$Support.Util;if(e!==TRIGGER_SEND_MESSAGE||$Support.waitTimer)e===TRIGGER_PLAY_TUNE&&EmbedSound.play(t.tune);else{if($Support.isChatExist())return;EmbedSound.play("smessage"),i.handleChatTrigger(t),i.handleCallbacks("visitor.chattrigger",t)}},handleTrackChat:function(e){$Support.isChatExist()||($Support.Util.handleCallbacks("visitor.chattrigger",{}),$Support.Util.proactiveChat(e))},handleUTSConnect:function(e){var t=$Support.isChatExist();if(!t||e.isnewconnection){var i=$Support.getRecentLiveChatid(),n=ZSIQConversationManager.getChatWinObjById(i).visitorID;t&&n&&-1!==n&&e.isnewconnection&&$Support.rejoinVisitorInUTS(n)}},proactiveChat:function(e){var t=$Support.EmbedObj;if(!$Support.isChatExist()&&!$Support.getTriggerCookie()){if(delete $Support.istrigmsg,t.uvid=e.uvid,t.setVisitorEmail(e.email),t.setVisitorName(e.name),t.setVisitorPhone(e.phone),!$Support.getParent().$ZSIQUtil.getAPIVisitorID()){t.setvwmsID(e.vwmsid);var i=$Support.getParent().$ZSIQChat.getWidgetData();i.embedobj.annonid=e.vwmsid,$Support.getParent().$ZSIQUtil.storeDetails(i)}LSMessanger.setNickName(e.name),$EmbedManger.setQuitStatus(!1);var n={attender:e.attender,attenderuseragent:e.attender_useragent,attenderemail:e.attenderemail,attendername:getUnescapedText(e.attendername),chid:e.chid,did:e.department,imagefkey:e.image_fkey,pmsg:e.msg,RCHID:e.wms_chat_id,attenderaboutme:e.aboutme,chatintime:(new Date).getTime()-1e3,proactive:!0,triggername:getUnescapedText(e.attendername)};ZSIQConversationManager.init(n),$Support.chidmappinglist[e.wms_chat_id]=e.chid;var a=ZSIQConversationManager.getChatWinObjById(e.chid);$Support.setCookie(a),$Support.checkAndRegisterWms(),$Support.isFAQUIFocussed()&&$Support.handleNewChatInConversation(a)}},setBotStatus:function(e){$Support.isbottrigmsg=e,$Support.isBotChat=e},handleChatTrigger:function(e,t,i){var n=$Support.EmbedObj,a=$Support.getParent().$ZSIQUtil.getAPIValues(),r=$Support.getTriggerCookie();if((!$Support.isChatExist()||t)&&(a.triggermsg||!r||t||a.mtrigger)){var o=e.lsid;if(!o||o==n.livelsid){if(a.mtrigger&&r&&!t){var s=r.winid,d=ZSIQConversationManager.getChatWinObjById(s);return d.pmsg=e.message,void(d.handleMultiTrigger&&d.handleMultiTrigger())}var p={aboutme:e.aboutme,attender:e.attenderdetails?e.attenderdetails.attender:"",attender_imagefkey:e.attenderdetails?e.attenderdetails.imagefkey:"",istrigmsg:!0,winid:e.winid||e.time,istrigmsg:!0,pmsg:e.message,triggername:e.sendername};$Support.setTriggerCookie(e),ZSIQConversationManager.init(p,"chattrigger",i)}}},handleBotTriggers:function(e,t,i){var n=$Support.EmbedObj,a=$Support.getParent().$ZSIQUtil.getAPIValues();if($Support.getParent().$ZSIQChatWindow.RemoveLoadingForTrigger(),!$Support.isChatExist()&&(a.triggermsg||!$Support.getTriggerCookie()||t)){$Support.EmbedObj.attender=e.attender,$Support.EmbedObj.attendername=e.dname,delete $Support.waitingtime,delete n.question;e.dname,ZSIQTranscript.getImageURL({sender:e.attender}),e.aboutme;e.options&&(e.options=JSON.parse(e.options));var r={aboutme:e.aboutme,attender:e.attender,attender_imagefkey:e.attender_imagefkey,istrigmsg:!0,isbottrigmsg:!0,isbotchat:!0,winid:e.time,attendername:e.sendername||e.dname,istrigmsg:!0,pmsg:e,triggername:e.dname,triggval:e,repopulate:t};ZSIQConversationManager.init(r,"bottrigger",i)}},populateTriggerWindow:function(e,t,i){var n=$Support.isFAQUIFocussed(),a=-1==ZSIQConversationManager.getcurrchatwinChid();if($Support.isConversationUIFocussed()||n||!a||$UI.setInnerHeader(e),$Support.contentdiv||(t.updateInnerBody(),n&&(t.contentdiv&&t.contentdiv.hide(),ZSIQConversationManager.resetLastViewd())),t.showWaitingUI(),$UI.setFooter(),n)return $Support.incrementUnreadCount(t.winid),$("#conv-tab").removeClass("sel"),void $("#faqtab").addClass("sel");$Support.Util.hideFooter(),$Support.contentdiv="";var r=ZSIQConversationManager.getcurrchatwinChid();a=-1==r||r==t.winid;var o=ZSIQConversationManager.chidbeforereload;a&&(o==t.winid||!o)&&$Support.Util.showMessageAreaUI("","","",t)},populateTriggerUI:function(e){var t={attendername:e.sendername||e.attendername,image_fkey:e.imagefkey||e.attenderimagefkey,aboutme:e.attenderaboutme,isbottrigger:e.isbottrigger,attender:e.attender,isBotchat:e.isBotChat};this.populateTriggerWindow(t,e)},toggleAudio:function(e){var t=ZSIQConversationManager.getcurrchatwinobj(),i=e.hasClass("sqico-mute")?-1:1;if($Support.LSDB.setCookie(t.chatID+"_sound",i),t.setSoundConfig(),this.handleUnmute(t),e.parent()[0]&&"UL"!==e.parent()[0].nodeName?shtml=$UI.getSoundHTML(!0,t.soundval):shtml=$UI.getSoundHTML("",t.soundval),e.replaceWith(shtml),-1==i)EmbedSound.stop();else if($Support.endtimer){var n=0;try{var a=$("#endtimer").text();n=parseInt(a.split(" ")[0])}catch(e){}0<n&&!t.isSoundOff()&&EmbedSound.play("endtimer",n)}},handleUnmute:function(e){if(e){var t=e.soundval;if(isUndefined(t)||-1!=t)e.contentdiv.find('[proptype="moreaction"]').prev("span.sqico-unmute").remove();else{var i=$UI.getSoundHTML(!0,t);e.contentdiv.find('[proptype="moreaction"]').before(i)}}},hideMaskAnim:function(){$Support.maskdiv.addClass("hidemaskanim")},setTextareaHeight:function(e){if(!window.parent.$ZSIQWidget.getWidgetObject().isshowcallbubble){var t=e&&e.contentdiv||$Support.contentdiv;if(t&&$Support.container.hasClass("outerwin")){var i=0;(e&&e.composer||$Support.getComposer()).removeAttr("style"),t.children('div:visible:not("#info_banr")').each(function(){i+=$(this).outerHeight(!0)});var n=t.height();if(n<i)t.find(".msgbox").addClass("posrel");else{var a=$Support.isNewHeader()?15:0;i=n-i-a;var r=e&&e.composer||$("#msgarea");r.css("height",r.innerHeight()+i+"px"),r.height()<70&&r.css("height","70px")}}}},removeDiv:function(e){setTimeout(function(){e.remove()},2e3)},handleCaptcha:function(){},getCaptchaValue:function(){},handleDropEvent:function(e,t,i){if($Support.Util.isDragNotAllowed())LSDebugger.postDebugInfo("Attachement issue debug | isDragNotAllowed retruned true - ongoing chat cookie exist: "+$Support.isChatExist()+"; vwmsid:"+$Support.EmbedObj.vwmsid+"; visitoremail:"+$Support.EmbedObj.visitoremail+";chid:"+e,null,"",!0);else try{t.preventDefault(),LSDragDrop.onDropEvent(e,t,i)}catch(e){}},showPasteUI:function(){var e=PasteImage.getHTML();$("#pstimg-main").remove(),$Support.container.addClass("imgcmt").find("header").after(e),PasteImage.updateDetailes($Support.container)},openPushPage:function(e){$UI.hideBanner(),$Support.pushwinobj=window.open(e)},handleTextareaEnter:function(e,t,i,n,a){var r=$("#chatconsent");if(!$Support.Util.getChatConsentStatus()||1!=r.length||0!=r.is(":checked"))return $Support.toggleSendButton(e),!(13!=t||!i.shiftKey)||(!!a||void((13===t||isUndefined(t))&&this.handleStartChat(n,i)));$Support.Util.removeSendClickAction()},handleCallFdbEnter:function(e,t,i,n,a){if(13==t&&i.shiftKey)return!0;""!==$.trim(e.val())&&(13===t||isUndefined(t))&&$Support.sendFeedback(e,"",!0)},handleStartChat:function(e,t,i,n){$Support.EmbedObj;if(!$Support.Util.isPreview()){var a,r=$Support.container;if(t){var o=$(t.target).closest('section [proptype = "siqform"]');a=(a=o.length?o:$Support.contentdiv)&&a.length?a:$(t.target).closest('section [proptype="contentdiv"]')}i=a&&a.attr("data-id")||i;var s=ZSIQConversationManager.getChatWinObjById(i);if(!a&&(a=s.contentdiv),r.find(".hidemaskanim").remove(),!ZSIQConversationForm.checkContextInitiated()&&r.hasClass("outerwin")&&(!$Support.checkCustomFields()||!this.validateFields(a)))return t&&t.preventDefault(),!1;if(!$Support.isConversationAllowed()&&r.find("#showsiqconv").hide(),ZSIQConversationForm.checkFormContext()&&"leavemsg"!=n)return $Support.updateInputValues(s),void ZSIQConversationManager.init({winid:(new Date).getTime()},"formview");$Support.checkCustomFields(),i?!$.isEmptyObject(s)&&s.hideBanner():$UI.hideBanner(),$Support.updateInputValues(s),"function"==typeof e&&e()}},hidePasteUI:function(){$("#pstimg-main").addClass("hidemaskanim"),$("section.imgcmt").removeClass("imgcmt")},bindUtilEvents:function(){bindDragDropEvents(),handlePaste()},handleDrpdwnEvent:function(e,t,i){if(!$Support.Util.isPreview()){var n=e.find("ul"),a=e.find("li.atsel"),r=n.find("li:first-child");if(13==t){if(a.length)return a.trigger("click"),void i.preventDefault();e.find("a").trigger("click"),i.preventDefault()}a=n.find("li.atsel").removeClass("atsel");if(40==t){if(n.is(":hidden"))return e.find("a").trigger("click"),void i.preventDefault();var o=a.next();a=o.length?o:r,i.preventDefault()}else if(38==t){var s=a.prev();a=s.length?s:n.find("li:last-child"),i.preventDefault()}a.addClass("atsel"),a.length&&n.stop(!0,!0).animate({scrollTop:a[0].offsetTop}),i.stopImmediatePropagation()}},fillApiValues:function(){var e=$Support.EmbedObj,i=e.addinfo||{};getUnescapedText(i.question);i.name=getUnescapedText(e.visitorname),i.phone=e.visitorphone,i.email=e.visitoremail,DynamicMsg.updateValues(i),$Support.container.find("[info]").each(function(){var e=$(this),t=i[e.attr("info")];isUndefined(t)||e.val(t)}),$Support.toggleSendButton();var t=i?i.forcefloatingwindow:null,n=$("body");n.removeClass("siq_mprv"),($Support.Util.isSIQMobilePreview()||(t||$Support.Util.isHandHeldDevice())&&$Support.isFloat()&&window.outerWidth<555)&&(n.addClass("siq_mprv"),$Support.contentdiv.parent().removeClass("siq_mscreen").addClass("siq_mscreen"),this.setTextareaHeight())},handleCustomHTML:function(h){var e=$Support.customobj,v=$Support.EmbedObj.isformremoval;if(e){(!v||ZSIQConversationForm.isOldFormView())&&this.checkAndRemoveCustomField([]);try{$.each(e,function(e,t){t.index=t.index||e;var i=t.name;if(/^_default./.test(i)){var n=i.replace("_default.",""),a=$Support.container.find("[purpose=visitor"+n+"]"),r="true"==t.required||1==t.required,o=t.maxlength,s=t.minlength;if(/^department$/.test(n)&&(a=$Support.container.find("[purpose=department]")).text(getEscapedText(t.hint)),/^question$/.test(n))(a=$Support.container.find("[purpose=question]")).attr("placeholder",getEscapedText(t.hint));else if(t.hint){if(a.length<1)return"";if(r)var d=a.attr("data-validate").replace("optional","required");else d=a.attr("data-validate").replace("required","optional");a.attr("data-validate",d),a.attr("placeholder",getEscapedText(t.hint))}if(o||s){if(a.length<1)return"";o&&a.attr("maxlength",o);var p=a.attr("data-validate");s&&(p=p.concat(" minlimit "+s)),a.attr("data-validate",p)}return""}if(!v||ZSIQConversationForm.isOldFormView()){var c=$($UI.getCustomHTML(t));if(!c.length)return!0;var l=t.before||t.after||"",u=$Support.container.find('[custom = "'+l+'"]');l&&0<u.length?u[t.before?"before":"after"](c):h?c.insertBefore($("#usereditactionbtn")):c.insertBefore("div.msgbox")}if("selectbox"==t.type&&($("#sqico-cdrpdwn"+t.index).dropdown({options:t.options,purpose:"customdrpdwn",defaultval:t.hint||t.name||"Custom"}),t.defaultvalue)){var g=$("#sqico-cdrpdwn"+t.index).find('li[val="'+t.defaultvalue+'"]');g.length&&g.trigger("click")}if(t.errorinfo){var m=$Support.EmbedObj;i=t.name;m.errorinfo[i]=t.errorinfo}}),this.handleCustomVisibility(),this.setTextareaHeight()}catch(e){}}},handleCustomVisibility:function(){var e=$Support.contentdiv||ZSIQConversationManager.getcurrchatwinobj().contentdiv,r=$Support.EmbedObj,t=e.find('[purpose="custom"]'),i=this;$.each(t,function(e,t){var i=$(t),n="undefined"!=i.attr("visibility")?i.attr("visibility"):"both";i.hide();var a=i.prev(".subtitle").hide();"both"==n||r.status&&"online"==n||!r.status&&"offline"==n?(i.show(),a.show()):(i.remove(),a.remove())}),t.find("input[type=radio],input[type=checkbox]").off().on("change",function(){var e=$(this).attr("name");i.handleInputChange(e,t.find("input[name='"+e+"']:checked").map(function(){return this.id}).get())})},removeSendClickAction:function(){$("#sqico-send").removeAttr("documentclick"),$("#action_icons").removeClass("show_send")},getFileURL:function(e,t){var i=new FileReader;i.onload=function(e){t(e.target.result)},i.readAsDataURL(e)},handleDeptChange:function(e,t){var i=!t,n=e.find("span").attr("status"),a=$Support.EmbedObj;if("1"!=n)a.offlinedeptid=e.attr("val"),$Support.Util.UpdateDeptforFormInstance(e.attr("val")),$Support.Util.setHeaderforDeptChange(n),$UI.updateOfflineUI(null,i);else{if(!this.prevstatus||"1"==this.prevstatus)return;$Support.isFAQEnabled()&&$("#msgarea").parent().find("#sqico-send").remove(),$Support.Util.setHeaderforDeptChange(n),$Support.Util.UpdateDeptforFormInstance(e.attr("val")),$UI.updateOnlineUI(null,i),a.question&&($Support.composer=$("#msgarea"),$Support.composer.text(a.question),$Support.toggleSendButton()),this.setTextareaHeight()}this.prevstatus=n},UpdateDeptforFormInstance:function(e){ZSIQConversationForm.isOldFormView()||e&&(ZSIQConversationManager.getcurrchatwinobj().department=e)},setHeaderforDeptChange:function(e){var t=this.prevstatus;t&&t==e||$Support.container.find("#attname").text(getEscapedText($Support.getChatWindowTitle("",e)))},handleResize:function(e){if($Support.Util.calculateContentHeight(e),$Support.Util.setTextareaHeight(e),$Support.Util.calculateTextareaHeight(e),!$Support.isParentIframe()||"embed"===$Support.type){var t=$Support.container,i=$("body").children('#cmpylogo:not(".nologo")'),n=0!=i.length?i.outerHeight():0,a=$Support.container.find("header").outerHeight()+n;t.css("height",$(window).height()-n);var r=e?e.contentdiv:$Support.contentdiv;e?e.chatdiv:$Support.chatdiv;r.css("height",t.find("footer").offset().top-a-8),$Support.chatdiv&&$Support.chatdiv.css("height",r.outerHeight()-(r.find(".usrinpt").outerHeight()+r.find(".chtend").outerHeight(!0))),$Support.Util.setTextareaHeight(e)}},isInValidVisitorName:function(e){return!(e=e||$Support.EmbedObj.visitorname)||e&&(0===e.lastIndexOf("Visitor ",0)||0===e.lastIndexOf("Guest",0))},handleInputChange:function(e,t){var i={val:t,name:e};this.handleCallbacks("custom.field",i)},handleCallbacks:function(e,t){if(e&&t){var i={};i[e]=t,$Support.getParent().$ZSIQWidget.handleCallBacks(i)}},handleGroupIcon:function(e){var t=e.participants;t&&1<getObjectSize(t)&&$UI.addGroupIcon()},IsMandatoryFieldsAvailable:function(){var e=$Support.EmbedObj,t=e.eprops,i=$Support.customobj,n=$Support.Util.isInValidVisitorName()&&this.checkToShowField("isname","siq_name")&&JSON.parse(t.isname[1].ismandatory)||!e.visitoremail&&this.checkToShowField("isemail","siq_email")&&JSON.parse(t.isemail[1].ismandatory)||!e.visitorphone&&this.checkToShowField("isphoneno","siq_phone")&&JSON.parse(t.isphoneno[1].ismandatory),a=!1;try{for(var r=0;r<i.length;r++){var o=i[r];if(""+o.required=="true"&&(!o.visibility||"offline"!=o.visibility))if(/^_default./.test(o.name)){var s=o.name.replace("_default.","");if(/^department$/.test(s))continue;if("name"==s&&this.checkToShowField("isname","siq_name")&&$Support.Util.isInValidVisitorName()){a=!0;break}if("email"==s&&this.checkToShowField("isemail","siq_email")&&!e.visitoremail){a=!0;break}if("phone"==s&&this.checkToShowField("isphoneno","siq_phone")&&!e.visitorphone){a=!0;break}}else if(!e.cinfo||!e.cinfo[o.name]){a=!0;break}}}catch(e){}return n||a},CheckAllDefaultFieldsDisabled:function(){var e=$Support.Util;return e.checkToShowField("isname","siq_name")||e.checkToShowField("isemail","siq_email")||e.checkToShowField("isphoneno","siq_phone")},checkToShowField:function(e,t){var i="clearfield",n=$Support.EmbedObj.eprops,a=$Support.getParent().$ZSIQUtil.getAPIValues()||{},r=!(!a[i]||!a[i].includes(t));return n[e]&&JSON.parse(n[e][0])&&!r},checkAndRemoveCustomField:function(e){var t=$Support.contentdiv;if($.isEmptyObject(e))t&&t.find("div[custombx]").remove();else for(var i=0;i<e.length;i++){var n=e[i];t&&t.find("[customid='"+n+"']").remove(),"object"==typeof $Support.EmbedObj.cinfo&&delete $Support.EmbedObj.cinfo[n]}},isApiWaitHandler:function(e){return isPostMessageSupported()&&$Support.isscript&&$Support.isapiwaitinghandler},setBrowserValues:function(){var e=$Support.getParent().$ZSIQUtil.getReferrer();e=-1!=navigator.userAgent.indexOf("MSIE")||-1!=navigator.userAgent.indexOf("Trident")?window.btoa?window.btoa(e):_ZLDReq.btoa(e):window.btoa(e);var t=$Support.EmbedObj.eparams;t.referrer=e,t.cpage=document.location.href||e,Browser.setReferer(e),Browser.setCurrentPage(t.cpage),Browser.setPageTitle(t.pagetitle)},handleDeptApiChange:function(t,i){if(null!=t&&-1!=t)if($.isArray(t)){$("#sqico-drpdwn").find("li").each(function(){var e=$(this);-1==$.inArray(getEncodedText(e.attr("uniname")),t)&&$(this).hide()});var e=$("#sqico-drpdwn").find("li");e.sort(function(e,t){return i.indexOf($(t).attr("uniname"))<i.indexOf($(e).attr("uniname"))?1:-1}),$("#sqico-drpdwn").find("ul").empty().append(e)}else"online.department"===t&&$Support.EmbedObj.status&&$("#sqico-drpdwn").find("li").each(function(){var e=$(this);$(e).children("span").attr("status")===$Support.DEPT_OFFLINESTATUES&&$(this).hide()})},isCampaignEnabled:function(){try{var e,t=$Support.EmbedObj.integprops.integinfo;if(!t)return!1;for(var i in t){e=$Support.enabledCampaignID=i;break}if(e&&"0"==t[e].status)return!1;var n=t[e].listname;return n&&""!==n}catch(e){return!1}},hideFeedback:function(e){$Support.Util.isPreview()||(e.hideMaskDiv(),$Support.container.find("footer .floatrg").remove(),e.isfeedbacksent=!0,e.isratingsent=!0,$Support.Util.handleFeedbackSubmit(e),e.contentdiv.find('[proptype="sqico-send"]').parent().remove())},displayInfo:function(e){$UI.displayInfo(e)},hideInfo:function(){$UI.hideBanner()},showOfflineBanner:function(){var e=$Support.EmbedObj;if(!$Support.proactive&&!$Support.isChatExist()&&!(e.status&&this.isOnline(e.department)||$Support.getCookieValue("ZLD"+e.livelsid+"OFFLINEBANNER"))){$UI.showBanner($Support.getOfflineMessage(),!0,null,3e3);setTimeout(function(){$Support.LSDB.set("ZLD"+e.livelsid+"OFFLINEBANNER",!0,31e4)})}},showOnlineBanner:function(){var e=$Support.EmbedObj;if(!$Support.proactive&&!$Support.isChatExist()&&((e.status||this.isOnline(e.department))&&!$Support.getCookieValue("ZLD"+e.livelsid+"ONLINEBANNER"))){$UI.showBanner(LSResource.getRealValue("ne.onlinemsg"),!0,null,3e3);setTimeout(function(){$Support.LSDB.set("ZLD"+e.livelsid+"ONLINEBANNER",!0,31e4)})}},isOnline:function(e){if(""+e=="-1")return!0;for(var t=$Support.EmbedObj.deptlist,i=0;i<t.length;i++){var n=t[i];if(n.ID==e)return""+n.STATUS=="true"}},updateParentFontFamily:function(){var e=$Support.getParent().$ZSIQUtil.getWebFontFamily();$Support.font=e,$("body").css("font-family",e)},isSIQMobilePreview:function(){return $Support.Util.isPreview()&&"mobile"==parent._WIDGETPREV_MODE},isPreview:function(){return $Support.getParent().$ZSIQChat.isPreview()},isHandHeldDevice:function(){return!!$Support.Util.isSIQMobilePreview()||!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB10|IEMobile|Opera Mini/i.test(navigator.userAgent)},handleShowConversation:function(a,r){if($Support.isConversationAllowed()||!$Support.Util.checkToShowConversationEmptyPage(!0)){var o="";$Support.Util.updateViewAttribute("msgarea"),0<$Support.convlistcontainer.find("#pastchatconv").find(".siqc_cntbody").length?$Support.Util.showConversationListUI():(0<$Support.convlistcontainer.find("#currchatconv").find(".siqc_cntbody").length&&(o=$($Support.convlistcontainer.find("#currchatconv").find(".siqc_cntbody")[0]).attr("chid"),$Support.Util.showConversationListUI()),$Support.PopulateConversationList(function(e,t){if(e.length){var i="";if(e.forEach(function(e){o!=e.chid&&(e.question=getEscapedText(e.question),i+=$Temp.getConversationHistoryHTML(e),$Support.Util.checkAndRemoveEndedChatinOngoingArray(e.chid))}),t?$Support.convlistcontainer.find("#pastchatconv").prepend($(i)):$Support.convlistcontainer.find("#pastchatconv").append(i),r||!a&&$Support.isChatExist()){var n=$Support.container.find("#showsiqconv");n.find("#siqnoticon").hide(),n.show()}else $Support.Util.showConversationListUI();$Support.Util.calculateContentHeight()}},a))}else $Support.Util.showConversationEmptyPage()},hideConversation:function(){$Support.convlistcontainer&&$Support.convlistcontainer.hide(),$Support.convtranscontainer&&$Support.convtranscontainer.hide(),$Support.container.find("#showsiqchatui").hide()},checkAndFocusComposer:function(){ZSIQConversationForm.isOldFormView()||$("#msgarea").focus()},checkAndRemoveEndedChatinOngoingArray:function(e){var t="conv"+e,i=$Support.convlistcontainer.find("#currchatconv").find("#"+t);"end"==i.attr("status")&&i.remove()},showConvBackArrow:function(e){!ZSIQConversationForm.isOldFormView()&&$Support.isFAQEnabled()&&$Support.isNewHeader()&&!$Support.Util.isPreview()&&($Support.getParent().$ZSIQChatWindow.isChatExist()||ZSIQConversationForm.checkContextInitiated()||$Support.container.find("#showsiqconv").show())},showMessageAreaUI:function(e,t,i,n){var a=i&&i.attr("chid"),r=a?ZSIQConversationManager.getChatWinObjById(a):n||{};this.hideConversation(),this.showConvBackArrow();var o=$Support.EmbedObj,s="showsiqchatui"==e||"faqchtnow"==e||"restartchat"==e;if(s&&"restartchat"!=e&&$Support.deletePrechatVal(),$FAQ.checkandSetHeaderUserClass(),!s||$Support.contentdiv&&0!=$Support.contentdiv.find("[custom=question]").length){o=$Support.EmbedObj;var d=r&&r.visitorID,p=$Support.getCookieValue("ZLD"+o.livelsid),c=p&&p["aboutme_"+d]||r.attenderaboutme||o.lastattenderaboutme,l=p&&p["attname_"+d]||r.attendername||o.lastattendername;!l&&r.istrigmsg&&(l=r.triggername),$Support.Util.updateViewAttribute("msgarea");var u=o.status?"1":"2",g=$Support.getChatWindowTitle(l,u),m=$("body"),h=m.find('[prop="header"]');m.find("#attname").text(g);var v='<div class="txtelips siq-about-me" id="attabtme" title="'+(c=c?CommonUtil.decodeHTML(c):"")+'">'+Smiley.replace(c)+"</div>";m.find("#attabtme").replaceWith(v),m.find("#siqconvchaticon").remove();var f=$Support.getParent().$ZSIQUtil.getAPIValues(),S=JSON.parse(o.eprops.iclogo)?o.clogo:"";f.clogo&&(S=f.clogo);var C=$Support.isUserLogoEnabled("",r)&&r.attenderimagefkey?$Support.Util.getPhotoURL(r.attenderimagefkey,r.attender):"",b=r.istrigmsg&&!r.isBotChat&&!r.attenderimagefkey;S=(S=l&&!b?C:S)||!r.isBotChat&&!r.isBotattendedchat?S:ZSIQTranscript.getImageURL({sender:r.attender}),h.find(".cmplogo").removeAttr("style"),$Support.Util.updateUserImage(S,r),h.find(".cmplogo"),$Support.Util.updateHeaderBotType("",r),$Support.isUserLogoEnabled("",r)&&h.find(".cmplogo").attr("data-chttype","agent");var I=h.find('[prop="clogo"]'),w=l?"sqico-user":"sqico-chat";I.removeClass("sqico-chat sqico-user wincustom_bg").addClass(w),h.removeClass("nologo category siq-usr conv_headview"),S||(h.addClass("nologo"),I.addClass("wincustom_bg")),r.attendername&&!r.isBotChat&&h.addClass("conv_headview"),$Support.Util.reSetHeaderClass();var y=$Support.container.find("#showsiqconv");y.find("#siqnoticon").hide(),$Support.isShowConversationArrow(r)&&y.show(),$.isEmptyObject(r)||-1!=ZSIQConversationManager.getcurrchatwinChid()?$Support.contentdiv&&$.isEmptyObject(ZSIQConversationManager.getcurrchatwinobj())&&($Support.container.addClass("outerwin"),$Support.contentdiv.show(),$Support.container.find("footer").show()):($Support.container.removeClass("outerwin"),r.contentdiv.show(),$Support.contentdiv&&$Support.contentdiv.hide(),-1!=r.chatID&&$Support.Util.hideFooter(),ZSIQConversationManager.updateLastviewed(r.winid,{chatid:r.chatID,chatendmsg:r.chatendmsg})),$Support.removeConversationPopupMessage(),$Support.applyOngoingChatClass("siqc_cntbody",r.convongoingchatobj);var U=$Support.getUnreadCount(r.chatID),E=r.chatmaindiv;if(U&&!$.isEmptyObject(r)){$Support.removeUnreadCookie(r.chatID),$Support.getParent().$ZSIQWidgetUI.removeUnreadCount();var T=y.find(".siqc_prochtcls");0!=T.length&&T.remove(),E.length&&Message.scroll(E[0]),r.composer.focus()}var _=SUPPORT_REPS[r.chatID]||{};Object.keys(_).length;r.convongoingchatobj&&(r.convongoingchatobj.find(".siqc_eletype").html("")[0].className=-1!=r.chatID||r.istrigmsg||ZSIQConversationForm.checkContextInitiated()?"siqc_eletype sqico-chat2":"siqc_eletype"),t&&r.composer.val(t),$Support.isFAQEnabled()&&($("#conv-tab").addClass("sel"),$("#faqtab").removeClass("sel")),$Support.Util.handleResize(r);try{k=ZSIQConversationManager.getChatWinObjById(r.chatID).RCHID;SiqAVRouter.container.detailsHandler.triggerIconCheck(k)}catch(e){}}else{$Support.contentdiv=$($Temp.getBodyHTML()).insertAfter($Support.container.find("header")),$Support.composer=$Support.contentdiv.find("#msgarea"),-1==$Support.EmbedObj.department&&$UI.populateDropDown(),$TH.updateFooter(),ZSIQConversationForm.isOldFormView()&&$Support.handleApiData($Support.getParent().$ZSIQUtil.getAPIValues()),$Support.container.addClass("outerwin"),$Support.contentdiv.show(),ZSIQConversationManager.resetLastViewd(),$Support.isConversationAllowed()&&($Support.removeEndedChatInstanceAndElement(),$Support.container.find("#showsiqconv").click()),$Support.Util.showMessageAreaUI();try{var k=ZSIQConversationManager.getChatWinObjById(r.chatID).RCHID;SiqAVRouter.container.detailsHandler.triggerIconCheck(k)}catch(e){}}},toggleAudioCallIcon:function(e,t){},showConversationListUI:function(){var e=ZSIQConversationManager.getcurrchatwinobj();ZSIQConversationManager.resetLastViewd(),$Support.container.find("footer").show();var t=$Support.convlistcontainer.find("#convwtime");0!=t.length&&t.html(MyDate.timeDifference(t.attr("convmtime"))),$Support.convlistcontainer.find("#pastchatconv").find("[convmtime]").each(function(){var e=$(this),t=e.attr("convmtime");t&&e.html(MyDate.timeDifference(t))}),!$.isEmptyObject(e)&&0<e.contentdiv.find("#edituserdetails").length&&(e.contentdiv.find("#edituserdetails").remove(),$Support.enableTextarea($Support.getComposer())),$Support.convtranscontainer.hide(),$Support.isFAQEnabled()||($Support.container.find("footer").hide(),$Support.Util.checkAndAddFreeLogo($Support.convlistcontainer));var i=$Support.container.find("#showsiqconv");i.find("#siqnoticon").hide(),i.hide(),$Support.Util.updateViewAttribute("convlist");var n=$("body");n.find("#attname").text(LSResource.getRealValue("converation.withus")),n.find("#attabtme").text(""),n.find("#complogo").attr("src","");var a=n.find('[prop="header"]');a.find(".cmplogo").removeAttr("style"),a.addClass("nologo"),a.find(".cmplogo").attr("data-chttype","conv"),a.removeClass("siq-usr").removeClass("conv_headview"),$Support.Util.removeHeaderType(),a.find('[prop="clogo"]').removeClass("sqico-user wincustom_bg").addClass("sqico-chat wincustom_bg "),$Support.convlistcontainer.show(),this.showSiqChatUI(e),$Support.Util.reSetHeaderClass();try{var r=ZSIQConversationManager.getChatWinObjById(e.chatID).RCHID;SiqAVRouter.container.detailsHandler.triggerIconCheck(r)}catch(e){}},showConversationTranscriptUI:function(e,t){var i=-1!==t?t:e,n=ZSIQConversationManager.getChatWinObjById(i);$Support.convlistcontainer.hide(),$Support.isFAQEnabled()||$Support.container.find("footer").hide();var a,r=$Support.getParent().$ZSIQUtil.getAvuid(),o=$Support.LSDB.getFromSession(r+"_conversation"),s="",d="",p="";for(var c in o)if(o.hasOwnProperty(c)){var l=o[c];if(l.visitorid!=e)continue;l.chid||l.attender?l.attender?(s=l.attender,p=l.attender_imgkey?$Support.isUserLogoEnabled(l,n)||l.isbotattender?_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/userimg/"+l.attender_imgkey+"/photo.ls?nocache=1":"":ZSIQTranscript.getImageURL(JSON.parse(l.lastmsg))):s=LSResource.getRealValue("conversation.missedchat"):s=LSResource.getRealValue("conversation.offlinechat"),l.designation&&(d=l.designation),a=l.isbotattender}$Support.Util.isbotconversation=a,$Support.Util.updateViewAttribute("convchat");var u=$("body");u.find("#attname").text(s),u.find("#attabtme").text(d),u.find("#siqconvchaticon").remove(),$Support.Util.updateUserImage(p,n);var g=u.find('[prop="header"]');g.removeClass("nologo").addClass("conv_headview"),g.find(".cmplogo").removeAttr("style");var m=g.find('[prop="clogo"]'),h=s?"sqico-user":"sqico-chat";m.removeClass("sqico-chat sqico-user wincustom_bg").addClass(h),g.find(".cmplogo").attr("data-chttype","agent"),$Support.Util.updateHeaderBotType("",n),p||(g.addClass("siq-usr").addClass("nologo"),m.addClass("wincustom_bg")),this.showSiqChatUI(n),n.contentdiv.show(),ZSIQConversationManager.updateLastviewed(i);var v=$Support.container.find("#showsiqconv"),f=$Support.getUnreadCount(),S=v.find("#siqnoticon");f&&0==S.length&&v.prepend("<em id='siqnoticon' class='siqc_prochtcls' documentclick='showchatui'></em>"),v.find("#siqnoticon").show(),v.show(),$Support.Util.reSetHeaderClass();try{var C=ZSIQConversationManager.getChatWinObjById(n.chatID).RCHID;SiqAVRouter.container.detailsHandler.triggerIconCheck(C)}catch(e){}},showSiqChatUI:function(e){var t=$Support.EmbedObj,i=e&&$Support.isfeedback&&e.isfeedbacksent,n=e&&$Support.israting&&e.isratingsent,a=e&&!$Support.isfeedback&&!e.israting;e&&!$.isEmptyObject(e)?e.contentdiv.hide():$Support.contentdiv&&$Support.contentdiv.hide(),$Support.isFAQEnabled()||$Support.container.find("footer").hide(),t.allow_multiplechat&&(!$Support.isChatExist()||$Support.isChatExist()&&_WMSACK)&&!t.curraddvistid&&!ZSIQConversationForm.checkContextInitiated()?$Support.container.find("#showsiqchatui").show():$Support.isChatExist()||!(i||n||a||!e.lchid||$.isEmptyObject(e)||-1==e.lchid)||e.proactive||$Support.getTriggerCookie()||ZSIQConversationForm.checkContextInitiated()||$Support.container.find("#showsiqchatui").show(),$Support.removeConversationPopupMessage(),$Support.Util.calculateContentHeight()},isAnnonUser:function(e){try{if(-1!=e.indexOf("$"))return!0}catch(e){}return!1},getFileClassType:function(e){var t="";return e?t=-1!=e.indexOf("image")?"sqico-camera":-1!=e.indexOf("audio")?"sqico-audio":-1!=e.indexOf("video")?"sqico-video":"sqico-file-min":t},hexToRGBA:function(e,t){return e+=4==e.length?e.slice(1,4):"","rgba("+parseInt(e.slice(1,3),16)+", "+parseInt(e.slice(3,5),16)+", "+parseInt(e.slice(5,7),16)+", "+(t||1)+")"},handleCompanyLogo:function(e){var t=$("#complogo");t.on("load",function(){t.parent().removeClass("sqico-clogo")}),t.on("error",function(){var e=ZSIQConversationManager.getcurrchatwinobj();$("#blur_userbg").hide().parent().removeClass("hide_fontico"),""!=t.attr("src")&&(t.attr("src",""),$Support.Util.isBotTranscript(e)?t.parents(".cmplogo").addClass("siq_botimg"):t.parent().addClass("sqico-clogo"))})},lastMessageTemplate:function(e){if(e)return'<div class="ziq_msg agntmsg siq-agntmsg fd_lastmsg" data-field="message"><div purpose="name" class="siq-user-name"></div><div class="msgbx"><span class="siq-user-message">'+($Support.EmbedObj.ratingcomplete||LSResource.getRealValue("ne.rating.message")+"<br>"+LSResource.getRealValue("ne.rating.fbmessage"))+"</span>"+(e?'<div class="lstmsg_strs" id="feedback_res" proptype = "feedback_res" documentclick="showChatFeedback"><span class="reaction_ico '+e+'_icon noanim" title="'+LSResource.getRealValue("common."+e)+'" data-prop="rating"></span><div class="reactions">'+$Temp.getStarHTML()+"</div></div>":"")+"</div></div>"},showChatFeedback:function(e){e.addClass("sel")},handleFeedbackSubmit:function(e){var t=e.contentdiv.find('[proptype = "feedback_res"]');if(0==t.length){var i=e.chatdiv;ZSIQTranscript.updateTranscript({html:this.lastMessageTemplate(e.rating)},e.winid),ZSIQTranscript.setMessageClass();var n=i.find(".fd_lastmsg");n.hasClass("single_msg")&&n.find('[purpose="name"]').text(e.attendername),Message.scroll(e.chatmaindiv[0]);var a=t.find(".rating");a.find(".sel").removeClass("sel"),a.find("span:nth-child("+(6-e.rating)+")").addClass("sel")}else t.removeClass("sel").find('[data-prop="rating"]').text(e.rating)},setMessageClass:function(e){var a=$Support.container.find(".ziq_msg:not(.siq_widget)");a.each(function(e){var t=$(this);t.removeClass("single_msg lst_msg");var i=$(a[e-1]),n=$(a[e+1]);!n.length&&!i.length||!n.length&&t.hasClass("agntmsg")&&i.hasClass("vismsg")||!n.length&&t.hasClass("vismsg")&&i.hasClass("agntmsg")||t.hasClass("agntmsg")&&n.hasClass("vismsg")&&i.hasClass("vismsg")||t.hasClass("vismsg")&&n.hasClass("agntmsg")&&(i.hasClass("agntmsg")||!i.length)?t.addClass("single_msg"):(!n.length||t.hasClass("agntmsg")&&n.hasClass("vismsg")||t.hasClass("vismsg")&&n.hasClass("agntmsg"))&&t.addClass("lst_msg")})},getTextColor:function(e){var t=this.getRGB(e);return 186<.299*t[0]+.587*t[1]+.114*t[2]?{text_color:"#444",icon_color:"#ccc"}:{text_color:"#fff"}},getRGB:function(e){return[parseInt(e.slice(1,3),16),parseInt(e.slice(3,5),16),parseInt(e.slice(5,7),16)]},calculateTextareaHeight:function(e){if($Support.container&&!$Support.container.hasClass("outerwin")){var t=!$.isEmptyObject(e),i=$Support.container,n=t?e.contentdiv.find(".msgarea"):i.find(".msgarea");if(n.length){n.removeAttr("style");var a=t?e.contentdiv:i.find(".content"),r=n[0].scrollHeight+2,o=140<(r=r<70?70:r)?{height:"140px",overflow:"auto"}:{height:r+"px",overflow:"hidden"};if(n.css(o),!$Support.isNewHeader()){var s=$("#consentbannerdiv").length?$("#consentbannerdiv").height()+10:0,d=a.height()-a.find(".txtarewrap").height();a.find(".chtcont").css({height:d-s+"px"}),i.find(".dragmask").css({height:d+"px"})}}}},calculateContentHeight:function(e){if(!$Support.isNewHeader()){var t=$Support.container,i=2*parseInt(t.css("border-left-width")),n=t.outerHeight()-(t.find("header").outerHeight()+t.find("footer").outerHeight()+i);t.find(".siq_content").css({height:n}),t.find('[ctype="hstrycntnt"]').css({height:n})}},getImagePreviewHTML:function(e){var t=e.user_photo||CommonUtil.getStaticURL("/salesiq/images/user/user_160-160_8265b0d9db45b8cd081ef20d712e559a_.png");return'<div class="zsiq_prv_main zsiq_imgprv" id="zsiqimagepreview" zsiqclose="true" docclick = "zsiqclose"><img src="'+e.url+'" zprv-prop="image" zsiqclose="true" /><div><img src="'+t+'" zprv-prop="userimage" /><div class="zsiq_prv_cmtmain"><p zprv-prop="userneme">'+getEncodedText(e.user)+'</p><div zprv-prop="comment">'+getEncodedText(e.comment)+"</div></div>"+(e.durl?'<a href="'+e.durl+'" zprv-prop="download"><em class="zsiq_fsize">'+e.size+'</em><em class="siqico-download"></em></a>':"")+'</div><em class="siqico-close" zsiqclose="true" docclick="zsiqclose"></em></div>'},showImagePreview:function(e){var t=e.parents('[data-field="message"]'),i=t.hasClass("vismsg"),n=t.find("img").attr("src");if(n){var a=t.find("code").text(),r=t.find(".fdload").attr("href"),o=i?"":$Support.container.find("header img").attr("src"),s=$Support.EmbedObj,d=$("#attname").text();i&&(d=ZSIQTranscript.isInValidVisitorName(s.visitorname)?LSResource.getRealValue("common.you"):s.visitorname);var p={url:n,comment:a,durl:r,user:d,user_photo:o,size:t.find("[data-filesize]").attr("data-filesize")},c=this.getImagePreviewHTML(p);$(window.parent.document).find("body").append(c),$Support.getParent().$ZSIQUtil.bindEventsForImgPreview()}},handleUpdateBTN:function(e){var t=$("#continue_btn"),i="true"==t.attr("data_isupdate"),n=i?"ne.update":"common.continue";e&&(n=i?"common.updating":"common.continuing"),t.text(LSResource.getRealValue(n))},handleAccordian:function(n){var a=$('[data-type="accordian-item"]').hide();$('[data-type="accordian-header"]').click(function(){var e=$(this),t=a.filter(":visible"),i=e.prev();if($('[data-type="accordian-header"]').find(".sqico-uarrow").removeClass("sqico-uarrow"),t.animate({height:"toggle",opacity:"toggle"},"500"),t[0]!=i[0])return"function"==typeof n&&n(e),e.find(".sqico-darrow").addClass("sqico-uarrow"),i.animate({height:"toggle",opacity:"toggle"},"500"),!1})},handleOnlineStatus:function(e,t){var i=$Support,n=i.EmbedObj,a=i.contentdiv;ZSIQConversationForm.checkContextInitiated()&&ZSIQConversationManager.getcurrchatwinobj().contentdiv&&(a=ZSIQConversationManager.getcurrchatwinobj().contentdiv),a||($UI.init(e),a=i.contentdiv),t&&!$Support.isOnlineChat()&&$UI.showBanner(LSResource.getRealValue("ne.onlinemsg"),!0,null);var r=a.find("#msgarea");r.attr("dockeyup","textarea").val(null!=n.question?n.question:$("#msgarea").val()).parents(".msgbox").removeClass("posrel"),r.attr("dockeydown","textarea").attr("placeholder",LSResource.getRealValue("ne.message.hitenter")),$Support.isFAQEnabled()||$("footer").find(".floatrg").remove().end().append($Temp.getSendBtnHTML(LSResource.getRealValue("common.startchat"))),""!=r.val()&&$("footer").find("em#sqico-send").attr("documentclick","textarea"),i.Util.setTextareaHeight();var o=$Support.getParent().$ZSIQWidget.getWidgetObject();o.status=!0,o.onlysticker=!0,$Support.getParent().$ZSIQWidgetUI.drawWidget(o)},updateViewAttribute:function(e){$Support.isBotChat||$Support.isBotattendedchat;$("body").find('[prop="header"]').find(".cmplogo").attr("data-chttype","conv"),$Support.container.attr("cwview",e),"2"===$Support.container.attr("themeid")&&$("body").attr("cwview",e)},getFAQLabel:function(){var e="";if($Support.isFAQEnabled()&&(e=LSResource.getRealValue("faq.header.title"),$Support.EmbedObj.faqaccess)){var t=$Support.EmbedObj.faqaccess[1].label;""!==t&&(e=t)}return e},getChatConsentStatus:function(){var e=$Support.getParent().$ZSIQChat.getWidgetData().widgetobj,t=$Support.EmbedObj.pprops,i=$Support.LSDB.getFromSession(_SCREENNAME+"_gdpr_chatconsent");return!(!(1==e.isgdprenabled)||!JSON.parse(t.isgdprenabled)||1!=JSON.parse(t.chatprivacyconfig)||i)},getConversationSelect:function(e){for(var t="",i=e.options,n=e.type,a=0;a<i.length;a++){var r=i[a],o=r.text||r.value;t+='<span class="choose mB10" purpose="custom" val="'+o+'" prop="'+n+'" documentclick="chooseField">'+o+"</span>"}return'<div class="ziq_msg agntmsg siq-agntmsg single_msg"><div id="sel_msg" isrequired="'+e.required+'" class="sel_msg font14" data-type="type"></div><div class="options textL" id="conversationoption" data-type="'+e.type+'">'+t+"</div></div>"},chooseField:function(e,t){var i=$(t.target).attr("val"),n=$Support.EmbedObj,a=n.chatID;Message.animate(e.parents(".ziq_msg"),!0,function(e){if(e.remove(),-1==n.department||$Support.Util.IsMandatoryFieldsAvailable())return $Support.getComposer().val(i),$Support.EmbedObj.question=i,$Support.disableTextarea(),$UI.showUserEditUI(),void $Support.container.find('[documentclick="updateuserdetails"]').attr("callback","trigger");!$Support.isbottrigmsg||a&&"-1"!=a?Message.send(a,i):($Support.EmbedObj.question=i,ZSIQTranscript.updateTranscript({html:ZSIQTranscript.getTranscript({msg:i,sender:$Support.EmbedObj.vwmsid}),ispopulate:!0}),$Support.handleBotTriggerReply(i))})},getOfflineAPIConsent:function(e){var t=$Support.getParent().$ZSIQUtil.getAPIValues();if(t.textbannerobj&&t.textbannerobj.offline){var i=t.textbannerobj.offline;if(e=i.description&&0!=i.description.trim().length?i.description:e,i.policytextandlink){var n=i.policytextandlink,a=n.text&&0!=n.text.trim().length?n.text:"",r=n.link&&0!=n.link.trim().length&&$Support.getParent().$ZSIQUtil.isValidURL(n.link)?n.link:"";e=$Support.getParent().$ZSIQUtil.hyperLinksSubString(e,a,r)}}return e},getTypingHTML:function(){return'<div class="type-loadr textC"><span></span><span></span><span></span></div>'},setDStorageIframe:function(){var e=document.createElement("iframe"),t=_SCHEMA+"://"+_EMBEDSERVERURL+"/setdstorage.ls";e.id="dstorageframe",e.src=t,e.style.display="none",$Support.container.append(e)},isDragNotAllowed:function(){return!CommonUtil.isAllowFileSharing()||$Support.waitingtime||!$Support.isChatExist()},updateHeader:function(e){if(e){var t=e.dname||e.attendername;t=getEscapedText(t||"");var i=getEscapedText(e.aboutme||""),n='<div class="txtelips siq-about-me" id="attabtme" title="'+i+'">'+Smiley.replace(i)+"</div>";$("#attname").html(t),$("#attabtme").replaceWith(n)}},reSetHeaderClass:function(){$Support.container.find("header").removeClass("min_header").removeAttr("style"),$("#header_style").remove()},checkWindowVisibility:function(){if(parent.$ZSIQUtil.getCookieValue("dragpos")){var e=$(window.parent.document).find("body"),t=e.find(".siqembed"),i=t.offset();(i.left+t.width()>e.width()||i.top+t.height()>e.height())&&(t.css({left:"auto",right:"15px",top:"auto",bottom:"15px"}),parent.$ZSIQUtil.storeCookieVal("dragpos","",!0))}},toggleFreeLogo:function(){var e=$("#msgbox_main").find(".flogo");$("#typgstatus").text()?e.fadeOut(250):e.fadeIn(250)},checkAndAddFreeLogo:function(e){$Support.isNewHeader()&&(e.find("#siqfreelogo").remove(),e.append($Temp.getFreeLogoHTML()))},removeHeaderType:function(){$Support.container.find("header").removeAttr("header-type").find(".cmplogo").removeClass("siq_botimg")},updateHeaderBotType:function(e,t){$Support.Util.removeHeaderType(),$Support.Util.isBotTranscript(t)&&$Support.container.find("header").attr("header-type","bot")},isMessageDIVScrolled:function(e){var t=e&&e[0]||$("#msgmaindiv")[0],i=$(t).find(".ziq_msg").last()[0];if(!i||!t)return!1;var n=i.getBoundingClientRect(),a=!1;if($Support.EmbedObj&&$Support.EmbedObj.uxclientconf){var r=t.getBoundingClientRect(),o=$(t).find("#agenttransfer").outerHeight(),s=n.height+o,d=s-r.height;a=0<d&&s==d+r.height}return!(0<=n.top&&(n.bottom<=(window.innerHeight||document.documentElement.clientHeight)||a))},handleUnReadChatUI:function(e,t){if(t=t||$("#msgmaindiv"),$Support.Util.isMessageDIVScrolled(t)){var i=$("#unreadarrow");if(ZSIQTranscript.isLocalUser(e.sender)||!i.length&&e.istyping)$Support.Util.handleUnReadScroll();else if(i.length){var n=i.find("em");n.text(parseInt(n.text())+(e.istyping?0:1))}else{t.next('[proptype="msgbox_main"]').append('<div id="unreadarrow" class="unread_arrow sqico-larrow" documentclick="unreadscroll"><em>1</em></div>')}}},handleUnReadScroll:function(){$("#unreadarrow").remove(),ZSIQTranscript.scroll(200),$Support.sendReadCall()},handleMessageDIVScroll:function(){$("#unreadarrow").length&&!$Support.Util.isMessageDIVScrolled()&&$Support.Util.handleUnReadScroll()},checkAndRemoveUnreadDIV:function(){var e=$("#unreadarrow");if(e.length){var t=$("#msgmaindiv"),i=t[0];t.scrollTop()>i.scrollHeight-i.clientHeight-20&&(e.remove(),$Support.sendReadCall())}},isBotTranscript:function(e){var t=(e=e||{}).attender,i=$Support.getBotUser(e.department),n=$Support.container.attr("cwview");if(("msgarea"==n||"convchat"==n)&&t&&i&&-1!=i.indexOf(t))return!0;var a=$Support.isConversationUIFocussed();return a&&$Support.Util.isbotconversation||!a&&e.isBotChat},checkToShowConversationEmptyPage:function(e){var t=!e&&$Support.getConversationData(),i=ZSIQConversationForm.isOldFormView(),n=$Support.getParent().$ZSIQChatWindow.isChatExist();return!(!$Support.isNewHeader()||t||n||i)},showConversationEmptyPage:function(e){if($Support.convongoingchatobj||ZSIQConversationForm.checkContextInitiated()){(e?"conv-tab"==e.attr("id"):"")&&$Support.Util.showMessageAreaUI()}else{$Support.Util.removeFormEmptyBg();var t=$Support.convlistcontainer;t.append($Temp.conversationEmptyState()),t.addClass("emptybg"),$Support.Util.showConversationListUI(),$("#msgarea").focus(),$("#showsiqchatui").hide()}},handleBlurImage:function(e){if($Support.isNewHeader()){var t=$(e),i=t.parent(),n=i.find("canvas")[0]||i.append('<canvas width="100%" height="100%" id="blur_userbg" class="blur_userbg"></canvas>').find("canvas")[0],a=i.height(),r=i.width();n.height=a,n.width=r,n.getContext("2d").drawImage(e,0,0,a,r),$(n).show(),i.addClass("hide_fontico"),t.parents("header").removeClass("nologo")}},removeFormEmptyBg:function(){var e=$Support.convlistcontainer;e&&(e.find("#emptybg").remove(),e.removeClass("emptybg"))},hideFooter:function(){$Support.isNewHeader()&&$Support.container.find("footer").hide()},handleAbusiveDetectionMsgObj:function(e,t){var i=e.meta&&e.meta.meta_type,n=e.sender;return!t&&"content_moderation_close"!=i&&"content_moderation_warning"!=i&&"content_moderation_block"!=i||n!=$Support.EmbedObj.vwmsid&&"null"!=n||(e.sender="-1",e.nname=e.dname=LSResource.getRealValue("abusive.msg.sender")),e},sanitizeMessage:function(e){return"string"==typeof e&&$Support.EmbedObj&&$Support.EmbedObj.xssdetectioneabled?getEscapedText(e):e},checkToShowReopenButton:function(){var e=$Support.EmbedObj;return!!e.isreopenenabled&&(!!e.allow_multiplechat||!ZSIQConversationManager.getConnectedCount())},checkAndHideReopenMaskDiv:function(e){$Support.EmbedObj.allow_multiplechat||ZSIQConversationManager.getConnectedCount()&&(e.hideReopenMaskDiv(),e.chatendmsg.remove(),delete e.chatendmsg)},resetFormFieldValue:function(){var e=$Support.EmbedObj.eprops;e.isname={0:"false",1:{ismandatory:"false"}},e.isemail={0:"false",1:{ismandatory:"false"}},e.isphoneno={0:"false",1:{ismandatory:"false"}}}};Gator(document).on("click","[documentclick]",function(r){try{var s=$(this);({sendCallRating:function(){if(!$Support.Util.isPreview()){$(".sqico-star").removeClass("sel"),s.addClass("sel");try{var e=SiqAVRouter.chatwinobj;e.composer.focus()}catch(e){}this.feedbacksent||$Support.setRating(s,e)}},sendCallFb:function(){$Support.sendFeedback(s.parent().find("#fdbkarea"),"",!0)},moreaction:function(){$Support.Util.showMoreAction(s,r)},sendmail:function(){$UI.populateSendMail(s,r)},smiley:function(){$UI.populateSmiley(s)},userdetails:function(){var e=s.closest("section [data-id]").attr("data-id"),t=ZSIQConversationManager.getcurrchatwinobj(e);MessageOperation.removeMessagoprPopups(),t.showUserEditUI(!0,!0)},hideuserdetails:function(){ZSIQConversationManager.getcurrchatwinobj().hideUserEditUI(),$Support.hideBotEditUICB(),$Support.checkAndPopulateLastMessage()},reopenchat:function(){var e=s.parent().prev().find("#reopenmsgarea");$Support.handleReopenWaitingUI(e)},hidemaskdiv:function(){ZSIQConversationManager.getcurrchatwinobj().hideReopenMaskDiv()},updateuserdetails:function(){$Support.checkAndUpdateInfo(s)},triggermsg:function(){$Support.startTriggerChat(s)},min_iframe:function(){$Support.Util.minimizeEmbed()},max_iframe:function(){$Support.Util.maximizeEmbed()},close_iframe:function(){$Support.Util.closeEmbed("",s)},chatend:function(){var e=ZSIQConversationManager.getcurrchatwinobj();avUIhandler.container.detailsHandler.handleEndSession(e.RCHID,function(){var e=ZSIQConversationManager.getcurrchatwinobj();$Support.quitChat(e)})},triggermail:function(){$Support.sendMail(s)},triggermailconfirm:function(){$Support.sendMailConfirm(s)},updatetranslatecookie:function(){$Support.updateTranslateCookie()},rating:function(){$Support.Util.handleRating(s)},showChatFeedback:function(){$Support.Util.showChatFeedback(s)},resetbotflow:function(){$BotImpl.handleBotflowCommand({chatobj:ZSIQConversationManager.getcurrchatwinobj(),command:s.attr("command")})},printfile:function(){$Support.printPreview()},toggleaudio:function(){$Support.Util.toggleAudio(s)},captcha:function(){$Support.Util.handleCaptcha()},restartchat:function(){$Support.restartchat()},showreopenchatui:function(){var e=s.closest("section [data-id]").attr("data-id");ZSIQConversationManager.getChatWinObjById(e).reOpenChatUI()},imgupload:function(){PasteImage.uploadImage($Support.container)},imgcancel:function(){$Support.Util.hidePasteUI()},accepturl:function(){$Support.Util.openPushPage(s.attr("url"))},sendmessage:function(){$Support.triggerSendMessage(s)},textarea:function(){$Support.Util.handleStartChat(function(){$Support.startChat(s)},r)},missedleavemsg:function(){$Support.Util.handleStartChat(function(){$Support.missedLeaveMsg(s)},r,"","leavemsg")},leavemessage:function(){$Support.Util.handleStartChat(function(){$Support.handleLeaveMessage()},r)},feedback:function(){$Support.sendFeedback(s)},hideprogress:function(){$UI.hideUploadProgress(s.attr("msgid"))},hidefeedback:function(){var e=s.attr("chatid")||s.closest("section [fdbkarea-id]").attr("fdbkarea-id"),t=ZSIQConversationManager.getChatWinObjById(e);$Support.Util.hideFeedback(t)},openmeeting:function(){$Support.handleMeetingJoinCB()},sharedesktop:function(){$Support.shareDesktop(s)},sharescreen:function(){},resendmsg:function(){LSMessanger.resendMessages(RESEND_MANUAL)},showconvlist:function(){var e=r.target;if($Support.Util.removeFormEmptyBg(),$(e).parents("header").hasClass("category"))$FAQ.showFAQUI(s);else if("siqnoticon"!=e.id){var t=r.hasOwnProperty("originalEvent");$Support.Util.handleShowConversation(t)}},showchatui:function(){if(!$Support.Util.isPreview()){if("convpopupmsg"===s.attr("id")){var e=ZSIQConversationManager.getcurrchatwinobj();$.isEmptyObject(e)?$Support.contentdiv&&$Support.contentdiv.hide():e.contentdiv.hide(),ZSIQConversationManager.resetLastViewd()}$Support.Util.removeFormEmptyBg();var t=r.target.id||$(r.target).attr("proptype");"removeconvpopup"==r.target.id||$(r.target).is("a")||($Support.Util.showMessageAreaUI(t,"",s),$Support.Util.checkAndFocusComposer(),avUIhandler&&avUIhandler.container.detailsHandler.triggerIconCheck(ZSIQConversationManager.getcurrchatwinobj().RCHID),$Support.sendReadCall())}},fetchconvtranscript:function(){if("showsiqchatui"!=r.target.id){var e=s.attr("chid"),t="chid";e||(e=s.attr("visitorid"),t="visitorid");var n=ZSIQConversationManager.getChatWinObjById(e),o=$Support.getParent().$ZSIQUtil.getAvuid(),a=$Support.LSDB.getFromSession(o+"_conversation"),i=getMatchedObjFromArray(a,t,e);i={vid:(i=i.length?i[0]:"").visitorid,attender:i.attenderid,attendername:i.attender,ques:i.question,name:i.name,did:i.department,cid:i.chid,imagefkey:i.attender_imgkey,rchid:i.wms_chat_ids,chatintime:(new Date).getTime()},$.isEmptyObject(n)?ZSIQConversationManager.init(i,"pastconv"):(n.chatID=i.cid||-1,n.visitorID=i.vid||-1,n.getConversationChatTranscript(),$Support.Util.checkAndHideReopenMaskDiv(n))}},removeconvpopupmsg:function(){$Support.removeConversationPopupMessage()},toggleMadatoryField:function(){$CWPreview.toggleMadatoryField(s)},triggerDeleteEMField:function(){$CWPreview.triggerDeleteEMField(s)},newsletter:function(){$Support.handleNewsLetter()},transferchat:function(){$Support.transferChat("",s.parents(".siq_content").attr("data-id"))},removetransfer:function(){var e=ZSIQConversationManager.getChatWinObjById(s.closest("section [data-id]").attr("data-id"));$UI.removeTransferDiv(s,e),$Support.storeHideTransfer(e.chatID)},transfermissed:function(){$Support.handleTransferMissed(s)},hidetransferoption:function(){$Support.hideTransferOption(),$Support.storeHideTransfer()},audiocall:function(){var e=ZSIQConversationManager.getcurrchatwinobj(),t=e.chatID,n=SiqAVRouter.container.audioImpl,o=SiqAVRouter.container.detailsHandler;if("-1"==t)return n.clearOngoingCallDataOnFailure(),void o.hideAudioCall();if(!$(r.target).hasClass("cmn_disable")){t&&e.attender||(LSDebugger.pushDebugInfo(e),LSDebugger.postDebugInfo("siqMedia: audio call | visitor start param failed | chat exists: "+$Support.isChatExist(),null,"",!0));var a={chatid:t,mediarequest:!0,mediainvitation:!0,wmsid:$Support.EmbedObj.vwmsid,lsuid:e.attender,lsid:$Support.getParent().$ZSIQWidget.getWidgetObject().lsid,session_id:o.getSessionID(),type:"audio",mode:"visitor"};n.startAudioCall(a)}},imagepreview:function(){$Support.Util.showImagePreview(s)},showfaq:function(){$FAQ.showFAQUI(s)},faqcategory:function(){$FAQ.showCategory(s),r.stopPropagation()},faqsearch:function(){$FAQ.handleSearch(s)},openmapfromimage:function(){ZMaps.openMapsFromImage(r)},showconversation:function(){$Support.Util.isPreview()||$Support.showConversation(s)},faqpreview:function(){$FAQ.showFAQPreview(s)},extendview:function(){$FAQ.showAllArticlesInCategory(s)},validateConversation:function(){$Support.Util.chooseField(s,r)},unreadscroll:function(){$Support.Util.handleUnReadScroll()},validateConversation:function(){ZSIQConversationForm.validateConversation(s)},getChatUserConsent:function(){var e=s.attr("isproactive");e=e&&JSON.parse(e),$Support.getChatUserConsent(s.attr("type"),s.attr("skipregister"),e,s.attr("winid"))},downloadvcard:function(){ZSIQContactCard.downloadVCard(s)},sharemyscreen:function(){ZSIQMedia.shareMyScreen(s)},handleCta:function(){$Support.handleWidgetCustomAction(s.attr("data-val"),{name:s.attr("name")})},leaveMsgForQueue:function(){ZSIQConversationManager.getChatWinObjById(s.attr("chatid")).handleLeavemsgforQueue()},voicenote:function(){if(!$(r.target).attr("disabled")){var e=ZSIQConversationManager.getcurrchatwinobj().RCHID;window.currentRecorder&&!window.currentRecorder.isVoiceNote()&&window.currentRecorder.destroy(),Recorder().init(!1,e,"",!0)}},forwardcategory:function(){$FAQ.forwardCategoryNavigation(s)},backwardcategory:function(){$FAQ.backwardCategoryNavigation(s)},scrolltomsg:function(){MessageOperation.navigateRepliedMessage(s)},editmsg:function(){MessageOperation.editMessage(s)},closemsgactionpopup:function(){MessageOperation.closeMsgActionPopup()},closereplypopup:function(){MessageOperation.removeReplymsgdiv()},sendeditmsg:function(){MessageOperation.sendeditmsg(s)},smileyedit:function(){Smiley.showSmileyList("","",s.parents('[proptype="msgeditor"]').find('[proptype="editorarea"]'))},deletemsg:function(){MessageOperation.deleteMessage(s)},senddeletemsg:function(){MessageOperation.senddeletemsg(s)},showmsgactions:function(){MessageOperation.showmsgactions(s)},replymsg:function(){MessageOperation.replyMessage(s)}})[s.attr("documentclick")]()}catch(e){}});var isComposing=!1,hasCompositionJustEnded=!1,brow_lang=$Support.getParent().$ZSIQUtil.getBrowserLanguage();Gator(document).on("keydown","[dockeydown]",function(e){var t=$(this),n=t.attr("dockeydown"),o=$Support.Util.getKeyCode(e);if(229==o&&hasCompositionJustEnded)return!1;hasCompositionJustEnded=!1,27==o&&$Clickoutside.handleEscape(e),{textarea:function(){$Support.Util.handleKeyDown(t,o,e)},captcha:function(){13==o&&($Support.addVisitor(),e.preventDefault())},pasteimage:function(){27==o&&($Support.Util.hidePasteUI(),e.preventDefault())},dropdown:function(){$Support.Util.handleDrpdwnEvent(t,o,e)},triggermail:function(){$Support.Util.sendMail(e,t)},removeError:function(){t.removeClass("errfield")},searchfaq:function(){27==o&&t.parent().find(".sqico-close").trigger("click")}}[n]()}).on("compositionstart",function(e){var t=$(e.target);isComposing=!0,t.attr("dockeyup")&&$Support.toggleSendButton(t)}).on("compositionend",function(e){hasCompositionJustEnded=!(isComposing=!1)}).on("compositionupdate",function(e){var t=$(e.target);t.attr("dockeyup")&&$Support.toggleSendButton(t)}),$(document).on("keyup","[dockeyup]",function(e){var t=$Support.Util.getKeyCode(e);if(!isComposing&&!hasCompositionJustEnded||(hasCompositionJustEnded=!1,"13"!=t)){var n=$(this);({textarea:function(){$Support.Util.handleTextareaEnter(n,t,e,function(){$Support.startChat(n)})},sendmessage:function(){$Support.handleSendMessage(n,t,e)},sendeditmsg:function(){$Support.handleSendMessage(n,t,e,function(){MessageOperation.sendeditmsg(n)},function(){MessageOperation.handleEditMessage(n)})},reopenchat:function(){$Support.handleReopenWaitingUI(n,t)},leavemessage:function(){$Support.Util.handleTextareaEnter(n,t,e,function(){$Support.handleLeaveMessage(n)},!0)},triggermsg:function(){$Support.handleTriggerMsg(n,t,e)},missedleavemsg:function(){$Support.Util.handleTextareaEnter(n,t,e,function(){$Support.missedLeaveMsg(n)},!0)},feedback:function(){CallImpl.isCallWithChat?$Support.Util.handleCallFdbEnter(n,t,e):$Support.Util.handleFeedback(n,t,e)},triggermail:function(){$Support.Util.handleSendMail(n,t,e)},handlepasteimage:function(){PasteImage.handlepasteimage(n)},searchfaq:function(){$FAQ.searchFAQ(n,e)},validateConversation:function(){ZSIQConversationForm.validateConversation(n,e)}})[n.attr("dockeyup")]()}}),$(document).mousedown($Support.Util.triggerAdditionalFileDownload),Gator(document).on("blur","[docblur]",function(e){var t=$(this);({email:function(){ZSIQConversationForm.isOldFormView()?$Support.Util.validateFields(t.parent()):$Support.Util.isFormsUI()&&ZSIQConversationForm.checkInputVal(t)},custominput:function(){if(ZSIQConversationForm.isOldFormView())return $Support.Util.validateFields(t.parent()),void $Support.Util.handleInputChange(t.attr("id"),t.val());ZSIQConversationForm.checkInputVal(t)},required:function(){$Support.Util.validateFields(t.parent())},checkInputVal:function(){ZSIQConversationForm.checkInputVal(t)}})[t.attr("docblur")]()}),Gator(document).on("keydown",function(e){27==$Support.Util.getKeyCode(e)&&($Clickoutside.handleEscape(e),CommonUtil.handleEscape(e))}),Gator(document).on("keyup",function(e){var t=$(e.target);t.filter("[data-validate*='required']").length&&(""===$.trim(t.val())?t.next().addClass("req"):t.next().removeClass("req"))}),Gator(document).on("focusin",function(e){KeyHandler.winfocus=!0,$Support.iswindowfocused=!0,Message.stopBlinking()}),Gator(document).on("focusout",function(e){KeyHandler.winfocus=!1,$Support.iswindowfocused=!1});var wheel=void 0!==window.onwheel?"wheel":"mousewheel";function bindDragDropEvents(){CommonUtil.isAllowFileSharing()&&($Support.isNewHeader()&&jQuery.event.addProp?jQuery.event.addProp("dataTransfer"):jQuery.event.props.push("dataTransfer"),$Support.container.on({dragover:function(e){"slider"!==e.srcElement.getAttribute("data-type")&&(e.preventDefault(),$UI.showDragDropUI())},drop:function(e){e.preventDefault();var t=ZSIQConversationManager.getcurrchatwinobj(),n=t.chatID;-1!=n&&n&&"pastconv"!=t.chatstatus&&$Support.Util.handleDropEvent(n,e),$UI.hideDragDrop()},dragleave:function(e){$UI.hideDragDrop()}}))}function handlePaste(){CommonUtil.isAllowPasteImage()&&$("#msgarea").on("paste",function(e){PasteImage.onPaste(e,this),e.stopImmediatePropagation()})}function handleDrag(){if(!$Support.isMobileWidth()){var t=$("header"),n=0,o=0,a=0,i=0;t.on("mousedown.drag",function(e){"INPUT"!==e.target.tagName&&(a=e.pageX,i=e.pageY,t.on("mousemove.drag",function(e){n=e.pageX,o=e.pageY,parent.$ZSIQChatWindow.handleDrag(a-n+"#"+(i-o)),e.stopImmediatePropagation()}),e.preventDefault(),t.on("mouseup.drag",function(e){r(e)}).on("mouseleave.drag",function(e){r(e)}))})}function r(e){parent.$ZSIQChatWindow.cacheChatDivPosition(),t.off("mousemove.drag mouseleave.drag"),e.stopImmediatePropagation()}}Gator(document).on(wheel,"[docwheel]",function(e){var t=$(this);({handlescroll:function(){try{scrollHandler.init(t,e),CommonUtil.debounce(function(){MessageOperation.handleMsgDivScroll(t)},500)()}catch(e){}},removeUnread:function(){$Support.Util.checkAndRemoveUnreadDIV()}})[t.attr("docwheel")]()}),$(window).resize(function(){$Support.Util.handleResize(),$Support.Util.checkWindowVisibility()}),Gator(document).on("keypress","[onenter]",function(e){if("13"==(e.keyCode?e.keyCode:e.which)){var t=$(this);({updateuserdetails:function(){$Support.checkAndUpdateInfo(t.parents(".editfields").find('[documentclick="updateuserdetails"]'))}})[t.attr("onenter")]()}}),KeyHandler={isWindowFocused:function(){return KeyHandler.winfocus}},$(document).on("change","[docchange]",function(e){var t=this;({attachment:function(){$Support.EmbedObj.messagereply_allowed?ZSIQFileUpload.handleFileUpload(t,e):$Support.Util.submitFile(t,e)}})[$(t).attr("docchange")]()}),$(document).on("focus","[docfocus]",function(e){var t=$(this);({inputFocus:function(){t.parent().addClass("sel")}})[t.attr("docfocus")]()}),$(document).on("animationend","[docanimationend]",function(e){var t=$(this),n=t.attr("docanimationend"),o={handleMsgAnimationEnd:function(){t.removeClass("replymsge_anim")}};o[n]&&o[n]()}),Gator(document).on("dblclick","[ondblclick]",function(e){var t=$(this),n=t.attr("ondblclick"),o=$(e.target),a={replymsg:function(){"message"==o.attr("data-field")&&MessageOperation.replyMessage(t,!0)}};a[n]&&a[n]()});$ThemeHandler={},$ThemeHandler.theme={updateContainer:function(){$(".siqembed").remove();var e=$("body");e.append($Temp.getCloseWindowHTML()).append($Support.container=$($Temp.getContainerHTML())),$Support.isSeasonalTheme()&&e.addClass("zsiq_seasonal")},updateHeader:function(e){var t=$Support.container.find("header");t.length&&t.remove(),$Support.container.prepend($Temp.getHeaderHTML(e)),handleDrag(),$("#zsiq_customcss").remove(),$("body").append(this.getCustomColor()),$Support.Util.handleCompanyLogo(e)},updateInnerHeader:function(e){var t=$Support.container.find("header");$Support.container.removeClass("outerwin"),t.length?this.animateHeader(e):this.updateHeader(e)},updateBody:function(e,t){$Support.container.append($Support.contentdiv=$($Temp.getBodyHTML(e,t))).append($Support.convlistcontainer=$($Temp.getConversationContainerHTML())).append($Support.convtranscontainer=$($Temp.getConversationTranscriptContainerHTML())),$Support.bindScrollForConversationListContainer(),$Support.chatdiv=$("#msgdiv"),$Support.chatmaindiv=$("#msgmaindiv"),$Support.composer=$("#msgarea")},updateFooter:function(){$Support.container.find("footer").remove().end().append($Temp.getFooterHTML()),!$Support.isConversationUIFocussed()&&$.isEmptyObject(ZSIQConversationManager.getcurrchatwinobj())||$Support.isFAQEnabled()||$Support.container.find("footer").hide(),$Support.container.find("#showsiqchatui").remove().end().append($Temp.getConversationCreateChatIConHTML()),this.populateSendBtn(),$Support.Util.handleResize(),$Support.Util.isCampaignEnabled()&&($Support.subscribe=!1,$("#newsletter").on("change",function(){$Support.subscribe=$(this).is(":checked")}));var e=$("#chatconsent");$Support.Util.getChatConsentStatus()&&1==e.length&&$("#chatconsent").on("change",function(){1==$(this).is(":checked")?$Support.toggleSendButton($Support.getComposer()):$Support.Util.removeSendClickAction()})},updateDeptDropdown:function(){var e=$("#sqico-drpdwn");if(e.length){e.dropdown({options:$Support.getEmbedDepartments(),purpose:"department",defaultval:LSResource.getRealValue("ne.chosedepartment")});var t=$Support.getParent().$zohosq.nonce;t&&$Support.contentdiv&&$Support.contentdiv.find('[purpose="department"]').next("#dropcontent").find("li").attr("nonce",t)}},animateHeader:function(e){var t=$Support.container.find("header"),o=t.find(".cmplogo");o.removeClass("siq_botimg"),e.attendername&&(t.find("#attname").html(getEscapedText(e.attendername)),t.find(".cmpylogo").removeClass("sqico-chat").addClass("sqico-user"));var n=e.aboutme||"",i=n?"":"noaboutme",r='<div class="txtelips siq-about-me" id="attabtme" title="'+n+'">'+Smiley.replace(n)+"</div>";t.find("#attabtme").replaceWith(r),t.removeClass("noaboutme").addClass(i).removeAttr("header-type");var a=$Support.isUserLogoEnabled("",e);if((e.image_fkey||e.userimg)&&a){t.removeClass("nologo");var s=e.image_fkey?$Support.Util.getPhotoURL(e.image_fkey,e.attendername):e.userimg;o.removeAttr("style").find("#complogo").attr("src",$Support.Util.getUserImageWithNPS(s)),!e.isBotChat||t.attr("header-type","bot")}else(e.chid||!a&&e.attendername)&&(t.removeClass("nologo").addClass("nologo"),o.removeAttr("style").find("#complogo").removeAttr("src"),$("#blur_userbg").hide().parent().removeClass("hide_fontico"));a&&e.attendername?o.attr("data-chttype","agent"):o.removeAttr("data-chttype")},showBanner:function(e,t,o,n,i,r){if(0!=e.length){var a=$Support.contentdiv||ZSIQConversationManager.getcurrchatwinobj().contentdiv,s=!1;a.find("#info_banr").length||(s=!0,a.prepend($Temp.getBannerHTML(e,t,i,r)),e=""),$Support.Util.showInfoBanner(e,t,s,o,n)}},hideBanner:function(e,t){var o=$Support.contentdiv||ZSIQConversationManager.getChatWinObjById(t).contentdiv;(o=o||ZSIQConversationManager.getcurrchatwinobj().contentdiv).find("#info_banr").slideUp(500,function(){$(this).remove(),"function"==typeof e&&e()})},showTimerBanner:function(e){clearTimeout($Support.Util.bnrtimer),$Support.contentdiv.append($Temp.getTimerBannerHTML(e))},populateSendMail:function(e){var t=ZSIQConversationManager.getChatWinObjById(e.parents(".siq_content").attr("data-id")),o=this,n=t.contentdiv,i="chatendmail"==e.attr("id")?n.find(".chtlnks"):n.find(".txtarewrap"),r=n.find("#smailbx");r.length||i.before(r=$($Temp.getSendMailHTML()));var a=$Support.EmbedObj.visitoremail||"";r.find("input").val(a),$Clickoutside.bindclick(function(){o.hideUtilityDiv(r)},"smailbx",e.attr("id"))},populateSendMailConfirm:function(e,t){var o=ZSIQConversationManager.getChatWinObjById(t),n=o.contentdiv||$Support.contentdiv,i=this,r=!1,a=n.find(".usrinpt"),s=n.find(".infomsg.chtend");(a=a.length&&-1!=o.chatID?a:s).hasClass("chtend")&&(a.hide(),r=!0);var p=n.find("#consentbannerdiv");"gtranslateconsent"==p.attr("cattr")&&(p.remove(),$Support.Util.calculateTextareaHeight(o),p=n.find("#consentbannerdiv")),p.length||a.before(p=$($Temp.getSendMailConfimHTML(e,t))),$Support.Util.calculateTextareaHeight(o),$Clickoutside.bindclick(function(){i.hideUtilityDiv(p,!0,r,o)}.bind(o),"consentbannerdiv","smailbx")},populateSmiley:function(e){Smiley.showSmileyList()},hideUtilityDiv:function(e,t,o,n){e.animate({bottom:"-60px",opacity:"0"},400,function(){e.remove(),t&&!o&&$Support.Util.calculateTextareaHeight(n),o&&n&&n.contentdiv.find(".infomsg.chtend").show()})},animateUtilityDiv:function(e){e.animate({bottom:"82%",opacity:"1"},400,function(){e.find("input").focus()})},showUserEditUI:function(e,t,o){if(ZSIQConversationForm.isOldFormView()){var n=$Support.contentdiv.find(".editfields");if(n.length&&!n.hasClass("hidemaskanim"))return;$Support.contentdiv.find(".maskdiv").remove().end().prepend($Temp.getUserEditHTML(e)),-1==$Support.EmbedObj.department&&$UI.populateDropDown(),t||$Support.Util.handleCustomHTML(!0),$Support.Util.calculateTextareaHeight();var i=$("#edituserdetails");i.length&&i.find(".siq-input-text-box").first().focus()}else!ZSIQConversationForm.checkContextInitiated()&&ZSIQConversationForm.fetchFieldsToEdit(t,o)},hideUserEditUI:function(){$Support.enableTextarea(),$UI.hideMaskDiv()},hideMaskDiv:function(){var e=$Support.contentdiv.find(".maskdiv").addClass("hidemaskanim");$Support.Util.removeDiv(e),$Support.contentdiv.removeClass("siq_popup")},showCaptcha:function(e){if($Support.contentdiv&&null!=CommonUtil.getCaptcha(e)){var t=$Support.contentdiv,o=$Temp.getCaptchaHTML(e),n=t.find(".maskdiv");n.length?n.html(o):t.prepend('<div class="maskdiv captcha">'+o+"</div>")}},hideCaptcha:function(){if($Support.contentdiv){var e=$Support.contentdiv.find(".captcha").addClass("hidemaskanim");$Support.Util.removeDiv(e)}},showWaitingDialog:function(){if(!(!$Support.waitingtime||$Support.isBotChat||$Support.proactive&&-1!=$Support.EmbedObj.chatID))return clearTimeout($Support.Util.bnrtimer),{text:function(){$Support.contentdiv.prepend($Temp.getWaitingTextHTML()),$UI.wait_div=$("#wait_div")},video:function(){$(".content").prepend($Temp.getWaitingTextHTML()).animate({top:"auto"},400)}}[$Support.EmbedObj.waitaction]()},populateCWaitHandler:function(){var e=$Support.contentdiv;if($Support.cwaitmsg){var t=e.find("#cwaitmsg");if(t.length)return void t.html($Support.cwaitmsg);e.find("#info_banr").after($Temp.getWaitHandlerHTML())}},removeCWaitHandler:function(){$("#cwaitmsg").remove()},populateVisitorQuestion:function(e,t){var o=ZSIQConversationManager.getChatWinObjById(t),n=$Support.EmbedObj,i=o.visitorname,r=o.question,a=o.istrigmsg&&ZSIQConversationForm.checkContextInitiated();if(r||$Support.getTriggerCookie()){var s=n.vwmsid;(o.istrigmsg||o.proactive)&&(i=o.triggername,r=e||o.pmsg,s=o.triggername),r=getEscapedText(r),o.istrigmsg&&!o.isbottrigmsg&&"string"==typeof r&&(r=r.replace(/&lt;br&gt;/g,"<br>"));var p={sender:s,dname:i,msg:Message.getDisplayContent(r),isques:a?"":o.question};$BotImpl.formatAndDisplay(p,t),o.presender=s}},checkAndShowBotTyping:function(e,t){$Support.isBotAvailable(e)&&(t&&$BotImpl.disableComposer(),ZSIQTranscript.showTyping({isautotyping:t}))},getInfoMsgHTML:function(e,t){return $Temp.getInfoHTML(e,t)},populateUserAction:function(e){if(e){var t=e.contentdiv;$Support.EmbedObj;e.setSoundConfig(),t.find(".usractions").remove().end().find(".usrinpt").prepend($Temp.getUserActionsHTML(e));var o=t.find("#mraction li");o.length?1===o.length&&t.find("#moreaction").removeAttr("title").attr({documentclick:o.attr("documentclick"),class:o.attr("class")}).html(o.children()):t.find("#moreaction").hide(),this.populateSendBtn(LSResource.getRealValue("ne.send"),e.winid),$Support.Util.handleUnmute(e)}},removeUserActions:function(e){e&&e.contentdiv.find(".usractions").remove().end()},getSoundHTML:function(e,t){var o=$Temp.getSoundHTML(t);return e&&(o=o.replace(/<li /g,"<span ").replace(/<\/li>/g,"</span>"),o=$(o).empty()),o},populateIcon:function(){$UI.removeSmileyIcon(),$Support.contentdiv.find("#smilelist").after($Temp.getIconHTML())},removeSmileyIcon:function(){$Support.contentdiv.find("#smiley").remove(),$("#action_icons").remove()},populateSendBtn:function(e,t){$Support.isFAQEnabled()||$("footer").find(".floatrg").remove().end().append($Temp.getSendBtnHTML(e).replace(/{SQICOSEND}/g,t))},handleOfflineStatus:function(e,t,o){var n=$Support,i=(n.EmbedObj,n.contentdiv);ZSIQConversationManager.getcurrchatwinobj().contentdiv&&(i=ZSIQConversationManager.getcurrchatwinobj().contentdiv),i||($UI.init(e),i=n.contentdiv),t&&$Support.isOnlineChat()&&$UI.showBanner(n.getOfflineMessage(),!0,null);var r=i.find("#msgarea");r.attr("placeholder",$Support.isFAQEnabled()?LSResource.getRealValue("ne.message.clicksubmit.icon"):LSResource.getRealValue("ne.message.clicksubmit")),$Support.isFAQEnabled()&&(r.parent().find("#sqico-send").remove(),r.after($Temp.getSendIcon(!0))),ZSIQConversationForm.isOldFormView()?r.attr("dockeyup","leavemessage").val(null!=o?o:$("#msgarea").val()).parents(".msgbox").addClass("posrel"):r.attr("dockeyup","leavemessage"),r.removeAttr("dockeydown"),this.populateSendBtn(LSResource.getRealValue("ne.submit")),ZSIQConversationForm.isOldFormView()&&!$Support.isFAQEnabled()&&$("footer").show(),""!=i.find("#msgarea").val()&&$("footer").find("em#sqico-send").attr("documentclick","leavemessage"),n.Util.setTextareaHeight()},handleMissedStatus:function(e,t,o){o=$.isEmptyObject(o)?ZSIQConversationManager.getcurrchatwinobj():o;var n=$Support,i=o.composer||$("#msgdiv");i.removeAttr("disabled").attr("placeholder",$Support.isFAQEnabled()?LSResource.getRealValue("ne.missed.placeholder.icon"):LSResource.getRealValue("ne.missed.placeholder")),i.removeAttr("dockeydown"),t||(e?o.showBanner(LSResource.getRealValue("ne.offlinemsg")):o.showBanner(DynamicMsg.fillValues(n.EmbedObj.missedmessage))),this.removeUserActions(o),o.contentdiv.addClass("missed").find('[proptype="msgarea"]').attr("dockeyup","missedleavemsg"),$TH.populateSendBtn(LSResource.getRealValue("ne.submit"),o.winid)},populateFeedbackHTML:function(e){if(!CallImpl.isCallWithChat){var t=$Support.contentdiv;t.find(".sqico-edit").remove();var o=JSON.parse($Support.EmbedObj.eprops.feedback[0]),n=$Support.israting,i=$Support.isfeedback;if(!(o||n||i)||0==n&&0==i)this.emptyFeedback();else{$Support.isfeedbacksent=!i,$Support.contentdiv.removeClass("feedback_popup").addClass("feedback_popup");var r=!1===$Support.israting?$Temp.getFeedbackOnlyHTML():$Temp.getFeedbackHTML(!i);t.find(".maskdiv").remove().end(),t.find("#msgdiv").append(r),this.emptyFeedback(n),ZSIQTranscript.scroll("",$Support.chatmaindiv)}}},handleFeedbackBtn:function(){this.populateSendBtn(LSResource.getRealValue("ne.submit")),$("footer #sqico-send").before('<em documentclick="hidefeedback" class="hidemask">'+LSResource.getRealValue("common.cancel")+"</em>")},emptyFeedback:function(e){var t=$Support.contentdiv;t.find("div.usrinpt").remove(),$("footer #sqico-send").remove(),t.addClass("nofdbk"),e&&$("#fdbkarea + .sqico-send").hide()},updateCloseIcon:function(){$Support.container.find(".sqico-min").replaceWith($Temp.getCloseHTML())},showFdbkResponse:function(e){var t=e.chatmaindiv;if(Message.scroll(t),$Support.isfeedback){var o=$Support.EmbedObj.feedbackcomplete||LSResource.getRealValue("visitorchat.feedback.submit");e.showBanner(o,"psabs",!0)}this.feedbackAck(e)},feedbackAck:function(e){$Support.Util.hideFeedback(e),e.chatmaindiv.addClass("fdbalone"),e.chatmaindiv.find('.vismsg [purpose="name"]').removeAttr("documentclick")},getInfoMsgContent:function(e,t,o,n){var i=Message.getInfoHTML(e,t,o,n);return i?this.getInfoMsgHTML(i):""},showDragDropUI:function(){if(!$Support.Util.isDragNotAllowed()){this.hideDragDrop();var e=ZSIQConversationManager.getcurrchatwinobj();e.contentdiv&&e.contentdiv.prepend($Temp.getDragDropHTML())}},hideDragDrop:function(){if(!$Support.Util.isDragNotAllowed()){var e=ZSIQConversationManager.getcurrchatwinobj();e.contentdiv&&e.contentdiv.find("#dragmask").remove()}},getPreviewHTML:function(){return $Temp.getPreviewHTML()},displayInfo:function(e){$UI.showBanner(e)},getCustomHTML:function(e){var t=e.type||e.format||"text";return/^(phone|number|text|email|url|percentage|decimal|percent|website)$/.exec(t)?$Temp.getCInputHTML(e):{checkbox:function(){return $Temp.getCCheckBxHTML(e)},radio:function(){return $Temp.getCRadioHTML(e)},selectbox:function(){return $Temp.getCDropDwnHTML(e)},textarea:function(){return $Temp.getCTextareaHTML(e)},label:function(){return $Temp.getCLabelHTML(e)}}[t]()||""},getFormattedCustomobj:function(e){var t=e.meta||{},o=t.input_card||{};return{hint:o.placeholder,name:t.field_name,options:o.options,required:!t.skippable,type:o.type,visibility:o.visibility,maxlength:o.maxlength,style:o.style,question:t.msg}},showUploadProgress:function(a,s){var p=$Support.EmbedObj,c=ZSIQConversationManager.getChatWinObjById(s),d=a.fileobj,l=a.msgid,m=d.name||a.filename,e=$('span[msgid="'+l+'"]'),u=p.vwmsid;if(this["fileprg"+l]||e.length){var t=a.prgval,o=parseInt(t.loaded/t.total*100),n=e.find(".file_prgs"),i=o/100*360;180<i&&n.addClass("gt50"),e.find(".size").html(getMemSize(t.loaded)+" of "+getMemSize(t.total)+" ("+o+"%)"),n.find(".pie:first-child").css({transform:"rotate("+i+"deg)","-webkit-transform":"rotate("+i+"deg)","-moz-transform":"rotate("+i+"deg)"})}else this["fileprg"+l]=!0,$Support.Util.getFileURL(d,function(e){var t,o,n={sender:u,dname:p.visitorname,msg:{content:d.type},file:{size:d.size,purl:e,fName:m,progress:!0,msgid:l,comment:a.comment},previoussender:c.presender&&c.presender===u,msgid:a.msgid,att_type:a.att_type,chid:s||ZSIQConversationManager.getcurrchatwinChid(),reply_to:a.reply_to},i=-1!=d.type.indexOf("audio"),r=a.att_type&&"voice_note"==a.att_type;i&&r&&(o=(t=ZSIQAudio.init(n,s)).getHTML()),ZSIQTranscript.updateTranscript({html:ZSIQTranscript.getTranscript(n,"",s,o),sender:u},s),MessageOperation.removeReplymsgdiv(),t&&t.init(),c.chatstatus&&"missed"===c.chatstatus&&$Support.missedLeaveMsg("",s,r)})},hideUploadProgress:function(e){var t=$('span[msgid="'+e+'"]');t.find(".file_prgs").removeClass("gt50"),t.removeClass("fprgs");var o=t.find(".size");o.html(o.attr("size")),delete this["fileprg"+e],$("#"+e).find('[proptype="readrec"]').removeClass("dn"),MessageOperation.removeReplymsgdiv(),ZSIQTranscript.scroll()},updateParentFontFamily:function(){$Support.Util.updateParentFontFamily()},updateQuesArea:function(){this.populateSendBtn(),$Support.contentdiv.find(".msgbox").html($Temp.getQuesAreaHTML()),$Support.composer=$("#msgarea")},updateChatEndMsg:function(e){e=e||{};var t=$Support.Util.isPreview()?$Support.chatmaindiv:e.chatmaindiv;t&&t.addClass("chtcomp").after(e.chatendmsg=$($Temp.getChatEndHTML("",{chid:e.chatID,vid:e.visitorID}))),$Support.Util.handleUnReadScroll()},updateVisitorName:function(t){var o=getEscapedText(t.name),n=$Support.Util.CheckAllDefaultFieldsDisabled()?'<em class="sqico-edit" documentclick="userdetails" title="'+LSResource.getRealValue("ne.title.edit")+'"></em>':"";o&&$Support.container.find('[proptype ="contentdiv"]').each(function(){var e=$(this);e.find('.vismsg div[purpose="name"]').html(o+n),e.find('[proptype="visname"]').text(t.name)})},getBusinessHrInfo:function(){var e=$Support.EmbedObj;if(!e.bushrstatus)return"";var t=LSResource.getRealValue("ne.offlinemsg"),o=e.bushrtiming;if(!o)return t;var n;for(var i in o){var r=o[i];r.length&&(isUndefined(n)&&(n=i),o[n][0]!==r[0]&&!1)}return $Temp.getBusnsInfoHTML(o[n][0])},setSoundConfig:function(){var e=$Support.EmbedObj,t=$Support.getCookieValue(e.chatID+"_sound");e.setSoundConfig(t)},addGroupIcon:function(){$Support.container.find("#complogo").after($Temp.getGroupIconHTML())},removeGroupIcon:function(){$Support.container.find("#complogo").next(".sqico-grpico").remove()},getCustomColor:function(){if(4==$Support.getThemeID())return"";var e=$Support.EmbedObj.eprops,t=parent.$zv.embedtheme||e.color[1].code,o=$Support.Util.getTextColor(t),n=o.text_color,i=o.icon_color,r=$Support.Util.getRGB(t),a="";if("#0066cc"!=t){var s=r[0]+", "+r[1]+", "+r[2];a='header, .win_close, .siqc_edt, [themeid="9"] header:after, [themeid="10"] header:after, .buble_bg .msgbx { background-image : -webkit-linear-gradient( 90deg, rgb( '+s+" ) 0%, rgba( "+s+", 0.9 ) 100%) !important; background-image : -moz-linear-gradient( 90deg, rgb( "+s+" ) 0%, rgba( "+s+", 0.9 ) 100%) !important; background-image : -ms-linear-gradient( 90deg, rgb( "+s+" ) 0%, rgba( "+s+", 0.9 ) 100%) !important}"}var p="";return i&&(p+='.headercont, .siq-convback.sqico-larrow:hover:before, .win_close.sqico-larrow:hover::before, aside.siqc_edt:hover:before, .faq-srch .sqico-close:hover:before, div.faq-srch input[type="text"], .min-view:hover .sqico-search:before, .chat_btn, div.win_close.sqico-larrow::before { color: '+n+' !important }.win_close.sqico-larrow::before, .siq-convback.sqico-larrow::before, aside.siqc_edt:before, .sqico-user:before, .sqico-typing.siqc_usrimg img[src=""] + .sqico-user:after, .faq-srch .sqico-close:before, .sqico-search::before, .sqico-chat:before  { color: '+i+" !important; }.faq-srch input::placeholder{ color: #999 !important; }.cmplogo, .siq-convback.sqico-larrow:hover, .faq-srch, .min-view.faq-srch:hover { background-color: rgba(0, 0, 0, .05); }.vismsg .range .range-path {background-color: #999 !important;}.vismsg span.siq-voice-control:before {color: #000;}.siq-voice-audio .range-handle, .vismsg .siq-voice-audio .range-val, .vismsg .siq-voice-control.sqico-pause:after, .vismsg .siq-voice-control.sqico-pause:before { background-color: #000 !important;}.vismsg span.siq-voice-control { border-color: #888;}"),'<style id="zsiq_customcss">.siqc_prochtcls:before, .vismsg .msgbx, .vismsg .msgbx code, .smile_list .siqsmile_li:hover, .smile_list .siqsmile_li.sel,#conv-tab.count .siqc_eletype,.cmpnt-ftr .sqico-tick,.range-point.sel .range-dot,.range-handle, .range-handle1,.range-val,.cmpnt-optn-list div:hover .cmpnt-mul-optn:not(.sqico-tick), .siqc_usrimg img[src=""] + .convrstn-usr, div#conv-tab.count:after, .chat_btn, .vismsg .siq-voice-audio {background-color: '+t+' !important;}.wincustom_clr, .sqico-chat2:before, .lstmsg_strs .sqico-star,.infomsg span:before,.infomsg span, .artcle-viewal, textarea + .sqico-send[documentclick]::before, .sqico-send[documentclick]::before, .sqico-send[documentclick], .cmpnt-optn-list div:hover, .cmpnt-optn-list .sel, .cmpnt-btnurl:not(.cmpnt-cal-time):hover,.cmpnt-cal-time em:hover,.sel .sqico-tick:before, .cmpnt-btnurl:not(.cmpnt-cal-time):hover *,.cmpnt-ftr #range-display,.range-value,.cmpnt-rtng:hover [class*="sqico-"]::before,.siq-user-message + .cmpnt-rtng .sqico-like:before, .siq-user-message + .cmpnt-rtng .sqico-dislike:before,.cmpnt-body-cont .sqico-star:hover:before, .cmpnt-body-cont .sqico-star:hover ~ div:before,.cmpnt-btnurl:before, .cmpnt-skip:hover,.cmpnt-skip:hover .sqico-skip:before,.cmpnt-nxtprev em,.choose:hover,.msgbx > .sqico-star:before,.cmpnt-art-list span,.cmpnt-cusclr, #action_icons span:hover:before, .chtend a, .chtend a:before, footer .sel span, footer .sel:before, .faqdiv > div.sel, .sqico-smail:hover::before, .faq-srch .sqico-close:before, .sqico-more:hover:before, .mraction li:hover, .mraction li:hover::before, .reply_msg .sqico-reply:before, body .reply_msg .sqico-reply, span.sqico-file-min:before, .msgbx .mraction li:hover, .msgbx .replyicon:hover:before, .botactions em { color:'+(i?n:t)+' !important; }.vismsg .msgbx .siq-message:not([proptype="filecomment"]), .content .vismsg .time, .siqc_hstrycht .vismsg .time, .vismsg .msgbx *, .vismsg .sqico-close:BEFORE, .smile_list .siqsmile_li:hover, .smile_list .siqsmile_li.sel, .zsiq_transferdiv .bot_opt.gltr-srno:not(.gltr-no){ color: '+n+" !important;}.msgbx a{ border-bottom-color: "+n+"}.file_prgs > .pie,.range-handle, .range-handle1,.cmpnt-art-list:hover span, .sinl-prw-link a:last-child .cmpnt-btnurl:hover { border-color: "+t+"}"+a+".santacap .st2 { fill: "+t+"; }"+p+"</style>"},getHeader:function(){return $Support.container.find("header")},getTranslateBannerHTML:function(e,t){return $Temp.getTranslateBannerHTML(e,t)},checkAboutmeClass:function(){var e=$("#attabtme");e.removeClass("empty_abtme"),e.text()||e.addClass("empty_abtme")}};!function(i){i.$Template=i.$Template||{},$Temp=$Template.theme={getContainerHTML:function(){$Support.EmbedObj;if($("body").find("#formcss").remove(),ZSIQConversationForm.isOldFormView()){$("body").append('<style id="formcss">[class*="deptst_"] em{display: inline-block;}a, .sqico-drpdwn a:hover, section.content .errfield.sqico-drpdwn a{ background-color: transparent; text-decoration:  none; outline: none;}input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 / padding: 0; / 2 */ display: none; outline: none;}.dspnone, .errfield .req, .errfield + em.req{ display: none;}.sqico-drpdwn[val] .req{ visibility: hidden; }.sqico-drpdwn .req{ visibility: visible;}div textarea[purpose="custom"]{ height: auto;}em.req{ color: #fe8d8d;}.outerwin input[type="text"],.editfields input[type="text"]{ border-radius: 8px; background-color: #f4f4f4; border: solid 1px #e3e3e3; width: 100%; outline: none;transition:  border ease-in-out 0.5s; -webkit-transition:border ease-in-out 0.5s; -moz-transition: border ease-in-out 0.5s;padding: 0 13px; height: 44px; line-height: normal; -webkit-appearance: none; -webkit-tap-highlight-color: rgba(0,0,0,0);}.content .errfield.sqico-drpdwn a, .content .errfield.sqico-drpdwn{ background-color: #fff6f6; border-color: #ffc3c3;}input[type="text"]:focus, .content .sqico-drpdwn a:focus { border-color: #ccc; outline: none;}.sqico-drpdwn ul, .content .sqico-drpdwn {   position: absolute; width: 100%;  z-index: 1;color:#444;}.content .sqico-drpdwn{ position: relative;height: 44px; line-height: 42px; width: auto;  z-index: 4; background-color: #f4f4f4; border-radius: 8px; }.sqico-drpdwn a, .sqico-drpdwn a:hover { display: block; padding: 0 13px; width: 100%;  border: solid 1px #e3e3e3;  border-radius: 8px;height: auto; }.sqico-drpdwn ul { width: 97.35%; width:calc( 100% - 56px ); left: 26px; position: fixed;max-height: 174px; overflow: auto; display:none;padding: 0;}.sqico-drpdwn li:first-child{ padding-top: 12px;}.sqico-drpdwn li { padding: 11px 120px 11px 14px; cursor: pointer; line-height: normal;height: 40px; border-radius: 0; font-size: 14px;}.sqico-drpdwn li:hover, .sqico-drpdwn li.atsel { background-color: #eaeaea;}div.sqico-drpdwn.zindrp{ z-index:inherit; border-radius: 8px 8px 0 0; box-shadow:0 1px 3px 0 #ccc;}div.sqico-drpdwn.zindrp ul{ border-radius: 0 0 8px 8px; max-height: 169px; box-shadow: 0 2px 3px 0 #ccc; border-top-color:#edf4f8; z-index: 11112; background-color: #f4f4f4; }[themeid="4"] .content .zindrp, [themeid="4"] div.sqico-drpdwn.zindrp ul {background-color: #f4f4f4;}.zindrp.btmalign em.req{ border-radius: 0 0 8px 8px;}[data-validate*="required"] + em.req, .sqico-drpdwn[data-validate*="required"] .req { position: absolute; border-left: 2px solid #fe8d8d; border-radius: 15px; height: 42px; left: 0; padding-left: 9px; top:1px;}.fdbck_star, .sqico-drpdwn.zindrp ul, .content .sqico-drpdwn a, .smileydiv, .zindrp.sqico-drpdwn ul { border-color: #e3e3e3; }.content > div, footer span, footer a, .sqico-drpdwn:before, .desc, .sqico-enter, .content .sqico-drpdwn a{color:#777;}input[type="text"].errfield:focus, textarea.errfield:focus{background-color: #fff;}.content .errfield.sqico-drpdwn a, .content .errfield.sqico-drpdwn{transition: all 0.5s cubic-bezier(1, 0.7, 0.5, 1); -moz-transition: all 0.5s cubic-bezier(1, 0.7, 0.5, 1); -webkit-transition: all 0.5s cubic-bezier(1, 0.7, 0.5, 1);}.siqc_usrimg{height:49px;width:49px;display: inline-block;vertical-align: middle;position: relative;border-radius: 100%;overflow: hidden;box-shadow: 0 0 0 0.6px rgba(170, 170, 170, 0.5);z-index: 1;}#action_icons  span:hover:before, .chtend a, .chtend a:before { color: #0091ff; }[themeid="4"] input[type="text"], [themeid="4"] textarea, [themeid="4"] .content .sqico-drpdwn a { background-color: rgba(255, 255, 255, 0.80);  border: solid 1px #e3e3e3; }[themeid="4"] div.sqico-drpdwn.zindrp ul {left: 26px;width: calc( 100% - 52px ); }[themeid="4"] input[type="text"].errfield, [themeid="4"] textarea.errfield, [themeid="4"] .content .errfield.sqico-drpdwn { background-color: #fedddd; border-color: #f07777; }[header-type="bot"] .blur_userbg, [cwview="convchat"] .blur_userbg, [cwview="msgarea"] .blur_userbg, .siq_content .blur_userbg {position: absolute;height: 100%;width: 100%;filter: blur(5px); display: inline-block; left: 0; z-index: -1; top: 0; }.skipdrag .siqc_edt { bottom: 100px; }.skipdrag .faq .siqc_edt {bottom: 135px;}</style>')}var e=($Support.isParentIframe()?"":" emfullwindow")+" emwin";return e+=$Support.isFAQEnabled()?" faq":"",e+=$Support.isNewHeader()?" zsiq-newtheme":"",e+=$Support.Util.isPreview()?" newpreview":"",e+=$Support.isSignature($Support.EmbedObj)?" signature_embed":"",e+=i._ISRTLSUPPORTEDLANG?" zsiqrtl_lang":"",['<section id="window-ribbon" themeid="'+$Support.getThemeID()+'" class="siqembed siqc-convert outerwin'+e+$Support.getEmbedSizeClass()+'"></section>'].join("")},getCloseWindowHTML:function(){return $("body").find(".win_close").remove(),$Support.isSignature($Support.EmbedObj)?"":'<div class="win_close sqico-larrow" themeid="'+$Support.getThemeID()+'" documentclick="min_iframe">'+$Temp.getSantaCap()+"</div>"},getHeaderHTML:function(e){e=e||{};var i=$Support.EmbedObj,s=JSON.parse(i.eprops.iclogo)?i.clogo+"?nps=202":"",t=e.attenderimagefkey||e.imagefkey||e.image_fkey,a=e&&$Support.isUserLogoEnabled("",e)&&t?$Support.Util.getPhotoURL(t,e.attender):"",o=e&&e.attendername;a=!a&&e.isBotChat?ZSIQTranscript.getImageURL({sender:e.attender}):a;var c=e.isBotChat?a+"?nps=202":a,n=(s=o?c:s)?"":"nologo";o=getEscapedText($Support.getChatWindowTitle(o));var l=getEscapedText(e&&e.aboutme||""),d=l?"":" noaboutme",r=!1;if(i.companywebsite){var p=i.companywebsite;r=!0}return['<header class="'+n+d+'" prop="header"><div class="headercont">','<div class="siq-convback sqico-larrow" id="showsiqconv" documentclick="showconvlist" style="display:none;"></div>','<div class="cmplogo siq-company-logo" prop="clogo">',r?'<a id="compurl" href="'+p+'" target="_blank">':"",'<span class="sqico-user"><img src="'+s+'" height="49" width="49" id="complogo" class="cmn_mdl siq-company-logo" onload="$Support.Util.handleBlurImage(this)" /></span>',"</div>",r?"</a>":"",'<div class="header_txt">','<div class="txtelips siq-chat-attender-name" id="attname">'+o+"</div>",'<div class="txtelips siq-about-me" id="attabtme" title="'+l+'">'+l+'</div><div id="attabtme"></div>',"</div></div>",'<span class="siqchat-detl sqico-call" documentclick="audiocall" id="audiocall" style="display:none;" title="'+LSResource.getRealValue("audiovideo.audiocall")+'"></span>',$Temp.getSnowHTML(),"</header>"].join("")},getBodyHTML:function(e,i){var s=$Support.getJSAPIMessageHint(),t=$Support.EmbedObj,a=$Support.isSignature(t),o=t.isformremoval,c=0==(d=t.status)?$Support.isFAQEnabled()?LSResource.getRealValue("ne.message.clicksubmit.icon"):LSResource.getRealValue("ne.message.clicksubmit"):LSResource.getRealValue("ne.message.hitenter"),n=s?'placeholder="'+s+'"':'placeholder="'+c+'"';if(!ZSIQConversationForm.isOldFormView())return'<section class="content chtanim siq_content'+(a?" algn_hgt":"")+'" proptype="siqemptybg"><div class="chtcont" id="msgmaindiv"><div class="disply_tbl"><div class="disply_cel" id="msgdiv">'+$Temp.getEmptySlate(d)+'</div></div></div><div class="usrinpt" id="msgbox_main">'+this.getFreeLogoHTML()+'<div class="txtarewrap"><textarea '+n+' purpose="question" custom= "question" info = "question" class="msgarea siq-message-textarea" id="msgarea" dockeydown="textarea" dockeyup="textarea"  data-validate="required"></textarea><div class="smile_list siq-smileys-section" id="smilelist" style="display: none;"></div></div></div></section>';if(e)return'<section class="content siq_content"></section>';t=$Support.EmbedObj;var l="content posrel siq_content siqforms";(a=$Support.isSignature(t))&&(l+="algn_hgt ");var d=$Support.EmbedObj.status,r=t.eprops,p=t.pprops.chatcookiepolicyurl;return['<section class="'+l+'" purpose="outer" proptype="siqform">',JSON.parse(r.isname[0])&&!o?this.getNameHTML(r.isname[1].ismandatory):"",JSON.parse(r.isemail[0])&&!o?this.getEmailHTML(r.isemail[1].ismandatory):"",JSON.parse(r.isphoneno[0])&&!o?this.getPhoneHTML(r.isphoneno[1].ismandatory):"",o?this.getFieldHTML():"",!t.lastdeptid&&-1==t.department||i?'<div id="sqico-drpdwn" class="sqico-drpdwn siq-dropdown" custom="department" info="department" data-validate="required"></div>':"",'<div class="msgbox" custom="question">',this.getQuesAreaHTML(d),0==d?this.getChatConsentHTML(p):"",o?"":this.getCampaignHTML(),"</div>","</section>"].join("")},getFieldHTML:function(){($Support.getParent().$ZSIQUtil.getAPIValues()||{}).floatwindowfields&&ZSIQConversationForm.updateformconfig();for(var e=$Support.fieldlist||[],i={visitor_name:this.getNameHTML,visitor_email:this.getEmailHTML,visitor_phone:this.getPhoneHTML},s=e.length,t="",a=0;a<s;a++){var o=e[a],c=o.meta||{},n=c.input_card||{},l=n.type||"",d=n.placeholder||"";if("department"!=c.field_name)if("subscribe"!=c.key&&"campaign"!=l){var r=!c.skippable;i[l]||((o=$TH.getFormattedCustomobj(o)).index=a),t+=i[l]?i[l](r,"",d):$UI.getCustomHTML(o),"selectbox"==o.type&&$("#sqico-cdrpdwn"+a).dropdown({options:o.options,purpose:"customdrpdwn",defaultval:o.hint||o.name||"Custom"})}else{var p=$Support.Util.isPreview()?o.msg||c.msg||LSResource.getRealValue("embed.campaign.label"):"";t+=this.getCampaignHTML(p)}}return t},getEmptySlate:function(e){var i="offline_bg",s=LSResource.getRealValue("cw.statustext.offline");return e&&(i="online_bg",s=LSResource.getRealValue("cw.statustext.online")),'<div class="content_mdl textC" id="emptybg"><span class="'+i+'"><em class="bg_shadow"></em>'+s+"</span></div>"},getQuesAreaHTML:function(e){$Support.EmbedObj;var i=e?"textarea":"leavemessage",s=e?'dockeydown="textarea"':"";if(ZSIQConversationForm.isOldFormView())return['<div class="posrel siq-message-area">','<textarea placeholder="'+(0==e?$Support.isFAQEnabled()?LSResource.getRealValue("ne.message.clicksubmit.icon"):LSResource.getRealValue("ne.message.clicksubmit"):LSResource.getRealValue("ne.message.hitenter"))+'" class="msgarea siq-message-textarea" purpose="question" info="question" type="text" id="msgarea" '+s+" dockeyup="+i+'  data-validate="required charlimit 2048"></textarea>',this.getSendIcon(0==e)+"</div>"].join("");var t=$Support.getJSAPIMessageHint(),a=t?'placeholder="'+t+'"':'placeholder="'+LSResource.getRealValue("ne.message.hitenter")+'"';return'<div class="usrinpt" id="msgbox_main">'+this.getFreeLogoHTML()+'<div class="txtarewrap"><textarea '+a+' class="msgarea siq-message-textarea" id="msgarea" dockeydown="textarea" dockeyup="'+i+'"  data-validate="required"></textarea><div class="smile_list siq-smileys-section" id="smilelist" style="display: none;"></div></div></div>'},getNameHTML:function(e,i,s){i=i||"";var t="optional",a='docblur="checkInputVal"',o="",c=getEncodedText(s)||LSResource.getRealValue("ne.entername");!0===CommonUtil.parseToJSON(e)&&(t="required",a=' docblur="required"',o='iserrorfield="true"');var n=$Support.Util.isInValidVisitorName($Support.EmbedObj.visitorname)?"":$Support.EmbedObj.visitorname;$Support.EmbedObj;if(ZSIQConversationForm.isOldFormView()){i=i||"";t="optional";var l="";a="";return!0===CommonUtil.parseToJSON(e)&&(t="required",l=" ("+LSResource.getRealValue("ne.required")+")",a=' docblur="required"'),'<div custom="name"  customid = "siq_name"><input type="text" value="'+getEncodedText(n)+'" id="visname" placeholder="'+c+l+'" class="siq-input-text-box" '+a+i+' info="name" fieldname = "name" purpose="visitorname"  data-validate="'+t+' charlimit 100"/>'+$Temp.getRequiredHTML()+"</div>"}return'<div custom="name" class="field_main posrel" field-type="text"><input type="text" class="input_field font15" value="'+getEncodedText(n)+'" '+o+' id="visname" '+a+i+' info="name" fieldname = "name" purpose="visitorname" data-validate="'+t+' charlimit 100" docfocus="inputFocus" dockeydown="removeError"/><span class="field_title font15">Name '+$Temp.getRequiredHTML(e)+"</span></div>"},getEmailHTML:function(e,i,s){$Support.EmbedObj;var t=!0===CommonUtil.parseToJSON(e)?"required":"optional",a=getEncodedText(s)||LSResource.getRealValue("ne.action.enteremail"),o=$Support.EmbedObj.visitoremail||"";return ZSIQConversationForm.isOldFormView()?['<div custom="email" customid = "siq_email">','<input type="text" id="visemail" value="'+o+'" class="siq-input-text-box" placeholder="'+a+(1==CommonUtil.parseToJSON(e)?" ("+LSResource.getRealValue("ne.required")+")":"")+'" info="email" fieldname = "email" purpose="visitoremail"  data-validate="'+t+' email charlimit 100" docblur="email" />'+$Temp.getRequiredHTML(),$Temp.getFetchMailHTML(),"</div>"].join(""):'<div custom="email" class="field_main posrel" field-type="text"><input type="text" id="visemail" value="'+o+'" '+(!0===CommonUtil.parseToJSON(e)?'iserrorfield="true"':"")+' class="input_field font15" info="email" purpose="visitoremail" data-validate="'+t+' email charlimit 100" docblur="email" docfocus="inputFocus" dockeydown="removeError"/><span class="field_title font15">Email'+$Temp.getRequiredHTML(e)+"</span>"+$Temp.getFetchMailHTML()+"</div>"},getFetchMailHTML:function(e){$Support.EmbedObj;return ZSIQConversationForm.isOldFormView()?$Support.EmbedObj.fetchid?'<div class="fetchmail" id="fetchmail"><span class="sqico-fb"></span><span class="sqico-gplus"></span></div>':"":$Support.EmbedObj.fetchid?'<div class="social_icons"><em class="sqico-fb"></em><em class="sqico-gplus"></em></div>':""},getPhoneHTML:function(e,i,s){$Support.EmbedObj;var t=$Support.EmbedObj.visitorphone||"",a=getEncodedText(s)||LSResource.getRealValue("cw.form.phone.placeholder");if(ZSIQConversationForm.isOldFormView()){var o="optional",c="",n="";return!0===CommonUtil.parseToJSON(e)&&(o="required",c=" ("+LSResource.getRealValue("ne.required")+")",n=' docblur="required"'),'<div custom="phone" customid = "siq_phone"><input type="text" value="'+t+'" class="siq-input-text-box" id="visphone" placeholder="'+a+c+'" class="" '+n+' info="phone" fieldname = "phone" purpose="visitorphone"  data-validate="'+o+' phone"/>'+$Temp.getRequiredHTML()+"</div>"}o="optional",n='docblur="checkInputVal"';var l="";return!0===CommonUtil.parseToJSON(e)&&(o="required",n=' docblur="required"',l='iserrorfield="true"'),'<div custom="phone" class="field_main posrel" field-type="text"><input type="text" value="'+t+'" '+l+' class="input_field font15" id="visphone" class="" '+n+' info="phone" purpose="visitorphone"  data-validate="'+o+' phone" docfocus="inputFocus" dockeydown="removeError"/><span class="field_title font15">Phone '+$Temp.getRequiredHTML(e)+"</span></div>"},getCampaignHTML:function(e){$Support.EmbedObj;if(!$Support.Util.isCampaignEnabled()&&!e)return"";var i=e||$Support.EmbedObj.integprops.integinfo[$Support.enabledCampaignID].subscribelabel||LSResource.getRealValue("embed.campaign.label");return ZSIQConversationForm.isOldFormView()?['<div class="newsletter siq-newsletter txtelips" documentclick="newsletter">','<input type="checkbox" id="newsletter" name="Checkbox" />','<label for="newsletter" class="siq-checkbox-label txtelips" title="'+getEncodedText(i)+'"><span class="sqico-chkbx siq-checkbox"></span><em>'+getEncodedText(i)+"</em></label>","</div>"].join(""):'<div class="mT15 siq-newsletter elips pL15" documentclick="newsletter"><span class="posrel"><input type="checkbox" class="hide_fld" name="newsletter" id="newsletter"><span class="checkbox sqico-checkbox siq-check"><label for="newsletter" class="curP dib-mid" title="'+getEncodedText(i)+'">'+getEncodedText(i)+"</label></span></span></div>"},getChatConsentHTML:function(e){if($Support.Util.getChatConsentStatus()){var i=LSResource.getRealValue("common.gdpr.agent.offlineaccept2");e&&(e=-1==e.indexOf("http")?"http://"+e:e,i="<a class='siq-lnmor sbold' target='_blank' href='"+getEncodedText(e)+"'>"+i+"</a>");var s=LSResource.getRealValue("common.gdpr.agent.offlineaccept1")+i;return['<div id="offlineconsent" class="newsletter siq-newsletter">','<input type="checkbox" id="chatconsent" name="Checkbox" />','<label for="chatconsent" class="siq-checkbox-label txtelips" title=""><span class="sqico-chkbx siq-checkbox"></span><em>'+(s=$Support.Util.getOfflineAPIConsent(s))+"</em></label>","</div>"].join("")}},getChatAreaHTML:function(){var e=$Support.getJSAPIMessageHint(),i=$Support.EmbedObj,s=$Support.isSignature(i),t=e?'placeholder="'+e+'"':'placeholder="'+LSResource.getRealValue("ne.message.hitenter")+'"';return['<section class="content chtanim siq_content'+(s?" algn_hgt":"")+'" data-id = "{CONTENTDIV}" proptype ="contentdiv" >','<div class="chtcont"  id="msgmaindiv" proptype="msgmaindiv" docwheel="handlescroll"><div class="disply_tbl"><div class="disply_cel" id= "msgdiv" proptype="msgdiv">',"</div></div></div>",'<div class="usrinpt" id="msgbox_main" proptype="msgbox_main">',this.getFreeLogoHTML(),'<div class="txtarewrap"><textarea '+t+' class="msgarea siq-message-textarea"  id="msgarea" proptype="msgarea" dockeydown="textarea" dockeyup="sendmessage" txtarea-id = "{TXTAREAID}"  data-validate="required"></textarea><div class="smile_list siq-smileys-section" proptype = "smilelist" id="smilelist" style="display: none;"></div></div>',"</div>","</section>"].join("")},getRecorderHTML:function(){return['<div class="siq-voice-note" id="{SQICOVOICENOTE}"  proptype="voicerecorder" >','<div class="siq-voice-player-action">','<span class="sqico-close curP" cntrl="cancelRecord" title="'+LSResource.getRealValue("common.cancel")+'" ></span>',"</div>",'<div class="flexG w100" id="sqico-canvas"></div>','<span class="flexC">','<em class="siq-record-icn fshrink mR10" id="recording-icon"></em>','<em class="mR10 siq-voice-color" id="sqico-timer"></em>',"</span>",'<span class="sqico-delico mL5 curP" cntrl="settings" style="display:none" ></span>','<span class="siq-voice-stop-icn curP" cntrl="stopRecord" title="'+LSResource.getRealValue("av.info.stop")+'"></span>','<div class="siqc-progress siqc-float siqc-shadow" style="display:none">','<div class="siqc-progress-item"></div>',"</div>","</div>"].join("")},getSendIcon:function(e,i){return $Support.isFAQEnabled()||i?'<span class="sqico-send siq-send-button" id="sqico-send" chatid="{SQICOSEND}" proptype = "sqico-send" title="'+LSResource.getRealValue("embed.submit")+'"></span>':""},getIconHTML:function(e){var i=ZSIQConversationManager.getChatWinObjById($("#msgarea").attr("txtarea-id")),s=e||i.chatstatus,t=i.isBotChat,a=$Support.EmbedObj.eprops,o=JSON.parse(a.showsmiley)?'<span class="sqico-smile" documentclick="smiley" id="smiley" proptype="smiley" title="'+LSResource.getRealValue("ne.title.emoji")+'"></span>':"",c=CommonUtil.isAllowFileSharing()&&"connected"==s?'<span class="sqico-attach posrel" documentclick="attachfile" title="'+LSResource.getRealValue("ne.action.attachfile")+'">'+this.getSendFileHtml()+"</span>":"";return'<div id="action_icons" proptype="action_icons">'+o+("connected"==s&&$Support.EmbedObj.isvoicenotesallowed&&a.isvoicenotesenabled&&!t?'<span class="sqico-microphone posrel"  id="zsiq-voicenote" documentclick="voicenote" title="'+LSResource.getRealValue("av.info.sendvoicenote")+'"></span>':"")+c+'<span class="sqico-send siq-send-button" id="sqico-send" chatid="{SQICOSEND}" proptype = "sqico-send" documentclick="sendmessage" title="'+LSResource.getRealValue("ne.send")+'"></span></div>'},getUserActionsHTML:function(e){var i=$Support.EmbedObj.eprops;$Support.EmbedObj.isBetaPortal;return['<div class="usractions clearfix">','<div class="txtelips siq-typing-message" id="typgstatus" dochover="setToolTip" tooltip=""></div>','<div class="floatrg usractico">','<span class="sqico-more siq-menu" documentclick="moreaction" proptype="moreaction" id="moreaction"  title="'+LSResource.getRealValue("ne.title.action")+'"></span>','<span class="sqico-end siq-end-chat-button" documentclick="chatend"  title="'+LSResource.getRealValue("ne.title.chatend")+'"></span>',"</div>",'<ul class="mraction" proptype="mraction" id="mraction">',JSON.parse(i.icsound)&&EmbedSound.isPlayerEnable()?this.getSoundHTML(e.soundval):"",JSON.parse(i.icmail)?'<li class="sqico-smailico" documentclick="sendmail" id="sendmail">'+LSResource.getRealValue("ne.action.sendmail")+"</li>":"",JSON.parse(i.icprint)?'<li class="sqico-print" documentclick="printfile">'+LSResource.getRealValue("common.print")+"</li>":"",CommonUtil.isAllowAssist()&&!e.isBotChat?'<li class="sqico-share_screen" documentclick="sharedesktop" id="sharedesktop">'+LSResource.getRealValue("embed.desktop.sharing")+"</li>":"","</ul>","</div>"].join("")},getSoundHTML:function(e){return isUndefined(e)||-1!=e?'<li class="sqico-mute" documentclick="toggleaudio" purpose="sound">'+LSResource.getRealValue("ne.action.mute")+"</li>":'<li class="sqico-unmute" documentclick="toggleaudio" title="'+LSResource.getRealValue("common.unmute.title")+'" purpose="sound">'+LSResource.getRealValue("ne.action.unmute")+"</li>"},getFooterHTML:function(){var e,i=$Support.isFAQEnabled();i&&(e=(($Support.getParent().$ZSIQUtil.getAPIValues()||{}).articlecontent||{}).title||$Support.Util.getFAQLabel());return['<footer class="clearfix'+(i?" faq_footer":"")+'">',$Support.EmbedObj.sm?'<div class="floatlf"><span class="sqico-fb"></span><span class="sqico-tweet"></span><span class="sqico-gplus"></span></div>':"",this.getFreeLogoHTML(),i?'<div class="faqdiv dsp_table"><div class="sel sqico-chat" id="conv-tab" documentclick="showconversation"><span class="txtelips">'+LSResource.getRealValue("ne.conversation")+'</span><span class="disIB"><span class="siqc_eletype"></span></span></div><div class="sqico-faqico" id="faqtab" documentclick="showfaq">'+getEncodedText(e)+"</div></div>":"","</footer>"].join("")},getFreeLogoHTML:function(){var e=$Support.EmbedObj.isreopenenabled?"f-logo":"";return $Support.isAllowFreeLogo()?'<a target="_blank" id="siqfreelogo" href="'+_FREELOGOLINK+'"><div class="flogo '+e+'"><img src="'+CommonUtil.getStaticURL("/salesiq/images/portal/salesiqlogo_732e54c67935842cd738e588c71ac842_.png")+'" class="siq_logo" /><em class="txtelips" title="'+LSResource.getRealValue("ne.litby.freelogo")+'">'+LSResource.getRealValue("ne.litby.freelogo")+"</em></div></a>":""},getSendBtnHTML:function(e){return'<div class="floatrg"><em class="sqico-send siq-send-button" chatid="{SQICOSEND}" id="sqico-send" proptype = "sqico-send">'+(e=e||LSResource.getRealValue("ne.startchat"))+"</em> </div>"},getBannerHTML:function(e,i,s,t){var a='<div class="info_banr'+(i?"":" relate")+' siq-info-banner" id="info_banr" proptype = "info_banr"';return s&&(a+='style="cursor:pointer;" documentclick="'+t.documentclick+'"'+t.attr+'="'+t.value+'"'),a+=">"+e+"</div>"},getSendMailHTML:function(){return['<div class="semail sqico-smailico siq-send-email-section" id="smailbx">','<input type="text" class="siq-input-text-box siq-send-email-input" placeholder="'+LSResource.getRealValue("ne.action.enteremail")+'" info="email" data-validate="optional email" dockeyup="triggermail"/><em class="sqico-smail" documentclick="triggermail" title="'+LSResource.getRealValue("ne.action.sendmail")+'"></em>',"</div>"].join("")},getSendMailConfimHTML:function(e,i){var s=i||"";return['<div class="gltr-cont" id="consentbannerdiv" cattr="sendmailconfirm">','<span class="gltr-desc">'+LSResource.getRealValue("common.gdpr.emaildoubleoptin")+" <em>"+e+"</em></span>",'<div class="gltr-done"><span class="gltr-srno" documentclick="triggermailconfirm" cattr='+e+" chid="+s+" >"+LSResource.getRealValue("common.yes")+'</span><span class="gltr-srno gltr-no" documentclick="triggermailconfirm" >'+LSResource.getRealValue("common.no")+"</span></div>","</div>"].join("")},getSmileyHTML:function(){var e='<div class="smileydiv" id="smileydiv">',i=Smiley.defaultsmileyobj;for(var s in i)e+='<div class="smlynone"><div title="'+i[s]+'" code="'+s+'" class="siqsly-'+i[s]+'"></div></div>';return e+="</div>"},getUserEditHTML:function(e,i){i=i||{};var s=$Support,t=s.EmbedObj,a=t.eprops,o=a.isname[1].ismandatory,c=a.isemail[1].ismandatory,n=a.isphoneno[1].ismandatory,l=t.isformremoval,d=e?LSResource.getRealValue("ne.update"):LSResource.getRealValue("common.continue");s.ismissed&&(d=LSResource.getRealValue("ne.submit"),c="true");var r=' onenter="updateuserdetails"';return['<div id="edituserdetails" class="chtcont maskdiv editfields">',$Support.Util.checkToShowField("isname","siq_name")&&!l?this.getNameHTML(o,r):"",$Support.Util.checkToShowField("isemail","siq_email")&&!l?this.getEmailHTML(c,r):"",$Support.Util.checkToShowField("isphoneno","siq_phone")&&!l?this.getPhoneHTML(n,r):"",l?this.getFieldHTML():"",-1==i.department?'<div id="sqico-drpdwn" tabindex="3" class="sqico-drpdwn siq-dropdown" info="department" data-validate="required"></div>':"","{T&CBANNER}",'<div id="usereditactionbtn" class="actionbtn">','<p id="continue_btn" data_isupdate="'+e+'" class="siq-update-button" documentclick="updateuserdetails" tabindex="-1" onenter="updateuserdetails">'+d+"</p>",'<p class="cancel siq-cancel-button" documentclick="hideuserdetails"  >'+LSResource.getRealValue("common.cancel")+"</p>","</div>","</div>"].join("")},getCaptchaHTML:function(e){return["<div>","<div>"+LSResource.getRealValue("ne.captcha.title1")+"</div>","<p>"+LSResource.getRealValue("ne.captcha.title2")+"</p>","<div>"+CommonUtil.getCaptcha(e)+'<span class="sqico-captcha"  documentclick="captcha"></span></div>','<input type="text" class="siq-input-text-box" value="" purpose="'+e+'" dockeydown="captcha">','<div class="actionbtn">','<p documentclick="captcha">'+LSResource.getRealValue("ne.submit")+"</p>","</div>","</div>"].join("")},getWaitingTextHTML:function(e){return['<div class="info_banr timer siq-info-banner" proptype = "info_banr" id="info_banr">','<span class="">'+DynamicMsg.fillValues($Support.EmbedObj.waitmsg)+"</span>",'<span class="sqico-timer siq-info-timer" id="wait_div">'+MyDate.formatMS(1e3*e)+"</span>","</div>"].join("")},getInfoHTML:function(e,i){return'<div class="infomsg '+(i=i||"")+' siq-info-message">'+e+"</div>"},getFeedbackHTML:function(e){var i=$Support.EmbedObj.ratingtitle?$Support.EmbedObj.ratingtitle:LSResource.getRealValue("ne.rating.byline");return['<div class="sqfdbk maskdiv siq-feedback-section" isonlyrating="'+e+'" fdbkarea-id="{FDBKAREAID}" proptype="feedbackcontainer">','<div class="fdbk_cnt" proptype="fdbk_wrapper">',"<div>",'<div class="clblck">'+LSResource.getRealValue(e?"ne.rating.alone":"ne.rating")+"</div>",'<div class="rating reactions">'+this.getStarHTML()+"</div>",'<div class="clblck fd-byline">'+i+"</div>","</div>",e?"":'<textarea dockeyup="feedback" id="fdbkarea" dockeydown="textarea"   proptype = "fdbkarea" class="siq-feedback-textarea" data-validate="required" placeholder="'+LSResource.getRealValue("ne.feedback.title")+'"></textarea>'+this.getSendIcon("",!0),"</div>",'<em class="sqico-close" title="'+LSResource.getRealValue("common.close")+'" documentclick="hidefeedback"></em>',"</div>"].join("")},getFeedbackOnlyHTML:function(e){return['<div class="sqfdbk maskdiv fdbk_aln" fdbkarea-id="{FDBKAREAID}" proptype="feedbackcontainer">','<div class="clblck">'+LSResource.getRealValue("ne.feedback")+"</div>",'<div class="fdbk_cnt" proptype="fdbk_wrapper">','<textarea dockeyup="feedback" dockeydown="textarea" proptype = "fdbkarea" id="fdbkarea" class="feedback-textarea" data-validate="required" placeholder="'+LSResource.getRealValue("ne.feedback.title")+'"></textarea>'+this.getSendIcon("",!0),"</div>","</div>"].join("")},getStarHTML:function(e){var i={sad:{classname:"sad_icon"},neutral:{classname:"neutral_icon"},happy:{classname:"happy_icon"}},s="";for(var t in i){var a=e==t?" sel":"";s+='<span class="reaction_ico '+i[t].classname+a+'" data-reaction="'+t+'" documentclick="rating" title="'+LSResource.getRealValue("common."+t)+'"></span>'}return s},getSendFileHtml:function(){$Support.EmbedObj;return'<input name="file1" type="file" multiple size="1" class="embdinpfile" docchange = "attachment" id="embdfileupload"  proptype="embdfileupload" title="'+LSResource.getRealValue("chat.actions.filesharing")+'" onclick="this.value=\'\'"/>'},getDragDropHTML:function(){return'<div class="dragmask siq-dragdrop-mask" id="dragmask"><em>'+LSResource.getRealValue("ne.dropfile")+"</em></div>"},getPreviewHTML:function(){return['<div class="imgprev siq-image-preview" id="fileintex-FILEINDEX" purpose="fileupload">','<div class="cmtbx">','<div contenteditable="false"><input type="text" dockeydown="pasteimage" class="file-name" purp="name" data-validate="required"/></div>','<p id="pasteimage"></p>','<textarea id="pasteimgcomment" class="siq-comment-textarea" mcount="200" purp="comment" dockeyup="handlepasteimage" placeholder="'+LSResource.getRealValue("ne.imgcomment")+'"></textarea>','<em class="floatrg clr999 messagecount">200</em>',"</div>",'<div class="actionbtn">','<p class="siq-update-button" class="siq-update-button" documentclick="imgupload">'+LSResource.getRealValue("common.upload")+"</p>",'<p class="cancel siq-cancel-button" documentclick="imgcancel">'+LSResource.getRealValue("common.cancel")+"</p>","</div>","</div>"].join("")},getCCheckBxHTML:function(e){var i=e.options,s=getEscapedText(e.name)||"",t=($Support.EmbedObj,"");if(ZSIQConversationForm.isOldFormView()){for(var a='<div custombx="true" customid="'+s+'">'+this.getCustomWrap(e),o=0;o<i.length;o++){var c=i[o];t=e.defaultvalue==c.value?"checked":"";var n=getEscapedText(c.text);a+="<div>",a+='<input type="checkbox" id="'+(l=getEscapedText(c.value))+'" name="'+s+'" value="'+l+'" '+t+">",a+='<label for="'+l+'" class="siq-checkbox-label"><span class="sqico-chkbx siq-checkbox"></span>'+n+"</label></div>"}return a+="</div></div>"}for(a="",o=0;o<i.length;o++){var l;c=i[o],n=getEscapedText(c.text);a+='<span class="posrel"><input type="checkbox" class="hide_fld" id="'+(l=getEscapedText(c.value))+'" name="'+s+'" value="'+l+'"><span class="checkbox sqico-checkbox siq-check"><label for="'+l+'" class="curP dib-mid">'+n+"</label></span></span>"}return'<div class="field_main posrel pL15" field-type="checkbox" custombx="true" customid="'+s+'">'+$Temp.getCustomWrap(e)+"<div>"+a+"</div></div></div>"},getCRadioHTML:function(e){var i=e.options,s=getEscapedText(e.name)||"",t=($Support.EmbedObj,"");if(ZSIQConversationForm.isOldFormView()){for(var a='<div custombx="true" customid="'+s+'">'+this.getCustomWrap(e),o=0;o<i.length;o++){var c=i[o];t=e.defaultvalue==c.value?"checked":"";var n=getEscapedText(c.text);a+="<div>",a+='<label class="mR10 c000">',a+='<input type="radio" id="'+(l=getEscapedText(c.value))+'" name="'+s+'" '+t+">",a+='<span class="sqico-radio mR10"></span>'+n+"</label></div>"}return a+="</div></div>"}for(a="",o=0;o<i.length;o++){var l;c=i[o],n=getEscapedText(c.text);a+='<span class="posrel"><input type="radio" class="hide_fld" id="'+(l=getEscapedText(c.value))+'" name="'+s+'" value="'+l+'"><span class="checkbox sqico-radio siq-radio"><label for="'+l+'" class="curP dib-mid">'+n+"</label></span></span>"}return'<div class="field_main posrel pL15" field-type="radio" custombx="true" customid="'+s+'">'+$Temp.getCustomWrap(e)+"<div>"+a+"</div></div></div>"},getCustomWrap:function(e){e.options;var i=getEscapedText(e.name)||"",s=$Temp.getRequiredHTML(e.required);ZSIQConversationForm.isOldFormView()&&(s=JSON.parse(e.required)?$Temp.getRequiredHTML("*"):"");var t='<span class="field_lable font14">'+getEscapedText(e.hint)+s+"</span>",a=CommonUtil.parseToJSON(e.required)?'iserrorfield="true"':"";return t+='<div class="custombtn" purpose="custom" type="'+e.type+'" visibility="'+e.visibility+'" custom="'+i+'" '+$Temp.getCustomAttr(e)+' data-validate="" '+a+">"},getRequiredHTML:function(e){$Support.EmbedObj;if(ZSIQConversationForm.isOldFormView()){var i=e||"";return'<em class="req siq-required" title="'+LSResource.getRealValue("ne.required")+'">'+i+"</em>"}return CommonUtil.parseToJSON(e)?'<em class="mL5 req">*</em>':""},getCInputHTML:function(e){var i=getEscapedText(e.name)||"";$Support.EmbedObj;if(ZSIQConversationForm.isOldFormView()){var s=e.defaultvalue?' value="'+e.defaultvalue+'" ':"",t=e.required&&JSON.parse(e.required)?$Temp.getRequiredHTML():"";return['<div custom="'+i+'" type="'+e.type+'" customid="'+i+'" custombx="true" >','<input type="text" class="siq-input-text-box" docblur="custominput" purpose="custom" visibility="'+e.visibility+'" '+this.getCustomAttr(e)+s+" >"+t,"</div>"].join("")}var a=getEscapedText(e.hint)||i;return'<div custom="'+i+'" type="'+e.type+'" customid="'+i+'" custombx="true" class="field_main posrel" field-type="text"><input type="text" class="input_field font15" value="" info="email" purpose="custom" visibility="'+e.visibility+'" '+$Temp.getCustomAttr(e)+' docfocus="inputFocus" dockeydown="removeError" docblur="custominput"/><span class="field_title font15">'+a+$Temp.getRequiredHTML(e.required)+"</span>"+$Temp.getFetchMailHTML()+"</div>"},getCustomAttr:function(e){e.options;var i=getEscapedText(e.name)||"",s=getEscapedText(e.hint)||i,t=CommonUtil.parseToJSON(e.required)?"required":"optional",a=e.type?e.type:"text",o=e.maxlength||("url"==e.type||"textarea"==e.type?100:30),c=e.minlength?'minlength="'+e.minlength+'"':"",n=t+" "+a;$Support.EmbedObj;if(ZSIQConversationForm.isOldFormView())return'placeholder="'+s+'" id="'+i+'" mandatory="'+e.required+'" custom="'+i+'" name="'+i+'" data-validate="'+n+'" autocomplete="off" maxlength="'+o+'" '+c+' info="'+a+'"';var l=CommonUtil.parseToJSON(e.required)?'iserrorfield="true"':"";return'id="'+i+'" mandatory="'+e.required+'" '+l+' custom="'+i+'" name="'+i+'" data-validate="'+n+'" autocomplete="off" maxlength="'+o+'" info="'+a+'"'},getCDropDwnHTML:function(e){var i=getEscapedText(e.name)||"",s=($Support.EmbedObj,e.value?' val="'+e.value+'" ':"");return ZSIQConversationForm.isOldFormView()?'<div id="sqico-cdrpdwn'+e.index+'" class="sqico-drpdwn siq-dropdown" customid="'+i+'" custombx="true" custom="'+i+'" type="selectbox" visibility="'+e.visibility+'" purpose="custom" '+this.getCustomAttr(e)+s+"></div>":'<div class="field_main posrel" field-type="dropdown"><div id="sqico-cdrpdwn'+e.index+'" class="dropdown mT20 sqico-drpdwn siq-dropdown" customid="'+i+'" custombx="true" custom="'+i+'" type="selectbox" visibility="'+e.visibility+'" purpose="custom" '+this.getCustomAttr(e)+"></div></div>"},getCTextareaHTML:function(e){var i=getEscapedText(e.name)||"";$Support.EmbedObj;if(ZSIQConversationForm.isOldFormView()){var s=CommonUtil.parseToJSON(e.required)?$Temp.getRequiredHTML():"",t=e.defaultvalue?e.defaultvalue:"";return['<div custom="'+i+'" custombx="true" customid="'+i+'"  type="'+e.type+'"  visibility="'+e.visibility+'">','<textarea type="text" docblur="custominput" visibility="'+e.visibility+'" purpose="custom" '+this.getCustomAttr(e)+" >"+t+"</textarea>"+s,"</div>"].join("")}var a=getEscapedText(e.hint)||i;return'<div custom="'+i+'" type="'+e.type+'" customid="'+i+'" custombx="true" class="field_main posrel" field-type="textarea"><textarea type="text" class="input_field font15" value="" info="email" purpose="custom" visibility="'+e.visibility+'" '+this.getCustomAttr(e)+' docfocus="inputFocus" dockeydown="removeError" docblur="custominput"></textarea><span class="field_title font15">'+a+$Temp.getRequiredHTML(e.required)+"</span>"+$Temp.getFetchMailHTML()+"</div>"},getCLabelHTML:function(e){return e.hint?'<div class="subtitle mT10 lH20 pL15 c333" customid="'+(getEscapedText(e.name)||"")+'" custombx="true" '+$Temp.getCustomStyle(e)+">"+getEscapedText(e.hint)+"</div>":""},getCustomStyle:function(e){var i=e.Style||e.style,s="";if(i)for(var t in i)s+=t+":"+i[t]+";";return s?'style="'+s+'"':""},getCloseHTML:function(){return'<em class="sqico-close siq-close-icon" proptype = "closewindow" documentclick="close_iframe" title="'+LSResource.getRealValue("common.close")+'"></em>'},getChatEndHTML:function(e,i){i=i||{};var s=$Support.EmbedObj;return['<div class="infomsg chtend siq-info-message">'+(s.chatendmessage||(s.isreopenenabled?LSResource.getRealValue("ne.chatend.reopen",'documentclick="showreopenchatui"'):LSResource.getRealValue("ne.chatend",'documentclick="restartchat"'))),'<div class="chtlnks">',JSON.parse(s.eprops.icmail)&&!e?'<a href="javascript:;" class="sqico-smailico" documentclick="sendmail" id="chatendmail" chid="'+i.chid+'" visitorid="'+i.vid+'">'+LSResource.getRealValue("ne.email.transcript")+"</a>":"","</div>","</div>"].join("")},getBusnsInfoHTML:function(e){return["<div>"+LSResource.getRealValue("ne.offlinemsg")+"</div>","<div>"+LSResource.getRealValue("ne.busnshr")+' : <em class="fnt13">Monday to Friday '+e+"</em></div></div>"].join("")},getGroupIconHTML:function(){return'<span class="sqico-grpico"></span>'},getWaitHandlerHTML:function(){return['<div class="waitmsg" id="cwaitmsg">'+$Support.cwaitmsg,"</div>"].join("")},getConversationContainerHTML:function(){return'<section class="siqc_body sli_view siq_content" id="conversioncontainer" style="display:none;"><div docwheel="handlescroll" id="pastchatconv_main"><div id="currchatconv"></div><div id="pastchatconv"></div></div></section>'},getConversationHistoryHTML:function(e){$Support.EmbedObj;var i=e.attender_imgkey&&$Support.isUserLogoEnabled(e)?_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/userimg/"+e.attender_imgkey+"/photo.ls?nocache=1":"";!e.attender_imgkey&&e.isbotattender&&(i=ZSIQTranscript.getImageURL(JSON.parse(e.lastmsg)));var s=e.attender,t="";e.chid||e.attender?e.attender&&!e.transfer_missed||(s=LSResource.getRealValue("conversation.missedchat"),t=" sqico-missed",i=""):(s=LSResource.getRealValue("conversation.offlinechat"),t=" sqico-offline");var a=Message.getDisplayContent(e.question),o=!1,c="";if(e.lastmsg){var n=JSON.parse(e.lastmsg);if(o=$Support.Util.isAnnonUser(n.sender),n=n.msg){if("object"==typeof n)"cannedarticle"===n.mode?a=$FAQ.getHeaderMessage(n.msg):n.fName&&(a=n.fName,c=$Support.Util.getFileClassType(n.content));else if(a=Message.getDisplayContent(n),o||(a=Markdown.apply(a)),"string"==typeof n)try{JSON.parse(JSON.parse(n).mode&&"MEDIA"===JSON.parse(n).mode)&&(a=Message.getAVMessageBlock(JSON.parse(n),!0))}catch(e){}a=c?'<em class="'+c+'">'+a+"</em>":a,a=o?LSResource.getRealValue("common.you")+": "+a:a}}return['<div class="siqc_cntbody" '+(e.chid?'chid="'+e.chid+'"':"")+' visitorid="'+e.visitorid+'" documentclick="fetchconvtranscript">','<div class="siqc_usrimg'+t+'">','<img src="'+i+'" onload="$Support.Util.handleBlurImage(this)"><div class="sqico-user convrstn-usr wincustom_bg"></div>',"</div>",'<div class="siqc_msg">','<span class="txtelips">'+getEncodedText(s)+"</span>",'<div id="desc7" class="siqc_cusmsg">'+a+"</div>","</div>",'<div id="status7" class="siqc_duration" convmtime="'+e.endtime+'">'+MyDate.timeDifference(e.endtime)+'<em class="siqc_eletype"></em></div>',"</div>"].join("")},getCallFAQHtml:function(){return'<div id="showsiqchatui" class="siqc_edt zsiq-faqcal textC" style="display:none;"><div class="siq-fcal sqico-bubchat" documentclick="showchatui"></div> <div class="siq-fcal sqico-call" onclick="CallImpl.startCall()"></div><div class="siq-fcal sqico-plus" ></div></div>'},getConversationCreateChatIConHTML:function(){return'<aside class="siqc_edt sqico-createchat wincustom_bg" id="showsiqchatui" documentclick="showchatui" title="'+LSResource.getRealValue("conversation.newconversation")+'" style="display:none;"></aside>'},getConversationTranscriptContainerHTML:function(){var e=$Support.EmbedObj;return['<section class="siqc_hstrycht siq_content '+($Support.isSignature(e)?" algn_hgt":"")+'" docwheel="handlescroll" style="display:none;">',"</section>"].join("")},getLoadingHTML:function(){return'<div class="siqc-progress siqc-float siqc-shadow" id="convloadingui"><div class="siqc-progress-item"></div></div>'},getConversationListLoadingHTML:function(){return'<div class="siqc_cntbody siqc-loader" id="convlistloading"><div class="siqc-progress siqc-float"><div class="siqc-progress-item"></div></div></div>'},getchatWaitingUIinConversation:function(e){$Support.EmbedObj;return['<div class="siqc_cntbody" id="conv'+e.chatID+'" chid="'+e.chatID+'" visitorid="'+e.visitorID+'" documentclick="showchatui">','<div class="siqc_usrimg">','<img id="convchatattenderimg" propval = "convchatattenderimg" src="" onload="$Support.Util.handleBlurImage(this)">','<div class="sqico-user convrstn-usr wincustom_bg"></div>',"</div>",'<div class="siqc_msg">','<span id="convchatattendername" propval = "convchatattendername" class="txtelips"></span>','<p id="convmsg" propval = "convmsg" class="siqc_cusmsg">'+getEscapedText(e.question)+"</p>","</div>",'<div class="siqc_duration"><em id="convwtime" propval = "convwtime"></em><span><em class="siqc_eletype"></em></span></div>',"</div>"].join("")},getPopUpMessageInconversation:function(e,i,s,t){return['<div class="proactv_chat" id="convpopupmsg" documentclick="showchatui" chid="'+t+'">','<div class="siqc_usrimg">','<img src="'+s+'" onload="$Support.Util.handleBlurImage(this)">','<div class="sqico-user convrstn-usr wincustom_bg"></div>',"</div>",'<div class="siqc_msg">','<span class="txtelips">'+getEncodedText(e)+'</span><p id="desc1" class="siqc_cusmsg">'+i+"</p>","</div>",'<em class="sqico-clear" id="removeconvpopup" documentclick="removeconvpopupmsg" title="'+LSResource.getRealValue("common.close")+'"></em>',"</div>"].join("")},getPopUpAlertInconversation:function(e,i,s,t){return['<div class="proactv_chat" id="convpopupmsg" documentclick="showchatui">','<div class="siqc_usrimg">','<img src="'+t+'" onload="$Support.Util.handleBlurImage(this)">','<div class="sqico-user convrstn-usr wincustom_bg"></div>',"</div>",'<div class="siqc_msg">','<span class="txtelips">'+getEncodedText(e)+'</span><p id="desc1" class="siqc_cusmsg">'+getEncodedText(i)+"</p>",'<div id="alerttimer" class="siqc_duration">'+s+"</div>","</div>",'<em class="sqico-clear" id="removeconvpopup" documentclick="removeconvpopupmsg" title="'+LSResource.getRealValue("common.close")+'"></em>',"</div>"].join("")},getPopUPInfoMessageInConversation:function(e,i){return['<div class="proactv_chat" id="convpopupmsg" documentclick="showchatui" chid="'+i+'">','<div class="siqc_msg">','<p id="desc1" class="siqc_cusmsg siqc_cusmsg_info">'+e+"</p>","</div>",'<em class="sqico-clear" id="removeconvpopup" documentclick="removeconvpopupmsg" title="'+LSResource.getRealValue("common.close")+'"></em>',"</div>"].join("")},getOutgoingcallUI:function(e,i){var s="",t="";return null==e||""==e?t="<em class='sqico-person'></em>":s="<img src="+(e=e.split("?")[0])+">",null==i&&(i=""),['<div class="zsembd_audiocl textC">','<nav class="zsembd_usrprof zsembd_calrng">','<div class=" sqico-personimg">',s,t,"</div>","</nav>",'<span class="zsembd_adodesc txtelips">'+i+'<em class="txtelips font14">'+LSResource.getRealValue("av.info.calling")+"</em></span>",'<div class="cal_actns">','<div id="audiocall_mute" class="sqico-microphone" onclick="avimpl.toggleMute(this)" title='+LSResource.getRealValue("av.info.mute")+"></div>",'<div class="sqico-call reject-cal" onclick="avimpl.terminateAudioCall();"></div></div>',"</div>"].join("")},getReconnectionUI:function(e,i,s){var t="",a="";return null==e||""==e?t="sqico-person":a="<img src="+(e=e.split("?")[0])+">",['<div class="zsembd_audiocl textC reconnect" id="call_reconnection">','<nav class="zsembd_usrprof">','<div class="'+t+' sqico-personimg">',a,"</div>","</nav>",'<span class="zsembd_adodesc txtelips">'+s+'<em class="txtelips font14">'+LSResource.getRealValue(i)+"</em></span>",'<div class="cal_actns">','<div id="audiocall_mute" class="sqico-microphone" onclick="avimpl.toggleMute(this)" title='+LSResource.getRealValue("av.info.mute")+"></div>",'<div class="sqico-call reject-cal" onclick="avimpl.terminateAudioCall();"></div></div>',"</div>"].join("")},getConnectionDisconnectedUI:function(e,i){var s="",t="";return null==e||""==e?s="sqico-person":t="<img src="+(e=e.split("?")[0])+">",['<div class="zsembd_audiocl textC reconnect" id="call_connectiondisconnected">','<nav class="zsembd_usrprof">','<div class="'+s+' sqico-personimg">',t,"</div>","</nav>",'<span class="zsembd_adodesc txtelips">'+$Support.EmbedObj.attendername+'<em class="txtelips font14">'+LSResource.getRealValue(i)+"</em></span>",'<div class="cal_actns">','<div id="audiocall_mute" class="sqico-microphone" onclick="avimpl.toggleMute(this)" title='+LSResource.getRealValue("av.info.mute")+"></div>",'<div class="sqico-call reject-cal" onclick="avimpl.terminateAudioCall();"></div></div>',"</div>"].join("")},getUserBusyUI:function(e,i){var s="",t="";return null==e||""==e?s="sqico-person":t="<img src="+(e=e.split("?")[0])+">",['<div class="zsembd_audiocl textC" id="call_Busy">','<em class="sqico-close" onclick="avimpl.clear();"></em>','<nav class="zsembd_usrprof">','<div class="'+s+' sqico-personimg">',t,"</div>","</nav>",'<span class="zsembd_adodesc txtelips">'+i+'<em class="txtelips font14">'+LSResource.getRealValue("av.info.userbusy")+"</em></span>",'<div class="cal_actns">','<div class="call-record" title="'+LSResource.getRealValue("av.info.voicemessage")+'" onclick="avimpl.showAudioRecorder();"></div>','<div class="sqico-call" onclick="avimpl.startCall();"></div></div>',"</div>"].join("")},getAudioCallUI:function(e,i){var s="",t="";return null==e||""==e?t="<em class='sqico-person'></em>":s="<img src="+(e=e.split("?")[0])+">",['<div class="zsembd_audiocl textC">','<nav class="zsembd_usrprof zsembd_calrng">','<div class="sqico-personimg">',s,t,"</div>","</nav>",'<span class="zsembd_adodesc txtelips"><em class="txtelips font14">'+LSResource.getRealValue("av.info.callfrom")+"</em>"+i+"</span>",'<div class="cal_actns">','<div class="sqico-call" onclick="avimpl.acceptCallInvite();"></div>','<div class="sqico-call reject-cal" onclick="avimpl.rejectCallInvite();"></div></div>',"</div>"].join("")},getOnCallUI:function(e,i){var s="",t="";return null==e||""==e?s="sqico-person":t="<img src="+(e=e.split("?")[0])+">",['<div class="zsembd_audiocl textC">','<nav class="zsembd_usrprof\t">','<div class="'+s+' sqico-personimg" >',t,"</div>","</nav>",'<span class="zsembd_adodesc txtelips">'+i+'<em class="txtelips font14" id="sqico-timer"></em></span>','<div class="cal_actns">','<div id="audiocall_mute" class="sqico-microphone" onclick="avimpl.toggleMute(this)" title='+LSResource.getRealValue("av.info.mute")+"></div>",'<div class="sqico-call reject-cal" onclick="avimpl.stopOngoingCall();"></div></div>',"</div>"].join("")},getStartRecordUI:function(e){var i="";return null==e||""==e?"sqico-person":i="<img src="+(e=e.split("?")[0])+"  alt="+$Support.EmbedObj.attendername+">",['<div class = "zsiq_media_headshot_main" id="user_busy">','<div class="zsiq_media_headshot">',' <div class="zsiq_media_cirview">','<div class="zsiq_media_userimg">',i,"</div>",'<div class="zsiq_media_detail">','<div class="zsiq_media_elips zsiq_media_name">'+$Support.EmbedObj.attendername+"</div>",'<div class="zsiq_media_elips" id="sqico-timer" ></div>','<div class="zsiq_media_embd-calrec">',"</div>",' <div class="siq_media_btns siq_media_flexM">','<div class="zsiqmico-stop zsiq_media_wbtn"></div>'," </div>"," </div>","</div>","</div>"].join("")},getAudioRecordedUI:function(e,i,s,t){var a="";return null==e||""==e?"sqico-person":a="<img src="+(e=e.split("?")[0])+"  alt="+i+">",['<div class = "zsiq_media_headshot_main" id="user_busy" style="top:'+s+"px;left:"+t+'px;">','<div class="zsiq_media_headshot">',' <div class="zsiq_media_cirview">','<span class="zsiqmico-close" cntrl="cancelRecord"></span>','<div class="zsiq_media_userimg">',a,"</div>",'<div class="zsiq_media_detail">','<div class="zsiq_media_elips zsiq_media_name">'+i+"</div>",'<div class="zsiq_media_elips" id="sqico-timer"></div>','<div class="zsiq_media_embd-calrec" id="sqico-canvas">',"</div>",' <div class="siq_media_btns siq_media_flexM">','<div class="zsiqmico-record zsiq_media_wbtn" title="'+LSResource.getRealValue("av.info.voicemessage")+'" cntrl="settings" ></div>','<div class="zsiqmico-play zsiq_media_wbtn zsiq_media_mL13" cntrl="playRecord" ></div>','<div class="zsiq_media_wbtn" cntrl="stopRecord" ></div>'," </div>"," </div>","</div>","</div>"].join("")},getTranslateBannerHTML:function(e,i){var s="<a class='siq-lnmor sbold' target='_blank' id='gtconsenturl'> "+LSResource.getRealValue("helplink.learnmore")+"</a>";return['<div class="gltr-cont" id="consentbannerdiv" cattr="gtranslateconsent" ><span class="gltr-desc">'+LSResource.getRealValue("common.gdpr.agent.translateinfo")+"<em> "+LSResource.getRealValue("common.gdpr.gtranslatehead")+'<div class="gltr-bgimg"></div></em>'+s+'</span><div class="gltr-done mT10"><div documentclick="updatetranslatecookie" class="bot_opt gltr-srno" >'+LSResource.getRealValue("common.okay")+"</div></div></div>"].join("")},handleStartChatBTN:function(e){var i=$.isEmptyObject(e)?$Support.contentdiv:e.contentdiv;i.find('[proptype="action_icons"]').length||i.find('[proptype="smilelist"]').after('<div id="action_icons" proptype="action_icons"><span class="sqico-send siq-send-button" id="sqico-send" txtarea-id="'+e.winid+'" proptype = "sqico-send" title="'+LSResource.getRealValue("ne.send")+'"></span></div>')},handleMissedChatBtns:function(e){var i=$Support.EmbedObj,s=$.isEmptyObject(e)?$Support.contentdiv:e.contentdiv;if(!s.find('[proptype="action_icons"]').length){var t=i.isvoicenotesallowed&&i.eprops.isvoicenotesenabled?'<span class="sqico-microphone posrel"  id="zsiq-voicenote" documentclick="voicenote" title="'+LSResource.getRealValue("av.info.sendvoicenote")+'"></span>':"";s.find('[proptype="smilelist"]').after('<div id="action_icons" proptype="action_icons">'+t+'<span class="sqico-send siq-send-button" id="sqico-send" txtarea-id="'+e.winid+'" proptype = "sqico-send" title="'+LSResource.getRealValue("ne.send")+'"></span></div>')}},getSnowHTML:function(){return $Support.isSeasonalTheme()?'<div id="snow"><div class="snow_anim1 anim1 size1"> </div><div class="snow_anim2 anim2 size2"> </div><div class="snow_anim1 anim3 size3"> </div><div class="snow_anim2 anim4 size1"> </div><div class="snow_anim1 anim5 size2"> </div><div class="snow_anim1 anim6 size3"> </div><div class="snow_anim2 anim7 size1"> </div><div class="snow_anim1 anim8 size2"> </div><div class="snow_anim2 anim9 size3"> </div><div class="snow_anim1 anim10 size1"> </div></div>':""},getSantaCap:function(){if(!$Support.isSeasonalTheme())return"";return'<em class="santacap"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 331.9 209.8" style="enable-background:new 0 0 331.9 209.8;" xml:space="preserve"><path class="st0" d="M330.9,145.6c-0.4,0.2-0.8,0.3-1.2,0.3l-11.3,0.2l-5.9,9.6c-0.5,0.9-1.5,1.3-2.5,1.2c-1-0.1-1.9-0.8-2.2-1.8l-4-10.9l-11-3.1c-1-0.3-1.7-1.1-2-2.1c-0.2-1,0.1-2,0.9-2.7l8.8-6.9l-0.9-11.5c-0.1-1,0.4-2,1.3-2.5l0,0c0.9-0.5,1.9-0.4,2.8,0.2l9.5,6.6l10.5-4c0.9-0.4,2-0.1,2.8,0.6s1.1,1.8,0.8,2.8l-2.9,11l7.3,9c0.6,0.8,0.8,1.9,0.4,2.8C331.7,144.9,331.3,145.3,330.9,145.6z"/><path class="st1" d="M260.7,66.3c0,0-7,2.9-12.3,13.5c-3.6,7.3-7.9,18.4-4.6,26.7c3.6,9,10.9,24.5,36.8,25.4c22.9,0.7,40.2-25.1,40.6-34.8c0.4-9.6-4.5-21.2-8.8-26.2c-5.8-6.8-6.1-10-12.9-11.4c-9.7-1.9-19.6-2.4-28.7,1.7C267,63,263,64.9,260.7,66.3z"/><g><path class="st2" d="M305,61.9c15.7,57.1-54,57.8-52.7,59c31.1,30,64.2-6.7,64.1-6.7C332.9,89.2,305,61.9,305,61.9z"/><path class="st2" d="M216.9,52.9c10.1,0.3,24.1,18.1,32.9,24.4c5.1-8.6,10.9-11,10.9-11c2.3-1.4,6.3-3.3,10.1-5.1c0.9-0.4,1.9-0.8,2.8-1.1c0.4-1.6,0.9-3.2,1.3-5C287.8,4.7,204.7-1.1,172.4,0.4c-32.3,1.4-84.5,49.9-97.6,58.5c-13.1,8.6-20.3,28.4-28.2,43.6c-8,15.2-6.9,22.6-20.4,37.4c-8.7,9.6-19,27-25.2,38.1c-2.7,4.9,0.4,11,6,11.6c48.3,5.4,217.2,24.2,216.4,19.5c-0.7-5.2-3.4-6.5-3-12.1c0.5-5.6,0.4-11.8-6.6-23.6s-2.7-16-2.1-31.2c0.6-15.2-6-10.1-10.5-17.2c-4.6-7.1,5.7-8.6,7.7-19.7c2-11.1,1.3-24.7-1.5-31.7S205.1,52.6,216.9,52.9z"/></g><g class="st3"><path class="st4" d="M271.8,30c-9.2-13.5-18.6-15.5-24.8-18.5c-6.2-3-22.4-8.1-27.5-8.5c-5.1-0.4-24.8-1.9-28-2.1s-2.3,5.6,2.1,6.5c4.4,1,44.9,6.6,53.3,13c8.5,6.4,17.5,13.5,20.1,21.4c2.6,7.8,3.4,22.5,4.8,21.4C271.8,63.2,281,43.5,271.8,30z"/><path class="st4" d="M51.2,114.2c3.8-7.4,14.4-20.7,16-25c1.6-4.4,8.7-13.4,12.9-18.2s12.5-13.7,20.2-22.1c7.7-8.4,14.5-14.2,23.1-17.4c8.5-3.2,6.3-7.8-0.1-7.7c-6.4,0.1-22.2,15.5-26.4,19.7S82.3,58.4,74.3,62.9s-9.6,15.9-13.9,22.6C56,92.2,42.5,118.6,40,126.1c-2.5,7.4-10.6,13.2-10.6,13.2C32.6,139.6,47.4,121.5,51.2,114.2z"/><path class="st4" d="M202.8,188.6c-2.4-2.3,14.8,6.9,3.4-2.9c-0.3-0.3-0.7-0.5-1.1-0.8c0.8,0.1,12.7,1,10.9-4.6c-2-6.2-12.1-12.8-11.7-20.4c0.4-7.6,6.2-20.1,0.1-25.5c-6.1-5.4-9.3-4.3-9.6-10.7s6.9-9.8,8.3-13c1.4-3.1,3.2-24.7,1.1-36.4c-1.2-6.5-2.1-9.1-5-10.4c-5-2.2-10.8-1.2-13.5,1.2c-2.7,2.4-33.1,10.4-44.4,7.9c-11.4-2.5-5-8.4-8.7-10.5c-3.7-2.1-23.2,22.9-15,24.6s29.2,2.8,40.4,9.1c5.4,3,9.3,7.5,11.9,12.6c-6.1-0.5-13.5-1-22.7-1.8c-14-1.1-16.8-5.8-26.2-8.4c-9.4-2.6-23.8-6.3-27.1-5.3c-11.2,3.5,23.7,16.5,45.9,18.2c20.8,1.6,25.4,2,32.2,2.5c1.3,4,1.8,8.3,1.6,12.4c-0.6,11.5,4.1,18.7,7.4,29.7c3.2,11,3.6,16.8,2.8,19.9c-0.1,1.9,1.3,3.3,3.9,4.6c-6.7-0.8-14.3-1.2-22-1.4c0.1-3.5-0.4-12.5-8.8-19.3c-4.6-3.7-9.8-6.6-15-9c-0.3-1.4-1.4-4-4.3-6.5c-4.2-3.5-15.1-3.7-24.6-4.4c-9.5-0.8-22.8-1.8-35.5-3.4C64.9,135,33,142.1,33,142.1c-5.7,0.2-9,8.9-3,6.3c0,0,0,0,0,0c0.5,5.1,25.1,15.2,38.1,20.1c10.5,3.9,33.5,4.6,57.6,11.3c-1.3,0.1-2.1,0.1-2.1,0.1c1.4,0.1,2.9,0.3,4.6,0.6c4.9,1.4,9.8,3.1,14.6,5.2c8.6,3.6,14.1,4.9,17.7,4.7c23.9,8.7,49.4,18.9,55.7,14.5C226.4,197.8,205.2,190.9,202.8,188.6z M49.1,144.5c5.1-0.4,11.8-2.2,18-2.9C61.9,142.5,57.2,144.4,49.1,144.5z"/></g><g><path class="st5" d="M220.5,197c0.5-5.6,0.4-11.8-6.6-23.6c-7-11.8-2.7-16-2.1-31.2c0.6-15.2-6-10.1-10.5-17.2c-4.6-7.1,5.7-8.6,7.7-19.7c2-11.1,1.3-24.7-1.5-31.7s-2.3-21,9.5-20.7s29.1,24.8,36.9,26.5c7.8,1.8,8.2,26.1,21.1-24.3C287.9,4.7,204.8-1.1,172.5,0.4C140.2,1.8,88,50.3,74.9,58.9c-13.1,8.6-20.3,28.4-28.2,43.6c-8,15.2-6.9,22.6-20.4,37.4c-8.8,9.6-19.2,27.3-25.4,38.4c-2.7,4.8,0.4,10.7,5.8,11.3c47.9,5.3,217.5,24.2,216.8,19.5C222.8,203.9,220.1,202.6,220.5,197z"/><path class="st5" d="M305,61.9c15.7,57.1-54,57.8-52.7,59c31.1,30,64.2-6.7,64.1-6.7C332.9,89.2,305,61.9,305,61.9z"/></g></svg><em class="santacapbg"></em></em>'},getAskMediaPermission:function(e){var i="zsiq-"+e;return"Chrome"==e&&(i=""),'<div class="zsiq_prv_main zsiq-cal-turtrp" onclick="$ZSIQUtil.getIframe().avimpl.closeViewMediaPermission();"><div class="zsiq-cal-hnt-cont zsiq-isblk '+i+'"  ><div class="zsiq-trtp-anim "></div><span class="siqico-arrow zsiq-arrow"></span><div>'+LSResource.getRealValue("av.info.pleasetaponlock","<em class='siqico-lock'></em>")+"</div><p>("+LSResource.getRealValue("common.or")+")</p><div>"+LSResource.getRealValue("av.info.enablemicrophonesetting")+'</div><div class="calndr-sedulbtn" style=""  onclick="$ZSIQUtil.getIframe().avimpl.viewBrowserSettingsMediaPermission();"> '+LSResource.getRealValue("chatwindow.mailcopy.clickhere")+" </div></div></div>"},getMediaSetting:function(e){var i="zsiq-"+e;return"Chrome"==e&&(i=""),'<div class="zsiq_prv_main zsiq-cal-turtrp" onclick="$ZSIQUtil.getIframe().avimpl.closeViewMediaPermission();"><div class="zsiq-cal-hnt-cont  '+i+'""><div class="zsiq-trtp-anim"></div><span class="siqico-arrow zsiq-arrow"></span><span class="zsiq-alw-mic siqico-mic"></span><div class="zsiq-alw-mic-desc">'+LSResource.getRealValue("av.info.pleaseallowmicrophone")+"</div></div></div>"},conversationEmptyState:function(){return'<div class="content_mdl textC" id="emptybg"><span class="online_bg"><em class="bg_shadow"></em>'+LSResource.getRealValue("cw.emptypage.title")+'</span><div class="chat_btn sqico-chat" documentclick="showchatui" proptype="showsiqchatui">'+LSResource.getRealValue("ne.chatnow")+"</div></div>"},getReOpenMsgArea:function(){return['<div class="sqfdbk maskdiv fdbk_aln">','<div class="clblck">'+LSResource.getRealValue("chat.reopen")+"</div>",'<div class="fdbk_cnt">','<textarea dockeyup="reopenchat" dockeydown="textarea" id="reopenmsgarea" txtarea-id = "{TXTAREAID}" class="feedback-textarea" data-validate="required" placeholder="'+LSResource.getRealValue("embed.composer.placeholder")+'"></textarea>',"</div>",'<div class="actionbtn"><p class="cancel siq-cancel-button" documentclick = "hidemaskdiv" >'+LSResource.getRealValue("common.cancel")+'</p><p id="continue_btn" class="siq-update-button" documentclick = "reopenchat">'+LSResource.getRealValue("common.send")+"</p></div>","</div>"].join("")},getResourceSharingHTML:function(e){return['<div class="cmpnt-wrap " id="rel-articles-'+e.id+'">','<div class="flexC">','<em class="sqico-faqarticle"></em>','<span class="artcl-title mL10">'+LSResource.getRealValue("faq.article")+"</span>","</div>",'<div class="artclsh-title">'+getEscapedText(e.articlename)+"</div>","</div>"].join("")},getQueueBannerHTML:function(e){var i=CommonUtil.convertMstoMinAndSec(e.average_response_time);return['<div class="info_banr siq-info-banner queinfo-banr" id="info_banr" proptype="info_banr">','<div class="font14 clr3"><span>'+LSResource.getRealValue("chat.inqueue","")+"</span>",'<span class="siq-que" id="queuepos"> - Queue no. '+e.position+"</span>","</div>",'<div class="font12 c888" id="queuetime">Queue position updates in ~ '+i+" mins</div>","</div>"].join("")},getchatQueueingUIinConversation:function(e){return['<div class="siqc_cntbody" id="conv'+e.chatID+'" chid="'+e.chatID+'" visitorid="'+e.visitorID+'" documentclick="showchatui">','<div class="siqc_usrimg">','<img id="convchatattenderimg" propval = "convchatattenderimg" src="" onload="$Support.Util.handleBlurImage(this)">','<div class="sqico-user convrstn-usr wincustom_bg"></div>',"</div>",'<div class="siqc_msg">','<span id="convchatattendername" propval="convchatattendername" class="txtelips siq-quewd text-cap"></span>','<span class="siq-que" proptype="queuetitle">- In Queue</span>','<p propval="convmsg" class="siqc_cusmsg" id="queueinfo"></p>',"</div>",'<div class="siqc_duration dn" propval="siqduration"><em id="convwtime" propval = "convwtime"></em><span><em class="siqc_eletype"></em></span></div>',"</div>"].join("")},getQueueHandOffHtml:function(e){return['<div class="zsiq_transferdiv fnt13" id="leavemsgonqueue">'+LSResource.getRealValue("chatqueue.wait")+'<span documentclick="leaveMsgForQueue" chatid="'+e.chid+'" class="bot_opt">'+LSResource.getRealValue("chatqueue.leavemsg")+"</span></div>"].join("")},getReplyMessageHTML:function(e){var i={message:'<span class="cur-non">'+e.msg+"</span>",img_att:'<span data-ftype="image/jpeg" data-bubble="true" class="file_reply"><img src="'+e.file_url+'" height="75" width="75" class="replymsg_img"> <div><span proptype="filecomment" class="elips cmt_wt">'+e.att_comment+"</span></div></span>",file_att:'<span class="sqico-file-min file_reply"><em class="mL10 elips cmt_wt">'+e.att_comment+"</em></span>"},s=e.msgtype,t=i[s],a=$Support.isVisitorID(e.sender)?'proptype="visname"':"",o="img_att"==s||"file_att"==s?" filereply_msg":"",c=e.ignoreclose?"":'<em class="sqico-close flexC" documentclick="closereplypopup"></em>';return['<div class="reply_msg'+o+'" documentclick="scrolltomsg" proptype="reply_msg" msgidval='+$Support.formatMsgUid(e.msguid)+'><div class="flexC"><em class="sqico-reply flexC elips" '+a+">"+getEncodedText(e.dname)+'</em><div class="flexC"><em class="c999">'+CommonUtil.checkAndGetReadableTime(e.time)+"</em>"+c+"</div></div>"+t+"</div>"].join("")},getMessageActionsHTML:function(e){return['<ul class="mraction msgactnlist shwact '+e.leftaligncls+'" proptype="mraction" id="msgactnlist"><li class="sqico-edit_1" documentclick="editmsg" >'+LSResource.getRealValue("chat.msg.edit")+'</li><li class="sqico-delico" documentclick="deletemsg">'+LSResource.getRealValue("av.info.delete")+"</li></ul>"].join("")},getBotflowSetBackHTML:function(e){return'<div class="botactions">'+(e.rollback&&!e.disabled?'<em class="sqico-sync" documentclick="resetbotflow" proptype="flowresetter" command="rollback">'+LSResource.getRealValue("bot.rollbackflow")+"</em>":"")+(e.restart?'<em class="sqico-retry" documentclick="resetbotflow" proptype="flowresetter" command="restart">'+LSResource.getRealValue("bot.restartflow")+"</em>":"")+"</div>"},getVisitorEditMsgHTML:function(e){var i="",s="",t="";e.iattach&&(i=' isattachement="true"',s=" data-validate='charlimit 150' ",t='<em class="sqico-invalid txt-invalid dN mR10" purpose="invalid" title="'+LSResource.getRealValue("errormsg.char.exceed","150")+'"></em>');var a=!i&&JSON.parse($Support.EmbedObj.eprops.showsmiley)?'<div class="smile_list siq-smileys-section" id="smilelist" proptype="smilelist"></div><span class="sqico-smile" id="smiley" documentclick="smileyedit"></span>':"";return['<div class="siq-popup" proptype="msgeditor" purpose="msgaction" data-id="'+e.chid+'" msguid="'+e.msguid+'"'+i+'><em class="sqico-close flexC" documentclick="closemsgactionpopup"></em><div class="siqpopu-hdr"> <span><em class="sqico-edit"></em>'+LSResource.getRealValue("chat.msg.edit")+'</span></div><div class="p20"><div class="posrel mB20"><textarea proptype="editorarea" txtarea-id="'+e.chid+'" dockeyup="sendeditmsg" preval="'+e.msg+'" dockeydown="textarea"'+s+"></textarea>"+t+a+'</div><div class="btndiv"><span class="cancel_btn" documentclick="closemsgactionpopup">'+LSResource.getRealValue("common.cancel")+'</span><span class="save elem_disable" documentclick="sendeditmsg" proptype="editsave">'+LSResource.getRealValue("common.done")+"</span></div></div></div>"].join("")},getVisitorDeleteMsgHTML:function(e){return['<div class="siq-popup delpopup" proptype="deletecotainer" purpose="msgaction" data-id="'+e.chid+'" msguid="'+e.msguid+'"><em class="sqico-close flexC" documentclick="closemsgactionpopup"></em><em class="sqico-delico flexC"></em><div class="font18 c000 mB5">'+LSResource.getRealValue("chat.msg.delete")+'</div><div class="c999">'+LSResource.getRealValue("chat.msg.delete.desc")+'</div><div class="btns"><span class="cancel_btn w140" documentclick="closemsgactionpopup">'+LSResource.getRealValue("common.cancel")+'</span><span class="delete w140" documentclick="senddeletemsg">'+LSResource.getRealValue("av.info.delete")+"</span></div></div>"].join("")}}}(window);var scrollHandler=function(){var i,m,n={},s=0,h={8:{min:85,max:120},9:{min:93,max:140},10:{min:87,max:110}},d={bottom:30,skew:9},r=function(e,t){var o=t.deltaY||-1*t.wheelDelta,r=n.header.height(),a=r-o;clearTimeout(s),r<a&&0!=e.scrollTop()||(l(a=m<(a=a<i?i:a)?m:a),p(o),s=setTimeout(function(){a!=i&&a!=m&&(l(a=m/100*i<a?m:i,!0),$("#header_style").remove())},300))},a=function(e,t){if($Support.isAllowFreeLogo()){var o=e.outerHeight(),r=e[0].scrollHeight;if(o!=r){var a=$Support.getFreeLogo(e);o+e[0].scrollTop>=r-20?a.hide():a.show()}}},l=function(e,t){var o=t?100:0;n.header.animate({height:e+"px"},o).removeClass("min_header"),e==i&&n.header.addClass("min_header")},p=function(e){if(9==n.theme){var t=e/(h[9].max-h[9].min)*100,o=d.bottom+-t/100*20,r=d.skew+-t/100*6;d.skew=0<e?(d.bottom=o<10?10:o,r<3?3:r):(d.bottom=30<o?30:o,9<r?9:r),$("#header_style").remove();var a="transform: skewY("+d.skew+"deg) !important;";$("body").append('<style id="header_style">[themeid="9"] header:after { bottom: '+d.bottom+"px !important; "+a+" -webkit-"+a+" -moz-"+a+" -o-"+a+" -ms-"+a+" }</style>")}};return{init:function(e,t){if($Support.Util.checkAndRemoveUnreadDIV(),a(e,t),-1==[4].indexOf($Support.getThemeID())&&!$("body").hasClass("ssview")){if(!n.size){var o=h[$Support.getThemeID()];n.header=$Support.container.find("header"),n.size=getObjectSize(n),n.theme=$Support.getThemeID(),i=o.min,m=o.max}n.event=t,r(e,t),$TH.checkAboutmeClass(),$.fn.ztooltip.remove()}}}}();ZSIQConversationForm=function(){var s=$Support,u={},a={visitorname:{placeholder:"cw.form.name.placeholder",message:"cw.form.name.question",postmessage:"common.name"},visitoremail:{placeholder:"cw.form.email.placeholder",message:"cw.form.email.question",postmessage:"cw.form.email"},visitorphone:{placeholder:"cw.form.phone.placeholder",message:"cw.form.phone.question",postmessage:"ne.enterphone"},department:{postmessage:"common.department",message:"embed.choose_department"},campaign:{message:"embed.campaign.label"}},l={visitor_name:"isname",visitor_email:"isemail",visitor_phone:"isphoneno"},r=function(e,t,i,a){u=i||u;var r=o(e,t);$Support.requestRunning_fetchvisitorconfigurations=!0,$.ajax({url:r,type:"GET",success:function(e){var t=e&&e[0].objString?e[0].objString.form:{};$Support.getParent().$ZSIQUtil.getAvuid();if(delete $Support.requestRunning_fetchvisitorconfigurations,Object.keys(t).length)return $Support.Util.resetFormFieldValue(),k(t.dname,t.title),g(t.msglist),Y(t.form_fields_auto_pick_enabled),"function"==typeof a?void a():ZSIQConversationForm.isOldFormView()||$Support.Util.isPreview()?(K(t),!0,void $Support.handleChatWindowUI()):(G()||$.isEmptyObject(u)||(u.contentdiv.find('[purpose="name"]').find(".sqico-edit").first().addClass("dN"),t.currwinobj=u,$Support.handleOnGoingchatActionsInConversation("formchat",t)),void n(e));!0,$Support.Util.resetFormFieldValue(),u.istrigmsg||u.proactive?x():((ZSIQConversationForm.isOldFormView()||$Support.Util.isPreview())&&$Support.handleChatWindowUI(),!ZSIQConversationForm.isOldFormView()&&!ZSIQConversationForm.maualedit&&x()),delete ZSIQConversationForm.maualedit,ZSIQConversationForm.clearSessionStorage()},error:function(e){delete $Support.requestRunning_fetchvisitorconfigurations,ZSIQConversationForm.clearSessionStorage(),$Support.handleChatWindowUI();var t=e&&e.status;LSDebugger.postDebugInfo("Fetchvisitorconfigurations Call - Errorstatus:"+t+"| AVUID:"+$Support.getParent().$ZSIQUtil.getAvuid(),null,"",!0)}})},o=function(e,t){ispreview=$Support.Util.isPreview();var i=s.getParent(),a=i.$ZSIQChat.getWidgetData().widgetobj.lsid,r=ispreview?"1":i.$ZSIQUtil.getAvuid();""!=r&&r||LSDebugger.postDebugInfo("AVUID empty for fetchvisitorconfig actual cookie val|"+s.LSDB.get("ZLD"+a+"avuid")+"| avuid taken from server immediate response |"+i.$ZSIQChat.server_avuid,null,"",!0),delete i.$ZSIQChat.server_avuid;var o=$Support.getAjaxURL("fetchvisitorconfigurations",dext),n=u&&u.question;return o+="?avuid="+r+"&lsid="+a+(!G()&&n?"&visitor_question="+n:"")+(G()||ispreview||t?"&fetchallfields="+!0:"")+(e?"&clear_context="+!0:"")},n=function(e){var t=e&&e[0].objString?e[0].objString.form:{},i=($Support.EmbedObj,t.msglist||[]),a=i.length,r=t.visitor_question,o=t.form_type,n=u.isbottrigmsg&&r&&"conversation"==o;if(u.question||G()||!r||(u.question=r,!n&&p(a,t.form_type,r)),"classic"==o||G())m(e);else if(1<a||n&&a)f(t);else{var s=a?i[0]:{};I(s)}},p=function(e,t,i){var a=$Support.EmbedObj;1!=e&&"classic"!=t||($Support.Util.showMessageAreaUI("","","",u),u.showChatArea(),u.question=i,(u.istrigmsg||u.proactive)&&$BotImpl.formatAndDisplay({dname:a.visitorname,msg:getEscapedText(u.question),isques:u.question},u.winid))},m=function(e,t){$Support.Util.isPreview()&&t&&(u=t),h(e)},d=function(e,t,i){var a=s.LSDB.get("ZLD"+$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.lsid+"avuid");t=t?"&meta="+encodeURIComponent(t):"";i=i||"",e=encodeURIComponent(e);var r=$Support.getAjaxURL("sendmessage",dext);r+="?avuid="+a+"&msg="+e+t+"&ignore="+i,$.ajax({url:r,type:"GET",success:function(e){var t=e&&e[0]?e[0].objString:{};if("context_completed"==t)return!0,void x();t.currwinobj=u,g([t]),$Support.handleOnGoingchatActionsInConversation("formchat",t),I(e)}})},c=function(e,t){var i=e[0]&&e[0].objString?e[0].objString:e,a=i.form?i.form:i;a.msg=getEncodedText(a.msg);var r="classic"==t,o=$.extend({},a);return a.meta={},a.msglist&&!r||(a.msglist=[],a.msglist[0]=o,r&&(a.meta.input_card=o,a.meta.input_card.type=t)),a=r?a:j(a)},g=function(e){if(e)for(var t=e.length,i=$Support.EmbedObj.eprops,a=0;a<t;a++){var r=e[a],o=(r=r.meta||{}).skippable?"false":"true",n=(r=r.input_card||{}).type,s=i[n=l[n]];n&&s&&(s[0]="true",s[1].ismandatory=o,s[1].placeholder=r.placeholder)}},f=function(e){V(e);for(var t=e.msglist||[],i=0;i<t.length;i++)$BotImpl.iswidgetobj(t[i])&&(t[i].sender="-1");$Support.Util.showMessageAreaUI("","","",u),t.unshift({dname:$Support.EmbedObj.visitorname,chid:u.winid,msg:getEscapedText(u.question),isques:u.question});var a=t.length,r=t[a-1];if(!$BotImpl.iswidgetobj(r))return t=w(t),$Support.Util.populateChatUI(t),void x();var o=t.splice(0,a-1);o=w(o),o=v(o),$Support.Util.populateChatUI(o),!$Support.isNewHeader()&&$TH.populateSendBtn(LSResource.getRealValue("ne.send"),u.winid),I(t[0])},v=function(e){$Support.EmbedObj;if(u.istrigmsg){u.question&&(u.istriggeredchat=!0);var t=getEscapedText(u.pmsg),i="",a=-1;return u.isbottrigmsg&&(t={msg:u.pmsg},i="BOT_MESSAGE",a=u.pmsg.sender),[{sender:a,dname:u.triggername,msg:t,chid:u.winid,mode:i}].concat(e)}return u.proactive?($Support.getTranscriptFromSession(u.chatID)||[]).concat(e):e},S=function(){var e=$Support.getParent().$ZSIQUtil.getAvuid();s.LSDB.storeInSession(e+"_formcontextinitiated",!0)},b=function(e){return e.meta&&(e.meta=$BotImpl.setTypingandSoundConfig(e.meta)),e},h=function(e){P();var t=e&&e[0].objString?e[0].objString.form:{};t.dname=t.dname?t.dname:U(),t.dname=u.attendername||t.dname;var i=t.msglist?t.msglist:[];if(!function(e){var t=e[0]&&e[0].meta&&e[0].meta.field_name?e[0].meta.field_name:"";if(1==e.length&&ZSIQConversationForm.maualedit&&"department"==t)return!0}(i)){var a=i[0]?i[0].mtime:"",r=i.map(function(e){return e.meta&&e.meta.input_card?e.meta.input_card.type:""}).indexOf("campaign");-1!=r&&(i[r]=E(i[r],"classic"));var o=c(e,"classic");o.isdisablecache=!0,G()?(o=b(o),o=_(o)):($Support.Util.isPreview()&&(o=b(o)),o.callback=T,o.mtime=a),o.sender="-1",ZSIQTranscript.scroll(),$BotImpl.formatAndDisplay(o,u.winid)}},_=function(e){return e.isuseredit=ZSIQConversationForm.maualedit,e.triggerclbk=ZSIQConversationForm.triggerclbk,e.time=(new Date).getTime(),delete ZSIQConversationForm.maualedit,delete ZSIQConversationForm.triggerclbk,e.callback=function(e,t,i){if("siqformskip"!=i.currentTarget.id){var a="keyup"==i.type?$(i.currentTarget).find("#siqformsave"):$(i.target);$Support.checkAndUpdateInfo(a),P()}else B(e)},e},I=function(e){var t=$Support.EmbedObj,i=$Support.getParent().$ZSIQUtil.getAPIValues()||{},a=e[0]&&e[0].objString&&e[0].objString.meta?e[0].objString.meta:e.meta||{},r=a.input_card&&a.input_card.type?a.input_card.type:"",o=i[r.replace("visitor_","")],n="department"==a.field_name;if(o||n&&-1!=u.department){var s=o||t.department;d(s,"",!0)}else{e=y(e),a.input_card&&(a.input_card.fieldtype=r,a.input_card.type="conversationforminput"),"campaign"==r&&(e=E(e,"conversation")),a.ignoremeta=!0;var p,m=$Support.Util.isPreview();e=n?F(e):e,a=a.skippable?((p=a).skip_callback=function(){var e=$("#msgarea").parents(".usrinpt"),t={val:LSResource.getRealValue("cw.form.field.skip"),metaval:JSON.stringify({type:"skip",value:"-"})};e.find(".hint").remove(),$("#msgarea").removeClass("error_bar"),$("#msgbox_main").find(".flogo").show(),L("",t,"")},p):a;var l=c(e);/^(visitor_phone|visitor_name|visitor_email||department|campaign)$/.exec(r)||(l=C(l)),l.isdisablecache=!0,l.sender="-1",m&&l.meta&&(l.meta.typing_delay=0),$BotImpl.formatAndDisplay(l,u.winid),n&&(m?$BotImpl.disableComposer():_disableComposer())}},C=function(e){var t={checkbox:"multiple-select",radio:"select",selectbox:"suggestions"},i=e.msglist?e.msglist[0]:{},a=i.meta||{},r=i.meta.input_card?i.meta.input_card:{};return t[r.type]&&(a.callback=A,r.type=t[r.type]),"suggestions"==r.type&&(a.suggestions=r.options),i.iscustomfield=!0,e},y=function(e){var t=e[0]&&e[0].objString?e[0].objString:e,i=t.meta,a=i.input_card?i.input_card:{},r=a.type||i.field_name||"";return a.placeholder=a.placeholder?a.placeholder:ZSIQConversationForm.getDefaultPlaceholder(r.replace("_","")),t.dname=t.dname?t.dname:U(),t.msg=t.msg?getEncodedText(t.msg):ZSIQConversationForm.getDefaultMessage(r.replace("_","")),e},w=function(e){for(var t=0;t<e.length;t++){var i=e[t];$BotImpl.iswidgetobj(i)&&(e[t]=y(i),!i.sender&&(i.sender="-1"))}return e},F=function(e){for(var t=[],i=e&&e[0]&&e[0].objString?e[0].objString:{},a=i.meta?i.meta:e.meta||{},r=$Support.getEmbedDepartments(),o=r.length,n=0;n<o;n++){var s=r[n],p=Q(s),m="title = "+LSResource.getRealValue("common."+p)+" dept_status = "+p;t.push({text:s.DNAME,value:s.ID,custatrr:m})}return a.suggestions=t,a.callback=A,i.msg=i.msg||LSResource.getRealValue("embed.choose_department"),e},j=function(e){var t=e.msglist?e.msglist[0]:e.objString,i=t?t.meta:{},a=i.input_card||{},r=a.maxlength||"100",o=i?i.format:"";o=o||a.type;var n=r?" charlimit "+r:"";return e.data_validate=i&&i.skippable?o+n:"required "+o+n,e.fieldtype="default",e},E=function(e,t){if("classic"==t||G())return e.msg=e.msg?e.msg:LSResource.getRealValue("embed.campaign.label"),e={meta:{field_name:"campaign",skippable:!0,format:"checkbox",key:"subscribe",hint:"",is_default_field:!0,options:[{text:e.msg,value:!0}]}};var i=e&&e[0]&&e[0].objString?e[0].objString:e,a=i.meta?i.meta:{};return i.msg=i.msg?i.msg:LSResource.getRealValue("embed.campaign.label"),a.input_card={type:"select",options:[{value:!0,text:LSResource.getRealValue("common.yes")},{value:!1,text:LSResource.getRealValue("common.no")}],data_key:"subscribe"},a.callback=A,a.skippable=!1,a.field_name="subscribe",e},D=function(e,t,i,a){if("subscribe"==e&&($Support.subscribe=JSON.parse(t)),"department"==e)ZSIQConversationManager.getChatWinObjById(a).department=t;else if(i&&null!=t){var r=$Support.EmbedObj.cinfo||{},o="object"==typeof t?t[0]?t[0].value:"":t;r[e]=o,$Support.EmbedObj.cinfo=r}else $Support.EmbedObj[e]=t},k=function(e,t){var i=$Support.EmbedObj.eprops,a=i.agentname,r=i.question;a&&(a[1].name=e),r&&(r[1].msg=t)},U=function(){return u.attendername||getEscapedText($Support.EmbedObj.eprops.agentname[1].name)||LSResource.getRealValue("ne.operator")},Z=function(e){var t=e.length,a=[];for(i=0;i<t;i++)a.push(e[i].value);return a},A=function(e){var t,i=e.data_value,a=e.config||{};"object"==typeof i&&(i=Z(i)),t={val:e.msg,metaval:JSON.stringify(meta={type:a.fieldtype,value:i})},t="subscribe"==a.fieldname?e.msg:t,$BotImpl.enableComposer(),D(a.fieldname,e.data_value,a.iscustomfield,e.chatid),L(e.element,e.data_value,t)},Q=function(e){return e.ENGAGED?"engaged":e.STATUS?"online":"offline"},R=function(e){var t=$Support.EmbedObj,i=$Support.getEmbedDepartments()||[],a=(i.length,e||t.department);for(var r in i){var o=i[r];if(o.ID===a)return o.STATUS}return t.status},q=function(e){$Support.EmbedObj;var t=$Support.getEmbedDepartments();t.length;for(var i in t){var a=t[i];if(a.NAME===e)return a.ID}},x=function(e){e?$Support.getComposer().val(u.question):ConversationFormInput.resetMessageArea(u.winid),t()},O=function(e,t,i){s.getParent().$zoho.salesiq.visitor[e](i)},V=function(e){for(var t,i,a,r=e.msglist||{},o=r.length,n=!1,s=0;s<o;s++){var p=r[s],m=p.meta?p.meta:"";if(!m||n)if("department"!=i)if(n){var l=p[t]||(m?Z(m.value).toString():"");D(a,l,!0),n=!1}else"campaign"==i&&p[t]?$Support.subscribe="Yes"==p[t]:$Support.EmbedObj[i]=p[t];else $Support.EmbedObj[i]=q(p[t]);else{if(m.card_data&&"skip"==m.card_data.type)continue;t=m.input_card?m.input_card.type:m.field_name,a=m.field_name,i=t?t.replace("_",""):"",/^(visitor_phone|visitor_name|visitor_email||department|campaign)$/.exec(t)||(n=!0,i=m.field_name)}}},L=function(e,t,i){var a=$Support.EmbedObj.visitorname,r=e?e.parents(".ziq_msg"):"",o=i||t,n="object"==typeof o?o.metaval:"";if(o="object"==typeof o?o.val:o,$Support.Util.removeSendClickAction(),i||t)if(H())_updateDeptValue(r,o);else{r&&r.find(".cmpnt-desc").length&&r.find(".msgbx").text(r.find(".cmpnt-desc").text()),$("#conversationoption").remove();var s={isvisitor:!0,sender:a,dname:a,msg:getEscapedText(o),time:MyDate.getHoursandMin((new Date).getTime(),!0,"bclient"),previoussender:!1,isdisablecache:!0};$BotImpl.formatAndDisplay(s,u.winid),Message.presender=a,ConversationFormInput.resetMessageArea(u.winid),d(o,n)}},T=function(e,t,i){if("siqformskip"==i.currentTarget.id&&(_storeClassicData(!0),B(e),!e.isuseredit&&!e.triggerclbk&&$BotImpl.formatAndDisplay(N(ZSIQConversationForm.classicformdata,e.dname),u.winid)),$Support.checkCustomFields(s.getFormContainer()),s.Util.validateFields(s.getFormContainer())){_storeClassicData(),!0;var a=u.contentdiv;s.Util.isCampaignEnabled()&&($Support.subscribe=a&&a.find('[purpose="subscribe"] input').is(":checked")),t?t(e):x(),P(),!e.isuseredit&&!e.triggerclbk&&$BotImpl.formatAndDisplay(N(ZSIQConversationForm.classicformdata,e.dname),u.winid)}};_storeClassicData=function(r){ZSIQConversationForm.classicformdata={},$("#siqform").find("[purpose]").each(function(){var e=$(this),t=e.attr("purpose");if("custom"==t)return!0;var i=e.attr("fieldkey"),a=e.val()||e.attr("val");return!!isUndefined(i)||(r?(ZSIQConversationForm.classicformdata[i]={msg:LSResource.getRealValue("cw.form.field.skip"),meta:{type:"skip",value:""}},!0):(a="department"==t?e.find("#dropheader").text():a,a="subscribe"==t?1==e.find("input").prop("checked"):a,(isUndefined(a)||""==a)&&(a=LSResource.getRealValue("cw.form.emptyfieldvalue","")),void(ZSIQConversationForm.classicformdata[i]=a)))}),r&&(ZSIQConversationForm.classicformdata.skip=!0)};var B=function(e){!0;var t=!(!e.isuseredit&&!e.triggerclbk);P(),t||x()},P=function(){var e=$("#siqform").parents(".ziq_msg");e.prev('[frstmsg="true"]').remove(),e.remove(),$BotImpl.enableComposer()},t=function(){var t=$Support.EmbedObj.pprops,i=M();$Support.updateInputValues(u);var e=s.EmbedObj.status&&R(u.department)?function(){u.initiateChat()}:function(){if(i&&!s.EmbedObj.status){var e=u.contentdiv;return e.find(".sqico-edit").remove(),e.find("div[purpose=name]").attr("documentclick",""),u.hideUserEditUI(),$UI.appendChatConsentDiv(null,!1,t.chatcookiepolicyurl,u),void ZSIQTranscript.scroll()}$Support.EmbedObj.offlinedeptid=u.department,s.handleLeaveMessage(u.question,u.winid)};u.proactive&&(e=function(){var e=ZSIQConversationForm.getFormType()==CLASSIC_VIEW?ZSIQConversationForm.getFormatedResponse():"";$Support.joinProactiveChat(u.question,u,e)}),s.Util.handleStartChat(e,"",u.winid)},M=function(){var e=1==$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.isgdprenabled,t=$Support.EmbedObj.pprops,i=$Support.LSDB.getFromSession(_SCREENNAME+"_gdpr_chatconsent");return!(!e||!JSON.parse(t.isgdprenabled)||1!=JSON.parse(t.chatprivacyconfig)||i)},N=function(e,t,i){var a="";i=i||MyDate.getHoursandMin((new Date).getTime(),!0,"bclient");for(var r in e)if(e[r]&&"subscribe"!=r&&r){var o=e[r].meta||{};if("skip"==((o.card_data||{}).type||o.type||r)){a=LSResource.getRealValue("cw.form.field.skip");break}a+="<b>"+getEscapedText(r)+"</b><br>"+getEscapedText(e[r])+"<br>"}return{sender:t,dname:t,msg:a,isvisitor:!0,time:i,isdisablecache:!0}};_disableComposer=function(){setTimeout(function(){$BotImpl.disableComposer()},2e3)};var G=function(e){return ZSIQConversationForm.maualedit},W=function(){var e,t=$Support.getParent().$ZSIQUtil.getAvuid(),i=H();i&&(u.question=i,$Support.Util.showMessageAreaUI("","","",u),u.showChatArea()),S(),!i&&s.LSDB.storeInSession(t+"_vist_ques",u.question),e=[{sender:"-1",dname:U(),meta:{field_name:"department",skippable:!1,isskiptopost:!1},msg:LSResource.getRealValue("embed.choose_department"),mtime:""+(new Date).getTime(),currwinobj:u}],$Support.handleOnGoingchatActionsInConversation("formchat",e[0]),e=F(e[0]),(e=c(e)).isdisablecache=!0,$BotImpl.formatAndDisplay(e,u.winid),_disableComposer()};_updateDeptValue=function(e,t){e.prev("#bottype_msg").remove(),e.remove(),!0,x()};var H=function(){var e=$Support.getParent().$ZSIQUtil.getAvuid();return s.LSDB.getFromSession(e+"_vist_ques")},J=function(e){var t=$Support.fieldlist||[],i=t.map(function(e){return e.meta?e.meta.input_card?e.meta.input_card.type:e.meta.field_name:""}).indexOf(e);-1!=i&&t.splice(i,1)},z=function(){return!$Support.getCookieValue("ZLD"+$Support.EmbedObj.livelsid)||$Support.Util.IsMandatoryFieldsAvailable()||ZSIQConversationForm.getFormType()==CLASSIC_VIEW},K=function(e){if(e){for(var t=e.msglist||[],i=($Support.fieldlist=t).length,a=[],r=0;r<i;r++){var o=t[r],n=o.meta||{};if("department"!=n.field_name&&"subscribe"!=n.key){var s=n.input_card||{},p=s.type||n.field_name,m=$Support.EmbedObj.eprops;/^(visitor_phone|visitor_name|visitor_email||department|campaign)$/.exec(p)?m[l[p]]={0:"true",1:{ismandatory:!n.skippable,placeholder:s.placeholder,question:o.msg}}:a.push({hint:s.placeholder,index:r,name:n.field_name,options:s.options,required:!n.skippable,type:p,visibility:s.visibility,maxlength:s.maxlength,style:s.style,question:n.msg})}}$Support.customobj=a}},Y=function(e){(s.getParent().$ZSIQAutopick||{}).isenabled=e};return{fetchConfigurations:function(e){if(u=e,!1,z())return S(),void r(!0);"-1"!=$Support.EmbedObj.department?x(!0):r("",!0,"",W)},handleStartChat:function(e){$TH.showChatArea(),!$Support.isNewHeader()&&$TH.populateSendBtn(LSResource.getRealValue("ne.send"));var t=s.getParent().$ZSIQUtil.getAPIValues();s.handleApiData(t),t.floatwindowfields&&s.handleFieldVisibility(t.floatwindowfields),s.Util.setMessageClass()},validateConversation:function(e,t){var i=$("#msgarea");if(i.parents(".usrinpt").find(".hint").remove(),i.removeClass("error_bar"),$("#msgbox_main").find(".flogo").show(),$Support.toggleSendButton(e),!t||13==s.Util.getKeyCode(t)){var a,r,o=i.attr("purpose");if(!i.validateInput()){var n={visitorname:"ne.errorinfo.name",visitoremail:"ne.errorinfo.email",visitorphone:"ne.errorinfo.phone"}[o];return(n=n?LSResource.getRealValue(n):/^number|email|url|percentage|percent|decimal|name|email|phone$/.exec(o)?LSResource.getRealValue("ne.errorinfo."+o):"")&&(a=n,(r=$("#msgarea").parents(".usrinpt")).find(".hint").remove(),$("#msgbox_main").find(".flogo").show(),a&&(r.append('<div class="hint">( '+a+" )</div>"),$("#msgbox_main").find(".flogo").hide())),void i.addClass("error_bar")}!function(e){var t=e.val()||$("#msgarea").val();if("true"==e.attr("iscustomfield")){var i=e.attr("fieldtype");D(i,t,!0)}else{var a=e.attr("purpose");"visitorname"==a&&O("name","visitorname",t),"visitoremail"==a&&O("email","visitoremail",t),"visitorphone"==a&&O("contactnumber","visitorphone",t)}L(e,t)}(i)}},clearSessionStorage:function(){var e=$Support.getParent().$ZSIQUtil.getAvuid();$Support.LSDB.removeSessionStore(e+"_formcontextinitiated"),$Support.LSDB.removeSessionStore(e+"_vist_ques"),delete ZSIQConversationForm.classicformdata},checkInputVal:function(e){e.attr("value",$.trim(e.val())),e.val()||e.parent().removeClass("sel")},getOperatorName:U,getFormQuestion:function(){return s.EmbedObj.eprops.question[1].msg||LSResource.getRealValue("ne.operator.question","")},fetchFieldsToEdit:function(e,t,i){if(i&&(u=i),ZSIQConversationForm.maualedit=e,ZSIQConversationForm.triggerclbk=t){var a=$Support.EmbedObj;return u.question=$.trim(u&&u.composer.val())||$Widget.getLastMessage(),$BotImpl.formatAndDisplay({sender:a.visitorname,dname:a.visitorname,msg:u.question,isques:u.question},u.winid),u&&u.composer.val(""),void this.fetchConfigurations(u)}r()},updateAndGetClassicFormData:function(e){var t=e.msg;_classicformdata={};var i=t.msglist||[];i=w(i);for(var a,r=t.title||LSResource.getRealValue("ne.operator.question",""),o=MyDate.getHoursandMin(e.time,!0,"bclient"),n=t.msglist.length,s=0;s<n;){if(i[s]&&i[s].meta){a=i[s].dname||U();var p=i[s].meta.input_card?i[s].meta.input_card.type:"",m=p?ZSIQConversationForm.getDefaultPostMessage(p.replace("_","")):ZSIQConversationForm.getDefaultPostMessage(i[s].meta.field_name)||i[s].msg;_classicformdata[m]=i[s+1].meta&&i[s+1].meta.card_data?i[s+1]:i[s+1].msg}s+=2}return(i=[]).push({sender:"-1",dname:a,msg:r,time:o}),i.push(N(_classicformdata,"",o)),i},updateformconfig:function(){for(var e=$Support.fieldlist||[],t=$Support.EmbedObj.eprops||{},i=$Support.Util.isCampaignEnabled(),a=(t.agentname&&t.agentname[1],t.question&&t.question[1],$Support.EmbedObj.integprops||{}),r=a.integinfo?a.integinfo[$Support.enabledCampaignID]:{},o=r?r.subscribelabel:"",n=[{isenabled:"true"==t.isname[0],data:t.isname[1]||{},format:"text",type:"visitor_name"},{isenabled:"true"==t.isemail[0],data:t.isemail[1]||{},format:"email",type:"visitor_email"},{isenabled:"true"==t.isphoneno[0],data:t.isphoneno[1]||{},format:"phone",type:"visitor_phone"},{isenabled:i,data:{question:o},type:"campaign"}],s=[],p=0;p<n.length;p++){var m=n[p],l=m.isenabled,u=m.type;l?(J(m.type),s.push({dname:"",meta:{format:m.format,input_card:{placeholder:m.data.placeholder,type:u},skippable:!CommonUtil.parseToJSON(m.data.ismandatory),msg:m.data.question}})):J(m.type)}s.length&&(e=s.concat(e)),$Support.fieldlist=e},reSetFormValues:function(){!1},getFormType:function(){var e=$Support.EmbedObj,t=e.eprops;return e.isformremoval?t.formtype&&t.formtype[1]?t.formtype[1].val:void 0:"2"},getFormatedResponse:function(){var e=[],t=!(!ZSIQConversationForm.classicformdata||!ZSIQConversationForm.classicformdata.skip);for(var i in ZSIQConversationForm.classicformdata)t?"skip"!=i&&e.push(ZSIQConversationForm.classicformdata[i]):e.push({msg:ZSIQConversationForm.classicformdata[i]});return JSON.stringify(e)},checkContextInitiated:function(){var e=$Support.getParent().$ZSIQUtil.getAvuid();return!!$Support.LSDB.getFromSession(e+"_formcontextinitiated")},getDefaultPlaceholder:function(e){var t=a[e];return t?LSResource.getRealValue(t.placeholder):""},getDefaultMessage:function(e){var t=a[e];return t?LSResource.getRealValue(t.message):""},getDefaultPostMessage:function(e){var t=a[e];return t?LSResource.getRealValue(t.postmessage):""},isOldFormView:function(){return this.getFormType()==OLDFORM_VIEW&&!this.checkContextInitiated()},checkFormContext:function(){return!this.isOldFormView()&&!this.checkContextInitiated()&&(z()||"-1"==$Support.EmbedObj.department)},checkAndGetFormTranscript:function(e){var t=this.checkContextInitiated(),i=H();if(t||i){if(!e)return void ZSIQConversationManager.init({winid:(new Date).getTime()},"formview");var a=e;if(t&&!i)return S(),void r("","",a);i&&this.fetchConfigurations(a)}},formatAndPopulateTranscript:function(e,t,i,a){var r=e.chattrasncript,o=e.fieldtranscript,n=e.currindex+1;o=w(o);var s=r.slice(0,n-1).concat(o).concat(r.slice(n));$Support.Util.populateChatUI(s,t,i,a)},isCustomFieldExist:function(){var e=$Support.getParent().$ZSIQUtil.getAPIValues().customfield;return e&&e.length},isNewAppsUI:function(e){var t=parent.parent;if(e){if(t&&t.MESSANGER_SUBTAB)return!0}else if(t&&"siqforms"==t.MESSANGER_SUBTAB)return!0;return!1},fetchAllFields:function(){if($Support.Util.isPreview()&&$Support.fieldlist)return this.isNewAppsUI()&&K({msglist:$Support.fieldlist}),void $Support.handleChatWindowUI();r("",!0)},handleClassicConfig:m,updateFieldsData:K,handleConversationForm:I,getSelectedDeptstatus:R,setFormFieldsInEobj:g}}(),ZSIQConversationForm.reSetFormValues();ZSIQConversationForm=function(){var s=$Support,u={},a={visitorname:{placeholder:"cw.form.name.placeholder",message:"cw.form.name.question",postmessage:"common.name"},visitoremail:{placeholder:"cw.form.email.placeholder",message:"cw.form.email.question",postmessage:"cw.form.email"},visitorphone:{placeholder:"cw.form.phone.placeholder",message:"cw.form.phone.question",postmessage:"ne.enterphone"},department:{postmessage:"common.department",message:"embed.choose_department"},campaign:{message:"embed.campaign.label"}},l={visitor_name:"isname",visitor_email:"isemail",visitor_phone:"isphoneno"},r=function(e,t,i,a){u=i||u;var r=o(e,t);$Support.requestRunning_fetchvisitorconfigurations=!0,$.ajax({url:r,type:"GET",success:function(e){var t=e&&e[0].objString?e[0].objString.form:{};$Support.getParent().$ZSIQUtil.getAvuid();if(delete $Support.requestRunning_fetchvisitorconfigurations,Object.keys(t).length)return $Support.Util.resetFormFieldValue(),k(t.dname,t.title),g(t.msglist),Y(t.form_fields_auto_pick_enabled),"function"==typeof a?void a():ZSIQConversationForm.isOldFormView()||$Support.Util.isPreview()?(K(t),!0,void $Support.handleChatWindowUI()):(G()||$.isEmptyObject(u)||(u.contentdiv.find('[purpose="name"]').find(".sqico-edit").first().addClass("dN"),t.currwinobj=u,$Support.handleOnGoingchatActionsInConversation("formchat",t)),void n(e));!0,$Support.Util.resetFormFieldValue(),u.istrigmsg||u.proactive?x():((ZSIQConversationForm.isOldFormView()||$Support.Util.isPreview())&&$Support.handleChatWindowUI(),!ZSIQConversationForm.isOldFormView()&&!ZSIQConversationForm.maualedit&&x()),delete ZSIQConversationForm.maualedit,ZSIQConversationForm.clearSessionStorage()},error:function(e){delete $Support.requestRunning_fetchvisitorconfigurations,ZSIQConversationForm.clearSessionStorage(),$Support.handleChatWindowUI();var t=e&&e.status;LSDebugger.postDebugInfo("Fetchvisitorconfigurations Call - Errorstatus:"+t+"| AVUID:"+$Support.getParent().$ZSIQUtil.getAvuid(),null,"",!0)}})},o=function(e,t){ispreview=$Support.Util.isPreview();var i=s.getParent(),a=i.$ZSIQChat.getWidgetData().widgetobj.lsid,r=ispreview?"1":i.$ZSIQUtil.getAvuid();""!=r&&r||LSDebugger.postDebugInfo("AVUID empty for fetchvisitorconfig actual cookie val|"+s.LSDB.get("ZLD"+a+"avuid")+"| avuid taken from server immediate response |"+i.$ZSIQChat.server_avuid,null,"",!0),delete i.$ZSIQChat.server_avuid;var o=$Support.getAjaxURL("fetchvisitorconfigurations",dext),n=u&&u.question;return o+="?avuid="+r+"&lsid="+a+(!G()&&n?"&visitor_question="+n:"")+(G()||ispreview||t?"&fetchallfields="+!0:"")+(e?"&clear_context="+!0:"")},n=function(e){var t=e&&e[0].objString?e[0].objString.form:{},i=($Support.EmbedObj,t.msglist||[]),a=i.length,r=t.visitor_question,o=t.form_type,n=u.isbottrigmsg&&r&&"conversation"==o;if(u.question||G()||!r||(u.question=r,!n&&p(a,t.form_type,r)),"classic"==o||G())m(e);else if(1<a||n&&a)f(t);else{var s=a?i[0]:{};I(s)}},p=function(e,t,i){var a=$Support.EmbedObj;1!=e&&"classic"!=t||($Support.Util.showMessageAreaUI("","","",u),u.showChatArea(),u.question=i,(u.istrigmsg||u.proactive)&&$BotImpl.formatAndDisplay({dname:a.visitorname,msg:getEscapedText(u.question),isques:u.question},u.winid))},m=function(e,t){$Support.Util.isPreview()&&t&&(u=t),h(e)},d=function(e,t,i){var a=s.LSDB.get("ZLD"+$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.lsid+"avuid");t=t?"&meta="+encodeURIComponent(t):"";i=i||"",e=encodeURIComponent(e);var r=$Support.getAjaxURL("sendmessage",dext);r+="?avuid="+a+"&msg="+e+t+"&ignore="+i,$.ajax({url:r,type:"GET",success:function(e){var t=e&&e[0]?e[0].objString:{};if("context_completed"==t)return!0,void x();t.currwinobj=u,g([t]),$Support.handleOnGoingchatActionsInConversation("formchat",t),I(e)}})},c=function(e,t){var i=e[0]&&e[0].objString?e[0].objString:e,a=i.form?i.form:i;a.msg=getEncodedText(a.msg);var r="classic"==t,o=$.extend({},a);return a.meta={},a.msglist&&!r||(a.msglist=[],a.msglist[0]=o,r&&(a.meta.input_card=o,a.meta.input_card.type=t)),a=r?a:j(a)},g=function(e){if(e)for(var t=e.length,i=$Support.EmbedObj.eprops,a=0;a<t;a++){var r=e[a],o=(r=r.meta||{}).skippable?"false":"true",n=(r=r.input_card||{}).type,s=i[n=l[n]];n&&s&&(s[0]="true",s[1].ismandatory=o,s[1].placeholder=r.placeholder)}},f=function(e){V(e);for(var t=e.msglist||[],i=0;i<t.length;i++)$BotImpl.iswidgetobj(t[i])&&(t[i].sender="-1");$Support.Util.showMessageAreaUI("","","",u),t.unshift({dname:$Support.EmbedObj.visitorname,chid:u.winid,msg:getEscapedText(u.question),isques:u.question});var a=t.length,r=t[a-1];if(!$BotImpl.iswidgetobj(r))return t=w(t),$Support.Util.populateChatUI(t),void x();var o=t.splice(0,a-1);o=w(o),o=v(o),$Support.Util.populateChatUI(o),!$Support.isNewHeader()&&$TH.populateSendBtn(LSResource.getRealValue("ne.send"),u.winid),I(t[0])},v=function(e){$Support.EmbedObj;if(u.istrigmsg){u.question&&(u.istriggeredchat=!0);var t=getEscapedText(u.pmsg),i="",a=-1;return u.isbottrigmsg&&(t={msg:u.pmsg},i="BOT_MESSAGE",a=u.pmsg.sender),[{sender:a,dname:u.triggername,msg:t,chid:u.winid,mode:i}].concat(e)}return u.proactive?($Support.getTranscriptFromSession(u.chatID)||[]).concat(e):e},S=function(){var e=$Support.getParent().$ZSIQUtil.getAvuid();s.LSDB.storeInSession(e+"_formcontextinitiated",!0)},b=function(e){return e.meta&&(e.meta=$BotImpl.setTypingandSoundConfig(e.meta)),e},h=function(e){P();var t=e&&e[0].objString?e[0].objString.form:{};t.dname=t.dname?t.dname:U(),t.dname=u.attendername||t.dname;var i=t.msglist?t.msglist:[];if(!function(e){var t=e[0]&&e[0].meta&&e[0].meta.field_name?e[0].meta.field_name:"";if(1==e.length&&ZSIQConversationForm.maualedit&&"department"==t)return!0}(i)){var a=i[0]?i[0].mtime:"",r=i.map(function(e){return e.meta&&e.meta.input_card?e.meta.input_card.type:""}).indexOf("campaign");-1!=r&&(i[r]=E(i[r],"classic"));var o=c(e,"classic");o.isdisablecache=!0,G()?(o=b(o),o=_(o)):($Support.Util.isPreview()&&(o=b(o)),o.callback=T,o.mtime=a),o.sender="-1",ZSIQTranscript.scroll(),$BotImpl.formatAndDisplay(o,u.winid)}},_=function(e){return e.isuseredit=ZSIQConversationForm.maualedit,e.triggerclbk=ZSIQConversationForm.triggerclbk,e.time=(new Date).getTime(),delete ZSIQConversationForm.maualedit,delete ZSIQConversationForm.triggerclbk,e.callback=function(e,t,i){if("siqformskip"!=i.currentTarget.id){var a="keyup"==i.type?$(i.currentTarget).find("#siqformsave"):$(i.target);$Support.checkAndUpdateInfo(a),P()}else B(e)},e},I=function(e){var t=$Support.EmbedObj,i=$Support.getParent().$ZSIQUtil.getAPIValues()||{},a=e[0]&&e[0].objString&&e[0].objString.meta?e[0].objString.meta:e.meta||{},r=a.input_card&&a.input_card.type?a.input_card.type:"",o=i[r.replace("visitor_","")],n="department"==a.field_name;if(o||n&&-1!=u.department){var s=o||t.department;d(s,"",!0)}else{e=y(e),a.input_card&&(a.input_card.fieldtype=r,a.input_card.type="conversationforminput"),"campaign"==r&&(e=E(e,"conversation")),a.ignoremeta=!0;var p,m=$Support.Util.isPreview();e=n?F(e):e,a=a.skippable?((p=a).skip_callback=function(){var e=$("#msgarea").parents(".usrinpt"),t={val:LSResource.getRealValue("cw.form.field.skip"),metaval:JSON.stringify({type:"skip",value:"-"})};e.find(".hint").remove(),$("#msgarea").removeClass("error_bar"),$("#msgbox_main").find(".flogo").show(),L("",t,"")},p):a;var l=c(e);/^(visitor_phone|visitor_name|visitor_email||department|campaign)$/.exec(r)||(l=C(l)),l.isdisablecache=!0,l.sender="-1",m&&l.meta&&(l.meta.typing_delay=0),$BotImpl.formatAndDisplay(l,u.winid),n&&(m?$BotImpl.disableComposer():_disableComposer())}},C=function(e){var t={checkbox:"multiple-select",radio:"select",selectbox:"suggestions"},i=e.msglist?e.msglist[0]:{},a=i.meta||{},r=i.meta.input_card?i.meta.input_card:{};return t[r.type]&&(a.callback=A,r.type=t[r.type]),"suggestions"==r.type&&(a.suggestions=r.options),i.iscustomfield=!0,e},y=function(e){var t=e[0]&&e[0].objString?e[0].objString:e,i=t.meta,a=i.input_card?i.input_card:{},r=a.type||i.field_name||"";return a.placeholder=a.placeholder?a.placeholder:ZSIQConversationForm.getDefaultPlaceholder(r.replace("_","")),t.dname=t.dname?t.dname:U(),t.msg=t.msg?getEncodedText(t.msg):ZSIQConversationForm.getDefaultMessage(r.replace("_","")),e},w=function(e){for(var t=0;t<e.length;t++){var i=e[t];$BotImpl.iswidgetobj(i)&&(e[t]=y(i),!i.sender&&(i.sender="-1"))}return e},F=function(e){for(var t=[],i=e&&e[0]&&e[0].objString?e[0].objString:{},a=i.meta?i.meta:e.meta||{},r=$Support.getEmbedDepartments(),o=r.length,n=0;n<o;n++){var s=r[n],p=Q(s),m="title = "+LSResource.getRealValue("common."+p)+" dept_status = "+p;t.push({text:s.DNAME,value:s.ID,custatrr:m})}return a.suggestions=t,a.callback=A,i.msg=i.msg||LSResource.getRealValue("embed.choose_department"),e},j=function(e){var t=e.msglist?e.msglist[0]:e.objString,i=t?t.meta:{},a=i.input_card||{},r=a.maxlength||"100",o=i?i.format:"";o=o||a.type;var n=r?" charlimit "+r:"";return e.data_validate=i&&i.skippable?o+n:"required "+o+n,e.fieldtype="default",e},E=function(e,t){if("classic"==t||G())return e.msg=e.msg?e.msg:LSResource.getRealValue("embed.campaign.label"),e={meta:{field_name:"campaign",skippable:!0,format:"checkbox",key:"subscribe",hint:"",is_default_field:!0,options:[{text:e.msg,value:!0}]}};var i=e&&e[0]&&e[0].objString?e[0].objString:e,a=i.meta?i.meta:{};return i.msg=i.msg?i.msg:LSResource.getRealValue("embed.campaign.label"),a.input_card={type:"select",options:[{value:!0,text:LSResource.getRealValue("common.yes")},{value:!1,text:LSResource.getRealValue("common.no")}],data_key:"subscribe"},a.callback=A,a.skippable=!1,a.field_name="subscribe",e},D=function(e,t,i,a){if("subscribe"==e&&($Support.subscribe=JSON.parse(t)),"department"==e)ZSIQConversationManager.getChatWinObjById(a).department=t;else if(i&&null!=t){var r=$Support.EmbedObj.cinfo||{},o="object"==typeof t?t[0]?t[0].value:"":t;r[e]=o,$Support.EmbedObj.cinfo=r}else $Support.EmbedObj[e]=t},k=function(e,t){var i=$Support.EmbedObj.eprops,a=i.agentname,r=i.question;a&&(a[1].name=e),r&&(r[1].msg=t)},U=function(){return u.attendername||getEscapedText($Support.EmbedObj.eprops.agentname[1].name)||LSResource.getRealValue("ne.operator")},Z=function(e){var t=e.length,a=[];for(i=0;i<t;i++)a.push(e[i].value);return a},A=function(e){var t,i=e.data_value,a=e.config||{};"object"==typeof i&&(i=Z(i)),t={val:e.msg,metaval:JSON.stringify(meta={type:a.fieldtype,value:i})},t="subscribe"==a.fieldname?e.msg:t,$BotImpl.enableComposer(),D(a.fieldname,e.data_value,a.iscustomfield,e.chatid),L(e.element,e.data_value,t)},Q=function(e){return e.ENGAGED?"engaged":e.STATUS?"online":"offline"},R=function(e){var t=$Support.EmbedObj,i=$Support.getEmbedDepartments()||[],a=(i.length,e||t.department);for(var r in i){var o=i[r];if(o.ID===a)return o.STATUS}return t.status},q=function(e){$Support.EmbedObj;var t=$Support.getEmbedDepartments();t.length;for(var i in t){var a=t[i];if(a.NAME===e)return a.ID}},x=function(e){e?$Support.getComposer().val(u.question):ConversationFormInput.resetMessageArea(u.winid),t()},O=function(e,t,i){s.getParent().$zoho.salesiq.visitor[e](i)},V=function(e){for(var t,i,a,r=e.msglist||{},o=r.length,n=!1,s=0;s<o;s++){var p=r[s],m=p.meta?p.meta:"";if(!m||n)if("department"!=i)if(n){var l=p[t]||(m?Z(m.value).toString():"");D(a,l,!0),n=!1}else"campaign"==i&&p[t]?$Support.subscribe="Yes"==p[t]:$Support.EmbedObj[i]=p[t];else $Support.EmbedObj[i]=q(p[t]);else{if(m.card_data&&"skip"==m.card_data.type)continue;t=m.input_card?m.input_card.type:m.field_name,a=m.field_name,i=t?t.replace("_",""):"",/^(visitor_phone|visitor_name|visitor_email||department|campaign)$/.exec(t)||(n=!0,i=m.field_name)}}},L=function(e,t,i){var a=$Support.EmbedObj.visitorname,r=e?e.parents(".ziq_msg"):"",o=i||t,n="object"==typeof o?o.metaval:"";if(o="object"==typeof o?o.val:o,$Support.Util.removeSendClickAction(),i||t)if(H())_updateDeptValue(r,o);else{r&&r.find(".cmpnt-desc").length&&r.find(".msgbx").text(r.find(".cmpnt-desc").text()),$("#conversationoption").remove();var s={isvisitor:!0,sender:a,dname:a,msg:getEscapedText(o),time:MyDate.getHoursandMin((new Date).getTime(),!0,"bclient"),previoussender:!1,isdisablecache:!0};$BotImpl.formatAndDisplay(s,u.winid),Message.presender=a,ConversationFormInput.resetMessageArea(u.winid),d(o,n)}},T=function(e,t,i){if("siqformskip"==i.currentTarget.id&&(_storeClassicData(!0),B(e),!e.isuseredit&&!e.triggerclbk&&$BotImpl.formatAndDisplay(N(ZSIQConversationForm.classicformdata,e.dname),u.winid)),$Support.checkCustomFields(s.getFormContainer()),s.Util.validateFields(s.getFormContainer())){_storeClassicData(),!0;var a=u.contentdiv;s.Util.isCampaignEnabled()&&($Support.subscribe=a&&a.find('[purpose="subscribe"] input').is(":checked")),t?t(e):x(),P(),!e.isuseredit&&!e.triggerclbk&&$BotImpl.formatAndDisplay(N(ZSIQConversationForm.classicformdata,e.dname),u.winid)}};_storeClassicData=function(r){ZSIQConversationForm.classicformdata={},$("#siqform").find("[purpose]").each(function(){var e=$(this),t=e.attr("purpose");if("custom"==t)return!0;var i=e.attr("fieldkey"),a=e.val()||e.attr("val");return!!isUndefined(i)||(r?(ZSIQConversationForm.classicformdata[i]={msg:LSResource.getRealValue("cw.form.field.skip"),meta:{type:"skip",value:""}},!0):(a="department"==t?e.find("#dropheader").text():a,a="subscribe"==t?1==e.find("input").prop("checked"):a,(isUndefined(a)||""==a)&&(a=LSResource.getRealValue("cw.form.emptyfieldvalue","")),void(ZSIQConversationForm.classicformdata[i]=a)))}),r&&(ZSIQConversationForm.classicformdata.skip=!0)};var B=function(e){!0;var t=!(!e.isuseredit&&!e.triggerclbk);P(),t||x()},P=function(){var e=$("#siqform").parents(".ziq_msg");e.prev('[frstmsg="true"]').remove(),e.remove(),$BotImpl.enableComposer()},t=function(){var t=$Support.EmbedObj.pprops,i=M();$Support.updateInputValues(u);var e=s.EmbedObj.status&&R(u.department)?function(){u.initiateChat()}:function(){if(i&&!s.EmbedObj.status){var e=u.contentdiv;return e.find(".sqico-edit").remove(),e.find("div[purpose=name]").attr("documentclick",""),u.hideUserEditUI(),$UI.appendChatConsentDiv(null,!1,t.chatcookiepolicyurl,u),void ZSIQTranscript.scroll()}$Support.EmbedObj.offlinedeptid=u.department,s.handleLeaveMessage(u.question,u.winid)};u.proactive&&(e=function(){var e=ZSIQConversationForm.getFormType()==CLASSIC_VIEW?ZSIQConversationForm.getFormatedResponse():"";$Support.joinProactiveChat(u.question,u,e)}),s.Util.handleStartChat(e,"",u.winid)},M=function(){var e=1==$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.isgdprenabled,t=$Support.EmbedObj.pprops,i=$Support.LSDB.getFromSession(_SCREENNAME+"_gdpr_chatconsent");return!(!e||!JSON.parse(t.isgdprenabled)||1!=JSON.parse(t.chatprivacyconfig)||i)},N=function(e,t,i){var a="";i=i||MyDate.getHoursandMin((new Date).getTime(),!0,"bclient");for(var r in e)if(e[r]&&"subscribe"!=r&&r){var o=e[r].meta||{};if("skip"==((o.card_data||{}).type||o.type||r)){a=LSResource.getRealValue("cw.form.field.skip");break}a+="<b>"+getEscapedText(r)+"</b><br>"+getEscapedText(e[r])+"<br>"}return{sender:t,dname:t,msg:a,isvisitor:!0,time:i,isdisablecache:!0}};_disableComposer=function(){setTimeout(function(){$BotImpl.disableComposer()},2e3)};var G=function(e){return ZSIQConversationForm.maualedit},W=function(){var e,t=$Support.getParent().$ZSIQUtil.getAvuid(),i=H();i&&(u.question=i,$Support.Util.showMessageAreaUI("","","",u),u.showChatArea()),S(),!i&&s.LSDB.storeInSession(t+"_vist_ques",u.question),e=[{sender:"-1",dname:U(),meta:{field_name:"department",skippable:!1,isskiptopost:!1},msg:LSResource.getRealValue("embed.choose_department"),mtime:""+(new Date).getTime(),currwinobj:u}],$Support.handleOnGoingchatActionsInConversation("formchat",e[0]),e=F(e[0]),(e=c(e)).isdisablecache=!0,$BotImpl.formatAndDisplay(e,u.winid),_disableComposer()};_updateDeptValue=function(e,t){e.prev("#bottype_msg").remove(),e.remove(),!0,x()};var H=function(){var e=$Support.getParent().$ZSIQUtil.getAvuid();return s.LSDB.getFromSession(e+"_vist_ques")},J=function(e){var t=$Support.fieldlist||[],i=t.map(function(e){return e.meta?e.meta.input_card?e.meta.input_card.type:e.meta.field_name:""}).indexOf(e);-1!=i&&t.splice(i,1)},z=function(){return!$Support.getCookieValue("ZLD"+$Support.EmbedObj.livelsid)||$Support.Util.IsMandatoryFieldsAvailable()||ZSIQConversationForm.getFormType()==CLASSIC_VIEW},K=function(e){if(e){for(var t=e.msglist||[],i=($Support.fieldlist=t).length,a=[],r=0;r<i;r++){var o=t[r],n=o.meta||{};if("department"!=n.field_name&&"subscribe"!=n.key){var s=n.input_card||{},p=s.type||n.field_name,m=$Support.EmbedObj.eprops;/^(visitor_phone|visitor_name|visitor_email||department|campaign)$/.exec(p)?m[l[p]]={0:"true",1:{ismandatory:!n.skippable,placeholder:s.placeholder,question:o.msg}}:a.push({hint:s.placeholder,index:r,name:n.field_name,options:s.options,required:!n.skippable,type:p,visibility:s.visibility,maxlength:s.maxlength,style:s.style,question:n.msg})}}$Support.customobj=a}},Y=function(e){(s.getParent().$ZSIQAutopick||{}).isenabled=e};return{fetchConfigurations:function(e){if(u=e,!1,z())return S(),void r(!0);"-1"!=$Support.EmbedObj.department?x(!0):r("",!0,"",W)},handleStartChat:function(e){$TH.showChatArea(),!$Support.isNewHeader()&&$TH.populateSendBtn(LSResource.getRealValue("ne.send"));var t=s.getParent().$ZSIQUtil.getAPIValues();s.handleApiData(t),t.floatwindowfields&&s.handleFieldVisibility(t.floatwindowfields),s.Util.setMessageClass()},validateConversation:function(e,t){var i=$("#msgarea");if(i.parents(".usrinpt").find(".hint").remove(),i.removeClass("error_bar"),$("#msgbox_main").find(".flogo").show(),$Support.toggleSendButton(e),!t||13==s.Util.getKeyCode(t)){var a,r,o=i.attr("purpose");if(!i.validateInput()){var n={visitorname:"ne.errorinfo.name",visitoremail:"ne.errorinfo.email",visitorphone:"ne.errorinfo.phone"}[o];return(n=n?LSResource.getRealValue(n):/^number|email|url|percentage|percent|decimal|name|email|phone$/.exec(o)?LSResource.getRealValue("ne.errorinfo."+o):"")&&(a=n,(r=$("#msgarea").parents(".usrinpt")).find(".hint").remove(),$("#msgbox_main").find(".flogo").show(),a&&(r.append('<div class="hint">( '+a+" )</div>"),$("#msgbox_main").find(".flogo").hide())),void i.addClass("error_bar")}!function(e){var t=e.val()||$("#msgarea").val();if("true"==e.attr("iscustomfield")){var i=e.attr("fieldtype");D(i,t,!0)}else{var a=e.attr("purpose");"visitorname"==a&&O("name","visitorname",t),"visitoremail"==a&&O("email","visitoremail",t),"visitorphone"==a&&O("contactnumber","visitorphone",t)}L(e,t)}(i)}},clearSessionStorage:function(){var e=$Support.getParent().$ZSIQUtil.getAvuid();$Support.LSDB.removeSessionStore(e+"_formcontextinitiated"),$Support.LSDB.removeSessionStore(e+"_vist_ques"),delete ZSIQConversationForm.classicformdata},checkInputVal:function(e){e.attr("value",$.trim(e.val())),e.val()||e.parent().removeClass("sel")},getOperatorName:U,getFormQuestion:function(){return s.EmbedObj.eprops.question[1].msg||LSResource.getRealValue("ne.operator.question","")},fetchFieldsToEdit:function(e,t,i){if(i&&(u=i),ZSIQConversationForm.maualedit=e,ZSIQConversationForm.triggerclbk=t){var a=$Support.EmbedObj;return u.question=$.trim(u&&u.composer.val())||$Widget.getLastMessage(),$BotImpl.formatAndDisplay({sender:a.visitorname,dname:a.visitorname,msg:u.question,isques:u.question},u.winid),u&&u.composer.val(""),void this.fetchConfigurations(u)}r()},updateAndGetClassicFormData:function(e){var t=e.msg;_classicformdata={};var i=t.msglist||[];i=w(i);for(var a,r=t.title||LSResource.getRealValue("ne.operator.question",""),o=MyDate.getHoursandMin(e.time,!0,"bclient"),n=t.msglist.length,s=0;s<n;){if(i[s]&&i[s].meta){a=i[s].dname||U();var p=i[s].meta.input_card?i[s].meta.input_card.type:"",m=p?ZSIQConversationForm.getDefaultPostMessage(p.replace("_","")):ZSIQConversationForm.getDefaultPostMessage(i[s].meta.field_name)||i[s].msg;_classicformdata[m]=i[s+1].meta&&i[s+1].meta.card_data?i[s+1]:i[s+1].msg}s+=2}return(i=[]).push({sender:"-1",dname:a,msg:r,time:o}),i.push(N(_classicformdata,"",o)),i},updateformconfig:function(){for(var e=$Support.fieldlist||[],t=$Support.EmbedObj.eprops||{},i=$Support.Util.isCampaignEnabled(),a=(t.agentname&&t.agentname[1],t.question&&t.question[1],$Support.EmbedObj.integprops||{}),r=a.integinfo?a.integinfo[$Support.enabledCampaignID]:{},o=r?r.subscribelabel:"",n=[{isenabled:"true"==t.isname[0],data:t.isname[1]||{},format:"text",type:"visitor_name"},{isenabled:"true"==t.isemail[0],data:t.isemail[1]||{},format:"email",type:"visitor_email"},{isenabled:"true"==t.isphoneno[0],data:t.isphoneno[1]||{},format:"phone",type:"visitor_phone"},{isenabled:i,data:{question:o},type:"campaign"}],s=[],p=0;p<n.length;p++){var m=n[p],l=m.isenabled,u=m.type;l?(J(m.type),s.push({dname:"",meta:{format:m.format,input_card:{placeholder:m.data.placeholder,type:u},skippable:!CommonUtil.parseToJSON(m.data.ismandatory),msg:m.data.question}})):J(m.type)}s.length&&(e=s.concat(e)),$Support.fieldlist=e},reSetFormValues:function(){!1},getFormType:function(){var e=$Support.EmbedObj,t=e.eprops;return e.isformremoval?t.formtype&&t.formtype[1]?t.formtype[1].val:void 0:"2"},getFormatedResponse:function(){var e=[],t=!(!ZSIQConversationForm.classicformdata||!ZSIQConversationForm.classicformdata.skip);for(var i in ZSIQConversationForm.classicformdata)t?"skip"!=i&&e.push(ZSIQConversationForm.classicformdata[i]):e.push({msg:ZSIQConversationForm.classicformdata[i]});return JSON.stringify(e)},checkContextInitiated:function(){var e=$Support.getParent().$ZSIQUtil.getAvuid();return!!$Support.LSDB.getFromSession(e+"_formcontextinitiated")},getDefaultPlaceholder:function(e){var t=a[e];return t?LSResource.getRealValue(t.placeholder):""},getDefaultMessage:function(e){var t=a[e];return t?LSResource.getRealValue(t.message):""},getDefaultPostMessage:function(e){var t=a[e];return t?LSResource.getRealValue(t.postmessage):""},isOldFormView:function(){return this.getFormType()==OLDFORM_VIEW&&!this.checkContextInitiated()},checkFormContext:function(){return!this.isOldFormView()&&!this.checkContextInitiated()&&(z()||"-1"==$Support.EmbedObj.department)},checkAndGetFormTranscript:function(e){var t=this.checkContextInitiated(),i=H();if(t||i){if(!e)return void ZSIQConversationManager.init({winid:(new Date).getTime()},"formview");var a=e;if(t&&!i)return S(),void r("","",a);i&&this.fetchConfigurations(a)}},formatAndPopulateTranscript:function(e,t,i,a){var r=e.chattrasncript,o=e.fieldtranscript,n=e.currindex+1;o=w(o);var s=r.slice(0,n-1).concat(o).concat(r.slice(n));$Support.Util.populateChatUI(s,t,i,a)},isCustomFieldExist:function(){var e=$Support.getParent().$ZSIQUtil.getAPIValues().customfield;return e&&e.length},isNewAppsUI:function(e){var t=parent.parent;if(e){if(t&&t.MESSANGER_SUBTAB)return!0}else if(t&&"siqforms"==t.MESSANGER_SUBTAB)return!0;return!1},fetchAllFields:function(){if($Support.Util.isPreview()&&$Support.fieldlist)return this.isNewAppsUI()&&K({msglist:$Support.fieldlist}),void $Support.handleChatWindowUI();r("",!0)},handleClassicConfig:m,updateFieldsData:K,handleConversationForm:I,getSelectedDeptstatus:R,setFormFieldsInEobj:g}}(),ZSIQConversationForm.reSetFormValues();function CallImpl(){}var AV_INCOMINGCALL=1,AV_OUTGOINGCALL=2,AV_CONNECTING=3,AV_ONGOING=4,AV_RECONNECTING=5,AV_USERBUSY=6,AV_BODY=7,AV_CALLAGAIN=8,AV_RATING=9,AV_FDBCK=10,AV_FDBCKSUCCESS=11,AV_RATINGSUCCESS=12,AV_FDBKRATINGSUCCESS=13,AV_STARTRECORD=14,AV_RECORDING=15,AV_PLAY=16,AV_RECORDSENTSUCCESS=17,AV_DEPT=18,AV_MINIMIZE=1,AV_MAXIMIZE=2,AV_FEDBCK=3;CallImpl.updateUI=function(e,l){switch(e){case AV_OUTGOINGCALL:CallUIHandler.getTemplate(AV_OUTGOINGCALL,AV_MINIMIZE);break;case AV_CONNECTING:CallUIHandler.getTemplate(AV_CONNECTING,AV_MINIMIZE);break;case AV_ONGOING:CallUIHandler.getTemplate(AV_ONGOING,AV_MINIMIZE);break;case AV_RECONNECTING:CallUIHandler.getTemplate(AV_RECONNECTING,AV_MINIMIZE);break;case AV_BODY:CallUIHandler.getTemplate(AV_BODY,AV_MAXIMIZE),$(".cal-bodycont").on("scroll",function(e){CallImpl.handlescroll()});break;case AV_USERBUSY:if(!avimpl.isAudioRecordingSupported()){avimpl.terminateAudioCall();break}CallUIHandler.getTemplate(AV_USERBUSY,AV_MINIMIZE),avimpl.audiorecorder&&avimpl.audiorecorder.destroy(),avimpl.audiorecorder=Recorder(),avimpl.audiorecorder.init();break;case AV_RATING:CallUIHandler.getTemplate(AV_RATING,AV_MINIMIZE);break;case AV_CALLAGAIN:CallUIHandler.getTemplate(AV_CALLAGAIN,AV_MAXIMIZE);break;case AV_RATINGSUCCESS:CallUIHandler.getTemplate(AV_RATINGSUCCESS,AV_MINIMIZE);break;case AV_FDBCK:CallUIHandler.getTemplate(AV_FDBCK,AV_FEDBCK),$(".cal-footer").on("keyup",function(){CallImpl.checkFeedbackMsgHgt()}).focus();break;case AV_FDBCKSUCCESS:CallUIHandler.getTemplate(AV_FDBCKSUCCESS,AV_MAXIMIZE);break;case AV_RECORDING:CallUIHandler.getTemplate(AV_RECORDING,AV_MINIMIZE,-1);break;case AV_PLAY:CallUIHandler.getTemplate(AV_PLAY,AV_MINIMIZE,-1);break;case AV_RECORDSENTSUCCESS:CallUIHandler.getTemplate(AV_RECORDSENTSUCCESS,AV_MINIMIZE,-1)}},CallImpl.handlescroll=function(){var e=$(".cal-bodycont").scrollTop();if($("#call_inptfields").height()+$(".dup_div").height()<e)return $(".cal-deflnk").addClass("scrl_fix"),void $(".adocal-cont").addClass("scrl_anim");$(".adocal-cont").css("padding-top",25-e/15+"px").removeClass("scrl_anim"),$(".cal-visimg ").css("height",60-e/7+"px").css("width",60-e/7+"px"),$(".cal-cmpname").css("font-size",20-e/35+"px"),$(".cal-deflnk").removeClass("scrl_fix"),"theme4"==CallImpl.getTheme()&&$(".thme-bgimg").css("height",60-e/5.8+"px")},CallImpl.handleDeptClick=function(e){$(".cal-bodycont").animate({scrollTop:$(".cal-bodycont").height()-$("#call_inptfields").height()+$(".cal-deflnk").height()+81},"500")},CallImpl.handleDeptSelect=function(e){if(!$(e).attr("status"))return!(e.title="Offline");$Support.EmbedObj.department=e.id,$("#call_deptlist").children().removeClass("dep-sel"),e.className+=" dep-sel",$(".cal-bodycont").animate({scrollTop:$("#call_deptlist").height()+70},200),$("#dept_strtcall").removeClass("bg-grn").removeClass("bg-ddd").addClass("bg-grn")},CallImpl.startCall=function(){this.isCallWithChat=!0,this.updateUI(AV_BODY)},CallImpl.getAttenderImgHtml=function(){var e=ZSIQConversationManager.getChatWinObjById(avimpl.chid).attenderimagefkey;return e&&0!=e.split("_")[0]?'<div class="cal-visimg "><img src='+(e=_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/userimg/"+e+"/photo.ls?nps=404")+"></div>":'<div class="cal-visimg sqico-user"></div>'},CallImpl.compImgHtml=function(){var e=$Support.EmbedObj.clogo;return e?'<div class="cal-visimg "><img src='+e+"></div>":'<div class="cal-visimg sqico-user"></div>'},CallImpl.getCompImgHtmlCALFAQ=function(){return'<div class="faqcal-img"><img src='+$Support.EmbedObj.clogo+"></div>"},CallImpl.getAttenderImgCALFAQHtml=function(){var e=ZSIQConversationManager.getChatWinObjById(avimpl.chid).attenderimagefkey;return e&&0!=e.split("_")[0]?'<div class="faqcal-img"><img src='+(e=_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/userimg/"+e+"/photo.ls?nps=404")+"></div>":'<div class="faqcal-img sqico-user"></div>'},CallImpl.checkAndStartCall=function(e){if(!$("#dept_strtcall").hasClass("bg-ddd")){var l=$("#call_inptfields");if(!$Support.Util.validateFields(l))return $(".cal-bodycont").animate({scrollTop:0},500),!1;""!=$("#visname").val().trim()&&($Support.EmbedObj.visitorname=$("#visname").val()),""!=$("#visemail").val().trim()&&($Support.EmbedObj.visitoremail=$("#visemail").val()),this.isCallWithChat=!0,CallImpl.updateUI(AV_OUTGOINGCALL),$Support.startChat()}},CallImpl.checkFeedbackMsgHgt=function(){var e=$Support.container;$("#faqcall").length&&(e=$("#faqcall"));var l=e.find(".cal-footer"),a=e.find("#fdbkarea");l.removeAttr("style");var t=a[0].scrollHeight+2,i=140<t?{height:"140px",overflow:"auto"}:t<70?{height:"70px",overflow:"auto"}:{height:t+"px",overflow:"hidden"};l.css(i)},CallImpl.getCompValueForKey=function(e){var l=window.parent.$ZSIQWidget.getEmbedObject().pinfo;return"name"==e?l.companyname:""},CallImpl.isCallAloneEmbed=function(){return CallImpl.isCallWithChat},CallImpl.getAttenderName=function(){var e=ZSIQConversationManager.getChatWinObjById(avimpl.chid).attendername;return e?getEncodedText(e):""},CallImpl.handleSettingUI=function(e){if(0<$("#audio_setting",parent.document).length)return"none"===$("#audio_setting",parent.document).css("display")?void $("#audio_setting",parent.document).show():void $("#audio_setting",parent.document).hide();avaction.displaySettingUI()},CallImpl.getTheme=function(){var e=window.parent.$ZSIQWidget.getWidgetObject().calltheme;return e||"theme1"},CallImpl.getBackGndImg=function(e){return"theme4"!=this.getTheme()?"":'<div class="thme-bgimg" style="background-image:url('+("Comp"==e?$Support.EmbedObj.clogo:_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/userimg/"+$Support.EmbedObj.attenderimagefkey+"/photo.ls?nps=404")+')"></div>'},CallImpl.checkInputFields=function(){var e=$("#callfaq_inptfields");if(!$Support.Util.validateFields(e))return!1;""!=$("#visname").val().trim()&&($Support.EmbedObj.visitorname=$("#visname").val()),""!=$("#visemail").val().trim()&&($Support.EmbedObj.visitoremail=$("#visemail").val()),CallUIHandler.getTemplate(AV_DEPT,AV_MAXIMIZE)},CallImpl.checkDeptFields=function(){$("#dept_strtcall").parent().hasClass("fcal-enb")&&(this.isCallWithChat=!0,CallImpl.updateUI(AV_OUTGOINGCALL),$Support.startChat())},CallImpl.handleFAQClick=function(e){$("body").find("#faqcall").remove(),e&&$("body").append($Temp.getOnCallUI(avimpl.attenderimgurl)),$Support.container.find(".sqico-faqico").click(),document.getElementsByClassName("zsembd_audiocl")[0].sdrag()},CallImpl.updateRecorderHTML=function(e){var l=$Support.chidmappinglist[e];ZSIQConversationManager.getChatWinObjById(l).contentdiv.find(".usrinpt").append($Temp.getRecorderHTML().replace(/{SQICOVOICENOTE}/g,l))};function CallUIHandler(){}CallUIHandler.classmapp={},CallUIHandler.classmapp[AV_INCOMINGCALL]="",CallUIHandler.classmapp[AV_OUTGOINGCALL]="outcal",CallUIHandler.classmapp[AV_CONNECTING]="cal-recnct",CallUIHandler.classmapp[AV_ONGOING]="outcal",CallUIHandler.classmapp[AV_RECONNECTING]="cal-recnct",CallUIHandler.classmapp[AV_USERBUSY]="",CallUIHandler.classmapp[AV_RATING]="pL25",CallUIHandler.classmapp[AV_USERBUSY]="";var CALLALONE=1,CALLPLUSFAQ=2,CHATPLUSCALLPLUSFAQ=3;CallUIHandler.getTemplate=function(l,a,e){if("FAQPLUSCALL"!=CallImpl.getTheme()){switch((-1==e?$("#audiorec"):$("#audiocal")).replaceWith(this.mapTemp(l)),handleDrag(),setTimeout(function(){$(".zsembd_audiocl").hide()},1),a){case AV_MINIMIZE:$Support.getParent().$ZSIQWidgetUI.handleMinimizeCall();break;case AV_MAXIMIZE:$Support.getParent().$ZSIQWidgetUI.handleMinCall();break;case AV_FEDBCK:$Support.getParent().$ZSIQWidgetUI.handlefbCall()}}else 0<$("body").find("#faqcall").length?$("body").find("#faqcall").replaceWith(this.getTempForCALLPLUSFAQ(l,CALLPLUSFAQ)):$("body").prepend(this.getTempForCALLPLUSFAQ(l,CALLPLUSFAQ))},CallUIHandler.mapTemp=function(l){return"theme5"==CallImpl.getTheme()?this.getTempForSignChat(l):CallUIHandler.classmapp.hasOwnProperty(l)?this.getTempForThemes(l):this.getRequiredHtml(l)},CallUIHandler.getRequiredHtml=function(l,a){var e="";switch(l){case AV_INCOMINGCALL:e=a==CALLPLUSFAQ?this.getFQCALINCallhtml():this.getIncommingCallHtml();break;case AV_OUTGOINGCALL:e=a==CALLPLUSFAQ?this.getFQCALOUTCallhtml():this.getOutgoingCallHtml();break;case AV_CONNECTING:e=a==CALLPLUSFAQ?this.getFQCALConnectingCallhtml():this.getConnectingHtml();break;case AV_ONGOING:e=a==CALLPLUSFAQ?this.getFQCALOnCallhtml():this.getOnGoingCallHtml();break;case AV_RECONNECTING:e=this.getReConnectingHtml();break;case AV_USERBUSY:e=a==CALLPLUSFAQ?this.getFQCALUserBusyhtml():this.getUserBusyHtml();break;case AV_RATING:e=a==CALLPLUSFAQ?this.getFQCALRatinghtml():this.getRatingHtml();break;case AV_BODY:e=a==CALLPLUSFAQ?this.getFQCALBodyhtml():this.getBodyHtml();break;case AV_DEPT:e=this.getFQCALDepthtml();break;case AV_CALLAGAIN:e=a==CALLPLUSFAQ?this.getFQCALCallAgainhtml():this.getCallCancelledHtml();break;case AV_RATINGSUCCESS:e=this.getRatingSuccessHtml();break;case AV_FDBCK:e=a==CALLPLUSFAQ?this.getFQCALFDBKhtml():this.getFdbkratingHtml();break;case AV_FDBCKSUCCESS:e=a==CALLPLUSFAQ?this.getFQCALFDBKSucesshtml():this.getFdbkSuccessHtml();break;case AV_RECORDING:e=a==CALLPLUSFAQ?this.getFQCALRecordhtml():this.getRecordingHtml();break;case AV_PLAY:e=a==CALLPLUSFAQ?this.getFQCALAVPlayhtml():this.getRecordAVPlayHtml();break;case AV_RECORDSENTSUCCESS:e=a==CALLPLUSFAQ?this.getFQCALRecordSuccesshtml():this.getRecordSuccessHtml()}return e},CallUIHandler.getTempForThemes=function(l){return['<div class="cal-wrap" id="'+(l==AV_USERBUSY?"audiorec":"audiocal")+'"><div class="posrel dib-mid">','<div class="cal-widgt '+CallImpl.getTheme()+" "+CallUIHandler.classmapp[l]+'">','<div class="actbtn"><em class="sqico-min sqico-settings" id="call_stngicon" title="'+LSResource.getRealValue("common.settings")+'" onclick="CallImpl.handleSettingUI(this)"></em></div>',this.getRequiredHtml(l),"</div>","</div></div>"].join("")},CallUIHandler.getTempForSignChat=function(l){return['<div class="cal-wrap" id="audiocal"><div class="posrel dib-mid">','<div class="cal-widgt '+CallImpl.getTheme()+" "+CallUIHandler.classmapp[l]+'">','<div class="actbtn"><em class="sqico-min sqico-settings" id="call_stngicon" title="'+LSResource.getRealValue("common.settings")+'" onclick="CallImpl.handleSettingUI(this)"></em></div>',this.getRequiredHtml(l),"</div></div>"].join("")},CallUIHandler.getTempForCALLPLUSFAQ=function(l,a){return['<div class="faq-cal" id="faqcall"> <div class="fcal-actnbtn"> <em id="call_stngicon" class="sqico-settings dib-mid curP" title="'+LSResource.getRealValue("common.settings")+'" onclick="CallImpl.handleSettingUI()"></em> <em class="sqico-min siq-minimize-icon dib-mid curP" title="'+LSResource.getRealValue("common.minimize")+'" documentclick="min_iframe"></em> </div><div class="faqcal-wndw">',this.getRequiredHtml(l,a),"</div></div>"].join("")},CallUIHandler.getNameText=function(){var l=CallImpl.getAttenderName();return'<nav class="cal-actvevstr elips font18" title="'+l+'">'+l+"</nav>"},CallUIHandler.getOutgoingCallHtml=function(){return['<div class="posrel usr-imginfo"> '+CallImpl.compImgHtml()+" </div> ",'<div class="cal-vstrdetl"> <nav class="cal-actvevstr elips font18">'+CallImpl.getCompValueForKey("name")+'</nav> <p class="cal-usrdesc elips">'+LSResource.getRealValue("av.info.calling")+"</p> </div>",' <div class="cal-optns posrel textR"> <span id="audiocall_mute" class="sqico-microphone bg-aaa" onclick="avimpl.toggleMute(this)"></span> <span class="sqico-call cal-rjct cmn_disable" id="audiocall_outgoingend" onclick="avimpl.terminateAudioCall(true,true);"></span> </div>'].join("")},CallUIHandler.getIncommingCallHtml=function(){return['<div class="posrel usr-imginfo"> '+CallImpl.getAttenderImgHtml()+" </div>",'<div class="cal-vstrdetl"> '+CallUIHandler.getNameText()+' <p class="cal-usrdesc elips">'+LSResource.getRealValue("av.info.reconnecting")+"</p> </div> ",'<div class="cal-optns posrel textR"> <span id="audiocall_mute" class="sqico-microphone bg-aaa" onclick="avimpl.toggleMute(this)"></span> <span class="sqico-call cal-rjct" onclick="avimpl.stopOngoingCall()"></span> </div>'].join("")},CallUIHandler.getOnGoingCallHtml=function(){return[' <div class="posrel usr-imginfo"> '+CallImpl.getAttenderImgHtml()+" </div>",' <div class="cal-vstrdetl"> '+CallUIHandler.getNameText()+' <p class="cal-usrdesc elips" id="sqico-timer">00:00</p> </div>',' <div class="cal-optns posrel textR"> <span id="audiocall_mute" class="sqico-microphone bg-aaa" onclick="avimpl.toggleMute(this)"></span> <span class="sqico-call cal-rjct" onclick="avimpl.stopOngoingCall();"></span> </div>'].join("")},CallUIHandler.getConnectingHtml=function(){return['<div class="posrel usr-imginfo"> '+CallImpl.getAttenderImgHtml()+" </div>",'<div class="cal-vstrdetl"> '+CallUIHandler.getNameText()+' <p class="cal-usrdesc elips">'+LSResource.getRealValue("av.info.connecting")+"</p> </div> ",'<div class="cal-optns posrel textR"> <span id="audiocall_mute" class="sqico-microphone bg-aaa" onclick="avimpl.toggleMute(this)"></span> <span class="sqico-call cal-rjct" onclick="avimpl.terminateAudioCall(true,true)"></span> </div>'].join("")},CallUIHandler.getReConnectingHtml=function(){return['<div class="posrel usr-imginfo"> '+CallImpl.getAttenderImgHtml()+" </div>",'<div class="cal-vstrdetl"> '+CallUIHandler.getNameText()+' <p class="cal-usrdesc elips">'+LSResource.getRealValue("av.info.reconnecting")+"</p> </div> ",'<div class="cal-optns posrel textR"> <span id="audiocall_mute" class="sqico-microphone bg-aaa" onclick="avimpl.toggleMute(this)"></span> <span class="sqico-call cal-rjct" onclick="avimpl.stopOngoingCall()"></span> </div>'].join("")},CallUIHandler.getUserBusyHtml=function(){return['<div class="posrel usr-imginfo">'+CallImpl.compImgHtml()+"</div>",'<div class="cal-vstrdetl"><nav class="cal-actvevstr elips font18">'+LSResource.getRealValue("av.info.oprbusy")+'</nav><p class="cal-usrdesc elips">'+LSResource.getRealValue("av.info.voicemsg")+"</p></div>",'<div class="cal-optns posrel textR"><span cntrl="startRecord" class="sqico-record bg-aaa"></span></div>'].join("")},CallUIHandler.getRatingHtml=function(){var l=$Support.EmbedObj.ratingtitle?$Support.EmbedObj.ratingtitle:LSResource.getRealValue("ne.rating.byline");return['<div class="posrel usr-imginfo">'+CallImpl.getAttenderImgHtml()+"</div>",'<div class="cal-vstrdetl textC"><nav class="cal-actvevstr elips font16">'+LSResource.getRealValue("av.info.rating")+'</nav><div class="rating font18"><span class="reaction_ico sad_icon" data-reaction="sad" documentclick="sendCallRating"></span><span class="reaction_ico neutral_icon" data-reaction="neutral" documentclick="sendCallRating"></span><span class="reaction_ico happy_icon" data-reaction="happy" documentclick="sendCallRating"></span></div><p class="c777 font14">'+l+"</p>","</div></div>"].join("")},CallUIHandler.getStarHTML=function(l){for(var a="",e=null!=l?"":'documentclick="sendCallRating"',s=0;s<5;s++)a+='<span class="sqico-star'+(s===l?" sel":"")+'" '+e+"></span>";return a},CallUIHandler.getCallCancelledHtml=function(){return['<div class="cal-wrap" id="audiocal"> <div class="adocal-cont dtfix '+CallImpl.getTheme()+'"> '+CallImpl.getBackGndImg("Comp")+'<div class="header">',' <div class="actbtn"><em class="sqico-min siq-minimize-icon" title="'+LSResource.getRealValue("ne.title.minimize")+'" documentclick="min_iframe"></em></div> '+CallImpl.compImgHtml()+' <div> <div class="cal-cmpname font20 fontB">'+CallImpl.getCompValueForKey("name")+'</div> <div class="cal-cmpdesc lH22 font14"></div> </div> </div>',' <div class="cal-bodycont posrel"> <p class="cal-weldesc lH22 c333">'+CallImpl.getCompValueForKey("desc")+'</p> <div class="sqico-call bg-grn mA" onclick="parent.$zohosq.call.start()"></div> </div> </div> </div>'].join("")},CallUIHandler.getFdbkratingHtml=function(){var l=ZSIQConversationManager.getChatWinObjById(avimpl.chid).rating;return['<div class="cal-wrap" id="audiocal"> <div class="adocal-cont dtfix '+CallImpl.getTheme()+' cal-oflne" style="height:354px;"> '+CallImpl.getBackGndImg()+' <div class="header">',' <div class="actbtn"><em class="sqico-min siq-minimize-icon" title="'+LSResource.getRealValue("ne.title.minimize")+'" documentclick="min_iframe"></em></div> <div class="posrel dib-mid"> '+CallImpl.getAttenderImgHtml()+'<em class="reaction_ico '+$Support.rating+'_icon usr-rtng" title="'+l+'"></em></div> <div> <div class="cal-cmpname font20 fontB">'+CallImpl.getAttenderName()+"</div> </div> </div>",' <div class="cal-bodycont posrel"> <div class="ofln-msg mT5">'+$Support.getReactionIndex(l)+'</div> </div> <div class="cal-footer" style="height:70px;"> <textarea class="bg-f6 font13 c333 lH20" dockeyup="feedback" dockeydown="textarea" id="fdbkarea" data-validate="required" placeholder="'+LSResource.getRealValue("av.info.fdkbckmsg")+'" autofocus></textarea> <div class="sqico-calsend fdbak-send msg-send" documentclick="sendCallFb"></div> </div> </div> </div>'].join("")},CallUIHandler.getFdbkSuccessHtml=function(){return['<div class="cal-wrap" id="audiocal"> <div class="adocal-cont dtfix '+CallImpl.getTheme()+' cal-oflne"> '+CallImpl.getBackGndImg()+' <div class="header">',' <div class="actbtn"><em class="sqico-min siq-minimize-icon" title="'+LSResource.getRealValue("ne.title.minimize")+'" documentclick="min_iframe"></em></div> <div class="posrel dib-mid"> '+CallImpl.getAttenderImgHtml()+'<em class="reaction_ico '+$Support.rating+'_icon usr-rtng" title="'+$Support.rating+'"></em></div> <div> <div class="cal-cmpname font20 fontB">'+CallImpl.getAttenderName()+"</div> </div> </div>",' <div class="cal-bodycont posrel"> <div class="ofln-msg mT5">'+LSResource.getRealValue("av.info.ratingandfbk")+'</div> <div class="sqico-call bg-grn mT25 mA" title="'+LSResource.getRealValue("av.info.callagain")+'" onclick="$Support.startChat()"></div> </div> </div> </div>'].join("")},CallUIHandler.getRecordingHtml=function(){return['<div class="cal-wrap ado-rec" id="audiorec"><div class="cal-widgt '+CallImpl.getTheme()+'">','<div class="actbtn"><em class="sqico-min sqico-settings" title="'+LSResource.getRealValue("common.settings")+'" onclick="CallImpl.handleSettingUI(this)"></em></div><div class="posrel usr-imginfo"> '+CallImpl.compImgHtml()+'</div><div class="cal-vstrdetl"><p class="cal-vstmsg" id="sqico-timer">00:00:00</p><p class="cal-usrdesc elips">'+LSResource.getRealValue("av.info.recordingaudio")+"</p></div>",'<div class="vc-recrd pR10" id="sqico-canvas"></div><div class="cal-optns posrel textR"><div class="recd-optn" cntrl="stopRecord" ></div><em class="font14 rec-timer" id="sqico-remtimer">00:00</em></div></div></div>'].join("")},CallUIHandler.getRecordAVPlayHtml=function(){return['<div class="cal-wrap" id="audiorec"><div class="posrel dib-mid"><div class="cal-widgt '+CallImpl.getTheme()+'">','<div class="actbtn"><em class="sqico-min sqico-settings" title="'+LSResource.getRealValue("common.settings")+'" onclick="CallImpl.handleSettingUI(this)"></em></div><div class="posrel usr-imginfo"> '+CallImpl.compImgHtml()+"</div>",'<div class="cal-vstrdetl"><div id="slide" ><div id="fill" style="width: 2px;"></div><div id="thumb" style="left: 0px;"></div></div><div class="cal-usrdesc mT5"><div cntrl="playRecord" class="sqico-play font12 mR10 curP" title="'+LSResource.getRealValue("av.info.play")+'"></div><div id="sqico-timer" style="display:inline;">00:00 / 00:00</div></div></div><div class="cal-optns posrel textR"><span class="sqico-record  bg-aaa font19" cntrl="startRecord" title="'+LSResource.getRealValue("av.info.record")+'"></span><span class="sqico-videosend bg-blue mL20" cntrl="uploadRecord" title="'+LSResource.getRealValue("common.upload")+'"></span></div></div></div></div>'].join("")},CallUIHandler.getRecordSuccessHtml=function(){return['<div class="cal-wrap" id="audiocal"><div class="posrel dib-mid"><div class="cal-widgt '+CallImpl.getTheme()+' pL25">','<div class="actbtn"><em class="sqico-min sqico-settings" title="'+LSResource.getRealValue("common.settings")+'" onclick="CallImpl.handleSettingUI(this)"></em></div><div class="posrel usr-imginfo"> '+CallImpl.compImgHtml()+"</div>",'<div class="cal-vstrdetl"><p class="cal-vstmsg textC">'+LSResource.getRealValue("av.info.voicesent")+'</p></div><div class="cal-optns posrel textR"><span class="sqico-call cal-acpt" onclick="parent.$zohosq.call.start()"></span></div></div></div></div>'].join("")},CallUIHandler.getBodyHtml=function(){var l=$Support.EmbedObj,a=($Support.EmbedObj.status,l.eprops);return['<div class="cal-wrap" id="audiocal"> <div class="adocal-cont dtfix '+CallImpl.getTheme()+' ad-dep"> '+CallImpl.getBackGndImg("Comp")+' <div class="header"> <div class="actbtn"><em class="sqico-min siq-minimize-icon" title="'+LSResource.getRealValue("ne.title.minimize")+'" documentclick="min_iframe"></em></div> '+CallImpl.compImgHtml()+' <div> <div class="cal-cmpname font20 fontB">'+CallImpl.getCompValueForKey("name")+'</div> <div class="cal-cmpdesc font14">'+LSResource.getRealValue("av.info.welcomemsg")+"</div> </div> </div>",'<div class="cal-bodycont posrel"> <div class="vistr-dtlfld" id=call_inptfields>',JSON.parse(a.isname[0])?this.getNameHTML(a.isname[1].ismandatory):"",JSON.parse(a.isemail[0])?this.getEmailHTML(a.isemail[1].ismandatory):"",'</div> <div class="mT15">',1<$Support.EmbedObj.deptlist.length?' <div class="dup_div posrel mT20"><div class="cal-deflnk mT20 curP font16" onclick="CallImpl.handleDeptClick()">'+LSResource.getRealValue("av.info.deptchoose")+"</div></div>":'<div class="sqico-call bg-grn mA" onclick="CallImpl.checkAndStartCall()"></div>',1<$Support.EmbedObj.deptlist.length&&(l.department,1)?this.getDeptList():"","</div></div> </div>"].join("")},CallUIHandler.getNameHTML=function(l,a){a=a||"";var e="optional",s="";e="required",LSResource.getRealValue("ne.required"),s=' docblur="required"';var t=$Support.Util.isInValidVisitorName($Support.EmbedObj.visitorname)?"":$Support.EmbedObj.visitorname,i=t?"dN":"";return'<label class="posrel"><input onkeyup="CallUIHandler.handletextfiled(this)" type="text" value="'+getEncodedText(t)+'" id="visname" class="siq-input-text-box" '+s+a+' info="name" autofocus purpose="visitorname" data-validate="'+e+' charlimit 100"/><span class="ph-mntry '+i+'">'+LSResource.getRealValue("ne.entername")+this.getRequiredHTML()+'</span><em class="sqico-invalid" title="'+LSResource.getRealValue("ne.required")+'"></em></label>'},CallUIHandler.getEmailHTML=function(l){LSResource.getRealValue("ne.required");var a=$Support.EmbedObj.visitoremail||"";return['<label class="posrel"><input onkeyup="CallUIHandler.handletextfiled(this)" type="text" id="visemail" value="'+a+'" class="siq-input-text-box" info="email" purpose="visitoremail" data-validate="required email charlimit 100" docblur="email" /><span class="ph-mntry '+(a?"dN":"")+'">'+LSResource.getRealValue("ne.enteremail")+this.getRequiredHTML()+'</span><em class="sqico-invalid" title="'+LSResource.getRealValue("ne.required")+'"></em></label>',this.getFetchMailHTML()].join("")},CallUIHandler.handletextfiled=function(l){$(l).siblings("span").addClass("dN"),""==l.value&&$(l).siblings("span").removeClass("dN")},CallUIHandler.getPhoneHTML=function(l){var a="optional",e="",s="";return"true"===l&&(a="required",e=" ("+LSResource.getRealValue("ne.required")+")",s=' docblur="required"'),'<div custom="phone"><input type="text" value="'+($Support.EmbedObj.visitorphone||"")+'" class="siq-input-text-box" id="visphone" placeholder="'+LSResource.getRealValue("ne.enterphone")+e+'" class="" '+s+' info="phone" purpose="visitorphone"  data-validate="'+a+' phone"/>'+this.getRequiredHTML("*")+"</div>"},CallUIHandler.getRequiredHTML=function(l){return l=l||"",'<em class="req siq-required" title="'+LSResource.getRealValue("ne.required")+'">*</em>'},CallUIHandler.getFetchMailHTML=function(l){return $Support.EmbedObj.fetchid?'<div class="fetchmail" id="fetchmail"><span class="sqico-fb"></span><span class="sqico-gplus"></span></div>':""},CallUIHandler.getDeptList=function(){var l="",a=$Support.EmbedObj.deptlist;for(i in a){var e=a[i].DNAME;l+='<span class="depmnt-items font14 curP" onclick="CallImpl.handleDeptSelect(this)" status="'+a[i].STATUS+'" id="'+a[i].ID+'">'+e+"</span>"}return['<div class="pL15" id="call_deptlist">',l,'</div> <div class="sqico-call bg-ddd mA mT25" id=dept_strtcall onclick="CallImpl.checkAndStartCall(this)"></div> '].join("")},CallUIHandler.getFQCALINCallhtml=function(){},CallUIHandler.getFQCALBodyhtml=function(){var l=$Support.EmbedObj,a=($Support.EmbedObj.status,l.eprops);return['<div class="faqcal-head"><div class="posrel fcal-usrdetl"> '+CallImpl.getCompImgHtmlCALFAQ()+'</div> <div class="font22 cfff faqcal-usr">'+CallImpl.getCompValueForKey("name")+'</div> <p class="cfff lH22 font16 faqcal-desc">'+CallImpl.getCompValueForKey("desc")+"</p> </div>",'<div class="faq-cal-sec font14"> <div class="vistr-dtlfld" id="callfaq_inptfields">',JSON.parse(a.isname[0])?this.getNameHTML(a.isname[1].ismandatory):"",JSON.parse(a.isemail[0])?this.getEmailHTML(a.isemail[1].ismandatory):"",'</div> <div class="faqcal-btn cfff curP" onclick="CallImpl.checkInputFields(this)">'+LSResource.getRealValue("av.info.deptchoose")+"</div></div>"].join("")},CallUIHandler.getFQCALDepthtml=function(){var l="",a=$Support.EmbedObj.deptlist;for(i in a){var e=a[i].DNAME;l+='<span status="'+a[i].STATUS+'" call-dept="" id="'+a[i].ID+'">'+e+"</span>"}return setTimeout(function(){$("#FQCLdeptlist").on("click","[call-dept]",function(){$("#FQCLdeptlist").find("[call-dept]").removeClass("fcal-sel"),$(this).addClass("fcal-sel"),$Support.EmbedObj.department=this.id,$("#dept_strtcall").parent().removeClass("fcal-dis").addClass("fcal-enb")})},2),['<div class="faqcal-head"> <div class="posrel fcal-usrdetl">'+CallImpl.getCompImgHtmlCALFAQ()+'</div> <div class="font22 cfff faqcal-usr">'+CallImpl.getCompValueForKey("name")+'</div> <p class="cfff lH22 font16 faqcal-desc">'+CallImpl.getCompValueForKey("desc")+"</p> </div>",'<div class="faqcal-sec font14 textL"><div class="fcal-dephed dib-mid">'+LSResource.getRealValue("av.info.deptchoose")+'</div><div class="fcal-dept mT15" style="" id="FQCLdeptlist">',l,'</div></div> <div class="fcal-btnoptn dib-mid mT25 fcal-dis"><span class="fcal-btns sqico-call" onclick="CallImpl.checkDeptFields(this)" id="dept_strtcall"></span> <div class="cddd textC mT10">'+LSResource.getRealValue("av.info.call")+"</div> </div>"].join("")},CallUIHandler.getFQCALOUTCallhtml=function(){return['<div class="faqcal-head"> <div class="posrel fcal-usrdetl">'+CallImpl.getCompImgHtmlCALFAQ()+'</div> <div class="font22 cfff faqcal-usr">'+CallImpl.getCompValueForKey("name")+'</div> <p class="cfff lH22 font16 faqcal-desc">'+LSResource.getRealValue("av.info.calling")+"</p> </div>",'<div class="dtfix w100"> <div class="fcal-btnoptn"> <span id="audiocall_mute" onclick="avimpl.toggleMute(this)" class="fcal-btns sqico-microphone"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.mute")+'</div> </div> <div class="fcal-btnoptn dib-mid mT40"> <span class="fcal-btns sqico-call cal-rjct" onclick="avimpl.terminateAudioCall(true,true);"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.end")+"</div> </div> </div>"].join("")},CallUIHandler.getFQCALConnectingCallhtml=function(){return['<div class="faqcal-head"><div class="posrel fcal-usrdetl"> '+CallImpl.getAttenderImgCALFAQHtml()+' </div><div class="font22 cfff faqcal-usr">'+CallImpl.getAttenderName()+'</div> <p class="cfff lH22 font16 faqcal-desc">'+LSResource.getRealValue("av.info.connecting")+"</p> </div>",'<div class="dtfix w100"> <div class="fcal-btnoptn"> <span class="fcal-btns sqico-microphone" id="audiocall_mute" onclick="avimpl.toggleMute(this)"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.mute")+'</div> </div> <div class="fcal-btnoptn"> <span class="fcal-btns sqico-faqico" onclick="CallImpl.handleFAQClick()"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.faq")+'</div> </div> <div class="fcal-btnoptn"> <span class="fcal-btns sqico-call cal-rjct" onclick="avimpl.terminateAudioCall(true,true)"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.end")+"</div> </div> </div>"].join("")},CallUIHandler.getFQCALOnCallhtml=function(){return['<div class="faqcal-head"> <div class="posrel fcal-usrdetl">'+CallImpl.getAttenderImgCALFAQHtml()+'</div> <div class="font22 cfff faqcal-usr">'+CallImpl.getAttenderName()+'</div> <p class="cfff lH22 font16 faqcal-desc" id="sqico-timer">00:00</p> </div>','<div class="dtfix w100"> <div class="fcal-btnoptn"> <span class="fcal-btns sqico-microphone" id="audiocall_mute" onclick="avimpl.toggleMute(this)"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.mute")+'</div> </div> <div class="fcal-btnoptn"> <span class="fcal-btns sqico-faqico" onclick="CallImpl.handleFAQClick(true)"></span> <div class="cfff textC mT10 fcal-txt" >'+LSResource.getRealValue("av.info.faq")+'</div> </div> <div class="fcal-btnoptn"> <span class="fcal-btns sqico-call cal-rjct" onclick="avimpl.stopOngoingCall()"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.end")+"</div> </div> </div>"].join("")},CallUIHandler.getFQCALRatinghtml=function(){return['<div class="faqcal-head"><div class="posrel fcal-usrdetl"> '+CallImpl.getAttenderImgCALFAQHtml()+'</div> <div class="font22 cfff faqcal-usr">'+CallImpl.getAttenderName()+"</div></div>",'<div class="fcal-fdback textC"><div class="ofln-msg mT25">'+LSResource.getRealValue("av.info.rating")+'</div> <div class="rating mT30">'+this.getStarHTML()+'</div><p class="elips mT20 cfff font14">'+LSResource.getRealValue("av.info.ratingclick")+"</p>"].join("")},CallUIHandler.getFQCALFDBKhtml=function(){var l=ZSIQConversationManager.getChatWinObjById(avimpl.chid).rating;return['<div class="faqcal-head"><div class="posrel fcal-usrdetl">'+CallImpl.getAttenderImgCALFAQHtml()+'<em class="reaction_ico '+l+'_icon usr-rtng" title="'+l+'"></em></div><div class="font22 cfff faqcal-usr">'+CallImpl.getAttenderName()+"</div></div>",'<div class="ofln-msg mT25">'+LSResource.getRealValue("av.info.ratingsuccess")+'</div><div class="cal-footer bgfff" style="height:70px;"> <textarea class="bgfff font13 c333 lH20" dockeyup="feedback" dockeydown="textarea" id="fdbkarea" data-validate="required" placeholder="'+LSResource.getRealValue("av.info.fdkbckmsg")+'" autofocus></textarea> <div class="sqico-calsend fdbak-send msg-send" documentclick="sendCallFb"></div></div>'].join("")},CallUIHandler.getFQCALFDBKSucesshtml=function(){return['<div class="faqcal-head"><div class="posrel fcal-usrdetl"> '+CallImpl.getAttenderImgCALFAQHtml()+'</div><div class="font22 cfff faqcal-usr">'+CallImpl.getAttenderName()+"</div></div>",' <div class="ofln-msg mT25">'+LSResource.getRealValue("av.info.ratingandfbk")+' </div> <div class="fcal-btnoptn"><span class="fcal-btns sqico-call bg-grn mT25" onclick="$Support.startChat()"></span><div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.callback")+"</div></div>"].join("")},CallUIHandler.getFQCALCallAgainhtml=function(){return['<div class="faqcal-head"><div class="posrel fcal-usrdetl"> '+CallImpl.getCompImgHtmlCALFAQ()+' </div><div class="font22 cfff faqcal-usr">'+CallImpl.getCompValueForKey("name")+'</div> <p class="cfff lH22 font16 faqcal-desc">'+CallImpl.getCompValueForKey("desc")+"</p> </div>",'<div class="fcal-btns sqico-call bg-grn mT25" onclick="$Support.startChat()"></div>'].join("")},CallUIHandler.getFQCALUserBusyhtml=function(){return['<div class="faqcal-head"> <div class="posrel fcal-usrdetl">'+CallImpl.getCompImgHtmlCALFAQ()+'</div> <div class="font22 cfff faqcal-usr">'+LSResource.getRealValue("av.info.oprbusy")+' </div><p  class="cfff lH22 font16 faqcal-desc elips">'+LSResource.getRealValue("av.info.voicemsg")+"</p></div>",'<div class="dtfix w100"> <div class="fcal-btnoptn"> <span class="fcal-btns sqico-record" cntrl="startRecord"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.voicemsgtxt")+'</div> </div> <div class="fcal-btnoptn"> <span class=" fcal-btns sqico-faqico" onclick="CallImpl.handleFAQClick()"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.faq")+'</div> </div> <div class="fcal-btnoptn"> <span class="fcal-btns sqico-call bg-grn" onclick="$Support.startChat()"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.callback")+"</div> </div> </div>"].join("")},CallUIHandler.getFQCALRecordhtml=function(){return['<div class="faqcal-head"><div class="posrel fcal-usrdetl"> '+CallImpl.getCompImgHtmlCALFAQ()+' </div><div class="font22 cfff faqcal-usr">'+CallImpl.getCompValueForKey("name")+'</div> <p class="cfff lH22 font16 faqcal-desc" id="sqico-timer">00:00:00</p> </div>','<div class="dtfix w100"><div class="vc-recrd" id="sqico-canvas" style="margin:-30px;"></div><div class="posrel" id="faqrcd_play" style="display:none;"> <div class="fcal-btnoptn"><span class="fcal-btns sqico-record  bg-aaa font22" cntrl="startRecord"></span><div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.voicemsgtxt")+'</div></div> <div class="fcal-btnoptn"><span cntrl="playRecord" class="fcal-btns sqico-play"></span><div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.play")+'</div></div> <div class="fcal-btnoptn"><span class="fcal-btns sqico-voicesend cal-send" cntrl="uploadRecord"></span><div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.send")+'</div></div></div><div id="faqrcd"> <div class="fcal-btnoptn"><div class="rec-tmr font18 mB10" id="sqico-remtimer">00:00</div><span class="fcal-btns str-recd" cntrl="stopRecord"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.stop")+"</div></div> </div></div>"].join("")},CallUIHandler.getFQCALAVPlayhtml=function(){return['<div class="faqcal-head"> <div class="posrel fcal-usrdetl">'+CallImpl.getCompImgHtmlCALFAQ()+'</div> <div class="font22 cfff faqcal-usr">'+CallImpl.getCompValueForKey("name")+'</div><p id="sqico-timer" style="display:inline;">00:00</p></div>','<div class="cal-vstrdetl"><div class="vc-recrd" id="sqico-canvas" style="margin:-30px;"></div></div><div class="cal-optns posrel textR"> <div class="fcal-btnoptn"><span class="fcal-btns sqico-record  bg-aaa" cntrl="startRecord"></span><div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.voicemsgtxt")+'</div></div> <div class="fcal-btnoptn"><span cntrl="playRecord" class="fcal-btns sqico-play"></span><div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.play")+'</div></div> <div class="fcal-btnoptn"><span class="fcal-btns sqico-voicesend cal-send" cntrl="uploadRecord"></span><div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.send")+"</div></div></div></div></div></div>"].join("")},CallUIHandler.getFQCALRecordSuccesshtml=function(){return['<div class="faqcal-head"><div class="posrel fcal-usrdetl"> '+CallImpl.getCompImgHtmlCALFAQ()+' </div><div class="font22 cfff faqcal-usr">'+CallImpl.getCompValueForKey("name")+'</div> <p class="cfff lH22 font16 faqcal-desc">'+LSResource.getRealValue("av.info.voicesent")+"</p> </div>",'<div class="fcal-btns sqico-call bg-grn mT25" onclick="$Support.startChat()"></div>'].join("")},CallUIHandler.getInitialHtml=function(){return['<div class="cal-wrap" id="audiocal"><div class="adocal-cont '+CallImpl.getTheme()+'">'+CallImpl.getBackGndImg("Comp")+' <div class="header">',' <div class="actbtn"><em class="sqico-min siq-minimize-icon" title="'+LSResource.getRealValue("common.minimize")+'" documentclick="min_iframe"></em></div> '+CallImpl.compImgHtml()+" <div> ",'<div class="cal-cmpname font20 fontB elips" title="'+CallImpl.getCompValueForKey("name")+'">'+CallImpl.getCompValueForKey("name")+'</div> <div class="cal-cmpdesc"></div> </div> </div>','<section class="cal-bodycont"> <p class="cal-weldesc c333 lH22">'+CallImpl.getCompValueForKey("desc")+'</p> <div class="cal-deflnk lH22 dib-mid curP" onclick="CallImpl.startCall()">'+LSResource.getRealValue("av.info.callnow")+"</div> </section> </div> </div>"].join("")};var getBrowserFromUserAgent=function(e){var t=e.toLowerCase(),r="unknown-unknown";if(-1<t.indexOf("msie")){var n=e.substring(e.indexOf("MSIE")).split(";")[0];r=n.split(" ")[0].replace("MSIE","IE")+"-"+n.split(" ")[1]}else-1<t.indexOf("edge")?r=e.substring(e.indexOf("Edge")).split(" ")[0].replace("/","-"):-1<t.indexOf("safari")&&-1<t.indexOf("version")?r=e.substring(e.indexOf("Safari")).split(" ")[0].split("/")[0]+"-"+e.substring(e.indexOf("Version")).split(" ")[0].split("/")[1]:-1<t.indexOf("opr")||-1<t.indexOf("opera")?-1<t.indexOf("opera")?r=e.substring(e.indexOf("Opera")).split(" ")[0].split("/")[0]+"-"+e.substring(e.indexOf("Version")).split(" ")[0].split("/")[1]:-1<t.indexOf("opr")&&(r=e.substring(e.indexOf("OPR")).split(" ")[0].replace("/","-").replace("OPR","Opera")):-1<t.indexOf("chrome")?r=e.substring(e.indexOf("Chrome")).split(" ")[0].replace("/","-"):-1<t.indexOf("firefox")&&(r=e.substring(e.indexOf("Firefox")).split(" ")[0].replace("/","-"));return r},Recorder=function(){"use strict";var c,n,i,s,u,o,p,d,g,a,m,l,f,v,y,h,R,w=60,S=0,q=!0,L=!1,A=0,C=0,b=null,x=function(){},I=function(){},T=function(){},U=!1,V=!1,M=function(){l={startRecord:P,stopRecord:E,pauseRecord:W,playRecord:e,uploadRecord:z,cancelRecord:X}},_=function(){return window.AudioContext=window.AudioContext||window.webkitAudioContext,window.URL=window.URL||window.webkitURL,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||null,window.AudioContext&&navigator.getUserMedia&&window.URL&&window.Worker,!0},O=function(){c.addEventListener("click",t)},t=function(e){var t=e.target,r=t.getAttribute("cntrl");l||M(),l[r]&&l[r](t)},k=function(){var e=URL.createObjectURL(new Blob(["( "+J+" )()"]),{type:"javascript"});(n=new Worker(e)).onmessage=function(e){"view"==e.data.key&&(o=e.data.value)}};f=function(e){var t=m[e];t.add&&t.trigger.classList.add(t.add),t.remove&&t.trigger.classList.remove(t.remove),t.trigger.setAttribute("cntrl",t.cntrl),t.trigger.setAttribute("title",t.title)};var F=function(){(c=window.parent.document.querySelector("#user_busy")).zsiqdrag(c,!0),O(),g=c.querySelector("#sqico-timer");var e,t,r,n=c.querySelector("#sqico-canvas");n.innerHTML='<canvas id="level_audio2"></canvas>',n=n.querySelector("#level_audio2"),p={elem:n,ctx:n.getContext("2d"),step:-4,bufferLength:null,dataArray:null,stepincrement:2,waveTrigger:null,lineX:0},e=c.querySelector('[cntrl="settings"]'),t=c.querySelector('[cntrl="playRecord"]'),r=c.querySelector('[cntrl="stopRecord"]'),m={start:{trigger:e,cntrl:"startRecord",add:"zsiqmico-record",remove:"zsiqmico-settings",title:LSResource.getRealValue("av.info.recordagain")},stop:{trigger:r,cntrl:"stopRecord",add:"zsiqmico-stop",remove:"zsiqmico-send",title:LSResource.getRealValue("av.info.stop")},setting:{trigger:e,cntrl:"settings",add:"zsiqmico-settings",remove:"zsiqmico-record"},play:{trigger:t,cntrl:"playRecord",add:"zsiqmico-play",remove:"zsiqmico-pause",title:LSResource.getRealValue("av.info.play")},pause:{trigger:t,cntrl:"pauseRecord",add:"zsiqmico-pause",remove:"zsiqmico-play",title:LSResource.getRealValue("av.info.pause")},send:{trigger:r,cntrl:"uploadRecord",add:"zsiqmico-send",remove:"zsiqmico-stop",title:LSResource.getRealValue("av.info.send")},add:{trigger:r,cntrl:"uploadRecord",add:"zsiq_media_mL13",title:LSResource.getRealValue("av.info.send")},remove:{trigger:r,cntrl:"uploadRecord",remove:"zsiq_media_mL13",title:LSResource.getRealValue("av.info.send")}},x=function(){A=0,f("setting"),m.setting.trigger.style.display="none",m.play.trigger.style.display="none",f("remove"),f("stop"),re(!0),S=100*w},I=function(){f("send"),m.setting.trigger.style.display="flex",m.play.trigger.style.display="flex",f("add"),f("play"),f("start"),S=A,A=0},T=function(){c.remove()}},H=function(){var e=$Support.chidmappinglist[v];CallImpl.updateRecorderHTML(v),c=document.getElementById(e),O(),x=function(){oe("disable"),A=0,S=100*w,g=c.querySelector("#sqico-timer");var e,t,r,n=c.querySelector("#sqico-canvas");n.innerHTML='<canvas id="level_audio"  style="height: 60px;width: 100%;padding: 10px 10px 10px 10px;" ></canvas>',n=n.querySelector("#level_audio"),p={elem:n,ctx:n.getContext("2d"),bufferLength:null,dataArray:null,waveTrigger:null,lineX:0},O(),U=!0,e=c.querySelector('[cntrl="cancelRecord"]'),t=c.querySelector('[cntrl="settings"]'),r=c.querySelector('[cntrl="stopRecord"]'),m={setting:{trigger:t,cntrl:"settings"},cancel:{trigger:t,cntrl:"cancelRecord",title:LSResource.getRealValue("av.info.delete")},play:{trigger:e,cntrl:"playRecord",add:"sqico-play",remove:"sqico-pause",title:LSResource.getRealValue("av.info.play")},pause:{trigger:e,cntrl:"pauseRecord",add:"sqico-pause",remove:"sqico-play",title:LSResource.getRealValue("av.info.pause")},send:{trigger:r,cntrl:"uploadRecord",add:"siq-send-button",remove:"siq-voice-stop-icn",title:LSResource.getRealValue("av.info.send")},add:{trigger:r,cntrl:"uploadRecord",add:"sqico-send",title:LSResource.getRealValue("av.info.send")},addMargin:{trigger:r,cntrl:"uploadRecord",add:"mL15",title:LSResource.getRealValue("av.info.send")},removeCancelIcon:{trigger:e,cntrl:"playRecord",add:"sqico-play",remove:"sqico-close",title:LSResource.getRealValue("av.info.play")},addDisable:{trigger:t,cntrl:"",add:"cmn_disable",title:LSResource.getRealValue("av.info.delete")}}},I=function(){S=A,A=0,U=!1,f("removeCancelIcon"),(SiqAVRouter&&SiqAVRouter.container).detailsHandler.hasAudioCallInvitation()?oe("disable"):oe("show"),$("body").find("#recording-icon").remove(),f("play"),m.setting.trigger.style.display="flex",f("cancel"),f("send"),f("add"),f("addMargin"),c.querySelector(".siq-send-button").setAttribute("documentclick","");var r=0,e=getBrowserFromUserAgent(navigator.userAgent).split("-")[0],n="Chrome"==e||"Opera"==e;V=n;var i=c.querySelector("#sqico-canvas");function t(e){var t=i.offsetLeft-(r-e.clientX);A=S/parseInt(i.clientWidth)*t,s&&(s.currentTime=n?A/200:A/100),r=e.clientX}function a(e){document.onmouseup=null,document.onmousemove=null,L&&s&&(ge(),s.play())}i.style.cursor="pointer",i.onclick=function(e){var t=e.clientX-i.getBoundingClientRect().left;A=S/parseInt(i.clientWidth)*t,s&&(L&&s.pause(),s.currentTime=n?A/200:A/100,L&&s.play())},i.onmousedown=function(e){e.stopPropagation(),r=e.clientX,document.onmouseup=a,L&&s&&(s.pause(),clearInterval(d)),document.onmousemove=t}},T=function(){f("addDisable"),c.querySelector(".siq-send-button").remove(),c.querySelector(".siqc-progress").style="display:flex"}},B=function(){(c=document.querySelector("#audiorec"))||(c=document.querySelector("#faqcall")),O(),x=function(){A=0,S=100*w,CallImpl.updateUI(AV_RECORDING),(c=document.querySelector("#audiorec"))||(c=document.querySelector("#faqcall")),g=c.querySelector("#sqico-timer"),a=c.querySelector("#sqico-remtimer");var e,t,r,n=c.querySelector("#sqico-canvas");"FAQPLUSCALL"==CallImpl.getTheme()?(n.innerHTML='<canvas id="level_audio2" style="height:100px;width: 100%;"></canvas>',n=n.querySelector("#level_audio2"),p={elem:n,ctx:n.getContext("2d"),step:-4,bufferLength:null,dataArray:null,stepincrement:2,waveTrigger:null,lineX:0},e=c.querySelector('[cntrl="settings"]'),t=c.querySelector('[cntrl="playRecord"]'),r=c.querySelector('[cntrl="stopRecord"]'),m={start:{trigger:e,cntrl:"startRecord",add:"sqico-recorder",remove:"sqico-settings",title:LSResource.getRealValue("av.info.voicemessage")},stop:{trigger:r,cntrl:"stopRecord",add:"sqico-chkbx",remove:"sqico-videosend",title:LSResource.getRealValue("av.info.stop")},setting:{trigger:e,cntrl:"settings",add:"sqico-settings",remove:"sqico-recorder"},play:{trigger:t,cntrl:"playRecord",add:"sqico-play",remove:"sqico-pause",title:LSResource.getRealValue("av.info.play")},pause:{trigger:t,cntrl:"pauseRecord",add:"sqico-pause",remove:"sqico-play",title:LSResource.getRealValue("av.info.play")},send:{trigger:r,cntrl:"uploadRecord",add:"sqico-videosend",remove:"sqico-chkbx",title:LSResource.getRealValue("av.info.send")}}):(n.innerHTML='<canvas id="level_audio"  style="height: 60px;width: 72px;padding: 10px 10px 10px 0px;" ></canvas>',n=n.querySelector("#level_audio"),p={elem:n,ctx:n.getContext("2d"),bufferLength:null,dataArray:null,waveTrigger:null,slider:null,lineX:0});O()},I=function(){if(S=A,A=0,"FAQPLUSCALL"==CallImpl.getTheme())return $("#faqrcd_play").css("display",""),void $("#faqrcd").css("display","none");CallImpl.updateUI(AV_PLAY),(c=document.querySelector("#audiorec"))||(c=document.querySelector("#faqcall")),O();var e=c.querySelector('[cntrl="playRecord"]');(g=c.querySelector("#sqico-timer")).innerHTML="00:00 / "+ve(),p.slider=c.querySelector("#slide"),p.slider.style.cursor="pointer";var r=p.slider.querySelector("#thumb"),n=p.slider.querySelector("#fill"),i=0,t=getBrowserFromUserAgent(navigator.userAgent).split("-")[0],a="Chrome"==t||"Opera"==t;function o(e){var t=r.offsetLeft-(i-e.clientX);t>p.slider.clientWidth-4||t<-4||(r.style.left=t+"px",n.style.width=t+"px",A=S/parseInt(p.slider.clientWidth)*t,s&&(s.currentTime=a?A/200:A/100),i=e.clientX)}function l(e){document.onmouseup=null,document.onmousemove=null,L&&s&&(ge(),s.play())}V=a,p.slider.onclick=function(e){var t=e.clientX-p.slider.getBoundingClientRect().left-5;t>p.slider.clientWidth-4||t<-4||(r.style.left=t+"px",n.style.width=t+"px",A=S/parseInt(p.slider.clientWidth)*t,s&&(L&&s.pause(),s.currentTime=a?A/200:A/100,L&&s.play()))},r.onmousedown=function(e){e.stopPropagation(),i=e.clientX,document.onmouseup=l,L&&s&&(s.pause(),clearInterval(d)),document.onmousemove=o},m={play:{trigger:e,cntrl:"playRecord",add:"sqico-play",remove:"sqico-pause"},pause:{trigger:e,cntrl:"pauseRecord",add:"sqico-pause",remove:"sqico-play"}}},T=function(){CallImpl.updateUI(AV_RECORDSENTSUCCESS)}},P=function(){U=!0,window.currentAudioElement&&window.currentAudioElement.pause(),window.currentRecorder||(window.currentRecorder=ye),R&&(de(!0),ue(!0)),!L&&q&&(x(),n.postMessage({command:"clear"}),s=null,j(),q=!1)},E=function(){R&&de(!1),q||(U=!1,I(),i.close(),G(),n.postMessage({command:"getView"}),re(!0),q=!0)},W=function(){s&&(L=!1,clearInterval(d),s.pause(),(!R&&!CallImpl.isCallWithChat||"FAQPLUSCALL"==CallImpl.getTheme())&&re(!1)),f("play")},e=function(){if(window.currentAudioElement&&window.currentAudioElement.pause(),window.currentRecorder||(window.currentRecorder=ye),f("pause"),s)return L=!0,!R&&!CallImpl.isCallWithChat||"FAQPLUSCALL"==CallImpl.getTheme()?Y(K,25):Y(ae,50),s.play(),void ge();s=new Audio,L=!0,!R&&"FAQPLUSCALL"==CallImpl.getTheme()&&Y(K,25),r(),ge()},r=function(){var e=URL.createObjectURL(new Blob([o],{type:"audio/wav"}));if(s.src=e,!CallImpl.isCallWithChat){(i=new AudioContext).resume();var t=i.createMediaElementSource(s);u=i.createAnalyser(),t.connect(u),u.connect(i.destination),R?Y(ae,50):Y(K,25)}s.play(),s.currentTime=V?A/200:A/100},z=function(){var i,a,e=se();if(R&&S<100&&e&&e.RCHID==v)return $UI.showBanner(LSResource.getRealValue("voicenote.timer.check.banner.content"),!0,null,5e3),void X();c.removeEventListener("click",t),W(),T(),setTimeout(function(){var e,t,r,n=R?LSResource.getRealValue("common.voicenote"):"Audio";a=window.lamejs?(e=o,t=lamejs.WavHeader.readHeader(e),r=new Int16Array(e.buffer,t.dataOffset,t.dataLen/2),i=function(e,t,r){for(var n=[],i=new lamejs.Mp3Encoder(e,t,128),a=r.length,o=0;1152<=a;o+=1152){var l=r.subarray(o,o+1152),c=i.encodeBuffer(l);0<c.length&&n.push(new Int8Array(c)),a-=1152}var s=i.flush();return 0<s.length&&n.push(new Int8Array(s)),new Blob(n,{type:"audio/mp3"})}(t.channels,t.sampleRate,r),new File([i],n+".mp3",{type:"audio/mp3"})):(i=new Blob([o],{type:"audio/wav"}),new File([i],n+".wav",{type:"audio/wav"})),D(a)},0)},D=function(e){LSDragDrop.pos=0,LSDragDrop.nooffiles=1,$Support.EmbedObj.messagereply_allowed?ZSIQFileUpload.handleVoicenoteUpload($Support.chidmappinglist[v],[e],h,y):LSDragDrop.uploadFile($Support.chidmappinglist[v],[e],h,y),X()},X=function(){U=!1,clearInterval(d),re(!0),p=l=m=null,n&&(n.terminate(),n=null),i&&("closed"!=i.state&&i.close(),i=null),c&&c.remove(),R&&oe("show"),G(),window.currentRecorder=null,R&&(de(!1),ue(!1))},j=function(){(i=new AudioContext).resume(),n.postMessage({command:"setProperty",audioFormat:"audio/wav",bufferSize:4096,channels:1,sampleRate:i.sampleRate});var e=SiqAVRouter&&SiqAVRouter.container;e.MediaDetails.getBrowserName();window.$Temp&&(b=setTimeout(function(){SiqAVRouter&&SiqAVRouter.container.mediaUIHandler.mediaPermissionUI(R),clearTimeout(b)},1500)),e.MediaPermission.getAudioStream(Q,Z)},Q=function(e){e=e||SiqAVRouter&&SiqAVRouter.container.MediaPermission.getStreamByType("audio"),window.$Temp&&(clearTimeout(b),SiqAVRouter.container.detailsHandler.closeViewMediaPermission()),c.onclick||O(),C=i.currentTime,e;var t=i.createMediaStreamSource(e),r=t.context,n=(r.createScriptProcessor||r.createJavaScriptNode).call(r,4096,2,2);u=i.createAnalyser(),n.onaudioprocess=N,t.connect(u),u.connect(n),n.connect(i.destination),!R&&!CallImpl.isCallWithChat||"FAQPLUSCALL"==CallImpl.getTheme()?Y(K,25):Y(R?ae:ie,50)},N=function(e){if(i){var t=[];pe(i.currentTime-C);for(var r=0;r<1;r++)t.push(e.inputBuffer.getChannelData(r));n.postMessage({command:"record",buffer:t})}else X()},G=function(){var e=le();e.dataHandler.data.media_active||e.MediaPermission.closeStreamByType("audio")},Z=function(e){window.$Temp&&(clearTimeout(b),"NotAllowedError"==e.name&&SiqAVRouter&&SiqAVRouter.container.mediaUIHandler.mediaPermissionUnlock(R)),X()},J=function(){var n,i=[],a=0,o=2,l=0,c={record:function(e){i.push(e.buffer[0]),e.buffer[1]&&i.push(e.buffer[1])},getView:function(){postMessage({key:"view",value:function(e){function t(e,t,r){for(var n=0;n<r.length;n++)e.setUint8(t+n,r.charCodeAt(n))}var r=new ArrayBuffer(44+2*e.length),n=new DataView(r);return t(n,0,"RIFF"),n.setUint32(4,36+2*e.length,!0),t(n,8,"WAVE"),t(n,12,"fmt "),n.setUint32(16,16,!0),n.setUint16(20,1,!0),n.setUint16(22,o,!0),n.setUint32(24,l,!0),n.setUint32(28,4*l,!0),n.setUint16(32,2*o,!0),n.setUint16(34,16,!0),t(n,36,"data"),n.setUint32(40,2*e.length,!0),function(e,t,r){for(var n=0;n<r.length;n++,t+=2){var i=Math.max(-1,Math.min(1,r[n]));e.setInt16(t,i<0?32768*i:32767*i,!0)}}(n,44,e),n}(function(){n=new Float32Array(i.length*a);var e=0;if(1==o)for(var t=0;t<i.length;t++)for(var r=0;r<a;r++)n[e++]=i[t][r];else if(2==o)for(var t=0;t<i.length;t+=2)for(var r=0;r<a;r++)n[e++]=i[t][r],n[e++]=i[t+1][r];return n}())})},setProperty:function(e){e.audioFormat,a=e.bufferSize,o=e.channels,l=e.sampleRate},clear:function(){i=[]}};self.onmessage=function(e){var t=e.data,r=t.command;c[r]&&c[r](t)}};var Y=function(e,t){p.bufferLength=u.frequencyBinCount,p.dataArray=new Uint8Array(p.bufferLength),p.elem.style.backgroundColor="rgba(0,0,0,0)",p.waveTrigger&&clearInterval(p.waveTrigger),p.waveTrigger=setInterval(function(){requestAnimationFrame(e)},t)},K=function(){u.getByteTimeDomainData(p.dataArray),ne(),q&&(p.lineX=p.elem.width/S*(A<S-1?A:0),ee(p.ctx));for(var e=0,t=0;t<p.bufferLength;t++){var r=p.dataArray[t]/128*(p.elem.height/10)*1.5;e=Math.max(e,r)}p.step+=p.stepincrement;var n=p.step;te(e/1.5,n),te(-e/1.5,1.5*n),te(e/2,3*n)},ee=function(e){e.beginPath(),e.moveTo(p.lineX-1,50),e.lineTo(p.lineX-1,100),e.stroke()},te=function(e,t){var r=p.ctx,n=0,i=0,a=1.5*p.elem.width/10,o=e/(p.elem.height/6);for(o*=e,p.ctx.strokeStyle="rgb(35, 141, 233)",r.beginPath();n<p.lineX;)i=p.elem.height/2+o*Math.sin((n+t)/a),r.lineTo(n,i),n+=1;for(r.stroke(),p.ctx.strokeStyle="white",r.beginPath();n<p.elem.width;)i=p.elem.height/2+o*Math.sin((n+t)/a),r.lineTo(n,i),n+=1;r.stroke()},re=function(e){p&&(p.waveTrigger&&clearInterval(p.waveTrigger),e&&(p.lineX=0))},ne=function(){p.ctx.lineWidth=1.5,p.ctx.clearRect(0,0,p.elem.width,p.elem.height),p.ctx.fillStyle="rgba(100,100,100,0)",p.ctx.fillRect(0,0,p.elem.width,p.elem.height),p.ctx.moveTo(0,p.elem.height/2)},ie=function(){var e,t=p.ctx,r=p.dataArray,n=(p.bufferLength,p.elem.width),i=n/36,a=p.elem.height,o=0;u.getByteFrequencyData(p.dataArray);var l=CallImpl.getTheme();t.fillStyle="theme3"==l?"rgb(51, 51, 51)":"rgb(255,255,255)",t.fillRect(0,0,n,a);for(var c=i/4,s=18;0<=s;s--){var d=a/(e=r[9<s?18-s:s]);d<1&&0!=e&&(e=a*d),t.fillStyle="theme3"==l?"white":"rgb(73, 113, 127)",t.lineJoin="round",t.lineWidth=c,t.fillRect(o+c/2,(a-e)/2+c/2,i-c,e-c),o+=2*i}},ae=function(){if(U||L||!p.ctx){var e,t=p.ctx,r=p.dataArray,n=(p.bufferLength,p.elem.width),i=n/200,a=p.elem.height,o=0;u.getByteFrequencyData(p.dataArray),t.fillStyle="rgb(255,255,255)",t.fillRect(0,0,n,a);for(var l=i/4,c=0;c<=100;c++){var s=a/(e=r[50<c?100-c:c]);s<1&&0!=e&&(e=a*s);var d=parseInt(A/S*100);t.fillStyle=c<=d?"rgb(24 119 216)":"rgb(12 11 11 / 30%)",t.lineWidth=l,e<40&&(e=40),t.fillRect(o+l/2,(a-e)/2+l/2,i-l,e-l),o+=2*i}}},oe=function(e){var t=le();"connected"!=se().chatstatus||$Support.isConversationUIFocussed()||se().isBotChat||t.detailsHandler.isGroupConversation(v,!1)||t.detailsHandler.hasAudioCallInvitation()||!t.detailsHandler.isAudioCallEnabled()||t.detailsHandler.triggerAudioCallIcon(v,e)},le=function(){return SiqAVRouter&&SiqAVRouter.container},ce=function(){null==se().chatstatus&&X()},se=function(){var e=$Support.chidmappinglist[v];return ZSIQConversationManager.getChatWinObjById(e)},de=function(e){var t=window.parent.document.querySelector("#user_busy");if(t){var r=t.getElementsByClassName("zsiqmico-pickcall")[0];e?r.classList.add("zsiq_media_disable"):r.classList.remove("zsiq_media_disable")}},ue=function(e){var t=ZSIQConversationManager.getcurrchatwinobj().getComposer().parents("#msgbox_main")[0];t&&(e?t.classList.add("siq_voice_note_parent"):t.classList.remove("siq_voice_note_parent"))},pe=function(e){A=parseInt(100*e);var t=parseInt(A/100),r=parseInt(t/60);if(S<=A)return fe((A=S)%100,t%60,r),void E();fe(A%100,t%60,r)},ge=function(){clearInterval(d),d=setInterval(function(){var e=parseInt(A/100),t=parseInt(e/60);fe(A%100,e%60,t),S<=A?me():A++},10)},me=function(){clearInterval(d),re(),A=0,L=!1,f("play"),CallImpl.isCallWithChat&&(g.innerHTML="00:00 / "+ve())},fe=function(e,t,r){var n,i=CallImpl.isCallWithChat?ve():"";g.innerHTML=(r<10?"0"+r:r)+":"+(t<10?"0"+t:t),!R&&i&&q&&p.slider?(g.innerHTML+=" / "+i,(n=parseInt(p.slider.clientWidth)/S*(A<S-1?A:0))>p.slider.clientWidth-4||(p.slider.children[1].style.left=n+"px",p.slider.children[0].style.width=n+"px")):R?(U&&((le().detailsHandler.hasAudioCallInvitation()||$Support.isConversationUIFocussed())&&U&&(U=!1,E()),ce()),L&&((le().detailsHandler.hasAudioCallInvitation()||$Support.isConversationUIFocussed())&&L&&(L=!1,W()),ce())):g.innerHTML+="."+(e<10?"0"+e:e),i&&!q&&(a.innerHTML=i)},ve=function(){var e=parseInt(S/100)-parseInt(A/100),t=parseInt(e/60);return(t<10?"0"+t:t)+":"+((e%=60)<10?"0"+e:e)},ye={init:function(e,t,r,n){var i,a,o,l;i=e,a=t,o=r,l=n,_()?(h=null!=l&&l?(R=!0,"voice_note"):(R=!1,"voice_message"),v=a,o&&(y=o),k(),M(),i||R?R&&!i?(H(),w=480):B():F(),P()):X()},destroy:function(){X()},isAudioRecordingSupported:function(){return _()},isRecording:function(){return U||L},stopRecorder:function(){return U?E():L?W():void 0},isVoiceNote:function(){return R}};return ye};function avaction(){}function mediafailureoffer(a,e){if(window.$Temp&&avaction.clearMediaPermissionPop(),!avaction.callObj.mediaStream||!avaction.callObj.chid)if(a&&a.name){switch(a.name){case"NotFoundError":case"DevicesNotFoundError":message=LSResource.getRealValue("av.info.microphone.notavailable");break;case"SourceUnavailableError":case"PermissionDeniedError":case"SecurityError":case"NotAllowedError":default:message=LSResource.getRealValue("av.info.microphone.blocked")}"NotAllowedError"==a.name&&window.$Temp&&$(window.parent.document).find("body").append($Temp.getAskMediaPermission(avimpl.getCurrentBrowerName())),avaction.callObj.checkMediaPermission(message,avaction.callObj.chid),e&&("agent"==avaction.callObj.type?avaction.callObj.rejectCallInvite("reject",avaction.callObj.audioId,avaction.callObj.chid):avaction.callObj.rejectCallInvite(avaction.callObj.chid,null)),LSDebugger.postDebugInfo("Audio Call - Inside Filure media | PeerConnection "+avaction.callObj.pc,null,null,!0)}else avaction.callObj.StartAfterMediaPermission()}avaction.TYPE="AUDIO",avaction.supportedbrowsers=["Chrome","Firefox","Opera","Safari","Edge"],avaction.transfercallpermission=!0,avaction.enableTransferCall=!1,avaction.getScreenID=function(){return window.webkitRTCPeerConnection?'{"mandatory": { "chromeMediaSource": "desktop", "maxWidth": 1920, "maxHeight": 1080, "minAspectRatio": 1.77 }, "optional": [] }':'{"mediaSource":"screen"}'},avaction.constraints={AUDIO:{audio:!0,video:!1},VIDEO:{audio:!0,video:!0},SCREEN_SHARE:{audio:!0,video:JSON.parse(avaction.getScreenID())},SCREEN_VIEW:{audio:!0,video:!1}},avaction.getObject=function(a){return"undefined"==typeof AgentCall||"agent"!==a.msg.media.mode||a.msg.media.visitoraccess?avimpl:AgentCall},avaction.init=function(a){avaction.callObj=avaction.getObject(a);var e,n=a.msg,t=n.media;if("credential"!==a.msg.cbtype&&"call_credential"!==n.operation||(avaction.callObj.setCredentials(t),e="added credential data successfully"),"invite"!==a.msg.cbtype&&"call_initiate"!==n.operation||((t.credentials||a.msg.credential)&&avaction.callObj.setCredentials(t),avaction.callObj.showInvitation(t),e="added credential data and invitation successfully"),"accept"===a.msg.status||"call_accept"===n.operation)if(this.requestStream(t,UPSTREAM),"agent"===a.msg.media.mode){avaction.callObj.acceptedTime();var i=AgentDB.getWMSIDFromLSUID(JSON.parse(a.msg.media.opruser).lsuid);AgentCall.wmsid=i}else avaction.callObj.acceptedTime=Date.now();if("reject"!==a.msg.cbtype&&"call_reject"!==n.operation||("function"==typeof avaction.callObj.showRejectedBanner&&avaction.callObj.showRejectedBanner(t),avaction.callObj.handleUserBusy()),"candidate"!==a.msg.cbtype&&"call_candidates"!==n.operation||(avaction.callObj.connection_estb?avaction.addIceCandidate(t):(avaction.callObj.newcandidate||(avaction.callObj.newcandidate=[]),avaction.callObj.newcandidate.push(t))),"answer"===a.msg.cbtype||"call_answer"===n.operation){var c=JSON.parse(t.session);if(avaction.callObj.pc.setRemoteDescription(new RTCSessionDescription(c)),avaction.callObj.connection_estb=!0,avaction.callObj.newcandidate)for(var o in avaction.callObj.newcandidate)avaction.addIceCandidate(avaction.callObj.newcandidate[o]);avaction.callObj.pc.onaddstream=avaction.callObj.pc.ontrack=function(a){avaction.callObj.remoteStream&&avaction.callObj.remoteStream.active||avaction.callObj.addremotestream(a)}}"end"!==a.msg.status&&"call_end"!==n.operation||avaction.callObj.endCall(),"offer"!==a.msg.cbtype&&"call_offer"!==n.operation||this.requestStream(t,DOWNSTREAM),"cancel"!==a.msg.cbtype&&"call_cancel"!==n.operation&&"miss"!==a.msg.cbtype&&"call_miss"!==n.operation||avaction.callObj.clear(t.chatid),avaction.callObj.sendStats(a,e)},avaction.setNRSServers=function(a){this.NRSServers=a},avaction.setCredentials=function(a){!avimpl.active&&(avimpl.id=a.id);var e=JSON.parse(a.credentials);avaction.setNRSSereverUrls(e.user_name,e.token,e.servers),avaction.callObj.chid=a.chatid},avaction.setNRSSereverUrls=function(a,e,n){var t=n.split(","),i={iceServers:[]};for(var c in t)i.iceServers.push({urls:t[c],username:a,credential:e});avaction.callObj.iceServerlist=i,LSDebugger.postDebugInfo("Audio Call - Ice Servers "+avaction.callObj.iceServerlist+" | Server urls "+this.NRSServers,null,null,!0)},avaction.clearMediaPermissionPop=function(){clearTimeout(avaction.mediaTimer),avimpl.closeViewMediaPermission()},avaction.requestStream=function(e,n){if(!avaction.callObj.iceServerlist)return LSDebugger.postDebugInfo("Audio Call - End on reload| chid |"+avaction.callObj.chid+" | Data "+e+" |type "+n,null,null,!0),void avaction.callObj.endOnReload();if(avaction.callObj.getMediaApi=avaction.getUserMedia(),window.webkitRTCPeerConnection?(avaction.callObj.hostbrowser="Chrome",window.RTCPeerConnection=webkitRTCPeerConnection):window.mozRTCPeerConnection&&(avaction.callObj.hostbrowser="Firefox",window.RTCPeerConnection=mozRTCPeerConnection),avaction.callObj.chid=e.chatid,avaction.callObj.mediaStream){var a=avaction.callObj.mediaStream;n==UPSTREAM?avaction.initializeConnection(a,n):n==DOWNSTREAM&&(avaction.callObj.offer=CommonUtil.parseToJSON(e.offer),avaction.initializeConnection(a,n))}else{if(window.$Temp&&(avaction.mediaTimer=setTimeout(function(){$(window.parent.document).find("body").append($Temp.getMediaSetting(avimpl.getCurrentBrowerName())),clearTimeout(avaction.mediaTimer)},1500)),!avaction.callObj.getMediaApi)return navigator.mediaDevices.getUserMedia(avaction.constraints[avaction.TYPE]).then(function(a){n==UPSTREAM?avaction.initializeConnection(a,n):n==DOWNSTREAM&&(e.offer?avaction.callObj.offer=CommonUtil.parseToJSON(e.offer):avaction.callObj.offer=CommonUtil.parseToJSON(e.session),avaction.initializeConnection(a,n)),window.$Temp&&avaction.clearMediaPermissionPop()}).catch(function(a){mediafailureoffer(a,n)}),!1;avaction.callObj.getMediaApi.call(navigator,avaction.constraints[avaction.TYPE],function(a){n==UPSTREAM?avaction.initializeConnection(a,n):n==DOWNSTREAM&&(e.offer?avaction.callObj.offer=CommonUtil.parseToJSON(e.offer):avaction.callObj.offer=CommonUtil.parseToJSON(e.session),avaction.initializeConnection(a,n)),window.$Temp&&avaction.clearMediaPermissionPop()},function(a){mediafailureoffer(a,n)})}},avaction.initializeConnection=function(a,t){if(avaction.callObj.chid){var e={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};if(avaction.callObj.pc=new RTCPeerConnection(avaction.callObj.iceServerlist),avaction.callObj.localStream=localStream=a,avaction.getUserMedia()?avaction.callObj.pc.addStream(a):avaction.callObj.localStream.getTracks().forEach(function(a){avaction.callObj.pc.addTrack(a,avaction.callObj.localStream)}.bind(this)),LSDebugger.postDebugInfo("Audio Call - Added local Stream | Stream "+a+" | PeerConnection "+avaction.callObj.pc+" type "+t,null,null,!0),t==DOWNSTREAM&&avaction.callObj.pc.setRemoteDescription(new RTCSessionDescription(avaction.callObj.offer)),LSDebugger.postDebugInfo("Audio Call - Added candidate in Queue | avaction.callObj.newcandidate "+avaction.callObj.newcandidate+" | PeerConnection "+avaction.callObj.pc+" | connectionstate "+avaction.callObj.connection_estb,null,null,!0),avaction.callObj.pc.onicecandidate=function(a){avaction.callObj.addcandidate(a)},avaction.callObj.pc.onaddstream=avaction.callObj.pc.ontrack=function(a){avaction.callObj.remoteStream&&avaction.callObj.remoteStream.active||avaction.callObj.addremotestream(a)},LSDebugger.postDebugInfo("Audio Call - Added onicecandidate and onaddstream | Stream "+a+" | PeerConnection "+avaction.callObj.pc+" type "+t,null,null,!0),"function"==typeof avaction.callObj.addAudioElemts&&avaction.callObj.addAudioElemts(),t==UPSTREAM?avaction.getUserMedia()?avaction.callObj.pc.createOffer().then(avaction.callObj.successOffer,avaction.sendLog,e):avaction.callObj.pc.createOffer(e).then(avaction.callObj.successOffer).catch(avaction.sendLog):("Firefox"===avaction.hostbrowser&&(e=e.mandatory),avaction.getUserMedia()?avaction.callObj.pc.createAnswer(avaction.callObj.successAnswer,avaction.sendLog,e):avaction.callObj.pc.createAnswer(e).then(avaction.callObj.successAnswer).catch(avaction.sendLog),avaction.callObj.connection_estb=!0),avaction.callObj.newcandidate)for(var n in avaction.callObj.newcandidate)avaction.addIceCandidate(avaction.callObj.newcandidate[n]);avaction.callObj.pc.oniceconnectionstatechange=function(a){var e=avaction.callObj.pc.iceConnectionState;if(LSDebugger.postDebugInfo("Audio Call - State change event | event "+e+" | PeerConnection "+avaction.callObj.pc,null,null,!0),e==AV_CONNECTED)avaction.callObj.connectionStatus=!0,avaction.callObj.webrtcStatus=1,avaction.callObj.callConnected(a),avaction.callObj.sendStats(null,"call connected"),(0==avaction.callObj.reconcount||avaction.callObj.isreconnectstate)&&avaction.callObj.sendConnectionStatus("callconnected");else if(e==AV_FAILED){if(avaction.callObj.connectionStatus=!1,t==UPSTREAM){var n=t;avaction.checkConnectionAndCall(avaction.callObj.callReconnect,avaction.checkConnectionActivity,n),avaction.callObj.sendStats(null,"webrtc failed upstream")}else avaction.callObj.callReconnect(t),avaction.callObj.sendStats(null,"webrtc failed downstream");avaction.callObj.connection_estb=!1,(0==avaction.callObj.reconcount||avimpl.isreconnectstate)&&avaction.callObj.sendConnectionStatus("callfailed")}else"disconnected"==e&&(avaction.callObj.reconnecttime=(Date.now()-avimpl.getStartTime())/1e3,avaction.checkConnectionAndCall(avaction.callObj.callDisconnected,avaction.callObj.callDisconnected))}}},avaction.addIceCandidate=function(a){var e;LSDebugger.postDebugInfo("Audio Call - Inside Add Ice Candidate | data "+a+" | PeerConnection "+avaction.callObj.pc,null,null,!0),e=a.candidates?JSON.parse(a.candidates):JSON.parse(a.msg.candidate);var n=new RTCIceCandidate({sdpMid:e.id,sdpMLineIndex:e.label,candidate:e.candidate});avaction.callObj.pc.addIceCandidate(n)},avaction.checkMediaPermission=function(){if(avaction.callObj.getMediaApi=avaction.getUserMedia(),window.$Temp&&(avaction.mediaTimer=setTimeout(function(){$(window.parent.document).find("body").append($Temp.getMediaSetting(avimpl.getCurrentBrowerName())),clearTimeout(avaction.mediaTimer)},1500)),!avaction.callObj.getMediaApi)return navigator.mediaDevices.getUserMedia(avaction.constraints[avaction.TYPE]).then(function(a){mediafailureoffer(null),avaction.callObj.mediaStream=a}).catch(function(a){mediafailureoffer(a)}),!1;avaction.callObj.getMediaApi.call(navigator,avaction.constraints[avaction.TYPE],function(a){mediafailureoffer(null),avaction.callObj.mediaStream=a},function(a){mediafailureoffer(a)})},avaction.sendLog=function(){LSDebugger.postDebugInfo("Audio Call - Inside Filure offer | PeerConnection "+avaction.callObj.pc,null,null,!0)},avaction.getBrowserFromUserAgent=function(a){var e=a.toLowerCase(),n="unknown-unknown";if(-1<e.indexOf("msie")){var t=a.substring(a.indexOf("MSIE")).split(";")[0];n=t.split(" ")[0].replace("MSIE","IE")+"-"+t.split(" ")[1]}else-1<e.indexOf("edge")?n=a.substring(a.indexOf("Edge")).split(" ")[0].replace("/","-"):-1<e.indexOf("safari")&&-1<e.indexOf("version")?n=a.substring(a.indexOf("Safari")).split(" ")[0].split("/")[0]+"-"+a.substring(a.indexOf("Version")).split(" ")[0].split("/")[1]:-1<e.indexOf("opr")||-1<e.indexOf("opera")?-1<e.indexOf("opera")?n=a.substring(a.indexOf("Opera")).split(" ")[0].split("/")[0]+"-"+a.substring(a.indexOf("Version")).split(" ")[0].split("/")[1]:-1<e.indexOf("opr")&&(n=a.substring(a.indexOf("OPR")).split(" ")[0].replace("/","-").replace("OPR","Opera")):-1<e.indexOf("chrome")?n=a.substring(a.indexOf("Chrome")).split(" ")[0].replace("/","-"):-1<e.indexOf("firefox")&&(n=a.substring(a.indexOf("Firefox")).split(" ")[0].replace("/","-"));return n},avaction.isBrowserSupported=function(a,e){var n=this.getBrowserFromUserAgent(a),t=n.split("-")[0],i=parseInt(n.split("-")[1]),c=!1;switch(t){case"Chrome":c=23<=i;break;case"Firefox":c=22<=i;break;case"Opera":c=18<=i;break;case"Safari":c=11<=i}return!c||!e||!(!avaction.getUserMedia()&&!navigator.mediaDevices.getUserMedia)},avaction.getUserMedia=function(){return navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||null},avaction.displaySettingUI=function(a){var r={camera:[],mic:[],speaker:[]},s={};navigator.mediaDevices.enumerateDevices().then(function(a){a.forEach(function(a){"videoinput"==(s[a.kind+"&"+a.deviceId]=a).kind?r.camera.push(a):"audioinput"==a.kind?r.mic.push(a):"audiooutput"==a.kind&&r.speaker.push(a)});var n='<div class="siq-setngs-view font16" id="audio_setting"> <div class="setngs-head c666"><span class="sel-bor" mdevice-switch="mic">Audio Input</span> <span mdevice-switch="speaker" >Sound Output</span> </div>';if(r.mic.length){var t=avaction.callObj.localStream?avaction.callObj.localStream.getAudioTracks()[0].label:"default";n+='<div class="setngs-optn c333 font14 mL20" mdevice-cnt="mic">',r.mic.forEach(function(a){var e="";t===a.deviceId&&(e='class="sqico-tick"'),n+="<div "+e+' deviceid="'+a.deviceId+'">'+a.label+"</div>"}),n+="</div>"}if(r.speaker.length){t="default";n+='<div class="setngs-optn c333 font14 mL20" mdevice-cnt="speaker" style="display:none;">',r.speaker.forEach(function(a){var e="";t===a.deviceId&&(e='class="sqico-tick"'),n+="<div "+e+' deviceid="'+a.deviceId+'">'+a.label+"</div>"}),n+="</div>"}n+="</div>",$(window.parent.document).find("body").append(n),$("#audio_setting",parent.document).on("click","[mdevice-switch]",function(){$("#audio_setting",parent.document).find("[mdevice-switch]").removeClass("sel-bor");var a=$(this).addClass("sel-bor").attr("mdevice-switch");$("#audio_setting",parent.document).find("[mdevice-cnt]").hide(),$("#audio_setting",parent.document).find('[mdevice-cnt="'+a+'"]').show()}),$("#audio_setting",parent.document).on("click","[deviceid]",function(){var a=$(this).parent().attr("mdevice-cnt");if($("#audio_setting",parent.document).find('[mdevice-cnt="'+a+'"]').children().removeClass("sqico-tick"),$(this).addClass("sqico-tick"),"mic"!=a){var e=$(this).attr("deviceid"),n=document.getElementById("remoteaudio");void 0!==n.sinkId&&n.setSinkId(e).then(function(){})}});var e=parent.document.getElementById("siqiframe").getBoundingClientRect(),i=document.getElementById("call_stngicon").getBoundingClientRect(),c=parent.document.getElementById("audio_setting").style,o=e.left+i.left,l=e.top+i.top;c.left=CallImpl.CALLFAQ?o-260+"px":o-284+"px",c.top=CallImpl.CALLFAQ?l+15+"px":l-31+"px",$(document).click(function(a){$(a.target).closest("#audio_setting",parent.document).length||$(a.target).closest("#call_stngicon",parent.document).length||$("#audio_setting",parent.document).is(":visible")&&$("#audio_setting",parent.document).hide()})})},avaction.checkConnectionAndCall=function(a,e,n){var t=getStaticURL("/salesiq/images/spacer_592ebefc7104d681d57852665e9ad514_.gif");$("body").append('<img id="ntwcheckimg" style="opacity:0" />'),$("#ntwcheckimg").on("load",function(){"function"==typeof a&&avaction.successCallBack(a,n),$("#ntwcheckimg").remove()}),$("#ntwcheckimg").on("error",function(){"function"==typeof e&&avaction.errorCallBack(a,e,n),$("#ntwcheckimg").remove()}),$("#ntwcheckimg").attr("src",t+"?nocache="+(new Date).getTime())},avaction.checkConnectionActivity=function(a,e,n){avaction.reconnectinterval||(avaction.reconnectinterval=setInterval(function(){avaction.checkConnectionAndCall(a,"",n)},5e3))},avaction.successCallBack=function(a,e){avaction.connectionStatus=!0,avaction.reconnectinterval&&(clearInterval(avaction.reconnectinterval),avaction.reconnectinterval=null),a(e)},avaction.errorCallBack=function(a,e,n){avaction.connectionStatus=!1,e!=avaction.checkConnectionActivity?e():e(a,e,n)},avaction.transferInitiateReq=function(a,e){if(!AgentDB.getRepresentative()[CurrentUser.getLSUID()].callstatus||"DEPARTMENT"!=a.type){var n=a.chid,t=e?a.creator:a.sender,i=a.visitorid,c=a.mediaid;a.transferReqTimeout=setTimeout(function(){PortalUI.rejectTransChat(n,t,i,c)},3e4),avaction.addCallTransferObj(a,e),avaction.showcallTransferInvitation(a,e),Sound.playTune("vchat-transfer",6)}},avaction.showcallTransferInvitation=function(a,e){if(1===$("body").find(".call_wh").length&&$(".call_wh").find(".call_pickup").length<2?($("#additionalcallcount").remove(),$(".call_wh").append(Template.getTransferReqUI(a,e))):0===$("body").find(".call_wh").length&&$("body").append('<div class="call_wh">'+Template.getTransferReqUI(a,e)+"</div>"),2==$(".call_wh").find(".call_pickup").length){var n=avaction.getCallTransferOBJ(),t=Object.keys(n).length-2;$("#additionalcallcount").remove(),0<t&&$(".call_wh").append('<div class="call_more sqico-call" id="additionalcallcount"><em>+'+t+"more Calls</em></div>")}},avaction.checkAndUpdateCallTransferInvitation=function(){for(var a=avaction.getCallTransferOBJ(),e=Object.keys(a),n=0;n<e.length;n++){var t=e[n],i=a[t],c=t,o=i.msg_obj,l=i.is_invt;1!=$("#transreq_"+c).length&&avaction.showcallTransferInvitation(o,l)}},avaction.removeTransreqWaiting=function(a){$("#transreq_"+a).remove()},avaction.addCallTransferObj=function(a,e){var n=e?a.creator:a.sender,t=a.chid,i=a.visitorid,c=a.mediaid,o=a.transferReqTimeout;avaction.setCallTransferOBJ(t,{exuser_id:n,visitor_id:i,media_id:c,transferreq_timeout:o,msg_obj:a,is_invt:e})},avaction.setCallTransferOBJ=function(a,e){var n=avaction.getCallTransferOBJ();n[a]=e,sessionStorage.setItem("calltransferObj",CommonUtil.toJSON(n))},avaction.getCallTransferOBJ=function(a){var e=sessionStorage.getItem("calltransferObj");if(!e)return{};var n=CommonUtil.parseToJSON(e);return a?n[a]:n},avaction.clearCallTransferObj=function(a){var e=avaction.getCallTransferOBJ();delete e[a],sessionStorage.setItem("calltransferObj",CommonUtil.toJSON(e))},avaction.checkAndClearCallTransObj=function(a){avaction.cleartransferreqinterval(a),avaction.clearCallTransferObj(a);for(var e=avaction.getCallTransferOBJ(),n=Object.keys(e),t=0;t<n.length;t++){a=n[t];avaction.cleartransferreqinterval(a);var i=avaction.getCallTransferOBJ(a),c=i.exuser_id,o=i.visitor_id,l=i.media_id;avaction.rejectCallTransfer(a,c,o,l)}},avaction.cleartransferreqinterval=function(a){var e=avaction.getCallTransferOBJ(a).transferreq_timeout;clearInterval(e)},avaction.rejectCallTransfer=function(a,e,n,t){var i={};(i=lsnocachefix("json")).visitorid=n,i.chid=a,i.exuserid=e,i.mediaid=t;var c=Visitors.list[n];c.TRANS_TYPE&&"DEPARTMENT"==c.TRANS_TYPE&&(i.transtype=c.TRANS_TYPE),$ld.ajax({url:"rejtranschat.do",type:"POST",data:i,success:function(a){}}),avaction.clearCallTransferObj(a)};$FAQ=function(){_searchtimer=0,_appsenabled=!1;var i={},s={},c=function(){return _SCHEMA+"://"+_EMBEDSERVERURL},t=function(t){var i=$Support.LSDB.getFromSession(w());$("#faqdiv").html($Temp.getLoadingHTML());var e=$Support.EmbedObj.mappeddept,a=$Support.EmbedObj.livelsid,s="",r="",o=$Support.LSDB.getFromSession("lastsynctime_article");e&&"-1"!==e&&(s="department_id="+e),o&&i&&(r=(s?"&":"")+"client_sync_time="+o);var d=s+r;d=(d=d+(d?"&":"")+"app_id="+a)+"&language_code="+$Support.EmbedObj.embedlang,$Support.getParent().$ZSIQUtil.ajax(c()+"/visitor/v2/"+_SCREENNAME+"/articles/count?"+d,function(e){var a=JSON.parse(e).data;a.data?($Support.LSDB.removeAllFAQValuesFromSession(),$Support.LSDB.storeInSession(w(),a.data),$Support.LSDB.storeInSession("lastsynctime_article",a.client_sync_time),t(a.data)):t(i)},"",!0)},o=function(){z(),$Support.Util.updateViewAttribute("faqview"),e(),_appsenabled=!0},e=function(){var e=$Support.EmbedObj;if($FAQ.articledata)r($FAQ.articledata);else{var a=e.mappeddept&&-1!=e.mappeddept?"department_ids="+e.mappeddept+"&":"";$("#faqbox").html($Temp.getLoadingHTML());var t="articlecategories?"+a+"app_id="+e.appID;CommonUtil.handleAjaxGetReq(t,function(e){var a=e.data;$FAQ.articledata=a,r(a)},function(){},{isv3api:!0,isresourceapi:!0})}},r=function(e,a){for(var t=e.length,i="",s=0;s<t;s++){var r=e[s];0!=r.articles_count&&(i+=d(r))}a=a||"-1",$("#faqbox").html(i).attr("parent_id",a),"-1"==a&&z()},d=function(e){return'<div class="flexC siq-categ-list" '+(e.parent_category_id?"parent-id="+e.parent_category_id:"")+" "+("category-level="+e.level)+" category_id="+e.id+' documentclick="forwardcategory"><div class="cmplogo categ-cmplogo" prop="clogo" data-chttype="conv"><span class="sqico-catgeory"><img height="49" width="49" id="complogo" class="cmn_mdl siq-company-logo" onload="$Support.Util.handleBlurImage(this)" src=""></span></div><div class="flexG"><em class="font16 fw600">'+e.name+'</em><p class="font14 article"><em>'+e.articles_count+" "+LSResource.getRealValue("faq.articles")+'</em></p></div><em class="sqico-rarrow siq-categ-arrow"></em></div>'},n=function(t,e){var a=e||$FAQ.articledata;$.each(a,function(e,a){if(a.id==t)return i=a,!1;a.children&&n(t,a.children)})},a=function(e){var a=e.attr("category_id");e.attr("category-level"),e.attr("parent-id");n(a),l({category_name:i.name}),i.children?r(i.children,a):($("#faqbox").html('<div id="faqdiv" docwheel="handlescroll"></div>').attr("parent_id",a),function(t){if(s[t])f("","",s[t]);else{$("#faqdiv").html($Temp.getLoadingHTML());var e="articles?category_id="+t+"&app_id="+$Support.EmbedObj.livelsid;CommonUtil.handleAjaxGetReq(e,function(e){var a=e.data;a=p(a),s[t]=a,f("","",a)},function(){},{isresourceapi:!0})}}(a))},l=function(e){var a="2"===$Support.container.attr("themeid")?$("#cmpylogo"):$("header");a.find('[prop="clogo"]').find("span").removeClass("sqico-user sqico-clogo").addClass("sqico-catgeory"),a.find("#attabtme").hide(),a.find("#attname").html(e.category_name),a.find(".headercont").find("#showsiqcategory").length?a.find(".headercont").find("#showsiqcategory").show():a.find(".headercont").prepend('<div class="siq-convback sqico-larrow" id="showsiqcategory" documentclick="backwardcategory" proptype="backward"></div>')},p=function(e){for(var a=[],t=e.length,i=0;i<t;i++){var s=e[i],r=s.stats||{},o=s.modifier;a.push({visitors_disliked:r.disliked,visitors_viewed:r.viewed,modified_time:s.modified_time,article_info:{savedby:{dname:o.display_name,lsuid:o.id},modifiedtime:s.modified_time,message:s.title},enabled:s.enabled,visitors_liked:r.liked,message:s.title,id:s.id,department_id:s.department_id,version:"v2"})}return a},g=function(e,a,t,i){$.ajax({url:c()+"/visitor/v2/"+_SCREENNAME+"/cannedmessages/"+a+"/vote?type="+i,type:"POST",dataType:"json",success:function(e){t(e)}})},h=function(){return $Support.EmbedObj.resourcebaseconfigs.allow_visitor_to_like_article||{}},v=function(e,a,t,i){var s,r=a?"_"+a:"";if(s=_appsenabled?$Support.LSDB.getFromSession("faq"+r):$Support.LSDB.getFromSession("faq_"+e+r),i||!s){var o="",d=99;a?(o="&canned_category_id="+a,d=i?99:15,$("#"+a).html('<div class="cat_loading">'+$Temp.getLoadingHTML()+"</div>")):$("#faqdiv").html($Temp.getLoadingHTML());o=a?"&canned_category_id="+a:"";_appsenabled?o+="&app_id="+$Support.EmbedObj.livelsid:o+="&department_id="+e,$Support.getParent().$ZSIQUtil.ajax(c()+"/visitor/v2/"+_SCREENNAME+"/cannedmessages?limit="+d+o+"&language_code="+$Support.EmbedObj.embedlang,function(e){var a=JSON.parse(e).data;t(a)},function(){},!0)}else t(s)},u=function(e){var a=$Support.LSDB.getFromSession(w());if(a){var t=[];if(_appsenabled)t=a;else for(var i=0;i<a.length;i++)if(a[i].department_id===e){t=a[i].categoryinfo;break}var s="";for(i=0;i<t.length;i++){var r=t[i].categoryid,o=getEncodedText(t[i].categoryname);s+='<div class="posrel" category_id="'+r+'" data-type="accordian"><div data-type="accordian-item"><div id="'+r+'"></div><div class="artcle-viewal" documentclick="extendview">'+LSResource.getRealValue("faq.article.viewall")+'</div></div><div data-type="accordian-header" class="dsp_table faq-cat"><div class="sbold sqico-faqcat txtelips" title="'+o+'">'+o+'</div><div class="sqico-darrow"></div></div></div>'}}var d=$("#faqdiv"),c=!d.find("#article-wrap").length;d.html('<div id="article-wrap">'+s+"</div>"),c&&d.hide().fadeIn(),$Support.Util.handleAccordian(function(e){var a=d.attr("department_id"),t=e.parent().attr("category_id");v(a,t,function(e){_appsenabled?$Support.LSDB.storeInSession("faq_"+t,e):$Support.LSDB.storeInSession("faq_"+a+"_"+t,e),f(a,"",e,t),15<e.length&&m(t)})})},f=function(e,a,t,i){t=t||(_appsenabled?$Support.LSDB.getFromSession("faq_"):$Support.LSDB.getFromSession("faq_"+e));for(var s=_(a),r=0,o="",d=[],c=T(),n=0;n<t.length;n++){var l={};if("object"==typeof t[n]&&(l=$Support.LSDB.getFromSession("article_"+t[n].id)||t[n]),0!==getObjectSize(l)){var p=l.visitors_viewed,v=1==p?LSResource.getRealValue("common.view"):LSResource.getRealValue("faq.views"),u=CommonUtil.decodeHTML(l.message).replace(/<br *\/?>/gi," ");u=getEncodedText(u);var f=l.visitors_liked,m=h().enabled&&f&&"0"!=f?"<em  likeid="+l.id+' class="sqico-like">'+l.visitors_liked+"</em>":"",g=p&&"0"!=p?"<em viewid="+l.id+">"+p+" "+v+"</em>":LSResource.getRealValue("faq.noviews");o+='<div class="dsp_table faqarticle" documentclick="faqpreview" article-id="'+l.id+'"><div class="sqico-faqarticle"></div><div class="f15"><em class="font16">'+getEncodedText(u)+'</em><p class="font14 article">'+g+m+"</p></div></div>",d.push(l.id),r++}}s&&!c&&$("#"+i).html(o),q(),(c&&r||r&&!s)&&$("#faqbox").find("#faqdiv").html(o),r||$("#faqbox").find("#faqdiv").html(S(a))},q=function(){$("#faqbox").find("#faqdiv").length||$("#faqbox").html('<div id="faqdiv" docwheel="handlescroll"></div>')},m=function(e){$("#"+e).addClass("view_article"),$(".artcle-viewal").attr("categoryid",e)},S=function(e){var a=(e=getEncodedText(e)||"")?LSResource.getRealValue("faq.noarticles"):LSResource.getRealValue("faq.empty.articles"),t=-1==$Support.EmbedObj.chatID?LSResource.getRealValue("ne.chatnow"):LSResource.getRealValue("ne.gotochat");return'<div id="nofaqs" class="nofaq"><div class="dis_cell"><div class="faq-reslt-img"></div><p>'+e+"</p>"+a+($Support.EmbedObj.status&&!$Support.isChatExist()?'<div class="chatnw"><em class="wincustom_clr" proptype = "faqchtnow"  documentclick="showchatui">'+t+"</em></div>":"")+"</div></div>"},_=function(e){return!e&&(!!$Support.EmbedObj.faqaccess.length&&"1"==$Support.EmbedObj.faqaccess[1].orderbycategory)},w=function(e){return e?"faq_"+e:"faq_count_"+$Support.EmbedObj.mappeddept},b=function(e,a){for(var t="",i=0;i<e.length;i++){var s=e[i],r=s.count;if(0!==r){var o=s.department_name;void 0!==a&&-1===o.toLowerCase().indexOf(a.toLowerCase())||(r=1===r?r+" "+LSResource.getRealValue("faq.article"):r+" "+LSResource.getRealValue("faq.articles"),t+='<div class="dsp_table faqlst" documentclick="faqcategory" department="'+o+'" departmentid="'+s.department_id+'"><div class="sqico-faqdept"></div><div><em class="sbold">'+o+'</em><p class="font14 article">'+r+"</p></div></div>")}}var d=$("#faqdiv");if(t){var c=!d.find(".faqlst").length;d.html(t),c&&d.hide().fadeIn()}else d.html(S(a))},y=function(e){$(".faq-srch").remove();var a=e.title||"",t=e.placeholder||LSResource.getRealValue("faq.search.hint");$Support.isNewHeader()?!e.hasarrow||$("#showsiqconv").show():a=e.hasarrow?'<span class="sqico-larrow" documentclick="showfaq"></span>'+a:a;var i=e.desc||"",s=e.classname||"";$("#attname").html(a);var r=e.hasarrow?"":" fulwdth";$("#attabtme").html(i).after('<div class="faq-srch min-view '+r+'" documentclick="faqsearch"><span class="sqico-search"></span><input type="text" id="faqsearch-field" placeholder="'+t+'" dockeyup="searchfaq" dockeydown="searchfaq"/><em class="sqico-close"></em></div>'),$("#attabtme").show();var o="2"===$Support.container.attr("themeid")?$("#cmpylogo"):$("header");o.find('[prop="clogo"]').find("span").addClass("sqico-user sqico-clogo").removeClass("sqico-catgeory"),o.removeClass("category").addClass(s),o.find("#showsiqcategory").hide(),$Support.Util.removeHeaderType(),$Support.Util.reSetHeaderClass(),$("#complogo").parent().removeClass("hide_fontico")},E=function(e,a){var t=$Support.LSDB.getFromSession("article_"+e.id[0]),i={2:"visitors_viewed",3:"visitors_liked",4:"visitors_disliked"},s=e.type[0];t[i[s]]=parseInt(t[i[s]])+1,$Support.LSDB.storeInSession("article_"+e.id[0],t);var r=1==t[i[s]]?LSResource.getRealValue("common.view"):LSResource.getRealValue("faq.views");a.find("em[viewid="+e.id+"]").text(t[i[s]]+" "+r),"3"==s&&$("#faqdiv").find("em[likeid="+e.id+"]").text(t[i[s]])},C=function(t,i){var s="";return Object.keys(t).forEach(function(e){var a=t[e];return 0<a.child.length?s+=L(a,i).replace(/{CHILDELEMETHTML}/g,C(a.child,!0)):s+=R(a,i)}),s},L=function(e,a){return""==$.trim(e.content)?"{CHILDELEMETHTML}":'<div class="zsiq-arrow-cont '+(a?"zsiq-child1":"")+' zsiq-arrow-open" '+(a?"data-id='tocchild'":"")+'><div class="zsiq-flexT"><span class="zsiq-arw-point-div" docclick="toggletocchild"></span><a class="zsiq-anchor-link-div" data-id="'+e.elementId+'" docclick="articlesccrolltoview">'+e.content+"</a></div>{CHILDELEMETHTML}</div>"},R=function(e,a){return""==$.trim(e.content)?"":'<div class="zsiq-disc-cont '+(a?"zsiq-child1":"")+'" '+(a?"data-id='tocchild'":"")+'><div class="zsiq-flexT"><span class="zsiq-bullet-point-div"></span><a class="zsiq-anchor-link-div" data-id="'+e.elementId+'" docclick="articlesccrolltoview">'+e.content+"</a></div></div>"},z=function(){var e=($Support.getParent().$ZSIQUtil.getAPIValues()||{}).articlecontent||{};y({title:e.title||$Support.Util.getFAQLabel(),desc:e.subline||LSResource.getRealValue("faq.header.desc"),placeholder:e.placeholder||LSResource.getRealValue("faq.search.hint")}),$("#faqdiv").removeAttr("department_id")},T=function(){return $Support.EmbedObj.ismulti_categoryenabled&&$Support.isNewHeader()};return{showFAQUI:function(e){if(!$Support.Util.isPreview()){ZSIQConversationManager.resetLastViewd();var i=$("#faqdiv");i.length||($("footer").before('<div id="faqbox" class="siq_content"><div class="zsiq-wrap"><div class="zsiq-wrap-body"><div class="zsiq-wrap-child"><span>Q</span><div class="zsiq-wrp-lne"></div></div><div class="zsiq-wrap-child"><span>A</span><div class="zsiq-wrp-lne"></div></div></div><div class="zsiq-wrap-body2"><div class="zsiq-wrap-child"><span>Q</span><div class="zsiq-wrp-lne"></div></div><div class="zsiq-wrap-child"><span>A</span><div class="zsiq-wrp-lne"></div></div></div></div><div id="faqdiv" docwheel="handlescroll"></div></div>'),i=$("#faqdiv")),e.addClass("sel").prev(".sel").removeClass("sel"),i.parents(".siqembed").children("section").hide();var s=$Support.EmbedObj.mappeddept,r=!0;if(T()&&_())return o(),void $FAQ.toggleHeaderSearchClass(!0);t(function(e){if(e[0]&&!e[0].hasOwnProperty("department_id")&&(_appsenabled=!0),_appsenabled)0<(a=$Support.LSDB.getFromSession(w())).length?$FAQ._showCategory(a):i.html(S());else if(b(e),s&&"-1"!==s){for(var a=$Support.LSDB.getFromSession(w()),t=0;t<a.length;t++)if(a[t].department_id==s&&0<a[t].count){$FAQ.showCategory(void 0,a[t]),r=!1;break}r&&i.html(S())}}),$Support.Util.updateViewAttribute("faqview"),$FAQ.toggleHeaderSearchClass(!0),r&&z(),$Support.Util.calculateContentHeight()}},showCategory:function(e,a){if(!$Support.Util.isPreview()){var t=a?a.department_id:e.attr("departmentid");$("#faqdiv").attr("department_id",t),_()?u(t):v(t,"",function(e){_appsenabled?$Support.LSDB.storeInSession("faq_",e):$Support.LSDB.storeInSession("faq_"+t,e),f(t,"",e)}),y({title:a?a.department_name:e.attr("department"),classname:"category",hasarrow:!a}),$FAQ.toggleHeaderSearchClass(!0),$Support.isNewHeader()&&$TH.checkAboutmeClass()}},_showCategory:function(e){$Support.Util.isPreview()||(_()?u():v(void 0,"",function(e){$Support.LSDB.storeInSession("faq_",e),f(void 0,"",e)}),$FAQ.toggleHeaderSearchClass(!0),$Support.isNewHeader()&&$TH.checkAboutmeClass())},handleSearch:function(a){if(!$Support.Util.isPreview()){a.removeClass("min-view category");var t=a.find("input").focus();$FAQ.toggleHeaderSearchClass(),a.find(".sqico-close").on("click",function(e){a.addClass("min-view"),$FAQ.toggleHeaderSearchClass(!0),t.val(""),$FAQ.searchFAQ(t,e),e.stopPropagation()})}},toggleHeaderSearchClass:function(e){var a=$Support.container.find("header");e?a.removeClass("faq_srch"):a.addClass("faq_srch")},showFAQPreview:function(u,e){var t,i,s,a,r,f=u.attr("article-id"),m=$Support.getParent().$ZSIQUtil.getCookieValue("Article_"+f);t=f,i=function(e){if(!e||!e.message)return $(window.parent.document).find("body").append('<div class="zsiq_prv_main" zsiqclose="true" docclick = "zsiqclose" id="zsiqimagepreview"><div id="zsiqfaqpreview" class="siq-empty-slate" articleid="{ARTICLEID}"><div class="siq-emtyimg"><img src="'+CommonUtil.getStaticURL("/salesiq/images/articleemptystate_7ae02f0de4ec926861ff157cbbcb8201_.svg")+'"></div><p class="siq-emtydesc">'+LSResource.getRealValue("faq.empty.desc")+'</p></div><div class="zsiq-footer"><em class="sqico-close" zsiqclose="true" docclick = "zsiqclose"></em></div></div>'),void $Support.getParent().$ZSIQUtil.bindEventsForImgPreview();g(JSON.stringify({type:"2"}),f,function(e){E(e,u)},2);var a,t,i,s,r=function(e,a){if(e){var t=a||["h1","h2","h3","h4","h5","h6"],i=function(e,a){return(e=t.indexOf(e))<(a=t.indexOf(a))},s=e.querySelectorAll(t.join());if(s&&s.length){for(var r,o,d=s.length,c=[],n=0;n<d;n++){var l=s[n],p={content:l.textContent.trim(),elementId:l.getAttribute("id"),tagName:l.tagName.toLowerCase(),id:"toc_tree_item_"+n,child:[],isOpen:!1};r&&i(r.tagName,p.tagName)?r.child.push(p):r=o&&i(o.tagName,p.tagName)?(o.child.push(p),p):(c.push(p),void(o=p))}return c}}return[]}(CommonUtil.stringToHTML(e.article_info.content)),o=0<r.length?'<div class="zsiq-toc-cont" data-id="toccontainer"><header class="zsiq-toc-hdr" docclick = "toggletocview"><span class="zsiq-toc-title" docclick = "toggletocview">Table of contents</span><em class="zsiq-arrow-TB" docclick = "toggletocview"></em></header><div class="zsiq-toc-body">{TOCELEMENTS}</div></div>'.replace(/{TOCELEMENTS}/g,C(r)):"",d=('<div class="zsiq_prv_main" zsiqclose="true" id="zsiqimagepreview" docclick = "zsiqclose"><div id="zsiqfaqpreview" articleid="{ARTICLEID}"><div class="zsiq-prev-header" id="zsiq-prev-header">{HEADER}</div><div class="zsiq-prev-content">{TOCELEMENTCONTAINER}<div>{CONTENT}</div></div><div class="zsiq-footer">{VOTE}'+($Support.EmbedObj.status&&!$Support.isChatExist()?'<div class="zsiq-cbtn siqico-chat" proptype = "faqchtnow" docclick = "zsiqstartchat">{CHATNOW}</div>':"")+'</div><em class="siqico-close" zsiqclose="true" docclick = "zsiqclose" ></em></div></div>').replace(/{TOCELEMENTCONTAINER}/g,o),c=$Support.isChatExist()?LSResource.getRealValue("ne.gotochat"):LSResource.getRealValue("ne.chatnow"),n=""===m&&h().enabled?(t=(a=e).visitors_liked||"",i=a.visitors_disliked||"",s=h().content||LSResource.getRealValue("faq.ishelpful"),'<div class="zsiq-aside">'+($Support.isMobileWidth()?"":s)+'<span class="siqico-like" docclick = "zsiqfaqvote" data-vote="3">'+t+'</span><span class="siqico-dislike" docclick = "zsiqfaqvote"  data-vote="4">'+i+"</span></div>"):"",l=e.article_info.savedby,p="";$Support.EmbedObj.resourcebaseconfigs.show_creator_image&&(p=0==l.modifier_image.split("/")[5].indexOf("0_")?'<img src="'+CommonUtil.getStaticURL("/salesiq/images/user/user_160-160_8265b0d9db45b8cd081ef20d712e559a_.png")+'" class="zsiq-user36">':'<img src="'+_SCHEMA+"://"+_EMBEDSERVERURL+l.modifier_image+'" class="zsiq-user36">');var v="<p>"+getEncodedText(e.message)+'</p><div class="zsiq-flexC">'+p+'<div class="zsiq-artcl-modifiermain"><div class="zsiq-artcl-modifier">'+getEncodedText(l.modifier_name)+"</div> <div>"+LSResource.getRealValue("common.updated")+" "+MyDate.timeDifference(e.modified_time)+"</div></div></div>";d=d.replace(/{HEADER}/g,v).replace(/{ARTICLEID}/g,f).replace(/{VOTE}/g,n).replace(/{CHATNOW}/g,c).replace(/{CONTENT}/g,CommonUtil.SanitizeHtmlContent(e.article_info.content)),$(window.parent.document).find("body").append(d),$Support.getParent().$ZSIQUtil.bindEventsForImgPreview()},s=e,a=$Support.LSDB.getFromSession("article_"+t)||{},r=a.article_info,a&&r&&r.content?i(a):$Support.getParent().$ZSIQUtil.ajax(c()+"/visitor/v2/"+_SCREENNAME+"/cannedmessages/"+t,function(e){var a=JSON.parse(e).data;$Support.LSDB.storeInSession("article_"+t,a),i(a)},function(e){var a=e&&JSON.parse(e);a&&a.error&&"function"==typeof s&&s()},!0)},updateVote:function(e,a){a=$(a);JSON.stringify({type:a.attr("data-vote")});var t=a.parents("#zsiqfaqpreview");g(0,t.attr("articleid"),function(e){E(e,a),a.parent().html(LSResource.getRealValue("faq.feedback"))},a.attr("data-vote"))},getHeaderMessage:function(e){var a=JSON.parse(CommonUtil.decodeHTML(e));return"object"==typeof a?a.header:""},searchFAQ:function(s,e){clearTimeout(_searchtimer);var a=$Support.Util.getKeyCode(e);if(!(-1<["37","38","39","40","13","9","16"].indexOf(a))){var r=$.trim(s.val()).toLowerCase();!r||r.length<3?function(e){var a=$("#faqdiv").attr("department_id");if(a||_appsenabled){if(""===e&&_())return T()?o():u(a);f(a,e)}else t(function(e){b(e)})}(r):_searchtimer=setTimeout(function(){var e,t,a,i;e=r,t=function(e){r===s.val().toLowerCase()&&f("",r,e)},a=$("#faqdiv").attr("department_id"),i=c()+"/"+_SCREENNAME+"/searchcanned.ls?query="+e+"&entities=2&mode=listview&language_code="+$Support.EmbedObj.embedlang,i+=a?"&department_id="+a:"",i+="&app_id="+$Support.EmbedObj.livelsid,$Support.getParent().$ZSIQUtil.ajax(i,function(e){var a=JSON.parse(e);a&&0==a[0].res_count&&(a=[]),t(a)},"",!0)},500)}},updateMessageCount:function(e){if("newmsg"===e||"newchat"===e||"triggerchat"===e){var a=$Support.getUnreadCount();a&&($("#conv-tab").addClass("count").find(".siqc_eletype").show().html(a)[0].className="siqc_eletype")}},showAllArticlesInCategory:function(e){e.parent().find(".view_article").removeAttr("style").removeClass("view_article");var a=$("#faqdiv").attr("department_id"),t=e.attr("categoryid");v(a,t,function(e){f(a,"",e,t)},!0)},_noResultsHTML:S,forwardCategoryNavigation:function(e){a(e)},backwardCategoryNavigation:function(e){!function(e){var a=$("#faqbox").attr("parent_id");if(n(a),0!=i.level){var t=i.parent_category_id;n(t),r(i.children,t),l({category_name:i.name})}else r($FAQ.articledata)}()},checkandSetHeaderUserClass:function(){var e;(e=("2"===$Support.container.attr("themeid")?$("#cmpylogo"):$("header")).find('[prop="clogo"]').find("span")).hasClass("sqico-catgeory")&&e.removeClass("sqico-catgeory").addClass("sqico-user")}}}();$BotImpl=function(){var n,d={},c=[],m=ZSIQTranscript,p=function(e){l();var t=w(e);$.isEmptyObject(t)||""==t.chatdiv.html()&&b("",e)},l=function(){d={},clearInterval($BotImpl.timer),m.removeTyping()},g=function(e,t){var a=e.chid||e.enc_chid;if(m.removeTyping(),(!e.meta||!e.meta.disablesound)&&v(a),r(e)?e.meta.input_card&&e.meta.display_card?i(e):$Widget.showBotReply(e):(e.isbotmessage=y(e),e.time=MyDate.getHoursandMin(e.time,!0,"bclient"),e.html=m.getTranscript(e,!1,a),m.updateTranscript(e,a)),t)return l(),e.meta&&(e.meta[$Widget.input_card]||"pending"==e.meta.action)||b("",a),$BotImpl.resetDisableComposerTimer(),void(e.meta&&("pending"==e.meta.action&&h("pending",18e4,a),e.meta.allow_typing?b("",a):"wait_for_user_input"==e.meta.behaviour&&h("","",a)));m.showTyping(e)},i=function(e){var t=$.extend(!0,{},e),a=$.extend(!0,{},e);delete t.meta.input_card,delete a.meta.display_card,a.time+="1",a.msgid+="1",a.msg="",$Widget.showBotReply(t),$Widget.showBotReply(a)},r=function(e){return!!e.meta&&(e.meta[$Widget.display_card]||e.meta[$Widget.input_card]||e.meta.suggestions)},u=function(e,t,a){if(0==getObjectSize(d)||a){var i=e.meta;if($Support.chidmappinglist&&(e.chid=$Support.chidmappinglist[e.chid]||t),clearInterval($BotImpl.timer),!i)return e.msg&&!e.msg.msglist?void ZSIQTranscript.updateTranscript({html:ZSIQTranscript.getTranscript(e,"",t)},t):void o(e);d=e,i.image&&(e.bot_image=e.meta.image),s(e,e.chid),e.msglist?f(e,1):g(e,!0)}else c.push(e)},s=function(e,t){if(!e.isdisablecache){var a=e.msglist;if(a)for(var i=0;i<a.length;i++)$Support.updateChatCache($.extend({},e,a[i]),"",t);else $Support.updateChatCache(e,"",t)}},o=function(e){Message.lastMessagePostTime=(new Date).getTime();for(var t=e.msg.msglist,a=0;a<t.length;a++){var i=t[a],n=$.extend({msg:i.msg,meta:i.meta},e.msg);n.replies="",u(n,e.chid,!0)}},f=function(t,e){t=t||d;var a=m.getMessageID(t),i=t.chid||t.enc_chid;if(a&&m.isMessageExist(a,i))l();else{var n=t.msglist;if(n){h("","",i),m.showTyping(t),e=e||0;var r=m.getMessageDelay(t),s=0,o=t.disablesound;$BotImpl.timer=setInterval(function(){if(w(i).chatdiv){if(s<n.length){var e=$.extend({},t,n[s]);o&&e.meta&&(e.meta=T(e.meta)),g(e,s===n.length-1),$Widget.isPreview()&&"function"==typeof window.afterMsgRendered&&window.afterMsgRendered(e)}s==n.length-1&&0!=c.length&&(Message.updateLastMessagePostTime(),u(c.shift())),s++}else p(i)},e*r)}else l()}},v=function(e){KeyHandler.isWindowFocused()||($Support.getParent?$Support.getParent().$ZSIQWidgetUI.getWidgetState()==$Support.getParent().$ZSIQWidgetUI.F_WINDOW&&!w(e).isSoundOff()&&EmbedSound.play("smessage"):EmbedSound.play("smessage"))},h=function(e,t,a){var i=w(a),n=i.composer;n&&(n.attr("disabled","true"),"pending"==e?n.attr("placeholder",LSResource.getRealValue("common.pleasewait")):n.attr("placeholder",LSResource.getRealValue("ne.message.choose")),i.contentdiv.find("#action_icons").hide(),S(t,a))},b=function(e,t){clearTimeout(n);var a=w(t);$.isEmptyObject(a)||((e=e||a.composer).removeAttr("disabled"),a.checkAndFocusMessageArea(),e.attr("placeholder",LSResource.getRealValue("ne.message.hitenter")),a.contentdiv.find("#action_icons").show())},S=function(e,t){if(e){n=setTimeout(function(){b("",t),ZSIQTranscript.removeTyping();var e=w(t).contentdiv.find("#typgstatus");e.text(""),e.attr("tooltip","")},e);var a={};if(t&&-1!=t)$Support.LSDB.set("ZLD"+$Support.EmbedObj.livelsid+"disablecomposer",{},e),a.dname=$Support.EmbedObj.attendername,a.sender=$Support.EmbedObj.attender;else{var i=Bot.getBotOBJ();a.dname=i.name,a.sender=i.id}ZSIQTranscript.showTyping(a)}},T=function(e){if(e)return e.typing_delay=0,e.disablesound=!0,e},y=function(e){try{return"b"==e.sender.split("_")[2][0]}catch(e){return!1}},w=function(e){return ZSIQTranscript.getChatWindowOBJ(e)},I=function(e){var t=e.find("[input-card]");0<t.length?t.remove():e.find("#conversationoption").remove()};return{formatAndDisplay:u,resetValues:p,disableComposer:h,enableComposer:b,iswidgetobj:r,isBotMessage:y,resetMessageSequence:function(){m.removeTyping(),clearInterval($BotImpl.timer),f()},resetDisableComposerTimer:function(){clearTimeout(n),$Support.EmbedObj&&$Support.LSDB.remove("ZLD"+$Support.EmbedObj.livelsid+"disablecomposer"),ZSIQTranscript.removeTyping()},callback_expiry:18e4,checkAndScheduleComposerDisable:function(e){var t=$Support.LSDB.get("ZLD"+$Support.EmbedObj.livelsid+"disablecomposer");if(t){var a=t.time+t.ttl-(new Date).getTime();$Support.LSDB.remove("ZLD"+$Support.EmbedObj.livelsid+"disablecomposer"),h("pending",a,e)}},removeWidgets:function(){var e=$("[input-card]");if(!(e.size<=0)){var t=e.parents(".ziq_msg"),a=t.find(".cmpnt-desc").html();a?_msgobj.meta&&_msgobj.meta.input_card&&t.find(".msgbx").html(a):("undefined"==typeof BotPreview?Message:BotPreview).animate(t,!0,function(e){e.remove()}),$("#conversationoption").remove()}},handleInputAndDisplayWidgetsObj:i,setTypingandSoundConfig:T,sanitizeUrlContent:function(t){try{return ZSEC.URLValidator.sanitize(t,{ACTION:"REMOVE",KEEP_ORIGINAL:"True"})}catch(e){return t}},handleBotflowCommand:function(e){var t=e.chatobj;I(t.chatdiv.find('[data-field="message"]').last());var a={restart:LSResource.getRealValue("bot.restartflow"),rollback:LSResource.getRealValue("bot.rollbackflow")}[e.command];Message.displaySendMessage(t.chatID,a,"",(new Date).getTime()),Message.updateLastMessagePostTime(),LSMessanger.sendMessage(t.chatID,a,{botcommand:e.command},(new Date).getTime())},checkAndGetBotResetterHTML:function(e){var t=e.config||{};if(!e.chatobj.isBotChat||$Widget.isPreview())return ZSIQTranscript.removeBotResetter(e.chatobj),"";var a=t.hasOwnProperty("rollback");return a||t.hasOwnProperty("restart")?$Temp.getBotflowSetBackHTML({restart:t.restart,rollback:a,disabled:a&&!t.rollback}):""}}}();$Clickoutside={callbackfn:null,dest:null,src:null,ignoreesckey:null,bindclick:function(l,i,c,n,t){null==this.callbackfn||this.dest==i||this.ignoreclick||this.callbackfn(),this.callbackfn=l,this.dest=i,this.src=c,this.ignoreesckey=n,this.ignoreclick=t},handledclick:function(l){var c=getEventSourceId(l);if(null!=this.callbackfn&&this.src!=c&&!this.ignoreclick){var n=$(getSource(l)).parents();for(i=0;i<n.length;i++)if($(n[i]).attr("id")==this.src||$(n[i]).attr("id")==this.dest)return;this.callbackfn(),this.callbackfn=null,this.dest=null,this.src=null}},handleEscape:function(l){if(!this.ignoreesckey&&null!=this.callbackfn)return this.callbackfn(),this.callbackfn=null,this.dest=null,!(this.src=null)}},$(document).on("click",function(l){$Clickoutside.handledclick(l)});$Widget=function(){var r,l,i,d={},m="",p="",g="",n=function(){l.callback=l.callback||o,t()},u=function(){return"undefined"==typeof BotPreview?Message:BotPreview},t=function(){var t={skip:function(){s()},select:function(){Singleselect.init(l,r)},"multiple-select":function(){Multiselect.init(l,r)},slider:function(){Slider.init(l,r)},"range-slider":function(){Slider.init(l,r)},links:function(){Button.init(l,r)},calendar:function(){a(l,r)},"range-calendar":function(){l.range=!0,a(l,r)},"happiness-rating":function(){l.callback=f,Rating.smiley_init(l,r)},"star-rating":function(){l.callback=f,Rating.star_init(l,r)},like:function(){l.callback=f,Rating.like_init(l,r)},suggestions:function(){Suggestions.init(l,r)},location:function(){ZMaps.init(l,r)},articles:function(){BotArticle.init(l,r)},timeslots:function(){BotTimeSlot.init(l,r)},"date-timeslots":function(){BotTimeSlot.init(l,r)},input:function(){ZSIQInput.init(l,r)},classic:function(){ZSIQForm.init(l,r)},conversationforminput:function(){ConversationFormInput.init(l,r)},video:function(){ZSIQLinkInfo.init(l,r)},contact:function(){ZSIQContactCard.init(l,r)},relatedphrases:function(){ZSIQRelPhrases.init(l,r)},"single-product":function(){ZSIQCarousal.init(l,r)},"multiple-product":function(){ZSIQCarousal.init(l,r)},"drop-down":function(){Dropdowncreator.init(l,r)},file:function(){ZSIQFileUpload.init(l,r)}},e=l.type;if(/^(visitor_phone|visitor_name|visitor_email||phone|number|text|email|url|percent|decimal|double|website|textarea|tel|name|password)$/.exec(e)&&(e="input"),"function"==typeof t[e])return t[e](),void(l.skippable&&t.skip());l.actions&&b(),l.image&&(d.bot_image=l.image,c(""))},a=function(t,e){var i='<a><div class="cmpnt-btnurl elips sqico-calendar" id="bot_calender"><em class="dib-mid clr-azurblu cmpnt-cusclr">'+(getEncodedText(t.label)||LSResource.getRealValue("common.schedule"))+"</em></div></a>",n=$Widget.getLayout();n=(n=(n=n.replace(/{BOT_WIDGET}/g,i)).replace(/{CLASSNAME}/g,"botbtn")).replace(/{WIDGET_TYPE}/g,"input-card"),$Widget.attachHTML(n),t.hint="calendar"===t.type?LSResource.getRealValue("widget.calendar.hint"):LSResource.getRealValue("widget.rangecalendar.hint"),t.contentdiv=ZSIQTranscript.getChatWindowOBJ(t.chatid).contentdiv,t.contentdiv.find("#bot_calender").on("click",function(){zDatepicker.init(t,e)})},s=function(){var t=ZSIQTranscript.getChatWindowOBJ(l.chatid).contentdiv,e='<div class="cmpnt-skip dib-mid" id="skipquestion">'+LSResource.getRealValue("common.skip")+'<em class="mL5 sqico-skip font8"></em></div>',i=t&&t.find('[proptype="msgdiv"] .msgbx').last().parent();i.find("#skipquestion").length||(i.append(e),$("#skipquestion").click(function(){$(this).remove(),o({type:"skip",chatid:l.chatid,msg:"-",id:r,skipped:!0}),l.skip_callback&&l.skip_callback()}),ZSIQTranscript.scroll())},c=function(t,e,i){g="";var n=$Widget.getMessageOBJ(),a=n.meta||{},s=a.display_card&&a.display_card.type;if(s=!s&&a.related_phrases?"relatedphrases":s,n.isgetwidgethtml)return g=t,void(n.widget_cname=i);var c=$.extend({},n),r=n.time||n.mtime,o=i;-1!=["suggestions","relatedphrases"].indexOf(s)?$.extend(c,{msg:n.msg,time:MyDate.getHoursandMin(r,!0,"bclient"),isbotmessage:!0,iswidget:!0,widget_cname:o,suggestionhtml:t||""}):$.extend(c,{msg:t||n.msg,time:MyDate.getHoursandMin(r,!0,"bclient"),isbotmessage:!0,iswidget:!0,widget_cname:o}),e&&(c.is_ignoreformat=!0),c.html=ZSIQTranscript.getTranscript(c,"",l.chatid),ZSIQTranscript.updateTranscript(c,l.chatid)},o=function(t){var e=t.chatid;$BotImpl.enableComposer("",e);var i=ZSIQTranscript.getChatWindowOBJ(e);i.contentdiv.find("#skipquestion").remove();var n=t.msg,a=t.value||n,s=d.meta;if(n){var c=t.id,r=("true"===$("#bot_widget"+c).attr("hasquestion")?$("#bot_widget"+c):$("#cmpnt"+c)).parents(".ziq_msg"),o=r.find(".cmpnt-desc").html();o&&$.trim(o)?s&&s.input_card&&r.find(".msgbx").html(o):u().animate(r,!0,function(t){t.remove()}),(!s||!s.ignoremeta)&&(m={type:t.type,value:a}),t.data_id&&(m.id=t.data_id),i.contentdiv.find("#conversationoption").remove(),p=n,$Support.sendMessage(p,i.composer),d.active=!1}else u().formatAndDisplay(d)},f=function(i){var t=$("#cmpnt"+i.id).parents(".ziq_msg"),n=i.chatid,a=ZSIQTranscript.getChatWindowOBJ(n);a.contentdiv.find("#skipquestion").remove(),$BotImpl.enableComposer("",i.chatid);u().animate(t,!0,function(t){if(d.active=!1,i.ratinghtml){i.star&&(i.ratinghtml=i.ratinghtml.replace(/<\/div>$/,"<em>"+i.msg+"</em></div>")),d.mode="botrating",d.ratinghtml=i.ratinghtml,d.chid=n,d.msg=getEncodedText(t.find(".cmpnt-desc").text());var e=i.value;d.value=e,t.remove(),m={type:i.type,value:e},u().formatAndDisplay(d),p=i.msg,$Support.sendMessage(p,a.composer)}})},v=function(t,e){for(var i=Object.keys(t).length,n=e&&1==i?'class="single-btn "':"",a="",s=0;s<i;s++){var c=t[s],r=c.type;"url"==r&&(a+='<a href="'+c.link+'" target="_blank" prop="labelcontainer "'+n+'><div class="cmpnt-btnurl elips" prop="url"><em class="dib-mid clr-azurblu cmpnt-cusclr">'+c.label+"</em></div></a>"),"client_action"==r&&(a+='<a prop="ctacontainer" '+n+' name="'+c.name+'" data-val = "'+c.clientaction_name+'"  {BINDEVENT}><div class="cmpnt-btnurl elips" prop="callback" ><em class="dib-mid clr-azurblu cmpnt-cusclr" prop="callback">'+c.label+"</em></div></a>")}return a},b=function(){var t=l.actions,e=$Widget.isPreview(),i=(Object.keys(t).length,e?{}:$Support.getParent().$ZSIQUtil.getAPIValues()||{});i=i.clientaction||{};var n=$Widget.getLayout();n=(n=(n=(n=ZSIQTranscript.getFormatedHTML(n)).replace(/{BOT_WIDGET}/g,v(l.actions).replace(/{BINDEVENT}/g,'documentclick = "handleCta"'))).replace(/{CLASSNAME}/g,"botbtn")).replace(/{WIDGET_TYPE}/g,"display-card"),$Widget.attachHTML(n,!0)};return{input_card:"input_card",display_card:"display_card",suggestions:"suggestions",showBotReply:function(t){var e=t.meta;function i(){l.callback=t.callback||e.callback||"",l.validate=t.data_validate,l.isuseredit=t.isuseredit,l.iscustomfield=t.iscustomfield,l.triggerclbk=t.triggerclbk,l.fieldname=e&&e.field_name||"",l.hide_label=e.hide_label,l.subtype=e.subtype,e.skippable&&(l.skippable=e.skippable,l.skip_callback=e.skip_callback||""),l.chatid=t.enc_chid||t.chid}r=t.time||t.mtime||(new Date).getTime(),d={sender:t.sender,msgid:t.msgid,meta:e,time:r,dname:t.dname,msg:t.msg,isbotmessage:t.isbotmessage,isgetwidgethtml:t.isgetwidgethtml,msguid:t.msguid,reply_to:t.reply_to},l={},e[this.input_card]&&(l=e[this.input_card],e[this.display_card]&&(l.image=e[this.display_card].image),i(),n()),e[this.display_card]&&("suggestions"==(l=e[this.display_card]).type&&this.formatSuggestionObj(t),i(),n()),e.related_phrases&&(l.msglist=e.related_phrases,l.type="relatedphrases",d.msg&&(d.msg=ZSIQTranscript.getFormatedHTML(d.msg)),i(),n()),e.suggestions&&!t.isgetwidgethtml&&(l.type="suggestions",l.list=e.suggestions,t.msg&&this.handleMessage(t),i(),n())},formatSuggestionObj:function(t){l.list=l.phrases,l.isdisplaycard=!0},handleMessage:function(t){var e=t.enc_chid||t.chid,i=t.meta;t.isbotmessage=$BotImpl.isBotMessage(t),t.time=MyDate.getHoursandMin(r,!0,"bclient"),i&&i[this.display_card]&&(t.bot_image=i[this.display_card].image),t.iswidget=!0,t.html=ZSIQTranscript.getTranscript(t,"",e),ZSIQTranscript.updateTranscript(t,e)},getWidgetHTML:function(t){$Widget.showBotReply($.extend(t,{isgetwidgethtml:!0}));var e=$Widget.getMessageOBJ();return e.widget_cname&&(t.widget_cname=e.widget_cname),g||t.msg},getLayout:function(){return function(){var t=d.msg&&"file"==d.msg.type;d.msg=d.msg?d.msg:"",t&&(d.msg=ZSIQTranscript.getFileAttachHTML({msg:d.msg,file:d.msg}));var e="articles"==l.type,i=!!d.msg,n=$Support.EmbedObj,a="4"===$Support.container.attr("themeid")?" cmpnt-transtheme":"",s=n&&n.nonceval?"":' onload="$Support.handleUploadImageLoad( this )"',c=l.image&&!e?'<div class="cmpnt-sldimg mB10"><img src="'+l.image+'" chatmsgtype="image" '+s+' style="display: none;"></div>':"";return'<div class="posrel" id="cmpnt'+r+'" '+(e?"{ARTCLID}":"")+'><div class="cmpnt-wrap'+a+' {CLASSNAME}" id = "btnurl">'+c+'<div class="cmpnt-body-cont" id = "cmpnt_body'+r+'"><div class="cmpnt-desc lH20 c000"> '+d.msg+' </div><div {WIDGET_TYPE} id="bot_widget'+r+'" hasquestion = "'+i+'">{BOT_WIDGET}</div></div></div></div>'}()},attachHTML:function(t,e,i){c(t,e,i)},removeComponent:function(t){!function(t){if(0<Object.keys(d).length&&void 0===d.active){var e=$("#bot_widget"+r);0<e.length&&void 0===e.attr("isbutton")&&u().animate(e.parents(".ziq_msg"),!0,function(t){t.remove()})}t.contentdiv.find("#conversationoption").remove()}(t)},getMessageOBJ:function(){return d},isPreview:function(){return"undefined"!=typeof BotPreview},skipQuestion:function(t){if($BotImpl.enableComposer("",t.chatid),"-1"!=(i=$Support.getSkipObj()).chatid){var e=t||i.data;$.ajax({url:i.url,type:"POST",dataType:"json",data:JSON.stringify(e),success:function(){i.bottimer&&clearTimeout(i.bottimer)}})}},getLocationWidgetHtml:function(t){return'<a><div class="cmpnt-btnurl elips sqico-location" id="bot_location"><em class="dib-mid clr-azurblu cmpnt-cusclr">'+((e=t)?getEncodedText(e):LSResource.getRealValue("widget.location.set"))+"</em></div></a>";var e},getFileUploadHtml:function(t){return'<a><div class="cmpnt-btnurl elips sqico-reply" id="zsiqfilepreview"><em class="dib-mid clr-azurblu cmpnt-cusclr">'+((e=t)?getEncodedText(e):LSResource.getRealValue("widget.fileupload.set"))+'</em><input name="file1" type="file" docchange="attachment" multiple="" size="1" onclick="this.value="></div></a>';var e},getCtaHtml:function(t,e){return v(t,e)},getMetaData:function(){return"object"==typeof m?$.extend({},m):m},clearMetaData:function(){m=""},getMetaCardData:function(){return(t={}).card_data=$.extend({},m),t;var t},getLastMessage:function(){return p},clearLastMessage:function(){p=""}}}();Slider=function(){var s=function(t,e){this.RIGHT_ARROW=39,this.LEFT_ARROW=37,this.dotoffset=[],this.config_obj={values:t.values||["1","2","3","4"],initialheadposition:t.initialheadposition||"1",showcurrentposition:t.showcurrentposition||!0,enablearrowkeyopertion:t.enablearrowkeyopertion||!0,range:"range-slider"===t.type,callback:t.callback||function(){}},this.msgid=e,this.chatid=t.chatid,this.contentdiv=ZSIQTranscript.getChatWindowOBJ(this.chatid).contentdiv};return s.prototype.renderSlider=function(){this.renderComponentHtml(),this.setDivOBJ(),this._sliderwidth=this.contentdiv.find("#range-wrap").outerWidth();for(var t=this.config_obj.values,e="",i=0;i<t.length;i++)this.config_obj.values[i]=""+t[i],e+='<span class="range-point" data-type="slider-point"><em class="range-dot" title="'+t[i]+'" data-type="sliderdot" dot='+i+'></em><em class="range-value"></em></span>';this.$rangepoint.html(e),this.$rangeelem=this.$rangepoint.children();for(var s=0;s<this.$rangeelem.length;s++)this.dotoffset[s]=this.$rangeelem[s].offsetLeft;this.updateSliderPosition(this.dotoffset[this.config_obj.initialheadposition],this.$sliderrighthead),this.config_obj.range&&this.updateSliderPosition(this.dotoffset[0],this.$sliderlefthead),this.negwidth=this.contentdiv.find("#cmpnt"+this.msgid).parents(".msgbx")[0].clientWidth-this._sliderwidth-this.$sliderrighthead.outerWidth()/2,this.negwidth+="undefined"==typeof BotPreview?0:$("#botpreviewwindow").offset().left},s.prototype.renderComponentHtml=function(){var t=this.config_obj.values.length,e='<div class="sld-cont" id = "slidercont"><div class="dtfix mB10 w100 c999" id = "slider"><div class="dcell">'+this.config_obj.values[0]+'</div><div class="dcell textR">'+this.config_obj.values[t-1]+'</div></div><div class="range posrel textC" id="range-wrap"><span class="range-path" id="range-body"><span id="slider-val" class="range-val" style="position: absolute;height: 5px;border-radius: 4px;left: 0;"></span>'+(this.config_obj.range?'<span class="range-handle" id="sliderlefthead" style="left:0px" tabindex="2"></span>':"")+'<span class="range-handle" id="sliderrighthead"  style="left:65px" tabindex="1" ></span></span><div id="range-point-wrap" class="range-point-wrp"></div><div class="dtfix textL cmpnt-ftr"><div class="dcell clr-azurblu dib-mid" id="range-display"></div><div class="textR dcell"><div class="sqico-tick" id="range-selected"></div></div></div></div></div>',i=$Widget.getLayout();i=(i=(i=i.replace(/{BOT_WIDGET}/g,e)).replace(/{CLASSNAME}/g,"botslider")).replace(/{WIDGET_TYPE}/g,"input-card"),$Widget.attachHTML(i)},s.prototype.setDivOBJ=function(){var t=this.contentdiv.find("#cmpnt"+this.msgid);this.$displayelem=t.find("#range-display"),this.$rangepoint=t.find("#range-point-wrap"),this.$sliderrighthead=t.find("#sliderrighthead"),this.$sliderlefthead=t.find("#sliderlefthead"),this.$rangeval=t.find("#slider-val")},s.prototype.handleEvents=function(){var i=this,t=this.contentdiv.find("#cmpnt"+this.msgid);function e(t){var e=this;$(document).bind("mouseup touchend",function(t){$(document).off("mouseup touchend mousemove touchmove"),i.handleHeaderMovement(t)}),$(document).on("mousemove touchmove",function(t){i.handleHeaderMovement(t,e)})}this.ismousedown=!1,this.$sliderrighthead.bind("mousedown touchstart",e),this.config_obj.range&&this.$sliderlefthead.bind("mousedown touchstart",e),t.find("#range-body").click(function(t){i.handleNearestClick(t)}),this.$rangeelem.click(function(t){i.handleDotClicked(t)}),t.find("#range-selected").click(function(){i.handleCallBack()}),this.config_obj.enablearrowkeyopertion&&(this.$sliderrighthead.keyup(function(t){i.handleKeyOperation(t,this)}),this.config_obj.range&&this.$sliderlefthead.keyup(function(t){i.handleKeyOperation(t,this)}))},s.prototype.handleHeaderMovement=function(t,e){if(t.stopPropagation(),"mousemove"==t.type||"touchmove"==t.type){var i=("touchmove"==t.type?t.originalEvent.touches[0].pageX:t.pageX)-this.negwidth,s=$(e);this.updateSliderPosition(i,s)}else{var o=this.$sliderrighthead;if(this.handlePointMove(o[0].offsetLeft,o),this.config_obj.range){var n=this.$sliderlefthead;this.handlePointMove(n[0].offsetLeft,n)}}},s.prototype.handlePointMove=function(t,e){this.updateSliderPosition(this.getNearestPointPosition(t),e)},s.prototype.handleNearestClick=function(t){var e=t.target.id||"";if("sliderrighthead"!==e&&"sliderlefthead"!==e){var i=this.getNearestPointPosition(t.pageX-this.negwidth);this.moveNearestHeader(i)}},s.prototype.handleDotClicked=function(t){var e=t.target.getAttribute("dot");null!=this.dotoffset[e]&&this.moveNearestHeader(this.dotoffset[e])},s.prototype.moveNearestHeader=function(t){var e=this.$sliderrighthead,i=e[0].offsetLeft;if(this.config_obj.range){var s=this.$sliderlefthead[0].offsetLeft;e=s<t&&t<i?t-s<i-t?this.$sliderlefthead:this.$sliderrighthead:t<i?this.$sliderlefthead:this.$sliderrighthead}this.updateSliderPosition(t,e)},s.prototype.handleKeyOperation=function(t,e){t.currentTarget.id;var i=e.offsetLeft,s=t.keyCode,o=this.dotoffset.indexOf(i);if(s==this.RIGHT_ARROW&&o<this.dotoffset.length-1)var n=this.dotoffset[o+1];else{if(!(s==this.LEFT_ARROW&&0<o))return;n=this.dotoffset[o-1]}this.handlePointMove(n,$(e))},s.prototype.updateSliderPosition=function(t,e){if(!this.config_obj.range||this.checkHeaderMove(t,e)){t=t>this._sliderwidth?this._sliderwidth:t<0?0:t,this.contentdiv.find(".range-value").empty(),e.css("left",t),this.$rangeval.css("width",t);var i=this.$sliderrighthead[0].offsetLeft;if(this.config_obj.range){var s=this.$sliderlefthead[0].offsetLeft;s<i?this.highlightSelectedPoint(s,i):this.highlightSelectedPoint(i,s)}else this.highlightSelectedPoint(this.dotoffset[0],i);this.config_obj.showcurrentposition&&this.handleDisplayValue()}},s.prototype.checkHeaderMove=function(t,e){if("sliderrighthead"===e[0].id){var i=this.dotoffset.indexOf(this.$sliderlefthead[0].offsetLeft);return this.dotoffset[i+1]<=t}i=this.dotoffset.indexOf(this.$sliderrighthead[0].offsetLeft);return t<=this.dotoffset[i-1]},s.prototype.highlightSelectedPoint=function(t,e){this.$rangeelem.removeClass("sel");for(var i=0;i<this.config_obj.values.length;i++)t<=this.dotoffset[i]&&e>=this.dotoffset[i]&&this.$rangeelem[i].classList.add("sel");this.$rangeval.css("left",t+"px").css("width",e-t+"px")},s.prototype.handleDisplayValue=function(){var t=this.$sliderrighthead[0].offsetLeft;this.showPointValues(t);var e=this.getTextForPoint(this.getNearestPointPosition(t));if(this.config_obj.range){var i=this.$sliderlefthead[0].offsetLeft;this.showPointValues(i),e=this.getTextForPoint(this.getNearestPointPosition(i))+" - "+e}this.$displayelem.text(e)},s.prototype.showPointValues=function(t){var e=this.dotoffset.indexOf(t);0<e&&e<this.dotoffset.length-1&&(this.contentdiv.find(".range-value")[e].innerText=this.config_obj.values[e])},s.prototype.getTextForPoint=function(t){var e=this.dotoffset.indexOf(t);return-1<e?this.config_obj.values[e]:""},s.prototype.getNearestPointPosition=function(t){for(var e=this.dotoffset.length,i=0;i<e-1;i++){var s=this.dotoffset[i],o=this.dotoffset[i+1];if(s<=t&&t<=o)return t-s<=(o-s)/2?s:o}},s.prototype.handleCallBack=function(){var t=this.$displayelem.text(),e=this.config_obj.range?"range-slider":"slider",i="range-slider"==e?t.split(" - "):t;this.config_obj.callback({type:e,msg:t,id:this.msgid,value:i,chatid:this.chatid})},{init:function(t,e){if(t.values&&1<t.values.length){var i=new s(t,e);return i.renderSlider(),void i.handleEvents()}t.callback("",e)}}}();var Multiselect=function(){var e=function(t,i){this.dataval=t.options,this.callback=t.callback,this.max_selection=t.max_selection||this.dataval.length,this.min_selection=t.min_selection||0,this.componentid=i,this.select_label=t.select_label,this.userconfig=t,this.chatid=t.chatid,this.contentdiv=ZSIQTranscript.getChatWindowOBJ(this.chatid).contentdiv};return e.prototype={sel_count:0,populateButtons:function(){var t=$Widget.getLayout();t=(t=(t=t.replace(/{BOT_WIDGET}/g,this.getButtonHtml())).replace(/{CLASSNAME}/g,"botrating")).replace(/{WIDGET_TYPE}/g,"input-card"),$Widget.attachHTML(t),this.bindEvent()},getButtonHtml:function(){for(var t='<div id = "mselect"><div class="cmpnt-optn-list" id="multiselect">',i=0;i<this.dataval.length;i++){var e=this.dataval[i];if(e&&"object"==typeof e)t+="<div "+(e.custatrr||"")+'" op_id="'+(e.id||"")+'" data-value = "'+e.text+'"><span class="cmpnt-mul-optn"></span>'+getEncodedText(e.text)+"</div>";else t+='<div data-value = "'+e+'"><span class="cmpnt-mul-optn"></span>'+getEncodedText(e)+"</div>"}return t+='</div><div class="compnt-btn" id = "cnfmsel">'+(this.select_label?this.select_label:LSResource.getRealValue("common.confirm"))+"</div></div>"},bindEvent:function(){var t=this;this.contentdiv.find("#multiselect [data-value]").off("click.multiple").on("click.multiple",function(){t.handleMultiselection(this)}),this.contentdiv.find("#cnfmsel").click(function(){t.handleConfirm(this)})},handleMultiselection:function(t){(t=$(t)).hasClass("sel")?(t.find("span").removeClass("sqico-tick"),t.removeClass("sel"),this.sel_count--,this.sel_count<this.min_selection&&this.contentdiv.find(".compnt-btn").removeClass("btn-enbl")):this.sel_count<this.max_selection&&(t.find("span").addClass("sqico-tick"),t.addClass("sel"),this.sel_count++,this.sel_count>=this.min_selection&&this.contentdiv.find(".compnt-btn").addClass("btn-enbl"))},handleConfirm:function(t){if($(t).hasClass("btn-enbl")){var i="",e=$(t).parent().find("[data-value]"),n=e.length,s=[],l=0;if(0!=this.sel_count){for(var a=0;a<n;a++)$($(e)[a]).hasClass("sel")&&(i&&(i+=", "),s[l]=this.dataval[a],l++,i+=$($(e)[a]).attr("data-value"));this.callback({type:"multiple-select",msg:i,id:this.componentid,value:s,element:$(t),config:this.userconfig,data_value:s,chatid:this.chatid})}}}},{init:function(t,i){t.options?new e(t,i).populateButtons():t.callback("",i)}}}();var Button=function(){var n=function(t){this.buttonurl=t.links,this.callback=t.callback,this.chatid=t.chatid,this.contentdiv=ZSIQTranscript.getChatWindowOBJ(this.chatid).contentdiv};return n.prototype={populateButtons:function(t){var i=$Widget.getLayout();i=(i=(i=(i=ZSIQTranscript.getFormatedHTML(i,!0)).replace(/{BOT_WIDGET}/g,this.getButtonHtml())).replace(/{CLASSNAME}/g,"botbtn")).replace(/{WIDGET_TYPE}/g,"display-card"),$Widget.attachHTML(i,!0),this.contentdiv.find("#bot_widget"+t).attr("isbutton",!0)},getButtonHtml:function(){for(var t='<div class="font14 posrel" id = "buttonurl">',i=0;i<this.buttonurl.length;i++){var n=this.buttonurl[i],a=n.url;if(a){var e=n.hideicon?"":"sqico-reply",r="";n.icon&&" "!=n.icon&&(e="",r='<span class="cmpnt-btnimg"><img src="'+n.icon+'"></span>');var c=n.target?n.target:"_blank";c="_self"===c?"_parent":c;var l=a.split("://")[0];t+='<a href = "'+("http"==l||"https"==l?a:"https://"+a)+'" target="'+c+'" data-value = "'+a+'"><div class="cmpnt-btnurl elips '+e+'">'+r+'<em class="dib-mid clr-azurblu elips">'+(getEncodedText(n.text)||a)+"</em></div></a>"}}return t+="</div>"}},{init:function(t,i){t.links?new n(t).populateButtons(i):t.callback("",i)}}}();Rating=(BotRating=function(t,e){this.type=t.type||"smiley",this.image=t.data||this.getRatingobj(t)||"",this.level=t.level||5,this.callback=t.callback||function(){},this.msgid=e,this.chatid=t.chatid,this.contentdiv=ZSIQTranscript.getChatWindowOBJ(this.chatid).contentdiv},BotRating.prototype.smileyobj={3:{text:["common.neutral","common.good","common.great"],classname:["cmpnt-rtng","cmpnt-rtng good","cmpnt-rtng great"]},5:{text:["smiley.angry","smiley.sad","common.neutral","common.good","common.great"],classname:["cmpnt-rtng angry","cmpnt-rtng sad","cmpnt-rtng","cmpnt-rtng good","cmpnt-rtng great"]}},BotRating.prototype.getRatingobj=function(t){return"smiley"===t.type?this.smileyobj[t.level]:"gesture"===t.type?{text:["common.like","common.dislike"]}:void 0},BotRating.prototype.renderRating=function(){var t=this.type;"smiley"!=t?"star"!=t?"gesture"==t&&this.renderGestureHtml():this.renderStarHtml():this.renderSmileyHtml()},BotRating.prototype.renderSmileyHtml=function(){for(var t=this.image,e=' <div class="textC cmpnt-rtng-cont" id="rating-wrap">',i=0;i<this.level;i++)e+='<div class="'+(t.classname[i]||this.smileyobj[this.level].classname[i])+'" id="rating'+(i+1)+'" data-type="smile-rating-'+t.text[i]+'" index='+(i+1)+'><div></div><span class="c666 dib-mid mT5" purpose="text">'+LSResource.getRealValue(t.text[i])+"</span></div> ";e+="</div>";var a=$Widget.getLayout();for(a=(a=(a=a.replace(/{BOT_WIDGET}/g,e)).replace(/{CLASSNAME}/g,"botrating")).replace(/{WIDGET_TYPE}/g,"input-card"),$Widget.attachHTML(a),i=0;i<t.length;i++)""!==t.imageurl[i]&&$("#rating"+(i+1)).find("div")[0].setAttribute("style","background:url('"+t.imageurl[i]+"')no-repeat 0px 0px/95%")},BotRating.prototype.renderStarHtml=function(){for(var t=5<this.level?"cmpnt-rtng-cont":"",e="",i=this.level;1<=i;i--)e+='<div class="sqico-star" star-count="'+i+'"></div>';var a='<div class="textC rating mT10 rtl" id="rating-wrap"><em class = "'+t+'">'+e+"</em></div>",n=$Widget.getLayout();n=(n=(n=n.replace(/{BOT_WIDGET}/g,a)).replace(/{CLASSNAME}/g,"botrating")).replace(/{WIDGET_TYPE}/g,"input-card"),$Widget.attachHTML(n)},BotRating.prototype.renderGestureHtml=function(){var t=this.image,e='<div class="textC cmpnt-rtng-cont" id="rating-wrap"><div class="cmpnt-rtng" id="like-rating" data-type="gesture-rating-like"><div class="sqico-like"></div><span class="c666" purpose="text">'+LSResource.getRealValue(t.text[0])+'</span></div> <div class="cmpnt-rtng" id="dislike-rating" data-type="gesture-rating-dislike"><div class="sqico-dislike"></div><span class="c666" purpose="text">'+LSResource.getRealValue(t.text[1])+"</span></div> </div>",i=$Widget.getLayout();i=(i=(i=i.replace(/{BOT_WIDGET}/g,e)).replace(/{CLASSNAME}/g,"botrating")).replace(/{WIDGET_TYPE}/g,"input-card"),$Widget.attachHTML(i)},BotRating.prototype.handleEvents=function(){var t=this.contentdiv.find("#cmpnt"+this.msgid),e=this;t.find("#rating-wrap").click(function(t){e.handleClicked(t)})},BotRating.prototype.handleClicked=function(t){"star"!=this.type?"smiley"==this.type?this.handleSmileyRating(t):this.handleGestureRating(t):t.target.hasAttribute("star-count")&&this.handleStarRating(t)},BotRating.prototype.handleSmileyRating=function(t){var e=t.target.parentElement;if(e.hasAttribute("data-type")){var i=$(e).find("[purpose=text]").text(),a=$(e).attr("index"),n=e.lastChild.remove();$(n).remove(),this.callback({type:"happiness-rating",value:a,msg:i,ratinghtml:e.outerHTML,id:this.msgid,chatid:this.chatid})}},BotRating.prototype.handleGestureRating=function(t){var e=t.target.parentElement;if(e.hasAttribute("data-type")){var i=$(e).find("[purpose=text]").text(),a=i==$("#like-rating").find("[purpose=text]").text(),n=e.lastChild.remove();$(n).remove(),this.callback({type:"like",value:a,msg:i,ratinghtml:e.outerHTML,id:this.msgid,chatid:this.chatid})}},BotRating.prototype.handleStarRating=function(t){var e=t.target,i=e.getAttribute("star-count");this.callback({type:"star-rating",value:i,msg:i,ratinghtml:e.outerHTML,id:this.msgid,star:!0,chatid:this.chatid})},{init:function(t,e){if(t.type&&""!=t.type){var i=new BotRating(t,e);i.renderRating(),i.handleEvents()}else t.callback("",e)},smiley_init:function(t,e){t.type="smiley",Rating.init(t,e)},star_init:function(t,e){t.type="star",Rating.init(t,e)},like_init:function(t,e){t.type="gesture",Rating.init(t,e)}});"use strict";var zDatepicker=function(){var M={months:["date.january","date.february","date.march","date.april","date.may","date.june","date.july","date.august","date.september","date.october","date.november","date.december"],abbrmonths:["date.jan","date.feb","date.mar","date.apr","date.may","date.jun","date.jul","date.aug","date.sep","date.oct","date.nov","date.dec"],pad:function(e,t){return e<10&&(e="0"+e),e},toString:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"yyyy-mm-dd",a=(e="string"==typeof e?new Date(e):e).getFullYear(),i=this.pad(e.getMonth()+1),n=this.pad(e.getDate()),s="";switch(t){case"yyyy-mm-dd":s=a+"-"+i+"-"+n;break;case"yyyy/mm/dd":s=a+"/"+i+"/"+n;break;case"dd-mm-yyyy":s=n+"-"+i+"-"+a;break;case"dd/mm/yyyy":s=n+"/"+i+"/"+a;break;case"mm-dd-yyyy":s=i+"-"+n+"-"+a;break;case"mm/dd/yyyy":s=i+"/"+n+"/"+a;break;case"readable":s=n+"-"+LSResource.getRealValue(this.abbrmonths[e.getMonth()])+"-"+a}return s},toMonthAndYearString:function(e){return LSResource.getRealValue(this.months[e.getMonth()])+" "+e.getFullYear()},isSameDay:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},isSameMonth:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()},compareDay:function(e,t,a){e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),1),t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),1);var i=!1;switch(a){case"le":i=e<=t;break;case"ge":i=t<=e;break;case"g":i=t<e;break;case"l":i=e<t}return i},moveMonth:function(e,t){return new Date(e.getFullYear(),e.getMonth()+t)},listDates:function(e){for(var t=[],a=new Date(e.getFullYear(),e.getMonth(),1).getDay(),i=0==a?-6:1-a,n=1;n<=42;n++)t.push(new Date(e.getFullYear(),e.getMonth(),i++));return t},toDate:function(e,t){var a,i=e.indexOf("/")?e.split("/"):e.split("-");return i=i.map(Number),"yyyy-mm-dd"==t||"yyyy/mm/dd"==t?a=new Date(i[0],i[1]-1,i[2]):"dd-mm-yyyy"==t||"dd/mm/yyyy"==t?a=new Date(i[2],i[1]-1,i[0]):"mm-dd-yyyy"!=t&&"mm/dd/yyyy"!=t||(a=new Date(i[2],i[0]-1,i[1])),a},toTimezone:function(e,t){var a=e.getTime()+6e4*e.getTimezoneOffset();return new Date(a+36e5*parseFloat(t.replace(":",".")))},convertToDate:function(e){var t=new Date;if(e.match(/^\+/g)){var a=t.getDate()+parseInt(e.match(/([0-9]+)/)[0]);return n=new Date(t.getFullYear(),t.getMonth(),a,1)}if(e.match(/^-/g)){a=t.getDate()-parseInt(e.match(/([0-9]+)/)[0]);return new Date(t.getFullYear(),t.getMonth(),a,1)}if(e.match(/^[0-9]+$/))return new Date(parseInt(e));if(e.match(/^\s*([0-9]{13,14})\s*-\s*([0-9]{13,14})\s*$/i)){var i=e.match(/([0-9]{13,14})/gi);return[new Date(parseInt(i[0])),new Date(parseInt(i[1]))]}if(e.match(/^\s*last\s*([0-9]+)\s*days\s*$/gi)){a=t.getDate()-parseInt(e.match(/([0-9]+)/)[0]);return[new Date(t.getFullYear(),t.getMonth(),a,1),t]}if(e.match(/^\s*next\s*([0-9]+)\s*days\s*$/gi)){a=t.getDate()+parseInt(e.match(/([0-9]+)/)[0]);var n=new Date(t.getFullYear(),t.getMonth(),a,1);return[t,n]}return e.match(/^\s*future\s*$/gi)?[t,void 0]:e.match(/^\s*past\s*$/gi)?[void 0,t]:void 0}},S={overlay:'<div class="zsiq-datepicker-overlay" id="datepicker_body"><div class="cmpnt-cal-wrap" ><div class="cmpnt-calndr"><em class="siqico-close" data-target="close"></em><em class="siqico-larrow siqmob_back" id="siqdateback"></em><header class="calndr-head"><span class="siqico-calendar zsiq-lH22 zsiq-flex_GS0">!{label}</span><span id="selectedDateInfo" class="zsiq-elips zsiq-mR10 zsiq-mL10 zsiq-lH22"></span><div class="calndr-sedulbtn zsiq-flex_GS0" data-target="schedule">!{schedule}</div></header><div id="zsiqdatepicker"></div></div></div></div>',main:'<div class="zdatepicker"><div class="calndr-mnthname"><em class = "calndr-nxtprev siqico-larrow" data-target="prev-month"></em>!{date_info}<em class = "calndr-nxtprev siqico-rarrow" data-target="next-month"></em></div><div class = "calndr-detlvw"><em class = "calndr-nxtprev siqico-larrow" data-target="prev-month"></em><div class = "cmpnt-calvw">!{body}</div><em class = "calndr-nxtprev siqico-rarrow" data-target="next-month"></em></div>!{showTime}</div>',daysSpan:"<div>!{shortDay}</div>",dropDown:'<div class="calndr-drpdwn"><div class = "calndr-drp"><span class="calndr-setval">!{currentValue}</span><em class="siqico-darrow"></em></div><div class = "calndr-drp-dwnvw"> !{value} </div></div>',weekWrapperStart:'<div class="cmpnt-days">',meridiemAM:'<div class="cal-timtype"><span data-target="meridiem" data="AM" class="active">!{AM}</span><span data-target="meridiem" data="PM">!{PM}</span></div>',meridiemPM:'<div class="cal-timtype"><span data-target="meridiem" data="AM">!{AM}</span><span data-target="meridiem" data="PM" class="active">!{PM}</span></div>',timeTemplate:'<div class="calndr-settime"><div class="zsiq-flex">!{timeBody}</div>!{timezoneBody}</div>',weekWrapperEnd:"</div>",currentDay:"<div><div data='!{data}' data-target='date' class='currentday'>!{day}</div></div>",normalDay:"<div><div data='!{data}' data-target='date' class='normalday'>!{day}</div></div>",disabledDay:"<div><div data='!{data}' data-target='disabledday' class='disabledday'>!{day}</div></div>",selectedDay:"<div><div data='!{data}' data-target='date' class='selectedday'>!{day}</div></div>",RangeselectedDay:"<div class='zrangeHolder!{extra}'><div data='!{data}' data-target='date' class='selectedrange'>!{day}</div></div>",monthsView:'<div class="zdatepicker"><div class = "zdatepicker_header"><span class="zdatepicker_info zdatepicker_offset" data-target="yr-info"> !{year} </span></div><div class="zdatepicker_body">!{body}</div></div>',normalMonth:"<span data-target='month' data='!{month}' class='zdatepicker_normalmonth'>!{month}</span>",yearsView:"<div class=\"zdatepicker\"><div class = 'zdatepicker_header'><span class = 'zdatepicker_prev_month' data-target='prev-year'>&lsaquo;</span><span class = 'zdatepicker_info'>!{year_info}</span><span class = 'zdatepicker_next_month' data-target='next-year'>&rsaquo;</span></div><div class = \"zdatepicker_body\">!{body}</div></div>",normalYear:"<span data-target='year' data='!{year}' class='zdatepicker_normalyear' data-target='yr-info'>!{year}</span>",timezone:'<div class="zsiq-lH22 zsiq-clr-azurblu zsiq-mT30" id="datepicker_timezone" style="position: relative;"><span class="zsiq-elips" style="cursor:pointer;display:block;text-align:center;" data-target="showtzlist">!{currentTimezone}</span></div>'},i=function(e,t){this.options={format:"yyyy/mm/dd",range:e.range,view:e.view||0,onselect:e.callback,selected:"",showTime:e.time,tz:e.tz,label:e.label,from:e.from&&M.convertToDate(e.from),to:e.to&&M.convertToDate(e.to),limit:e.limit&&M.convertToDate(e.limit),select_label:e.select_label},this.msgid=t,this.type=e.type,this.chatid=e.chatid,this.options.limit=this.options.limit||[this.options.from,this.options.to]};return i.prototype={init:function(){var d,e,l=new Date,c=M.toString(l,this.options.format),s=l.getFullYear(),t=l.getHours();this.hours=M.pad(g(12<t?t-12:t,1)),this.minutes=M.pad(g(l.getMinutes(),5)),this.meridiem=l.toLocaleTimeString("en-US").slice(-2);var a,m="",h="",i=TimeZone.getCurrentTimeZone(),n=i.name;this.timezone=i.gmt,this.tz_name=n,this.timezoneid=n.substring(n.lastIndexOf("(")+1,n.lastIndexOf(")"));var p=function(e){d.innerHTML="",d.insertAdjacentHTML("beforeend",e)},u=function(e,t,a,i,n){for(var s=S.dropDown.replace("!{currentValue}",M.pad(g(e,i))),r="",o=t;o<=a;o+=i)r+="<div data='"+M.pad(o)+"' data-target='"+n+"'>"+M.pad(o)+"</div>";return s.replace("!{value}",r)};function g(e,t){return e-e%t}var r,v=function(){return S.timezone.replace("!{currentTimezone}",this.tz_name)}.bind(this),o=function(){var e=S.main.replace("!{date_info}",M.toMonthAndYearString(l)),a="",i="",t=S.weekWrapperStart;if(M.listDates(l).forEach(function(e){var t="";0===e.getDay()&&(a+=S.weekWrapperStart),i=M.isSameMonth(l,e)?this.options.range&&e>=M.toDate(m,this.options.format)&&e<=M.toDate(h,this.options.format)?S.RangeselectedDay:c&&M.isSameDay(M.toDate(c,this.options.format),e)?S.selectedDay:this.options.limit&&(this.options.limit[0]&&!M.compareDay(e,this.options.limit[0],"ge")||this.options.limit[1]&&!M.compareDay(e,this.options.limit[1],"le"))?S.disabledDay:S.normalDay:S.disabledDay,a+=i.replace("!{day}",e.getDate()).replace("!{data}",M.toString(e,this.options.format)),6===e.getDay()&&(a+=S.weekWrapperEnd),this.options.range&&M.isSameDay(e,M.toDate(m,this.options.format))&&(t="Start"),this.options.range&&M.isSameDay(e,M.toDate(h,this.options.format))&&(t="End"),a=a.replace("!{extra}",t)}.bind(this)),["date.su","date.mo","date.tu","date.we","date.th","date.fr","date.sa"].forEach(function(e){t+=S.daysSpan.replace("!{shortDay}",LSResource.getRealValue(e))}),t+=S.weekWrapperEnd,e=e.replace("!{body}",t+a),this.options.showTime){var n=S.timeTemplate,s=u(this.hours,1,12,1,"hours"),r=u(this.minutes,0,55,5,"minutes"),o=("PM"==this.meridiem?S.meridiemPM:S.meridiemAM).replace("!{AM}",LSResource.getRealValue("time.AM")).replace("!{PM}",LSResource.getRealValue("time.PM"));n=n.replace("!{timeBody}",s+r+o),e=(e=e.replace("!{showTime}",n)).replace("!{timezoneBody}",this.options.tz?v():"")}else e=e.replace("!{showTime}","");(p(e),this.options.showTime)&&d.querySelectorAll(".calndr-drp").forEach(function(e){e.onclick=function(e){var t=d.querySelector(".show");t&&t!=this.nextSibling&&t.classList.remove("show"),this.nextElementSibling.classList.toggle("show"),e.stopImmediatePropagation()}});this.isDateWithinRange(c)||$('[data="'+c+'"]').addClass("disabledday")}.bind(this),y=function(){var e=S.monthsView.replace("!{year}",l.getFullYear()),t="";M.months.forEach(function(e){t+=S.normalMonth.replace("!{month}",LSResource.getRealValue(e)).replace("!{month}",LSResource.getRealValue(e))}),p(e.replace("!{body}",t))},f=function(){for(var e=s,t=S.yearsView.replace("!{year_info}",e-7+"-"+(e+7)),a="",i=[],n=e-7;n<=e+7;n++)i.push(n);i.forEach(function(e){a+=S.normalYear.replace("!{year}",e).replace("!{year}",e)}),p(t.replace("!{body}",a))},D={date:function(e){if(this.options.range)if(m)if(m&&!h){if(h=e,M.toDate(m,this.options.format)>M.toDate(h,this.options.format)){var t=m;m=h,h=t}this.options.selected=[m,h],this.updateHeader()}else m&&h&&(m=e,h="");else m=e;c=e,this.options.range||(this.options.selected=e,this.updateHeader()),o()}.bind(this),"prev-month":function(){l=M.moveMonth(l,-1),o()},"next-month":function(){l=M.moveMonth(l,1),o()},disabledday:function(e){var t=M.toDate(e,this.options.format);this.isDateWithinRange(t)&&(l=t,o(),D.date(e))}.bind(this),"mo-yr-info":y,month:function(e){var t=M.months.indexOf(e);l=new Date(l.setMonth(t)),o()},"yr-info":f,year:function(e){l=new Date(l.setFullYear(parseInt(e))),y()},"prev-year":function(){s-=15,f()},"next-year":function(){s+=15,f()},hours:function(e){this.hours=e,o()}.bind(this),minutes:function(e){this.minutes=e,o()}.bind(this),schedule:function(){this.options.range&&!h||!this.isDateWithinRange()||(this.options.onselect({type:this.type,msg:this.getReadableSelection(),id:this.msgid,value:this.getValues(),chatid:this.chatid}),e.parentNode.removeChild(e),removeEventListener("click",a))}.bind(this),close:function(){e.parentNode.removeChild(e),removeEventListener("click",a)},meridiem:function(e){this.meridiem=e,o()}.bind(this),showtzlist:function(){d.querySelector("#datepicker_timezone").insertAdjacentHTML("beforeend",TimeZone.getTimeZoneHTML(!1)),d.querySelector("#tz-list input").addEventListener("input",function(e){TimeZone.handleSearch(e,this,!1)}),z()},timezone:function(e,t,a){this.timezone=e,this.timezoneid=a,this.tz_name=t.innerHTML,d.querySelector("#tz-list").remove(),z(!0),o()}.bind(this)},w=this,b=function(e,t,a,i){var n=d.querySelector(".calndr-settime");if(!n)return!0;var s=n.querySelector("#tz-list"),r=n.querySelector(".show");if(t=t?t.value:"",s){if("timezone"===t)return D.timezone(a,e,i),w.updateHeader(),!1;if(e===s||"showtzlist"===t||s.contains(e))return!1;s.remove(),z(!0)}else r&&e!==r&&r.classList.remove("show");return!0},z=function(e){var t=window.parent.document.querySelector("#siqdateback");e?t.classList.remove("siqshowbckico"):t.classList.toggle("siqshowbckico")};r=S.overlay.replace("!{label}",getEncodedText(this.options.label)||LSResource.getRealValue("common.scheduleameeting")).replace("!{schedule}",getEncodedText(this.options.select_label)||LSResource.getRealValue("common.schedule")),window.parent.document.body.insertAdjacentHTML("beforeend",r),e=window.parent.document.querySelector("#datepicker_body"),d=window.parent.document.querySelector("#zsiqdatepicker"),o(),this.options.selected=c,this.updateHeader(),a=e.addEventListener("click",function(e){var t,a,i,n,s;e.stopPropagation(),a=(t=e).target.attributes,i=a&&a["data-target"],n=a.data&&a.data.value,s=a&&a["data-id"]&&a["data-id"].value,b(t.target,i,n,s)&&i&&(D[i.value](n),w.updateHeader())})},updateHeader:function(){var e=window.parent.document.querySelector("#selectedDateInfo");e&&(e.innerHTML=this.getReadableSelection())},getReadableSelection:function(){var e=this.options.tz?" "+this.timezone:"",t=this.options.showTime?" "+this.hours+":"+this.minutes+" "+this.meridiem:"";if("object"==typeof this.options.selected){var a=this.getRangeString();return a.from+" to "+a.to+t+e}var i=M.toDate(this.options.selected,this.options.format);return M.toString(i,"readable")+t+e},getRangeString:function(){var e=M.toDate(this.options.selected[0],this.options.format),t=M.toDate(this.options.selected[1],this.options.format);return{from:M.toString(e,"readable"),to:M.toString(t,"readable")}},getValues:function(){var e=this.options.tz?{tz:this.timezone,time_zone_id:this.timezoneid}:{},t=this.options.showTime?" "+this.hours+":"+this.minutes+" "+this.meridiem:"";if(this.options.range){var a=this.getRangeString();return e.from_time=new Date(a.from+t).getTime(),e.to_time=new Date(a.to+t).getTime(),e}var i=M.toString(M.toDate(this.options.selected,this.options.format),"readable")+t;return e.time=new Date(i).getTime(),e},handleTimeFormat:function(){var e=this.getReadableSelection();if(!this.options.showTime)return e;var t=(-1==e.indexOf("GMT")?e:e.substring(e.indexOf(" GMT"),0)).split(/\s(.+)/)[1],a=t.split(":"),i=a[0],n=a[1].split(" ");if(-1==t.indexOf("AM")&&12!=i)i=parseInt(a[0])+12;return e.replace(t,i+":"+n[0]+":00")},getTimestamp:function(){if(this.options.range){var e=new Date(this.options.selected[0]),t=new Date(this.options.selected[1]);return this.options.tz&&(e=M.toTimezone(e,this.timezone.replace("GMT","")),t=M.toTimezone(t,this.timezone.replace("GMT",""))),e.getTime()+"-"+t.getTime()}var a=this.options.selected+(this.options.showTime?" "+this.hours+":"+this.minutes+" "+this.meridiem:"");return a=new Date(a),this.options.tz&&(a=M.toTimezone(a,this.timezone.replace("GMT",""))),a.getTime()},isDateWithinRange:function(e){if(this.options.from||this.options.to){var t=this.options.from?new Date(this.options.from):"",a=this.options.to?new Date(this.options.to):"",i="",n="";if(e||(e=this.options.selected),this.options.range){if(!e||"string"==typeof e)return!0;if(!e[0])return!1;i=new Date(e[0]),n=new Date(e[1])}else n=i=new Date(e);if(t&&M.compareDay(i,t,"l"))return!1;if(a&&M.compareDay(n,a,"g"))return!1}return!0}},{init:function(e,t){var a=new i(e,t);return a.init(),a}}}();var Suggestions=function(){var s=function(t,i){this.dataval=t.list,this.callback=t.callback,this.id=i,this.componentid=i,this.type=t.type,this.userconfig=t,this.chatid=t.chatid,this.isdisplaycard=t.isdisplaycard,this.chatobj=ZSIQTranscript.getChatWindowOBJ(this.chatid),this.chatdiv=this.chatobj.chatdiv};return s.prototype={populateButtons:function(){var t=this.getButtonHtml(),i=this.chatdiv,s=i.children().last();i.find("#conversationoption").remove(),this.isdisplaycard?$Widget.attachHTML(t,!0):0===i.find(".zsiq_transferdiv").length?s.append(t):s.prev().append(t),ZSIQTranscript.scroll("",this.chatobj.chatmaindiv),this.bindEvent()},getButtonHtml:function(){var t="",i="conversationoption";if(i=this.isdisplaycard?i+this.id:i,"suggestions"!==this.type)return'<div class="zsiq_transferdiv fnt13" style="" id="skipquestion"><span class="bot_opt">Skip</span>';for(var s=0;s<this.dataval.length;s++){var a=this.dataval[s];if(a&&"object"==typeof a){var n=a.custatrr||"",e=a.id||"";t+='<span class="choose mB10" '+n+' val="'+a.text+'" prop="'+this.type+'" sug_id="'+e+'" data-value = "'+a.value+'">'+getEncodedText(a.text)+"</span>"}else{var o=getEncodedText(this.dataval[s]);t+='<span class="choose mB10" val="'+o+'" prop="'+this.type+'">'+o+"</span>"}}return'<div class="options textR mT30" id="'+i+'" data-type="'+this.type+'">'+t+"</div>"},bindEvent:function(){var i=this;$(this.chatdiv).off("click.suggest","span[prop=suggestions]").on("click.suggest","span[prop=suggestions]",function(t){i.chooseField(this)})},chooseField:function(t){t=$(t),this.callback({msg:t.attr("val"),id:this.componentid,element:t,config:this.userconfig,data_value:t.attr("data-value"),config:this.userconfig,data_id:t.attr("sug_id"),type:t.attr("prop"),chatid:this.chatid})}},{init:function(t,i){($BotImpl.enableComposer("",t.chatid),t.list)?new s(t,i).populateButtons():t.callback("",i)}}}();var Singleselect=function(){var a=function(t,e){this.dataval=t.options,this.callback=t.callback,this.select_label=t.select_label,this.componentid=e,this.userconfig=t,this.chatid=t.chatid,this.contentdiv=ZSIQTranscript.getChatWindowOBJ(this.chatid).contentdiv};return a.prototype={populateButtons:function(){var t=$Widget.getLayout();t=(t=(t=t.replace(/{BOT_WIDGET}/g,this.getButtonHtml())).replace(/{CLASSNAME}/g,"botsselect")).replace(/{WIDGET_TYPE}/g,"input-card"),$Widget.attachHTML(t),this.bindEvent()},getButtonHtml:function(){for(var t='<div class="cmpnt-optn-list" id="singleselect">',e=0;e<this.dataval.length;e++){var a=this.dataval[e];if(a&&"object"==typeof a)t+="<div "+(a.custatrr||"")+'" op_id="'+(a.id||"")+'" data-value = "'+a.value+'">'+getEncodedText(a.text)+"</div>";else t+='<div data-value = "'+this.dataval[e]+'">'+getEncodedText(this.dataval[e])+"</div>"}return t+="</div>"},bindEvent:function(){var t=this;this.contentdiv.find("#singleselect [data-value]").off("click.select").on("click.select",function(){t.handleSingleselection(this)})},handleSingleselection:function(t){(t=$(t)).parent().find("[data-value]").removeClass("sel"),t.addClass("sel"),this.callback({msg:t.text(),id:this.componentid,type:"select",element:t,config:this.userconfig,data_value:t.attr("data-value"),data_id:t.attr("op_id"),chatid:this.chatid})}},{init:function(t,e){t.options?new a(t,e).populateButtons():t.callback("",e)}}}();var BotArticle=function(){var a=function(t,i){this.data=t,this.data.id=i,this.chatid=t.chatid,this.chatobj=ZSIQTranscript.getChatWindowOBJ(this.chatid),this.contentdiv=this.chatobj.contentdiv,this.isresourcesharing="resource-share"==this.data.subtype};return a.prototype={renderArticle:function(){var t=this.isresourcesharing?"artcle-vw article-share":"artcle-vw",i=$Widget.getLayout();i=(i=(i=i.replace(/{BOT_WIDGET}/g,ZSIQTranscript.getCustomArticleCard(this.data))).replace(/{CLASSNAME}/g,"")).replace(/{WIDGET_TYPE}/g,"display-card"),i=this.isresourcesharing?i.replace(/{ARTCLID}/g,"article-id="+this.data.articleid):i.replace(/{ARTCLID}/g,""),$Widget.attachHTML(i),this.contentdiv.find("#cmpnt"+this.data.id).parents(".msgbx").addClass(t)},setEvents:function(){var i=this;this.data.articles&&this.data.articles.length&&this.contentdiv.off("click.article","#rel-articles-"+this.data.id).on("click.article","#rel-articles-"+this.data.id,function(t){i.handleClicked(t)})},handleClicked:function(t){var i=$(t.target),e=i.attr("article-id");if(this.isresourcesharing){var a=i.closest("div #cmpnt"+this.data.id);e=a.attr("article-id"),i=a}e&&$FAQ.showFAQPreview(i,function(){this.chatobj.showBanner(LSResource.getRealValue("faq.notavail"),!0)}.bind(this))}},{init:function(t,i){var e=new a(t,i);e.renderArticle(),e.setEvents()},handleClicked:function(t){var i=t.target,e=$(i).attr("article-id");e&&Educate.faqPreview(e,$(i),void 0,void 0,function(){this.contentdiv.find("#faqpreview_footer").remove()},!0)}}}();var BotTimeSlot=function(){var e=["date.january","date.february","date.march","date.april","date.may","date.june","date.july","date.august","date.september","date.october","date.november","date.december"],i=["date.sunday","date.monday","date.tuesday","date.wednesday","date.thursday","date.friday","date.saturday"],s=function(t,e){this.data=t,this.label=getEncodedText(t.label)||LSResource.getRealValue("widget.timeslot.shedulemeeting"),this.select_label=t.select_label,this.time=e||Date.now(),this.minutes=0,this.shedule={time:"",time_str:"",date:"",date_str:"",tz:"",gmt:""},this.chatid=t.chatid,this.contentdiv=ZSIQTranscript.getChatWindowOBJ(this.chatid).contentdiv,this.timezone_id=t.time_zone_id},o=function(t){return LSResource.getRealValue(e[t])},m=function(t){return LSResource.getRealValue(i[t])},a=function(t,e){if(Array.isArray(e))for(var i=0;i<e.length;i++){var s=e[i];if(s.date==t)return s.time}return e[t]};s.prototype={init:function(){var t=this.data.slots;if(t)if("timeslots"==this.data.type){var e=new Date;this.shedule.date=this.data.date||e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear(),this.shedule.date_str=this.data.date?this.getReadableDate(this.data.date):m(e.getDay())+", "+o(e.getMonth())+" "+e.getDate()+", "+e.getFullYear(),this.datelist=[this.shedule.date],this.data.slots={},this.data.slots[this.shedule.date]=t,this.limit=1}else this.datelist=function(t){var e=[];if(Array.isArray(t))for(var i=0;i<t.length;i++){var s=t[i];e.push(s.date)}else e=Object.keys(t).sort(function(t,e){var i=t.split("/").reverse().join(),s=e.split("/").reverse().join();return i<s?-1:s<i?1:0});return e}(t),this.limit=2<this.datelist.length?3:this.datelist.length,this.index=0;var i=TimeZone.getCurrentTimeZone(this.timezone_id),s=i.name;this.shedule.gmt=i.gmt,this.shedule.tz=i.gmt+" "+s,this.shedule.timezoneid=s.substring(s.lastIndexOf("(")+1,s.lastIndexOf(")")),this.setButtonUI()},setButtonUI:function(){var t='<div class="cmpnt-btnurl elips sqico-calendar" id="bot_timeslot"><em class="dib-mid clr-azurblu cmpnt-cusclr">'+this.label+"</em></div>",e=$Widget.getLayout();e=(e=(e=e.replace(/{BOT_WIDGET}/g,t)).replace(/{CLASSNAME}/g,"botbtn")).replace(/{WIDGET_TYPE}/g,"input-card"),$Widget.attachHTML(e),this.contentdiv.find("#bot_timeslot").on("click",function(t){this.contentdiv.find(".cmpnt-wrap").removeClass("botbtn"),this.contentdiv.find("#bot_timeslot").replaceWith(this.getTimeSlotHTML()),this.renderTimeSlot(this.data)}.bind(this))},getTimeSlotHTML:function(){return'<div class="cmpnt-wrap" id="timeslot-'+this.time+'"><div class="cmpnt-body-cont" id="title-zone"></div><div class="posrel textC" id="timeslot-select"></div>'+this.getNextPrevHTML()+"</div>"},getNextPrevHTML:function(){return'<a><div class="cmpnt-nxtprev" id="timeslot-move" slot="date"><div class="c333"><div class="dib-mid" move="prev"><em class="sqico-larrow"></em><em class="dib-mid clr-azurblu">'+LSResource.getRealValue("common.prev")+'</em></div></div><div class="c333 cmpnt-prev"><div  class="dib-mid"  move="next"><em class="sqico-larrow"></em><em class="dib-mid clr-azurblu">'+LSResource.getRealValue("common.next")+"</em></div></div></div></a>"},renderTimeSlot:function(t){this.elem=this.contentdiv.find("#timeslot-"+this.time);var e="timeslots"==this.data.type?"time":"date";this.setDateTimeSlots(e),this.elem.find("#timeslot-move").attr("slot",e),this.setTitleAndZone();var i=this;this.elem.find("#timeslot-move [move]").on("click",function(t){i.handleMoveClick(this,t)})},setTitleAndZone:function(){var t="timeslots"==this.data.type?"widget.timeslot.selecttime":"widget.timeslot.selectday",e='<div class="font15"><div class="font16 c555 mB10 lH22"><em class="sqico-larrow" move=""></em>'+this.label+'</div><div class="mB10 clr-azurblu lH22 curP elips" tz="" id="tz_drpdown"></div><div class="c888 lH22" slot-title >'+LSResource.getRealValue(t)+"</div></div>";this.elem.find("#title-zone").html(e);var i=this;this.elem.find("#title-zone .sqico-larrow").hide().on("click",function(t){i.handleBackArrow()}),this.elem.find("#tz_drpdown").on("click",function(t){"date"!=i.elem.find("#timeslot-move").attr("slot")&&"timeslots"!=i.data.type||i.elem.has("#tz-list").length||i.showTimeZoneList(t)}),this.setTimeZone(),ZSIQTranscript.scroll()},showTimeZoneList:function(t){if(this.data.tz){var e=TimeZone.getTimeZoneHTML(!0);this.elem.find("#timeslot-select").after(e);var i=this;this.elem.find("#tz-list").on("click",function(t){i.handleTimeZoneClick(t)}),this.elem.find("#tz-list input").on("input",function(t){TimeZone.handleSearch(t,this,!0)}),l(i,t)}},setDateTimeSlots:function(t){var e=this,i="";this.data.slots&&(i="date"==t?this.getDateSlots():this.getTimeSlots()),this.elem.find("#timeslot-select").html(i),this.elem.find("#timeslot-select ["+t+"]").on("click",function(t){e.handleDateTimeClick(this,t)}),ZSIQTranscript.scroll()},handleTimeZoneClick:function(t){var e=t.target;if(e.hasAttribute("data")){var i=$(e).html();this.elem.find("#tz-list").remove(),this.shedule.gmt=$(e).attr("data"),this.shedule.tz=i,this.shedule.timezoneid=i.substring(i.lastIndexOf("(")+1,i.lastIndexOf(")")),this.setTimeZone()}},setTimeZone:function(){var t=this.data.tz?this.shedule.tz:"timeslots"==this.data.type?this.shedule.date_str:"";this.elem.find("#tz_drpdown").html(t)},handleDateTimeClick:function(t,e){if("date"==this.elem.find("#timeslot-move").attr("slot")){var i=$(t).attr("date");if(i){this.shedule.date=i,this.shedule.date_str=$(t).text(),this.minutes=0,this.elem.find("#timeslot-move").attr("slot","time"),this.setDateTimeSlots("time");var s=this.elem.find("#title-zone");s.find(".sqico-larrow").show(),s.find("#tz_drpdown").html(this.shedule.date_str),s.find("[slot-title]").html(LSResource.getRealValue("widget.timeslot.selecttime"))}}else{var l=$(e.target).attr("time");l&&(this.shedule.time=l,this.shedule.time_str=$(e.target).text(),this.setSelectedResult(),this.elem.find("#timeslot-select").hide(),this.elem.find("#timeslot-move").hide().attr("slot","confirm"))}},setSelectedResult:function(){var l=this.shedule.date_str+" at "+this.shedule.time_str,t=this.select_label?this.select_label:LSResource.getRealValue("common.confirm"),e='<div class="font15"><div class="font16 c555 mB10 lH22"><em class="sqico-larrow" move="prev"></em>'+this.label+'</div><div class="mB10 lH22 c000">'+l+'</div><div class="lH22 c000">'+this.shedule.tz+'</div><div class="compnt-btn cal-scdule" id="confirm">'+t+"</div></div></div>";this.elem.find("#title-zone").html(e);var a=this;this.elem.find("#title-zone .sqico-larrow").on("click",function(t){a.handleBackArrow()}),l+=" "+this.shedule.tz,this.elem.find("#confirm").on("click",function(t){var e={id:a.time,msg:l,type:a.data.type,chatid:a.chatid},i=a.shedule.date.split("/"),s=(i=i[1]+"/"+i[0]+"/"+i[2])+" "+a.shedule.time;e.value={tz:a.shedule.gmt,slot:"timeslots"==a.data.type?a.shedule.time:a.shedule.date+" "+a.shedule.time,time:new Date(s).getTime().toString(),time_zone_id:a.shedule.timezoneid},a.data.callback(e)})},enableBackArrow:function(){this.elem.find("#title-zone .sqico-larrow").show()},handleBackArrow:function(){var t=this.elem.find("#timeslot-move").attr("slot");"time"==t?(this.elem.find("#title-zone .sqico-larrow").hide(),this.elem.find("#timeslot-move").attr("slot","date"),this.setDateTimeSlots("date"),this.elem.find("#title-zone [slot-title]").html(LSResource.getRealValue("widget.timeslot.selectday")),this.setTimeZone()):"confirm"==t&&(this.elem.find("#timeslot-move").show().attr("slot","time"),this.elem.find("#timeslot-select").show(),this.setTitleAndZone(),"timeslots"!=this.data.type&&(this.elem.find("#title-zone .sqico-larrow").show(),this.elem.find("#tz_drpdown").html(this.shedule.date_str)),this.setDateTimeSlots("time"))},handleMoveClick:function(t){var e=$(t).attr("move"),i=this.elem.find("#timeslot-move").attr("slot");if("date"==i){if("prev"==e){var s=this.index-this.limit;this.index=s<0?0:s}else if("next"==e){s=this.index+this.limit;this.index=s>=this.datelist.length?this.index:s}this.setDateTimeSlots("date")}else if("time"==i){if("prev"==e){s=this.minutes-6;this.minutes=s<0?0:s}else if("next"==e){s=this.minutes+6;this.minutes=s>=a(this.shedule.date,this.data.slots).length?this.minutes:s}this.setDateTimeSlots("time")}},getReadableDate:function(t){var e=-1!=t.indexOf("/")?t.split("/"):t.split("-"),i=e[1];i=isNaN(parseInt(i))?new Date(i+" 01 0001").getMonth():i-1;var s=new Date(e[2],i,e[0]);return e=t,o(s.getMonth())+" "+s.getDate()+", "+s.getFullYear()},getDateSlots:function(){var t,e="",i=this.elem.find("#timeslot-move");3<this.datelist.length?$(i).show():$(i).hide();for(var s=this.index;s-this.index<this.limit;s++){var l=this.datelist[s];if(!l)break;var a=-1!=l.indexOf("/")?l.split("/"):l.split("-"),n=a[1];n=isNaN(parseInt(n))?new Date(n+" 01 0001").getMonth():n-1,t=new Date(a[2],n,a[0]),a=l;var d=o(t.getMonth())+" "+t.getDate()+", "+t.getFullYear();e+=' <div class="cmpnt-btnurl cmpnt-cal-date" date="'+a+'" ><em class="c333">'+m(t.getDay())+'</em><em class="c777"> '+d+"</em></div>"}return e},getTimeSlots:function(){var t="",e=a(this.shedule.date,this.data.slots),i=this.elem.find("#timeslot-move");if(!e)return"";function s(t){if(!t)return"";var e=t.split(":"),i=e[0]%=24;i=(i=12==i?12:i%12)<10?"0"+i:i;var s=11<e[0]?LSResource.getRealValue("time.PM"):LSResource.getRealValue("time.AM");return 2<e[1].length&&(e[1]=e[1].substring(0,2)),"00"==i&&"00"==e[1]&&(i=12),'<em time="'+t+'">'+i+":"+e[1]+" "+s+"</em>"}6<e.length?$(i).show():$(i).hide();for(var l=this.minutes;l-this.minutes<6;l++)t+=e[l]?'<div class="cmpnt-btnurl cmpnt-cal-time" id="">'+s(e[l++])+s(e[l])+"</div>":"";return t}};var l=function(t,e){$Clickoutside&&$Clickoutside.bindclick(function(){t.elem.find("#tz-list").remove()},"tz-list","tz_drpdown",!0,e)};return{init:function(t,e){new s(t,e).init()}}}();var ZMaps=function(){var c,n,o,i,l,s,r,d,u,g,p,v=function(){try{return $Support.getZMapKeys()}catch(e){return{zmapapicss:_ZMAPCSSURL,zmapstaticurl:_ZMAPSTATICURL,zmapapiurl:_ZMAPAPIURL,zmapapikey:_ZMAPAPIKEY,mapboxgl:window.mapboxgl}}},f=function(){p=$Widget.isPreview()?window:window.parent},a=function(){var e=$Widget.getLocationWidgetHtml(c.label),t=$Widget.getLayout();t=(t=(t=t.replace(/{BOT_WIDGET}/g,e)).replace(/{CLASSNAME}/g,"bot-locatn")).replace(/{WIDGET_TYPE}/g,"input-card"),$Widget.attachHTML(t),(d=document.querySelector("#bot_location")).addEventListener("click",m)},m=function(){T(c.lat,c.lng)},y=function(e,t){var a=p.document;a.body.insertAdjacentHTML("beforeend",E("overlay")),o=a.querySelector("#glocation_body");var n=a.querySelector("#widget_holder"),i=a.createElement("div");i.style.height="700px",n.insertAdjacentElement("beforeend",i),_event=o.addEventListener("click",function(e){e.stopPropagation(),A(e)});var l=I(M,500);(r=a.querySelector("#searchplace")).addEventListener("input",function(e){var t=e.target.value.length;r.parentElement.querySelector("[data-target = 'suggclose']").style.display=t?"block":"none",1<t?l(e.target.value):z()}),r.addEventListener("keyup",function(e){S(e.keyCode)}),L(e,t,i)},L=function(e,t,a){var n={container:a,zoom:12,center:[t,e],style:v().zmapstaticurl+"vector/styles/bright.json"};(i=new g.Map(n)).addControl(new g.NavigationControl,"bottom-right"),h(e,t),c.radius?i.on("style.load",function(){x(e,t)}):(i.on("click",function(e){h(e.lngLat.lat,e.lngLat.lng)}),i.flyTo({center:[t,e],zoom:12}))},h=function(e,t){if(l)return l.setLngLat({lat:e,lng:t}),void q(e,t,function(e){s.setHTML('<div class="font15">'+e.display_name+"</div>")});var a=document.createElement("span");a.className="siqico-location",a.style["font-size"]="25px";var n={anchor:"center",draggable:!c||!c.radius,element:a,offset:[-0,-12]};l=new g.Marker(n).setLngLat({lat:e,lng:t}).addTo(i),q(e,t,function(e){s=new g.Popup({offset:1}).setHTML('<div class="font15">'+e.display_name+"</div>"),l.setPopup(s)})},b=function(e,t,a){return v().zmapstaticurl+"v2/staticimage?lat="+e+"&lon="+t+"&zoom=12&height=250&width=300&marker=true"},q=function(e,t,a){var n=JSON.stringify({lat:e,lon:t});$.ajax({url:v().zmapstaticurl+"v1/query/rgeocode",type:"GET",data:{params:n,api_key:v().zmapapikey},success:function(e){a(e)}})},M=function(t){if(r.value.length<2)z();else{var e=p.document.querySelector("#autocomplete");e.style.display="block",e.innerHTML='<em class="siq_loading"></em>';var a=l.getLngLat(),n={q:t,limit:4,autocomplete:"true",priorityLat:a.lat,priorityLon:a.lng};n=JSON.stringify(n),$.ajax({url:v().zmapstaticurl+"v1/pelias/query/geocode",type:"GET",data:{params:n,api_key:v().zmapapikey},success:function(e){r.value===t&&_(e)}})}},z=function(){var e=p.document.querySelector("#autocomplete");e.innerHTML="",e.style.display="none"},S=function(e){var t,a=p.document.querySelector("#map_sugg"),n={38:function(){t?(t.previousElementSibling?t.previousElementSibling.classList.add("sel"):a.children[a.children.length-1].classList.add("sel"),t.classList.remove("sel")):a.children[a.children.length-1].classList.add("sel")},40:function(){t?(t.nextElementSibling?t.nextElementSibling.classList.add("sel"):a.children[0].classList.add("sel"),t.classList.remove("sel")):a.children[0].classList.add("sel")},13:function(){if(t){var e={};e.target=t,P(e),z()}}};a&&(t=a.querySelector(".sel"),"function"==typeof n[e]&&n[e]())},_=function(e){var t=p.document.querySelector("#autocomplete");t.style.display="block";var a="";if(e.length){for(var n=0;n<e.length;n++){var i=e[n];a+=E("suggestion",i)}t.innerHTML='<div class="locat-sugges"><div class="zsiq-c888 zsiq-mL10">Suggestions</div><div id="map_sugg">'+a+"</div>"}else t.innerHTML='<div class="zsiq-noresult"><div class="zsiq-nrdesc">'+LSResource.getRealValue("widget.location.notfound")+"</div></div>"},E=function(e,t){return{overlay:function(){return'<div class="zsiq-datepicker-overlay" id="glocation_body"><div class="cmpnt-cal-wrap" ><div class="cmpnt-calndr cmpnt-locatn" id ="widget_holder"><em class="siqico-close" data-target="close"></em><header class="calndr-head siqico-location"><input type="text" id="searchplace" placeholder="'+LSResource.getRealValue("widget.location.placeholder")+'"><em class="siqico-close" data-target="suggclose" style="display:none;"></em><div class ="cmpnt-srchloct" id="autocomplete" style="display : none;"></div>'+(c.callback?'<div class="calndr-sedulbtn" data-target="sendLocation">'+(getEncodedText(c.select_label)||LSResource.getRealValue("widget.location.send"))+"</div>":"")+"</header></div></div></div>"},suggestion:function(e){var t=e.display_name.split(","),a=k(e);return'<div class="zsiq-dtfix locat-fld '+(a?"zsiq_outofrange":"")+'" lat='+e.lat+" lng="+e.lon+(a?"":' data-target="suggestion"')+'><div><span class="siqico-location zsiq-dcell zsiq-pR10"></span><div class="zsiq-dcell"><div>'+t[0]+'</div><div class="zsiq-c777">'+t[1]+"</div>"+(a?'<div class="zsiq_ofrcont">'+LSResource.getRealValue("bot.location.outofrange")+"</div>":"")+"</div></div></div>"}}[e](t)},k=function(e){return R(e.lat,e.lon)>c.radius},T=function(e,t){if(c=c||{},f(),d&&d.removeEventListener("click",m),u)g&&w(e,t);else{var a="<link href='"+v().zmapapicss+"' rel='stylesheet' />";p.document.head.insertAdjacentHTML("beforeend",a),(u=document.createElement("script")).src=v().zmapapiurl,p.document.head.appendChild(u),u.onload=function(){g=v().mapboxgl,w(e,t)}}},w=function(e,t){e&&t?y(e,t):navigator.geolocation.getCurrentPosition(function(e){y(e.coords.latitude,e.coords.longitude)},function(){y(37.686091,-121.893752)})},A=function(e){var t={close:function(){d&&d.addEventListener("click",m),o.remove(),l=null,removeEventListener("click",_event)},sendLocation:function(){var t;t=l.getLngLat(),q(t.lat,t.lng,function(e){e.error?c.callback({type:"location",value:{lat:t.lat,lng:t.lng,image:b(t.lat,t.lng)},msg:t.lat+","+t.lng,id:n}):c.callback({type:"location",value:{street:e.address.road||e.address.village||"",city:e.address.state_district||"",state:e.address.state||"",lat:e.lat,lng:e.lon,image:b(e.lat,e.lon)},msg:e.display_name,id:n})}),l=null,o.remove(),removeEventListener("click",_event)},suggestion:function(){P(e),z(),r.value="",r.parentElement.querySelector("[data-target = 'suggclose']").style.display="none"},suggclose:function(){z(),r.value="",e.target.style.display="none"}},a=e.target.getAttribute("data-target");"function"==typeof t[a]&&t[a](),e.target!=r&&l&&z()},P=function(e){var t=e.target.getAttribute("lng"),a=e.target.getAttribute("lat");if(c.radius&&R(a,t)>c.radius)return;h(a,t),i.flyTo({center:[t,a],zoom:12})},x=function(e,t){i.addSource("radius_source",{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[t,e]}}]}}),i.addLayer({type:"circle",id:"radius",source:"radius_source",layout:{visibility:"visible"},paint:{"circle-radius":{stops:[[0,0],[20,C(c.radius,e)]],base:2},"circle-color":"rgba(0, 102, 204, 0.2)","circle-opacity":1}}),i.flyTo({center:[t,e],zoom:12}),i.on("click","radius",function(e){h(e.lngLat.lat,e.lngLat.lng)})},R=function(e,t){var a=c.lat,n=c.lng,i=H(a),l=H(e),o=H(e-a),s=H(t-n),r=Math.sin(o/2)*Math.sin(o/2)+Math.cos(i)*Math.cos(l)*Math.sin(s/2)*Math.sin(s/2);return 6371e3*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)))},C=function(e,t){return e/.075/Math.cos(t*Math.PI/180)},H=function(e){return e*Math.PI/180},I=function(n,i,l){var o;return function(){var e=this,t=arguments,a=l&&!o;clearTimeout(o),o=setTimeout(function(){o=null,l||n.apply(e,t)},i),a&&n.apply(e,t)}};return{init:function(e,t){c=e,n=t,f(),a()},getStaticImage:function(e,t){return b(e,t)},loadMap:function(e,t){T(e,t)},reverseGeoCoding:function(e,t,a){q(e,t,a)},openMapsFromImage:function(e){var t,a,n;a=(t=e).target.getAttribute("lat"),n=t.target.getAttribute("lng"),c={},T(a,n)}}}();var TimeZone=function(){function T(f,T){var e,a='<div class="cmpnt-time-list">!{list}</div>',r="";return[{name:"GMT-12:00 (Etc/GMT+12)",gmt:"GMT-12:00",offset:720},{name:"GMT-11:00 (Etc/GMT+11)",gmt:"GMT-11:00",offset:660},{name:"West Samoa Time (MIT)",gmt:"GMT-11:00",offset:660},{name:"West Samoa Time (Pacific/Apia)",gmt:"GMT+13:00",offset:660},{name:"Samoa Standard Time (Pacific/Midway)",gmt:"GMT-11:00",offset:660},{name:"Niue Time (Pacific/Niue)",gmt:"GMT-11:00",offset:660},{name:"Samoa Standard Time (Pacific/Pago_Pago)",gmt:"GMT-11:00",offset:660},{name:"Samoa Standard Time (Pacific/Samoa)",gmt:"GMT-11:00",offset:660},{name:"Samoa Standard Time (US/Samoa)",gmt:"GMT-11:00",offset:660},{name:"Hawaii-Aleutian Daylight Time (America/Adak)",gmt:"GMT-09:00",offset:600},{name:"Hawaii-Aleutian Daylight Time (America/Atka)",gmt:"GMT-09:00",offset:600},{name:"GMT-10:00 (Etc/GMT+10)",gmt:"GMT-10:00",offset:600},{name:"Hawaii Standard Time (HST)",gmt:"GMT-10:00",offset:600},{name:"Tokelau Time (Pacific/Fakaofo)",gmt:"GMT+13:00",offset:600},{name:"Hawaii Standard Time (Pacific/Honolulu)",gmt:"GMT-10:00",offset:600},{name:"Hawaii Standard Time (Pacific/Johnston)",gmt:"GMT-10:00",offset:600},{name:"Cook Is. Time (Pacific/Rarotonga)",gmt:"GMT-10:00",offset:600},{name:"Tahiti Time (Pacific/Tahiti)",gmt:"GMT-10:00",offset:600},{name:"Hawaii Standard Time (SystemV/HST10)",gmt:"GMT-10:00",offset:600},{name:"Hawaii-Aleutian Daylight Time (US/Aleutian)",gmt:"GMT-09:00",offset:600},{name:"Hawaii Standard Time (US/Hawaii)",gmt:"GMT-10:00",offset:600},{name:"Marquesas Time (Pacific/Marquesas)",gmt:"GMT-09:30",offset:570},{name:"Alaska Daylight Time (AST)",gmt:"GMT-08:00",offset:540},{name:"Alaska Daylight Time (America/Anchorage)",gmt:"GMT-08:00",offset:540},{name:"Alaska Daylight Time (America/Juneau)",gmt:"GMT-08:00",offset:540},{name:"Alaska Daylight Time (America/Nome)",gmt:"GMT-08:00",offset:540},{name:"Alaska Daylight Time (America/Yakutat)",gmt:"GMT-08:00",offset:540},{name:"GMT-09:00 (Etc/GMT+9)",gmt:"GMT-09:00",offset:540},{name:"Gambier Time (Pacific/Gambier)",gmt:"GMT-09:00",offset:540},{name:"Alaska Standard Time (SystemV/YST9)",gmt:"GMT-08:00",offset:540},{name:"Alaska Daylight Time (SystemV/YST9YDT)",gmt:"GMT-08:00",offset:540},{name:"Alaska Daylight Time (US/Alaska)",gmt:"GMT-08:00",offset:540},{name:"Pacific Daylight Time (America/Dawson)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (America/Ensenada)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (America/Los_Angeles)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (America/Tijuana)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (America/Vancouver)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (America/Whitehorse)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (Canada/Pacific)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (Canada/Yukon)",gmt:"GMT-07:00",offset:480},{name:"GMT-08:00 (Etc/GMT+8)",gmt:"GMT-08:00",offset:480},{name:"Pacific Daylight Time (Mexico/BajaNorte)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (PST)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (PST8PDT)",gmt:"GMT-07:00",offset:480},{name:"Pitcairn Standard Time (Pacific/Pitcairn)",gmt:"GMT-08:00",offset:480},{name:"Pacific Standard Time (SystemV/PST8)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (SystemV/PST8PDT)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (US/Pacific)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (US/Pacific-New)",gmt:"GMT-07:00",offset:480},{name:"Mountain Daylight Time (America/Boise)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (America/Cambridge_Bay)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (America/Chihuahua)",gmt:"GMT-06:00",offset:420},{name:"Mountain Standard Time (America/Dawson_Creek)",gmt:"GMT-07:00",offset:420},{name:"Mountain Daylight Time (America/Denver)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (America/Edmonton)",gmt:"GMT-06:00",offset:420},{name:"Mountain Standard Time (America/Hermosillo)",gmt:"GMT-07:00",offset:420},{name:"Mountain Daylight Time (America/Inuvik)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (America/Mazatlan)",gmt:"GMT-06:00",offset:420},{name:"Mountain Standard Time (America/Phoenix)",gmt:"GMT-07:00",offset:420},{name:"Mountain Daylight Time (America/Shiprock)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (America/Yellowknife)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (Canada/Mountain)",gmt:"GMT-06:00",offset:420},{name:"GMT-07:00 (Etc/GMT+7)",gmt:"GMT-07:00",offset:420},{name:"Mountain Standard Time (MST)",gmt:"GMT-07:00",offset:420},{name:"Mountain Daylight Time (MST7MDT)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (Mexico/BajaSur)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (Navajo)",gmt:"GMT-06:00",offset:420},{name:"Mountain Standard Time (PNT)",gmt:"GMT-07:00",offset:420},{name:"Mountain Standard Time (SystemV/MST7)",gmt:"GMT-07:00",offset:420},{name:"Mountain Daylight Time (SystemV/MST7MDT)",gmt:"GMT-06:00",offset:420},{name:"Mountain Standard Time (US/Arizona)",gmt:"GMT-07:00",offset:420},{name:"Mountain Daylight Time (US/Mountain)",gmt:"GMT-06:00",offset:420},{name:"Central Standard Time (America/Belize)",gmt:"GMT-06:00",offset:360},{name:"Central Daylight Time (America/Cancun)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Chicago)",gmt:"GMT-05:00",offset:360},{name:"Central Standard Time (America/Costa_Rica)",gmt:"GMT-06:00",offset:360},{name:"Central Standard Time (America/El_Salvador)",gmt:"GMT-06:00",offset:360},{name:"Central Standard Time (America/Guatemala)",gmt:"GMT-06:00",offset:360},{name:"Central Daylight Time (America/Indiana/Knox)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Indiana/Petersburg)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Indiana/Vincennes)",gmt:"GMT-05:00",offset:360},{name:"Eastern Daylight Time (America/Knox_IN)",gmt:"GMT-04:00",offset:360},{name:"Central Standard Time (America/Managua)",gmt:"GMT-06:00",offset:360},{name:"Central Daylight Time (America/Menominee)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Merida)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Mexico_City)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Monterrey)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/North_Dakota/Center)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/North_Dakota/New_Salem)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Rainy_River)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Rankin_Inlet)",gmt:"GMT-05:00",offset:360},{name:"Central Standard Time (America/Regina)",gmt:"GMT-06:00",offset:360},{name:"Central Standard Time (America/Swift_Current)",gmt:"GMT-06:00",offset:360},{name:"Central Standard Time (America/Tegucigalpa)",gmt:"GMT-06:00",offset:360},{name:"Central Daylight Time (America/Winnipeg)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (CST)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (CST6CDT)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (Canada/Central)",gmt:"GMT-05:00",offset:360},{name:"Central Standard Time (Canada/East-Saskatchewan)",gmt:"GMT-06:00",offset:360},{name:"Central Standard Time (Canada/Saskatchewan)",gmt:"GMT-06:00",offset:360},{name:"Easter Is. Time (Chile/EasterIsland)",gmt:"GMT-06:00",offset:360},{name:"GMT-06:00 (Etc/GMT+6)",gmt:"GMT-06:00",offset:360},{name:"Central Daylight Time (Mexico/General)",gmt:"GMT-05:00",offset:360},{name:"Easter Is. Time (Pacific/Easter)",gmt:"GMT-06:00",offset:360},{name:"Galapagos Time (Pacific/Galapagos)",gmt:"GMT-06:00",offset:360},{name:"Central Standard Time (SystemV/CST6)",gmt:"GMT-06:00",offset:360},{name:"Central Daylight Time (SystemV/CST6CDT)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (US/Central)",gmt:"GMT-05:00",offset:360},{name:"Eastern Daylight Time (US/Indiana-Starke)",gmt:"GMT-04:00",offset:360},{name:"Eastern Standard Time (America/Atikokan)",gmt:"GMT-05:00",offset:300},{name:"Colombia Time (America/Bogota)",gmt:"GMT-05:00",offset:300},{name:"Eastern Standard Time (America/Cayman)",gmt:"GMT-05:00",offset:300},{name:"Eastern Standard Time (America/Coral_Harbour)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Detroit)",gmt:"GMT-04:00",offset:300},{name:"Acre Time (America/Eirunepe)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Fort_Wayne)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Grand_Turk)",gmt:"GMT-04:00",offset:300},{name:"Ecuador Time (America/Guayaquil)",gmt:"GMT-05:00",offset:300},{name:"Central Daylight Time (America/Havana)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Indiana/Indianapolis)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Indiana/Marengo)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Indiana/Vevay)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Indianapolis)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Iqaluit)",gmt:"GMT-04:00",offset:300},{name:"Eastern Standard Time (America/Jamaica)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Kentucky/Louisville)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Kentucky/Monticello)",gmt:"GMT-04:00",offset:300},{name:"Peru Time (America/Lima)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Louisville)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Montreal)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Nassau)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/New_York)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Nipigon)",gmt:"GMT-04:00",offset:300},{name:"Eastern Standard Time (America/Panama)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Pangnirtung)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Port-au-Prince)",gmt:"GMT-04:00",offset:300},{name:"Acre Time (America/Porto_Acre)",gmt:"GMT-05:00",offset:300},{name:"Acre Time (America/Rio_Branco)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Thunder_Bay)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Toronto)",gmt:"GMT-04:00",offset:300},{name:"Acre Time (Brazil/Acre)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (Canada/Eastern)",gmt:"GMT-04:00",offset:300},{name:"Central Daylight Time (Cuba)",gmt:"GMT-05:00",offset:300},{name:"Eastern Standard Time (EST)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (EST5EDT)",gmt:"GMT-04:00",offset:300},{name:"GMT-05:00 (Etc/GMT+5)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (IET)",gmt:"GMT-04:00",offset:300},{name:"Eastern Standard Time (Jamaica)",gmt:"GMT-05:00",offset:300},{name:"Eastern Standard Time (SystemV/EST5)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (SystemV/EST5EDT)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (US/East-Indiana)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (US/Eastern)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (US/Michigan)",gmt:"GMT-04:00",offset:300},{name:"Atlantic Standard Time (America/Anguilla)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Antigua)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Aruba)",gmt:"GMT-04:00",offset:240},{name:"Paraguay Time (America/Asuncion)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Barbados)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Blanc-Sablon)",gmt:"GMT-04:00",offset:240},{name:"Amazon Time (America/Boa_Vista)",gmt:"GMT-04:00",offset:240},{name:"Amazon Time (America/Campo_Grande)",gmt:"GMT-04:00",offset:240},{name:"Venezuela Time (America/Caracas)",gmt:"GMT-04:00",offset:240},{name:"Amazon Time (America/Cuiaba)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Curacao)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Dominica)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Daylight Time (America/Glace_Bay)",gmt:"GMT-03:00",offset:240},{name:"Atlantic Daylight Time (America/Goose_Bay)",gmt:"GMT-03:00",offset:240},{name:"Atlantic Standard Time (America/Grenada)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Guadeloupe)",gmt:"GMT-04:00",offset:240},{name:"Guyana Time (America/Guyana)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Daylight Time (America/Halifax)",gmt:"GMT-03:00",offset:240},{name:"Bolivia Time (America/La_Paz)",gmt:"GMT-04:00",offset:240},{name:"Amazon Time (America/Manaus)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Martinique)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Daylight Time (America/Moncton)",gmt:"GMT-03:00",offset:240},{name:"Atlantic Standard Time (America/Montserrat)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Port_of_Spain)",gmt:"GMT-04:00",offset:240},{name:"Amazon Time (America/Porto_Velho)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Puerto_Rico)",gmt:"GMT-04:00",offset:240},{name:"Chile Time (America/Santiago)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Santo_Domingo)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/St_Kitts)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/St_Lucia)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/St_Thomas)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/St_Vincent)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Daylight Time (America/Thule)",gmt:"GMT-03:00",offset:240},{name:"Atlantic Standard Time (America/Tortola)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Virgin)",gmt:"GMT-04:00",offset:240},{name:"Chile Time (Antarctica/Palmer)",gmt:"GMT-03:00",offset:240},{name:"Atlantic Daylight Time (Atlantic/Bermuda)",gmt:"GMT-03:00",offset:240},{name:"Falkland Is. Summer Time (Atlantic/Stanley)",gmt:"GMT-03:00",offset:240},{name:"Amazon Time (Brazil/West)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Daylight Time (Canada/Atlantic)",gmt:"GMT-03:00",offset:240},{name:"Chile Time (Chile/Continental)",gmt:"GMT-04:00",offset:240},{name:"GMT-04:00 (Etc/GMT+4)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (PRT)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (SystemV/AST4)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Daylight Time (SystemV/AST4ADT)",gmt:"GMT-03:00",offset:240},{name:"Newfoundland Daylight Time (America/St_Johns)",gmt:"GMT-02:30",offset:210},{name:"Newfoundland Daylight Time (CNT)",gmt:"GMT-02:30",offset:210},{name:"Newfoundland Daylight Time (Canada/Newfoundland)",gmt:"GMT-02:30",offset:210},{name:"Argentine Time (AGT)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Araguaina)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Buenos_Aires)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Catamarca)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/ComodRivadavia)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Cordoba)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Jujuy)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/La_Rioja)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Mendoza)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Rio_Gallegos)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/San_Juan)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Tucuman)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Ushuaia)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Bahia)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Belem)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Buenos_Aires)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Catamarca)",gmt:"GMT-03:00",offset:180},{name:"French Guiana Time (America/Cayenne)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Cordoba)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Fortaleza)",gmt:"GMT-03:00",offset:180},{name:"Western Greenland Summer Time (America/Godthab)",gmt:"GMT-02:00",offset:180},{name:"Argentine Time (America/Jujuy)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Maceio)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Mendoza)",gmt:"GMT-03:00",offset:180},{name:"Pierre &amp; Miquelon Daylight Time (America/Miquelon)",gmt:"GMT-02:00",offset:180},{name:"Uruguay Time (America/Montevideo)",gmt:"GMT-03:00",offset:180},{name:"Suriname Time (America/Paramaribo)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Recife)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Rosario)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Sao_Paulo)",gmt:"GMT-03:00",offset:180},{name:"Rothera Time (Antarctica/Rothera)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (BET)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (Brazil/East)",gmt:"GMT-03:00",offset:180},{name:"GMT-03:00 (Etc/GMT+3)",gmt:"GMT-03:00",offset:180},{name:"Fernando de Noronha Time (America/Noronha)",gmt:"GMT-02:00",offset:120},{name:"South Georgia Standard Time (Atlantic/South_Georgia)",gmt:"GMT-02:00",offset:120},{name:"Fernando de Noronha Time (Brazil/DeNoronha)",gmt:"GMT-02:00",offset:120},{name:"GMT-02:00 (Etc/GMT+2)",gmt:"GMT-02:00",offset:120},{name:"Eastern Greenland Summer Time (America/Scoresbysund)",gmt:"GMT+00:00",offset:60},{name:"Azores Summer Time (Atlantic/Azores)",gmt:"GMT+00:00",offset:60},{name:"Cape Verde Time (Atlantic/Cape_Verde)",gmt:"GMT-01:00",offset:60},{name:"GMT-01:00 (Etc/GMT+1)",gmt:"GMT-01:00",offset:60},{name:"Greenwich Mean Time (Africa/Abidjan)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Accra)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Bamako)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Banjul)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Bissau)",gmt:"GMT+00:00",offset:0},{name:"Western European Time (Africa/Casablanca)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Conakry)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Dakar)",gmt:"GMT+00:00",offset:0},{name:"Western European Time (Africa/El_Aaiun)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Freetown)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Lome)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Monrovia)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Nouakchott)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Ouagadougou)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Sao_Tome)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Timbuktu)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (America/Danmarkshavn)",gmt:"GMT+00:00",offset:0},{name:"Western European Summer Time (Atlantic/Canary)",gmt:"GMT+01:00",offset:0},{name:"Western European Summer Time (Atlantic/Faeroe)",gmt:"GMT+01:00",offset:0},{name:"Western European Summer Time (Atlantic/Madeira)",gmt:"GMT+01:00",offset:0},{name:"Greenwich Mean Time (Atlantic/Reykjavik)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Atlantic/St_Helena)",gmt:"GMT+00:00",offset:0},{name:"Irish Summer Time (Eire)",gmt:"GMT+01:00",offset:0},{name:"GMT+00",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Etc/Greenwich)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (Etc/UCT)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (Etc/UTC)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (Etc/Universal)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (Etc/Zulu)",gmt:"GMT+00:00",offset:0},{name:"British Summer Time (Europe/Belfast)",gmt:"GMT+01:00",offset:0},{name:"Irish Summer Time (Europe/Dublin)",gmt:"GMT+01:00",offset:0},{name:"British Summer Time (Europe/Guernsey)",gmt:"GMT+01:00",offset:0},{name:"British Summer Time (Europe/Isle_of_Man)",gmt:"GMT+01:00",offset:0},{name:"British Summer Time (Europe/Jersey)",gmt:"GMT+01:00",offset:0},{name:"Western European Summer Time (Europe/Lisbon)",gmt:"GMT+01:00",offset:0},{name:"British Summer Time (Europe/London)",gmt:"GMT+01:00",offset:0},{name:"British Summer Time (GB)",gmt:"GMT+01:00",offset:0},{name:"British Summer Time (GB-Eire)",gmt:"GMT+01:00",offset:0},{name:"Greenwich Mean Time (GMT)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Greenwich)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Iceland)",gmt:"GMT+00:00",offset:0},{name:"Western European Summer Time (Portugal)",gmt:"GMT+01:00",offset:0},{name:"Coordinated Universal Time (UCT)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (UTC)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (Universal)",gmt:"GMT+00:00",offset:0},{name:"Western European Summer Time (WET)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (Zulu)",gmt:"GMT+00:00",offset:0},{name:"Central European Time (Africa/Algiers)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Bangui)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Brazzaville)",gmt:"GMT+01:00",offset:-60},{name:"Central European Summer Time (Africa/Ceuta)",gmt:"GMT+02:00",offset:-60},{name:"Western African Time (Africa/Douala)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Kinshasa)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Lagos)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Libreville)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Luanda)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Malabo)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Ndjamena)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Niamey)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Porto-Novo)",gmt:"GMT+01:00",offset:-60},{name:"Central European Summer Time (Africa/Tunis)",gmt:"GMT+02:00",offset:-60},{name:"Western African Summer Time (Africa/Windhoek)",gmt:"GMT+01:00",offset:-60},{name:"Central European Summer Time (Arctic/Longyearbyen)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Atlantic/Jan_Mayen)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (CET)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (ECT)",gmt:"GMT+02:00",offset:-60},{name:"GMT+01",gmt:"GMT+01:00",offset:-60},{name:"Central European Summer Time (Europe/Amsterdam)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Andorra)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Belgrade)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Berlin)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Bratislava)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Brussels)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Budapest)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Copenhagen)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Gibraltar)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Ljubljana)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Luxembourg)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Madrid)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Malta)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Monaco)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Oslo)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Paris)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Podgorica)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Prague)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Rome)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/San_Marino)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Sarajevo)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Skopje)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Stockholm)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Tirane)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Vaduz)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Vatican)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Vienna)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Warsaw)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Zagreb)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Zurich)",gmt:"GMT+02:00",offset:-60},{name:"Middle Europe Summer Time (MET)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Poland)",gmt:"GMT+02:00",offset:-60},{name:"Eastern European Summer Time (ART)",gmt:"GMT+03:00",offset:-120},{name:"Central African Time (Africa/Blantyre)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Bujumbura)",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Summer Time (Africa/Cairo)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Gaborone)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Harare)",gmt:"GMT+02:00",offset:-120},{name:"South Africa Standard Time (Africa/Johannesburg)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Kigali)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Lubumbashi)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Lusaka)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Maputo)",gmt:"GMT+02:00",offset:-120},{name:"South Africa Standard Time (Africa/Maseru)",gmt:"GMT+02:00",offset:-120},{name:"South Africa Standard Time (Africa/Mbabane)",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Time (Africa/Tripoli)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Asia/Amman)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Asia/Beirut)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Asia/Damascus)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Asia/Gaza)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Asia/Istanbul)",gmt:"GMT+03:00",offset:-120},{name:"Israel Standard Time (Asia/Jerusalem)",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Summer Time (Asia/Nicosia)",gmt:"GMT+03:00",offset:-120},{name:"Israel Standard Time (Asia/Tel_Aviv)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (CAT)",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Summer Time (EET)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Egypt)",gmt:"GMT+03:00",offset:-120},{name:"GMT+02",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Summer Time (Europe/Athens)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Bucharest)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Chisinau)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Helsinki)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Istanbul)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Kaliningrad)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Kiev)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Mariehamn)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Minsk)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Nicosia)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Riga)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Simferopol)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Sofia)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Tallinn)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Tiraspol)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Uzhgorod)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Vilnius)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Zaporozhye)",gmt:"GMT+03:00",offset:-120},{name:"Israel Standard Time (Israel)",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Time (Libya)",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Summer Time (Turkey)",gmt:"GMT+03:00",offset:-120},{name:"Eastern African Time (Africa/Addis_Ababa)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Asmera)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Dar_es_Salaam)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Djibouti)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Kampala)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Khartoum)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Mogadishu)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Nairobi)",gmt:"GMT+03:00",offset:-180},{name:"Syowa Time (Antarctica/Syowa)",gmt:"GMT+03:00",offset:-180},{name:"Arabia Standard Time (Asia/Aden)",gmt:"GMT+03:00",offset:-180},{name:"Arabia Daylight Time (Asia/Baghdad)",gmt:"GMT+03:00",offset:-180},{name:"Arabia Standard Time (Asia/Bahrain)",gmt:"GMT+03:00",offset:-180},{name:"Arabia Standard Time (Asia/Kuwait)",gmt:"GMT+03:00",offset:-180},{name:"Arabia Standard Time (Asia/Qatar)",gmt:"GMT+03:00",offset:-180},{name:"Arabia Standard Time (Asia/Riyadh)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (EAT)",gmt:"GMT+03:00",offset:-180},{name:"GMT+03",gmt:"GMT+03:00",offset:-180},{name:"Moscow Daylight Time (Europe/Moscow)",gmt:"GMT+03:00",offset:-180},{name:"Volgograd Summer Time (Europe/Volgograd)",gmt:"GMT+04:00",offset:-180},{name:"Eastern African Time (Indian/Antananarivo)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Indian/Comoro)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Indian/Mayotte)",gmt:"GMT+03:00",offset:-180},{name:"Moscow Daylight Time (W-SU)",gmt:"GMT+03:00",offset:-180},{name:"( GMT 3:7 ) GMT+03",gmt:"GMT+03:07",offset:-187},{name:"( GMT 3:30 ) Iran Standard Time (Asia/Tehran)",gmt:"GMT+03:30",offset:-210},{name:"( GMT 3:30 ) Iran Standard Time (Iran)",gmt:"GMT+03:30",offset:-210},{name:"Azerbaijan Summer Time (Asia/Baku)",gmt:"GMT+04:00",offset:-240},{name:"Gulf Standard Time (Asia/Dubai)",gmt:"GMT+04:00",offset:-240},{name:"Gulf Standard Time (Asia/Muscat)",gmt:"GMT+04:00",offset:-240},{name:"Georgia Time (Asia/Tbilisi)",gmt:"GMT+04:00",offset:-240},{name:"Armenia Summer Time (Asia/Yerevan)",gmt:"GMT+04:00",offset:-240},{name:"GMT+04",gmt:"GMT+04:00",offset:-240},{name:"Samara Summer Time (Europe/Samara)",gmt:"GMT+04:00",offset:-240},{name:"Seychelles Time (Indian/Mahe)",gmt:"GMT+04:00",offset:-240},{name:"Mauritius Time (Indian/Mauritius)",gmt:"GMT+04:00",offset:-240},{name:"Reunion Time (Indian/Reunion)",gmt:"GMT+04:00",offset:-240},{name:"Armenia Summer Time (NET)",gmt:"GMT+04:00",offset:-240},{name:"( GMT 4:30 ) Afghanistan Time (Asia/Kabul)",gmt:"GMT+04:30",offset:-270},{name:"Aqtau Time (Asia/Aqtau)",gmt:"GMT+05:00",offset:-300},{name:"Aqtobe Time (Asia/Aqtobe)",gmt:"GMT+05:00",offset:-300},{name:"Turkmenistan Time (Asia/Ashgabat)",gmt:"GMT+05:00",offset:-300},{name:"Turkmenistan Time (Asia/Ashkhabad)",gmt:"GMT+05:00",offset:-300},{name:"Tajikistan Time (Asia/Dushanbe)",gmt:"GMT+05:00",offset:-300},{name:"Pakistan Time (Asia/Karachi)",gmt:"GMT+05:00",offset:-300},{name:"Oral Time (Asia/Oral)",gmt:"GMT+05:00",offset:-300},{name:"Uzbekistan Time (Asia/Samarkand)",gmt:"GMT+05:00",offset:-300},{name:"Uzbekistan Time (Asia/Tashkent)",gmt:"GMT+05:00",offset:-300},{name:"Yekaterinburg Summer Time (Asia/Yekaterinburg)",gmt:"GMT+05:00",offset:-300},{name:"GMT+05",gmt:"GMT+05:00",offset:-300},{name:"French Southern &amp; Antarctic Lands Time (Indian/Kerguelen)",gmt:"GMT+05:00",offset:-300},{name:"Maldives Time (Indian/Maldives)",gmt:"GMT+05:00",offset:-300},{name:"Pakistan Time (PLT)",gmt:"GMT+05:00",offset:-300},{name:"India Standard Time (Asia/Calcutta)",gmt:"GMT+05:30",offset:-330},{name:"Sri Lanka Time (Asia/Colombo)",gmt:"GMT+05:30",offset:-330},{name:"India Standard Time (IST)",gmt:"GMT+05:30",offset:-330},{name:"Nepal Time (Asia/Katmandu)",gmt:"GMT+05:45",offset:-345},{name:"Mawson Time (Antarctica/Mawson)",gmt:"GMT+05:00",offset:-360},{name:"Vostok Time (Antarctica/Vostok)",gmt:"GMT+06:00",offset:-360},{name:"Alma-Ata Time (Asia/Almaty)",gmt:"GMT+06:00",offset:-360},{name:"Kirgizstan Time (Asia/Bishkek)",gmt:"GMT+06:00",offset:-360},{name:"Bangladesh Time (Asia/Dacca)",gmt:"GMT+06:00",offset:-360},{name:"Bangladesh Time (Asia/Dhaka)",gmt:"GMT+06:00",offset:-360},{name:"Novosibirsk Summer Time (Asia/Novosibirsk)",gmt:"GMT+07:00",offset:-360},{name:"Omsk Summer Time (Asia/Omsk)",gmt:"GMT+06:00",offset:-360},{name:"Qyzylorda Time (Asia/Qyzylorda)",gmt:"GMT+05:00",offset:-360},{name:"Bhutan Time (Asia/Thimbu)",gmt:"GMT+06:00",offset:-360},{name:"Bhutan Time (Asia/Thimphu)",gmt:"GMT+06:00",offset:-360},{name:"Bangladesh Time (BST)",gmt:"GMT+06:00",offset:-360},{name:"GMT+06",gmt:"GMT+06:00",offset:-360},{name:"Indian Ocean Territory Time (Indian/Chagos)",gmt:"GMT+06:00",offset:-360},{name:"Myanmar Time (Asia/Rangoon)",gmt:"GMT+06:30",offset:-390},{name:"Cocos Islands Time (Indian/Cocos)",gmt:"GMT+06:30",offset:-390},{name:"Davis Time (Antarctica/Davis)",gmt:"GMT+07:00",offset:-420},{name:"Indochina Time (Asia/Bangkok)",gmt:"GMT+07:00",offset:-420},{name:"Hovd Summer Time (Asia/Hovd)",gmt:"GMT+07:00",offset:-420},{name:"West Indonesia Time (Asia/Jakarta)",gmt:"GMT+07:00",offset:-420},{name:"Krasnoyarsk Summer Time (Asia/Krasnoyarsk)",gmt:"GMT+07:00",offset:-420},{name:"Indochina Time (Asia/Phnom_Penh)",gmt:"GMT+07:00",offset:-420},{name:"West Indonesia Time (Asia/Pontianak)",gmt:"GMT+07:00",offset:-420},{name:"Indochina Time (Asia/Saigon)",gmt:"GMT+07:00",offset:-420},{name:"Indochina Time (Asia/Vientiane)",gmt:"GMT+07:00",offset:-420},{name:"GMT+07",gmt:"GMT+07:00",offset:-420},{name:"Christmas Island Time (Indian/Christmas)",gmt:"GMT+07:00",offset:-420},{name:"Indochina Time (VST)",gmt:"GMT+07:00",offset:-420},{name:"Western Standard Time  (Australia) (Antarctica/Casey)",gmt:"GMT+08:00",offset:-480},{name:"Brunei Time (Asia/Brunei)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Chongqing)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Harbin)",gmt:"GMT+08:00",offset:-480},{name:"Hong Kong Time (Asia/Hong_Kong)",gmt:"GMT+08:00",offset:-480},{name:"Irkutsk Summer Time (Asia/Irkutsk)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Kashgar)",gmt:"GMT+08:00",offset:-480},{name:"Malaysia Time (Asia/Kuala_Lumpur)",gmt:"GMT+08:00",offset:-480},{name:"Malaysia Time (Asia/Kuching)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Macao)",gmt:"GMT+08:00",offset:-480},{name:"Central Indonesia Time (Asia/Makassar)",gmt:"GMT+08:00",offset:-480},{name:"Philippines Time (Asia/Manila)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Shanghai)",gmt:"GMT+08:00",offset:-480},{name:"Singapore Time (Asia/Singapore)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Taipei)",gmt:"GMT+08:00",offset:-480},{name:"Central Indonesia Time (Asia/Ujung_Pandang)",gmt:"GMT+08:00",offset:-480},{name:"Ulaanbaatar Summer Time (Asia/Ulaanbaatar)",gmt:"GMT+08:00",offset:-480},{name:"Ulaanbaatar Summer Time (Asia/Ulan_Bator)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Urumqi)",gmt:"GMT+08:00",offset:-480},{name:"Western Standard Time  (Australia) (Australia/Perth)",gmt:"GMT+08:00",offset:-480},{name:"Western Standard Time  (Australia) (Australia/West)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (CTT)",gmt:"GMT+08:00",offset:-480},{name:"GMT+08",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (PRC)",gmt:"GMT+08:00",offset:-480},{name:"Singapore Time (Singapore)",gmt:"GMT+08:00",offset:-480},{name:"Choibalsan Summer Time (Asia/Choibalsan)",gmt:"GMT+08:00",offset:-540},{name:"East Timor Time (Asia/Dili)",gmt:"GMT+09:00",offset:-540},{name:"East Indonesia Time (Asia/Jayapura)",gmt:"GMT+09:00",offset:-540},{name:"Korea Standard Time (Asia/Pyongyang)",gmt:"GMT+09:00",offset:-540},{name:"Korea Standard Time (Asia/Seoul)",gmt:"GMT+09:00",offset:-540},{name:"Japan Standard Time (Asia/Tokyo)",gmt:"GMT+09:00",offset:-540},{name:"Yaktsk Summer Time (Asia/Yakutsk)",gmt:"GMT+09:00",offset:-540},{name:"GMT+09",gmt:"GMT+09:00",offset:-540},{name:"Japan Standard Time (JST)",gmt:"GMT+09:00",offset:-540},{name:"Japan Standard Time (Japan)",gmt:"GMT+09:00",offset:-540},{name:"Palau Time (Pacific/Palau)",gmt:"GMT+09:00",offset:-540},{name:"Korea Standard Time (ROK)",gmt:"GMT+09:00",offset:-540},{name:"( GMT 9:30 ) Central Standard Time  (Northern Territory) (ACT)",gmt:"GMT+09:30",offset:-570},{name:"( GMT 9:30 ) Central Standard Time  (South Australia) (Australia/Adelaide)",gmt:"GMT+09:30",offset:-570},{name:"( GMT 9:30 ) Central Standard Time  (South Australia/New South Wales) (Australia/Broken_Hill)",gmt:"GMT+09:30",offset:-570},{name:"( GMT 9:30 ) Central Standard Time  (Northern Territory) (Australia/Darwin)",gmt:"GMT+09:30",offset:-570},{name:"( GMT 9:30 ) Central Standard Time  (Northern Territory) (Australia/North)",gmt:"GMT+09:30",offset:-570},{name:"( GMT 9:30 ) Central Standard Time  (South Australia) (Australia/South)",gmt:"GMT+09:30",offset:-570},{name:"( GMT 9:30 ) Central Standard Time  (South Australia/New South Wales) (Australia/Yancowinna)",gmt:"GMT+09:30",offset:-570},{name:"Eastern Standard Time  (New South Wales) (AET)",gmt:"GMT+10:00",offset:-600},{name:"Dumont-d Urville Time (Antarctica/DumontDUrville)",gmt:"GMT+10:00",offset:-600},{name:"Sakhalin Summer Time (Asia/Sakhalin)",gmt:"GMT+11:00",offset:-600},{name:"Vladivostok Summer Time (Asia/Vladivostok)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (New South Wales) (Australia/ACT)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Queensland) (Australia/Brisbane)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (New South Wales) (Australia/Canberra)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (New South Wales) (Australia/Currie)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Tasmania) (Australia/Hobart)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Queensland) (Australia/Lindeman)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Victoria) (Australia/Melbourne)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (New South Wales) (Australia/NSW)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Queensland) (Australia/Queensland)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (New South Wales) (Australia/Sydney)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Tasmania) (Australia/Tasmania)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Victoria) (Australia/Victoria)",gmt:"GMT+10:00",offset:-600},{name:"GMT+10",gmt:"GMT+10:00",offset:-600},{name:"Chamorro Standard Time (Pacific/Guam)",gmt:"GMT+10:00",offset:-600},{name:"Papua New Guinea Time (Pacific/Port_Moresby)",gmt:"GMT+10:00",offset:-600},{name:"Chamorro Standard Time (Pacific/Saipan)",gmt:"GMT+10:00",offset:-600},{name:"Truk Time (Pacific/Truk)",gmt:"GMT+10:00",offset:-600},{name:"Yap Time (Pacific/Yap)",gmt:"GMT+10:00",offset:-600},{name:"Load Howe Standard Time (Australia/LHI)",gmt:"GMT+10:30",offset:-630},{name:"Load Howe Standard Time (Australia/Lord_Howe)",gmt:"GMT+10:30",offset:-630},{name:"Magadan Summer Time (Asia/Magadan)",gmt:"GMT+11:00",offset:-660},{name:"GMT+11",gmt:"GMT+11:00",offset:-660},{name:"Vanuatu Time (Pacific/Efate)",gmt:"GMT+11:00",offset:-660},{name:"Solomon Is. Time (Pacific/Guadalcanal)",gmt:"GMT+11:00",offset:-660},{name:"Kosrae Time (Pacific/Kosrae)",gmt:"GMT+11:00",offset:-660},{name:"New Caledonia Time (Pacific/Noumea)",gmt:"GMT+11:00",offset:-660},{name:"Ponape Time (Pacific/Ponape)",gmt:"GMT+11:00",offset:-660},{name:"Solomon Is. Time (SST)",gmt:"GMT+11:00",offset:-660},{name:"Norfolk Time (Pacific/Norfolk)",gmt:"GMT+11:00",offset:-690},{name:"New Zealand Standard Time (Antarctica/McMurdo)",gmt:"GMT+12:00",offset:-720},{name:"New Zealand Standard Time (Antarctica/South_Pole)",gmt:"GMT+12:00",offset:-720},{name:"Anadyr Summer Time (Asia/Anadyr)",gmt:"GMT+12:00",offset:-720},{name:"Petropavlovsk-Kamchatski Summer Time (Asia/Kamchatka)",gmt:"GMT+12:00",offset:-720},{name:"GMT+12",gmt:"GMT+12:00",offset:-720},{name:"Marshall Islands Time (Kwajalein)",gmt:"GMT+12:00",offset:-720},{name:"New Zealand Standard Time (NST)",gmt:"GMT+12:00",offset:-720},{name:"New Zealand Standard Time (NZ)",gmt:"GMT+12:00",offset:-720},{name:"New Zealand Daylight Time (NZDT)",gmt:"GMT+13:00",offset:-780},{name:"New Zealand Standard Time (Pacific/Auckland)",gmt:"GMT+12:00",offset:-720},{name:"Fiji Time (Pacific/Fiji)",gmt:"GMT+12:00",offset:-720},{name:"Tuvalu Time (Pacific/Funafuti)",gmt:"GMT+12:00",offset:-720},{name:"Marshall Islands Time (Pacific/Kwajalein)",gmt:"GMT+12:00",offset:-720},{name:"Marshall Islands Time (Pacific/Majuro)",gmt:"GMT+12:00",offset:-720},{name:"Nauru Time (Pacific/Nauru)",gmt:"GMT+12:00",offset:-720},{name:"Gilbert Is. Time (Pacific/Tarawa)",gmt:"GMT+12:00",offset:-720},{name:"Wake Time (Pacific/Wake)",gmt:"GMT+12:00",offset:-720},{name:"Wallis &amp; Futuna Time (Pacific/Wallis)",gmt:"GMT+12:00",offset:-720},{name:"Chatham Standard Time (NZ-CHAT)",gmt:"GMT+12:45",offset:-765},{name:"Chatham Standard Time (Pacific/Chatham)",gmt:"GMT+12:45",offset:-765},{name:"GMT+13",gmt:"GMT+13:00",offset:-780},{name:"Phoenix Is. Time (Pacific/Enderbury)",gmt:"GMT+13:00",offset:-780},{name:"Tonga Time (Pacific/Tongatapu)",gmt:"GMT+13:00",offset:-780},{name:"GMT+14",gmt:"GMT+14:00",offset:-840},{name:"Line Is. Time (Pacific/Kiritimati)",gmt:"GMT+14:00",offset:-840}].forEach(function(e){var a=e.name,m=a.substring(a.lastIndexOf("(")+1,a.lastIndexOf(")")),t=f.toLowerCase(),n=a.toLowerCase(),i=e.gmt.toLowerCase();(!f||n.includes(t)||i.includes(t))&&(r+='<div data-target="timezone" data="'+e.gmt+'" data-id="'+m+'">'+(T?e.gmt:"")+" "+e.name+"</div>")}),a=r?a.replace("!{list}",r):(e=f,'<div class="zsiq-emptytime"><div><div class="zsiq-nosrch">'+LSResource.getRealValue("widget.timezone.searchnotfound",e)+"</div></div></div>")}return{getTimeZoneHTML:function(e){return a=e,'<div class="zsiq-time-zone" id="tz-list"><div class="zsiq-time-srch" ><em class="sqico-search" ></em><input placeholder="'+LSResource.getRealValue("widget.timezone.search")+'"></div>'+T("",a)+"</div>";var a},handleSearch:function(e,a,m){var t,n,i,f;n=m,i=(t=a).value,(f=t.parentElement).nextElementSibling&&f.nextElementSibling.remove(),f.insertAdjacentHTML("afterend",T(i,n))},getTimeZone:function(){return[{name:"GMT-12:00 (Etc/GMT+12)",gmt:"GMT-12:00",offset:720},{name:"GMT-11:00 (Etc/GMT+11)",gmt:"GMT-11:00",offset:660},{name:"West Samoa Time (MIT)",gmt:"GMT-11:00",offset:660},{name:"West Samoa Time (Pacific/Apia)",gmt:"GMT+13:00",offset:660},{name:"Samoa Standard Time (Pacific/Midway)",gmt:"GMT-11:00",offset:660},{name:"Niue Time (Pacific/Niue)",gmt:"GMT-11:00",offset:660},{name:"Samoa Standard Time (Pacific/Pago_Pago)",gmt:"GMT-11:00",offset:660},{name:"Samoa Standard Time (Pacific/Samoa)",gmt:"GMT-11:00",offset:660},{name:"Samoa Standard Time (US/Samoa)",gmt:"GMT-11:00",offset:660},{name:"Hawaii-Aleutian Daylight Time (America/Adak)",gmt:"GMT-09:00",offset:600},{name:"Hawaii-Aleutian Daylight Time (America/Atka)",gmt:"GMT-09:00",offset:600},{name:"GMT-10:00 (Etc/GMT+10)",gmt:"GMT-10:00",offset:600},{name:"Hawaii Standard Time (HST)",gmt:"GMT-10:00",offset:600},{name:"Tokelau Time (Pacific/Fakaofo)",gmt:"GMT+13:00",offset:600},{name:"Hawaii Standard Time (Pacific/Honolulu)",gmt:"GMT-10:00",offset:600},{name:"Hawaii Standard Time (Pacific/Johnston)",gmt:"GMT-10:00",offset:600},{name:"Cook Is. Time (Pacific/Rarotonga)",gmt:"GMT-10:00",offset:600},{name:"Tahiti Time (Pacific/Tahiti)",gmt:"GMT-10:00",offset:600},{name:"Hawaii Standard Time (SystemV/HST10)",gmt:"GMT-10:00",offset:600},{name:"Hawaii-Aleutian Daylight Time (US/Aleutian)",gmt:"GMT-09:00",offset:600},{name:"Hawaii Standard Time (US/Hawaii)",gmt:"GMT-10:00",offset:600},{name:"Marquesas Time (Pacific/Marquesas)",gmt:"GMT-09:30",offset:570},{name:"Alaska Daylight Time (AST)",gmt:"GMT-08:00",offset:540},{name:"Alaska Daylight Time (America/Anchorage)",gmt:"GMT-08:00",offset:540},{name:"Alaska Daylight Time (America/Juneau)",gmt:"GMT-08:00",offset:540},{name:"Alaska Daylight Time (America/Nome)",gmt:"GMT-08:00",offset:540},{name:"Alaska Daylight Time (America/Yakutat)",gmt:"GMT-08:00",offset:540},{name:"GMT-09:00 (Etc/GMT+9)",gmt:"GMT-09:00",offset:540},{name:"Gambier Time (Pacific/Gambier)",gmt:"GMT-09:00",offset:540},{name:"Alaska Standard Time (SystemV/YST9)",gmt:"GMT-08:00",offset:540},{name:"Alaska Daylight Time (SystemV/YST9YDT)",gmt:"GMT-08:00",offset:540},{name:"Alaska Daylight Time (US/Alaska)",gmt:"GMT-08:00",offset:540},{name:"Pacific Daylight Time (America/Dawson)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (America/Ensenada)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (America/Los_Angeles)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (America/Tijuana)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (America/Vancouver)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (America/Whitehorse)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (Canada/Pacific)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (Canada/Yukon)",gmt:"GMT-07:00",offset:480},{name:"GMT-08:00 (Etc/GMT+8)",gmt:"GMT-08:00",offset:480},{name:"Pacific Daylight Time (Mexico/BajaNorte)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (PST)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (PST8PDT)",gmt:"GMT-07:00",offset:480},{name:"Pitcairn Standard Time (Pacific/Pitcairn)",gmt:"GMT-08:00",offset:480},{name:"Pacific Standard Time (SystemV/PST8)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (SystemV/PST8PDT)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (US/Pacific)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (US/Pacific-New)",gmt:"GMT-07:00",offset:480},{name:"Mountain Daylight Time (America/Boise)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (America/Cambridge_Bay)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (America/Chihuahua)",gmt:"GMT-06:00",offset:420},{name:"Mountain Standard Time (America/Dawson_Creek)",gmt:"GMT-07:00",offset:420},{name:"Mountain Daylight Time (America/Denver)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (America/Edmonton)",gmt:"GMT-06:00",offset:420},{name:"Mountain Standard Time (America/Hermosillo)",gmt:"GMT-07:00",offset:420},{name:"Mountain Daylight Time (America/Inuvik)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (America/Mazatlan)",gmt:"GMT-06:00",offset:420},{name:"Mountain Standard Time (America/Phoenix)",gmt:"GMT-07:00",offset:420},{name:"Mountain Daylight Time (America/Shiprock)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (America/Yellowknife)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (Canada/Mountain)",gmt:"GMT-06:00",offset:420},{name:"GMT-07:00 (Etc/GMT+7)",gmt:"GMT-07:00",offset:420},{name:"Mountain Standard Time (MST)",gmt:"GMT-07:00",offset:420},{name:"Mountain Daylight Time (MST7MDT)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (Mexico/BajaSur)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (Navajo)",gmt:"GMT-06:00",offset:420},{name:"Mountain Standard Time (PNT)",gmt:"GMT-07:00",offset:420},{name:"Mountain Standard Time (SystemV/MST7)",gmt:"GMT-07:00",offset:420},{name:"Mountain Daylight Time (SystemV/MST7MDT)",gmt:"GMT-06:00",offset:420},{name:"Mountain Standard Time (US/Arizona)",gmt:"GMT-07:00",offset:420},{name:"Mountain Daylight Time (US/Mountain)",gmt:"GMT-06:00",offset:420},{name:"Central Standard Time (America/Belize)",gmt:"GMT-06:00",offset:360},{name:"Central Daylight Time (America/Cancun)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Chicago)",gmt:"GMT-05:00",offset:360},{name:"Central Standard Time (America/Costa_Rica)",gmt:"GMT-06:00",offset:360},{name:"Central Standard Time (America/El_Salvador)",gmt:"GMT-06:00",offset:360},{name:"Central Standard Time (America/Guatemala)",gmt:"GMT-06:00",offset:360},{name:"Central Daylight Time (America/Indiana/Knox)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Indiana/Petersburg)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Indiana/Vincennes)",gmt:"GMT-05:00",offset:360},{name:"Eastern Daylight Time (America/Knox_IN)",gmt:"GMT-04:00",offset:360},{name:"Central Standard Time (America/Managua)",gmt:"GMT-06:00",offset:360},{name:"Central Daylight Time (America/Menominee)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Merida)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Mexico_City)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Monterrey)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/North_Dakota/Center)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/North_Dakota/New_Salem)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Rainy_River)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Rankin_Inlet)",gmt:"GMT-05:00",offset:360},{name:"Central Standard Time (America/Regina)",gmt:"GMT-06:00",offset:360},{name:"Central Standard Time (America/Swift_Current)",gmt:"GMT-06:00",offset:360},{name:"Central Standard Time (America/Tegucigalpa)",gmt:"GMT-06:00",offset:360},{name:"Central Daylight Time (America/Winnipeg)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (CST)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (CST6CDT)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (Canada/Central)",gmt:"GMT-05:00",offset:360},{name:"Central Standard Time (Canada/East-Saskatchewan)",gmt:"GMT-06:00",offset:360},{name:"Central Standard Time (Canada/Saskatchewan)",gmt:"GMT-06:00",offset:360},{name:"Easter Is. Time (Chile/EasterIsland)",gmt:"GMT-06:00",offset:360},{name:"GMT-06:00 (Etc/GMT+6)",gmt:"GMT-06:00",offset:360},{name:"Central Daylight Time (Mexico/General)",gmt:"GMT-05:00",offset:360},{name:"Easter Is. Time (Pacific/Easter)",gmt:"GMT-06:00",offset:360},{name:"Galapagos Time (Pacific/Galapagos)",gmt:"GMT-06:00",offset:360},{name:"Central Standard Time (SystemV/CST6)",gmt:"GMT-06:00",offset:360},{name:"Central Daylight Time (SystemV/CST6CDT)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (US/Central)",gmt:"GMT-05:00",offset:360},{name:"Eastern Daylight Time (US/Indiana-Starke)",gmt:"GMT-04:00",offset:360},{name:"Eastern Standard Time (America/Atikokan)",gmt:"GMT-05:00",offset:300},{name:"Colombia Time (America/Bogota)",gmt:"GMT-05:00",offset:300},{name:"Eastern Standard Time (America/Cayman)",gmt:"GMT-05:00",offset:300},{name:"Eastern Standard Time (America/Coral_Harbour)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Detroit)",gmt:"GMT-04:00",offset:300},{name:"Acre Time (America/Eirunepe)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Fort_Wayne)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Grand_Turk)",gmt:"GMT-04:00",offset:300},{name:"Ecuador Time (America/Guayaquil)",gmt:"GMT-05:00",offset:300},{name:"Central Daylight Time (America/Havana)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Indiana/Indianapolis)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Indiana/Marengo)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Indiana/Vevay)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Indianapolis)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Iqaluit)",gmt:"GMT-04:00",offset:300},{name:"Eastern Standard Time (America/Jamaica)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Kentucky/Louisville)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Kentucky/Monticello)",gmt:"GMT-04:00",offset:300},{name:"Peru Time (America/Lima)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Louisville)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Montreal)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Nassau)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/New_York)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Nipigon)",gmt:"GMT-04:00",offset:300},{name:"Eastern Standard Time (America/Panama)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Pangnirtung)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Port-au-Prince)",gmt:"GMT-04:00",offset:300},{name:"Acre Time (America/Porto_Acre)",gmt:"GMT-05:00",offset:300},{name:"Acre Time (America/Rio_Branco)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Thunder_Bay)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Toronto)",gmt:"GMT-04:00",offset:300},{name:"Acre Time (Brazil/Acre)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (Canada/Eastern)",gmt:"GMT-04:00",offset:300},{name:"Central Daylight Time (Cuba)",gmt:"GMT-05:00",offset:300},{name:"Eastern Standard Time (EST)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (EST5EDT)",gmt:"GMT-04:00",offset:300},{name:"GMT-05:00 (Etc/GMT+5)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (IET)",gmt:"GMT-04:00",offset:300},{name:"Eastern Standard Time (Jamaica)",gmt:"GMT-05:00",offset:300},{name:"Eastern Standard Time (SystemV/EST5)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (SystemV/EST5EDT)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (US/East-Indiana)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (US/Eastern)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (US/Michigan)",gmt:"GMT-04:00",offset:300},{name:"Atlantic Standard Time (America/Anguilla)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Antigua)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Aruba)",gmt:"GMT-04:00",offset:240},{name:"Paraguay Time (America/Asuncion)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Barbados)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Blanc-Sablon)",gmt:"GMT-04:00",offset:240},{name:"Amazon Time (America/Boa_Vista)",gmt:"GMT-04:00",offset:240},{name:"Amazon Time (America/Campo_Grande)",gmt:"GMT-04:00",offset:240},{name:"Venezuela Time (America/Caracas)",gmt:"GMT-04:00",offset:240},{name:"Amazon Time (America/Cuiaba)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Curacao)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Dominica)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Daylight Time (America/Glace_Bay)",gmt:"GMT-03:00",offset:240},{name:"Atlantic Daylight Time (America/Goose_Bay)",gmt:"GMT-03:00",offset:240},{name:"Atlantic Standard Time (America/Grenada)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Guadeloupe)",gmt:"GMT-04:00",offset:240},{name:"Guyana Time (America/Guyana)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Daylight Time (America/Halifax)",gmt:"GMT-03:00",offset:240},{name:"Bolivia Time (America/La_Paz)",gmt:"GMT-04:00",offset:240},{name:"Amazon Time (America/Manaus)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Martinique)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Daylight Time (America/Moncton)",gmt:"GMT-03:00",offset:240},{name:"Atlantic Standard Time (America/Montserrat)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Port_of_Spain)",gmt:"GMT-04:00",offset:240},{name:"Amazon Time (America/Porto_Velho)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Puerto_Rico)",gmt:"GMT-04:00",offset:240},{name:"Chile Time (America/Santiago)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Santo_Domingo)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/St_Kitts)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/St_Lucia)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/St_Thomas)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/St_Vincent)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Daylight Time (America/Thule)",gmt:"GMT-03:00",offset:240},{name:"Atlantic Standard Time (America/Tortola)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Virgin)",gmt:"GMT-04:00",offset:240},{name:"Chile Time (Antarctica/Palmer)",gmt:"GMT-03:00",offset:240},{name:"Atlantic Daylight Time (Atlantic/Bermuda)",gmt:"GMT-03:00",offset:240},{name:"Falkland Is. Summer Time (Atlantic/Stanley)",gmt:"GMT-03:00",offset:240},{name:"Amazon Time (Brazil/West)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Daylight Time (Canada/Atlantic)",gmt:"GMT-03:00",offset:240},{name:"Chile Time (Chile/Continental)",gmt:"GMT-04:00",offset:240},{name:"GMT-04:00 (Etc/GMT+4)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (PRT)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (SystemV/AST4)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Daylight Time (SystemV/AST4ADT)",gmt:"GMT-03:00",offset:240},{name:"Newfoundland Daylight Time (America/St_Johns)",gmt:"GMT-02:30",offset:210},{name:"Newfoundland Daylight Time (CNT)",gmt:"GMT-02:30",offset:210},{name:"Newfoundland Daylight Time (Canada/Newfoundland)",gmt:"GMT-02:30",offset:210},{name:"Argentine Time (AGT)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Araguaina)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Buenos_Aires)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Catamarca)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/ComodRivadavia)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Cordoba)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Jujuy)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/La_Rioja)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Mendoza)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Rio_Gallegos)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/San_Juan)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Tucuman)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Ushuaia)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Bahia)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Belem)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Buenos_Aires)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Catamarca)",gmt:"GMT-03:00",offset:180},{name:"French Guiana Time (America/Cayenne)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Cordoba)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Fortaleza)",gmt:"GMT-03:00",offset:180},{name:"Western Greenland Summer Time (America/Godthab)",gmt:"GMT-02:00",offset:180},{name:"Argentine Time (America/Jujuy)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Maceio)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Mendoza)",gmt:"GMT-03:00",offset:180},{name:"Pierre &amp; Miquelon Daylight Time (America/Miquelon)",gmt:"GMT-02:00",offset:180},{name:"Uruguay Time (America/Montevideo)",gmt:"GMT-03:00",offset:180},{name:"Suriname Time (America/Paramaribo)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Recife)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Rosario)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Sao_Paulo)",gmt:"GMT-03:00",offset:180},{name:"Rothera Time (Antarctica/Rothera)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (BET)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (Brazil/East)",gmt:"GMT-03:00",offset:180},{name:"GMT-03:00 (Etc/GMT+3)",gmt:"GMT-03:00",offset:180},{name:"Fernando de Noronha Time (America/Noronha)",gmt:"GMT-02:00",offset:120},{name:"South Georgia Standard Time (Atlantic/South_Georgia)",gmt:"GMT-02:00",offset:120},{name:"Fernando de Noronha Time (Brazil/DeNoronha)",gmt:"GMT-02:00",offset:120},{name:"GMT-02:00 (Etc/GMT+2)",gmt:"GMT-02:00",offset:120},{name:"Eastern Greenland Summer Time (America/Scoresbysund)",gmt:"GMT+00:00",offset:60},{name:"Azores Summer Time (Atlantic/Azores)",gmt:"GMT+00:00",offset:60},{name:"Cape Verde Time (Atlantic/Cape_Verde)",gmt:"GMT-01:00",offset:60},{name:"GMT-01:00 (Etc/GMT+1)",gmt:"GMT-01:00",offset:60},{name:"Greenwich Mean Time (Africa/Abidjan)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Accra)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Bamako)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Banjul)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Bissau)",gmt:"GMT+00:00",offset:0},{name:"Western European Time (Africa/Casablanca)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Conakry)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Dakar)",gmt:"GMT+00:00",offset:0},{name:"Western European Time (Africa/El_Aaiun)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Freetown)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Lome)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Monrovia)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Nouakchott)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Ouagadougou)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Sao_Tome)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Timbuktu)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (America/Danmarkshavn)",gmt:"GMT+00:00",offset:0},{name:"Western European Summer Time (Atlantic/Canary)",gmt:"GMT+01:00",offset:0},{name:"Western European Summer Time (Atlantic/Faeroe)",gmt:"GMT+01:00",offset:0},{name:"Western European Summer Time (Atlantic/Madeira)",gmt:"GMT+01:00",offset:0},{name:"Greenwich Mean Time (Atlantic/Reykjavik)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Atlantic/St_Helena)",gmt:"GMT+00:00",offset:0},{name:"Irish Summer Time (Eire)",gmt:"GMT+01:00",offset:0},{name:"GMT+00",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Etc/Greenwich)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (Etc/UCT)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (Etc/UTC)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (Etc/Universal)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (Etc/Zulu)",gmt:"GMT+00:00",offset:0},{name:"British Summer Time (Europe/Belfast)",gmt:"GMT+01:00",offset:0},{name:"Irish Summer Time (Europe/Dublin)",gmt:"GMT+01:00",offset:0},{name:"British Summer Time (Europe/Guernsey)",gmt:"GMT+01:00",offset:0},{name:"British Summer Time (Europe/Isle_of_Man)",gmt:"GMT+01:00",offset:0},{name:"British Summer Time (Europe/Jersey)",gmt:"GMT+01:00",offset:0},{name:"Western European Summer Time (Europe/Lisbon)",gmt:"GMT+01:00",offset:0},{name:"British Summer Time (Europe/London)",gmt:"GMT+01:00",offset:0},{name:"British Summer Time (GB)",gmt:"GMT+01:00",offset:0},{name:"British Summer Time (GB-Eire)",gmt:"GMT+01:00",offset:0},{name:"Greenwich Mean Time (GMT)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Greenwich)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Iceland)",gmt:"GMT+00:00",offset:0},{name:"Western European Summer Time (Portugal)",gmt:"GMT+01:00",offset:0},{name:"Coordinated Universal Time (UCT)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (UTC)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (Universal)",gmt:"GMT+00:00",offset:0},{name:"Western European Summer Time (WET)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (Zulu)",gmt:"GMT+00:00",offset:0},{name:"Central European Time (Africa/Algiers)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Bangui)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Brazzaville)",gmt:"GMT+01:00",offset:-60},{name:"Central European Summer Time (Africa/Ceuta)",gmt:"GMT+02:00",offset:-60},{name:"Western African Time (Africa/Douala)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Kinshasa)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Lagos)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Libreville)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Luanda)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Malabo)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Ndjamena)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Niamey)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Porto-Novo)",gmt:"GMT+01:00",offset:-60},{name:"Central European Summer Time (Africa/Tunis)",gmt:"GMT+02:00",offset:-60},{name:"Western African Summer Time (Africa/Windhoek)",gmt:"GMT+01:00",offset:-60},{name:"Central European Summer Time (Arctic/Longyearbyen)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Atlantic/Jan_Mayen)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (CET)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (ECT)",gmt:"GMT+02:00",offset:-60},{name:"GMT+01",gmt:"GMT+01:00",offset:-60},{name:"Central European Summer Time (Europe/Amsterdam)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Andorra)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Belgrade)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Berlin)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Bratislava)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Brussels)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Budapest)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Copenhagen)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Gibraltar)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Ljubljana)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Luxembourg)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Madrid)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Malta)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Monaco)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Oslo)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Paris)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Podgorica)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Prague)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Rome)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/San_Marino)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Sarajevo)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Skopje)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Stockholm)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Tirane)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Vaduz)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Vatican)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Vienna)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Warsaw)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Zagreb)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Zurich)",gmt:"GMT+02:00",offset:-60},{name:"Middle Europe Summer Time (MET)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Poland)",gmt:"GMT+02:00",offset:-60},{name:"Eastern European Summer Time (ART)",gmt:"GMT+03:00",offset:-120},{name:"Central African Time (Africa/Blantyre)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Bujumbura)",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Summer Time (Africa/Cairo)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Gaborone)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Harare)",gmt:"GMT+02:00",offset:-120},{name:"South Africa Standard Time (Africa/Johannesburg)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Kigali)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Lubumbashi)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Lusaka)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Maputo)",gmt:"GMT+02:00",offset:-120},{name:"South Africa Standard Time (Africa/Maseru)",gmt:"GMT+02:00",offset:-120},{name:"South Africa Standard Time (Africa/Mbabane)",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Time (Africa/Tripoli)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Asia/Amman)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Asia/Beirut)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Asia/Damascus)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Asia/Gaza)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Asia/Istanbul)",gmt:"GMT+03:00",offset:-120},{name:"Israel Standard Time (Asia/Jerusalem)",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Summer Time (Asia/Nicosia)",gmt:"GMT+03:00",offset:-120},{name:"Israel Standard Time (Asia/Tel_Aviv)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (CAT)",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Summer Time (EET)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Egypt)",gmt:"GMT+03:00",offset:-120},{name:"GMT+02",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Summer Time (Europe/Athens)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Bucharest)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Chisinau)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Helsinki)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Istanbul)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Kaliningrad)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Kiev)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Mariehamn)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Minsk)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Nicosia)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Riga)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Simferopol)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Sofia)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Tallinn)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Tiraspol)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Uzhgorod)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Vilnius)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Zaporozhye)",gmt:"GMT+03:00",offset:-120},{name:"Israel Standard Time (Israel)",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Time (Libya)",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Summer Time (Turkey)",gmt:"GMT+03:00",offset:-120},{name:"Eastern African Time (Africa/Addis_Ababa)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Asmera)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Dar_es_Salaam)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Djibouti)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Kampala)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Khartoum)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Mogadishu)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Nairobi)",gmt:"GMT+03:00",offset:-180},{name:"Syowa Time (Antarctica/Syowa)",gmt:"GMT+03:00",offset:-180},{name:"Arabia Standard Time (Asia/Aden)",gmt:"GMT+03:00",offset:-180},{name:"Arabia Daylight Time (Asia/Baghdad)",gmt:"GMT+03:00",offset:-180},{name:"Arabia Standard Time (Asia/Bahrain)",gmt:"GMT+03:00",offset:-180},{name:"Arabia Standard Time (Asia/Kuwait)",gmt:"GMT+03:00",offset:-180},{name:"Arabia Standard Time (Asia/Qatar)",gmt:"GMT+03:00",offset:-180},{name:"Arabia Standard Time (Asia/Riyadh)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (EAT)",gmt:"GMT+03:00",offset:-180},{name:"GMT+03",gmt:"GMT+03:00",offset:-180},{name:"Moscow Daylight Time (Europe/Moscow)",gmt:"GMT+03:00",offset:-180},{name:"Volgograd Summer Time (Europe/Volgograd)",gmt:"GMT+04:00",offset:-180},{name:"Eastern African Time (Indian/Antananarivo)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Indian/Comoro)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Indian/Mayotte)",gmt:"GMT+03:00",offset:-180},{name:"Moscow Daylight Time (W-SU)",gmt:"GMT+03:00",offset:-180},{name:"( GMT 3:7 ) GMT+03",gmt:"GMT+03:07",offset:-187},{name:"( GMT 3:30 ) Iran Standard Time (Asia/Tehran)",gmt:"GMT+03:30",offset:-210},{name:"( GMT 3:30 ) Iran Standard Time (Iran)",gmt:"GMT+03:30",offset:-210},{name:"Azerbaijan Summer Time (Asia/Baku)",gmt:"GMT+04:00",offset:-240},{name:"Gulf Standard Time (Asia/Dubai)",gmt:"GMT+04:00",offset:-240},{name:"Gulf Standard Time (Asia/Muscat)",gmt:"GMT+04:00",offset:-240},{name:"Georgia Time (Asia/Tbilisi)",gmt:"GMT+04:00",offset:-240},{name:"Armenia Summer Time (Asia/Yerevan)",gmt:"GMT+04:00",offset:-240},{name:"GMT+04",gmt:"GMT+04:00",offset:-240},{name:"Samara Summer Time (Europe/Samara)",gmt:"GMT+04:00",offset:-240},{name:"Seychelles Time (Indian/Mahe)",gmt:"GMT+04:00",offset:-240},{name:"Mauritius Time (Indian/Mauritius)",gmt:"GMT+04:00",offset:-240},{name:"Reunion Time (Indian/Reunion)",gmt:"GMT+04:00",offset:-240},{name:"Armenia Summer Time (NET)",gmt:"GMT+04:00",offset:-240},{name:"( GMT 4:30 ) Afghanistan Time (Asia/Kabul)",gmt:"GMT+04:30",offset:-270},{name:"Aqtau Time (Asia/Aqtau)",gmt:"GMT+05:00",offset:-300},{name:"Aqtobe Time (Asia/Aqtobe)",gmt:"GMT+05:00",offset:-300},{name:"Turkmenistan Time (Asia/Ashgabat)",gmt:"GMT+05:00",offset:-300},{name:"Turkmenistan Time (Asia/Ashkhabad)",gmt:"GMT+05:00",offset:-300},{name:"Tajikistan Time (Asia/Dushanbe)",gmt:"GMT+05:00",offset:-300},{name:"Pakistan Time (Asia/Karachi)",gmt:"GMT+05:00",offset:-300},{name:"Oral Time (Asia/Oral)",gmt:"GMT+05:00",offset:-300},{name:"Uzbekistan Time (Asia/Samarkand)",gmt:"GMT+05:00",offset:-300},{name:"Uzbekistan Time (Asia/Tashkent)",gmt:"GMT+05:00",offset:-300},{name:"Yekaterinburg Summer Time (Asia/Yekaterinburg)",gmt:"GMT+05:00",offset:-300},{name:"GMT+05",gmt:"GMT+05:00",offset:-300},{name:"French Southern &amp; Antarctic Lands Time (Indian/Kerguelen)",gmt:"GMT+05:00",offset:-300},{name:"Maldives Time (Indian/Maldives)",gmt:"GMT+05:00",offset:-300},{name:"Pakistan Time (PLT)",gmt:"GMT+05:00",offset:-300},{name:"India Standard Time (Asia/Calcutta)",gmt:"GMT+05:30",offset:-330},{name:"Sri Lanka Time (Asia/Colombo)",gmt:"GMT+05:30",offset:-330},{name:"India Standard Time (IST)",gmt:"GMT+05:30",offset:-330},{name:"Nepal Time (Asia/Katmandu)",gmt:"GMT+05:45",offset:-345},{name:"Mawson Time (Antarctica/Mawson)",gmt:"GMT+05:00",offset:-360},{name:"Vostok Time (Antarctica/Vostok)",gmt:"GMT+06:00",offset:-360},{name:"Alma-Ata Time (Asia/Almaty)",gmt:"GMT+06:00",offset:-360},{name:"Kirgizstan Time (Asia/Bishkek)",gmt:"GMT+06:00",offset:-360},{name:"Bangladesh Time (Asia/Dacca)",gmt:"GMT+06:00",offset:-360},{name:"Bangladesh Time (Asia/Dhaka)",gmt:"GMT+06:00",offset:-360},{name:"Novosibirsk Summer Time (Asia/Novosibirsk)",gmt:"GMT+07:00",offset:-360},{name:"Omsk Summer Time (Asia/Omsk)",gmt:"GMT+06:00",offset:-360},{name:"Qyzylorda Time (Asia/Qyzylorda)",gmt:"GMT+05:00",offset:-360},{name:"Bhutan Time (Asia/Thimbu)",gmt:"GMT+06:00",offset:-360},{name:"Bhutan Time (Asia/Thimphu)",gmt:"GMT+06:00",offset:-360},{name:"Bangladesh Time (BST)",gmt:"GMT+06:00",offset:-360},{name:"GMT+06",gmt:"GMT+06:00",offset:-360},{name:"Indian Ocean Territory Time (Indian/Chagos)",gmt:"GMT+06:00",offset:-360},{name:"Myanmar Time (Asia/Rangoon)",gmt:"GMT+06:30",offset:-390},{name:"Cocos Islands Time (Indian/Cocos)",gmt:"GMT+06:30",offset:-390},{name:"Davis Time (Antarctica/Davis)",gmt:"GMT+07:00",offset:-420},{name:"Indochina Time (Asia/Bangkok)",gmt:"GMT+07:00",offset:-420},{name:"Hovd Summer Time (Asia/Hovd)",gmt:"GMT+07:00",offset:-420},{name:"West Indonesia Time (Asia/Jakarta)",gmt:"GMT+07:00",offset:-420},{name:"Krasnoyarsk Summer Time (Asia/Krasnoyarsk)",gmt:"GMT+07:00",offset:-420},{name:"Indochina Time (Asia/Phnom_Penh)",gmt:"GMT+07:00",offset:-420},{name:"West Indonesia Time (Asia/Pontianak)",gmt:"GMT+07:00",offset:-420},{name:"Indochina Time (Asia/Saigon)",gmt:"GMT+07:00",offset:-420},{name:"Indochina Time (Asia/Vientiane)",gmt:"GMT+07:00",offset:-420},{name:"GMT+07",gmt:"GMT+07:00",offset:-420},{name:"Christmas Island Time (Indian/Christmas)",gmt:"GMT+07:00",offset:-420},{name:"Indochina Time (VST)",gmt:"GMT+07:00",offset:-420},{name:"Western Standard Time  (Australia) (Antarctica/Casey)",gmt:"GMT+08:00",offset:-480},{name:"Brunei Time (Asia/Brunei)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Chongqing)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Harbin)",gmt:"GMT+08:00",offset:-480},{name:"Hong Kong Time (Asia/Hong_Kong)",gmt:"GMT+08:00",offset:-480},{name:"Irkutsk Summer Time (Asia/Irkutsk)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Kashgar)",gmt:"GMT+08:00",offset:-480},{name:"Malaysia Time (Asia/Kuala_Lumpur)",gmt:"GMT+08:00",offset:-480},{name:"Malaysia Time (Asia/Kuching)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Macao)",gmt:"GMT+08:00",offset:-480},{name:"Central Indonesia Time (Asia/Makassar)",gmt:"GMT+08:00",offset:-480},{name:"Philippines Time (Asia/Manila)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Shanghai)",gmt:"GMT+08:00",offset:-480},{name:"Singapore Time (Asia/Singapore)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Taipei)",gmt:"GMT+08:00",offset:-480},{name:"Central Indonesia Time (Asia/Ujung_Pandang)",gmt:"GMT+08:00",offset:-480},{name:"Ulaanbaatar Summer Time (Asia/Ulaanbaatar)",gmt:"GMT+08:00",offset:-480},{name:"Ulaanbaatar Summer Time (Asia/Ulan_Bator)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Urumqi)",gmt:"GMT+08:00",offset:-480},{name:"Western Standard Time  (Australia) (Australia/Perth)",gmt:"GMT+08:00",offset:-480},{name:"Western Standard Time  (Australia) (Australia/West)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (CTT)",gmt:"GMT+08:00",offset:-480},{name:"GMT+08",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (PRC)",gmt:"GMT+08:00",offset:-480},{name:"Singapore Time (Singapore)",gmt:"GMT+08:00",offset:-480},{name:"Choibalsan Summer Time (Asia/Choibalsan)",gmt:"GMT+08:00",offset:-540},{name:"East Timor Time (Asia/Dili)",gmt:"GMT+09:00",offset:-540},{name:"East Indonesia Time (Asia/Jayapura)",gmt:"GMT+09:00",offset:-540},{name:"Korea Standard Time (Asia/Pyongyang)",gmt:"GMT+09:00",offset:-540},{name:"Korea Standard Time (Asia/Seoul)",gmt:"GMT+09:00",offset:-540},{name:"Japan Standard Time (Asia/Tokyo)",gmt:"GMT+09:00",offset:-540},{name:"Yaktsk Summer Time (Asia/Yakutsk)",gmt:"GMT+09:00",offset:-540},{name:"GMT+09",gmt:"GMT+09:00",offset:-540},{name:"Japan Standard Time (JST)",gmt:"GMT+09:00",offset:-540},{name:"Japan Standard Time (Japan)",gmt:"GMT+09:00",offset:-540},{name:"Palau Time (Pacific/Palau)",gmt:"GMT+09:00",offset:-540},{name:"Korea Standard Time (ROK)",gmt:"GMT+09:00",offset:-540},{name:"( GMT 9:30 ) Central Standard Time  (Northern Territory) (ACT)",gmt:"GMT+09:30",offset:-570},{name:"( GMT 9:30 ) Central Standard Time  (South Australia) (Australia/Adelaide)",gmt:"GMT+09:30",offset:-570},{name:"( GMT 9:30 ) Central Standard Time  (South Australia/New South Wales) (Australia/Broken_Hill)",gmt:"GMT+09:30",offset:-570},{name:"( GMT 9:30 ) Central Standard Time  (Northern Territory) (Australia/Darwin)",gmt:"GMT+09:30",offset:-570},{name:"( GMT 9:30 ) Central Standard Time  (Northern Territory) (Australia/North)",gmt:"GMT+09:30",offset:-570},{name:"( GMT 9:30 ) Central Standard Time  (South Australia) (Australia/South)",gmt:"GMT+09:30",offset:-570},{name:"( GMT 9:30 ) Central Standard Time  (South Australia/New South Wales) (Australia/Yancowinna)",gmt:"GMT+09:30",offset:-570},{name:"Eastern Standard Time  (New South Wales) (AET)",gmt:"GMT+10:00",offset:-600},{name:"Dumont-d Urville Time (Antarctica/DumontDUrville)",gmt:"GMT+10:00",offset:-600},{name:"Sakhalin Summer Time (Asia/Sakhalin)",gmt:"GMT+11:00",offset:-600},{name:"Vladivostok Summer Time (Asia/Vladivostok)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (New South Wales) (Australia/ACT)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Queensland) (Australia/Brisbane)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (New South Wales) (Australia/Canberra)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (New South Wales) (Australia/Currie)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Tasmania) (Australia/Hobart)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Queensland) (Australia/Lindeman)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Victoria) (Australia/Melbourne)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (New South Wales) (Australia/NSW)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Queensland) (Australia/Queensland)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (New South Wales) (Australia/Sydney)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Tasmania) (Australia/Tasmania)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Victoria) (Australia/Victoria)",gmt:"GMT+10:00",offset:-600},{name:"GMT+10",gmt:"GMT+10:00",offset:-600},{name:"Chamorro Standard Time (Pacific/Guam)",gmt:"GMT+10:00",offset:-600},{name:"Papua New Guinea Time (Pacific/Port_Moresby)",gmt:"GMT+10:00",offset:-600},{name:"Chamorro Standard Time (Pacific/Saipan)",gmt:"GMT+10:00",offset:-600},{name:"Truk Time (Pacific/Truk)",gmt:"GMT+10:00",offset:-600},{name:"Yap Time (Pacific/Yap)",gmt:"GMT+10:00",offset:-600},{name:"Load Howe Standard Time (Australia/LHI)",gmt:"GMT+10:30",offset:-630},{name:"Load Howe Standard Time (Australia/Lord_Howe)",gmt:"GMT+10:30",offset:-630},{name:"Magadan Summer Time (Asia/Magadan)",gmt:"GMT+11:00",offset:-660},{name:"GMT+11",gmt:"GMT+11:00",offset:-660},{name:"Vanuatu Time (Pacific/Efate)",gmt:"GMT+11:00",offset:-660},{name:"Solomon Is. Time (Pacific/Guadalcanal)",gmt:"GMT+11:00",offset:-660},{name:"Kosrae Time (Pacific/Kosrae)",gmt:"GMT+11:00",offset:-660},{name:"New Caledonia Time (Pacific/Noumea)",gmt:"GMT+11:00",offset:-660},{name:"Ponape Time (Pacific/Ponape)",gmt:"GMT+11:00",offset:-660},{name:"Solomon Is. Time (SST)",gmt:"GMT+11:00",offset:-660},{name:"Norfolk Time (Pacific/Norfolk)",gmt:"GMT+11:00",offset:-690},{name:"New Zealand Standard Time (Antarctica/McMurdo)",gmt:"GMT+12:00",offset:-720},{name:"New Zealand Standard Time (Antarctica/South_Pole)",gmt:"GMT+12:00",offset:-720},{name:"Anadyr Summer Time (Asia/Anadyr)",gmt:"GMT+12:00",offset:-720},{name:"Petropavlovsk-Kamchatski Summer Time (Asia/Kamchatka)",gmt:"GMT+12:00",offset:-720},{name:"GMT+12",gmt:"GMT+12:00",offset:-720},{name:"Marshall Islands Time (Kwajalein)",gmt:"GMT+12:00",offset:-720},{name:"New Zealand Standard Time (NST)",gmt:"GMT+12:00",offset:-720},{name:"New Zealand Standard Time (NZ)",gmt:"GMT+12:00",offset:-720},{name:"New Zealand Daylight Time (NZDT)",gmt:"GMT+13:00",offset:-780},{name:"New Zealand Standard Time (Pacific/Auckland)",gmt:"GMT+12:00",offset:-720},{name:"Fiji Time (Pacific/Fiji)",gmt:"GMT+12:00",offset:-720},{name:"Tuvalu Time (Pacific/Funafuti)",gmt:"GMT+12:00",offset:-720},{name:"Marshall Islands Time (Pacific/Kwajalein)",gmt:"GMT+12:00",offset:-720},{name:"Marshall Islands Time (Pacific/Majuro)",gmt:"GMT+12:00",offset:-720},{name:"Nauru Time (Pacific/Nauru)",gmt:"GMT+12:00",offset:-720},{name:"Gilbert Is. Time (Pacific/Tarawa)",gmt:"GMT+12:00",offset:-720},{name:"Wake Time (Pacific/Wake)",gmt:"GMT+12:00",offset:-720},{name:"Wallis &amp; Futuna Time (Pacific/Wallis)",gmt:"GMT+12:00",offset:-720},{name:"Chatham Standard Time (NZ-CHAT)",gmt:"GMT+12:45",offset:-765},{name:"Chatham Standard Time (Pacific/Chatham)",gmt:"GMT+12:45",offset:-765},{name:"GMT+13",gmt:"GMT+13:00",offset:-780},{name:"Phoenix Is. Time (Pacific/Enderbury)",gmt:"GMT+13:00",offset:-780},{name:"Tonga Time (Pacific/Tongatapu)",gmt:"GMT+13:00",offset:-780},{name:"GMT+14",gmt:"GMT+14:00",offset:-840},{name:"Line Is. Time (Pacific/Kiritimati)",gmt:"GMT+14:00",offset:-840}]},getCurrentTimeZone:function(e){return function(e){var a=(new Date).getTimezoneOffset(),m=[{name:"GMT-12:00 (Etc/GMT+12)",gmt:"GMT-12:00",offset:720},{name:"GMT-11:00 (Etc/GMT+11)",gmt:"GMT-11:00",offset:660},{name:"West Samoa Time (MIT)",gmt:"GMT-11:00",offset:660},{name:"West Samoa Time (Pacific/Apia)",gmt:"GMT+13:00",offset:660},{name:"Samoa Standard Time (Pacific/Midway)",gmt:"GMT-11:00",offset:660},{name:"Niue Time (Pacific/Niue)",gmt:"GMT-11:00",offset:660},{name:"Samoa Standard Time (Pacific/Pago_Pago)",gmt:"GMT-11:00",offset:660},{name:"Samoa Standard Time (Pacific/Samoa)",gmt:"GMT-11:00",offset:660},{name:"Samoa Standard Time (US/Samoa)",gmt:"GMT-11:00",offset:660},{name:"Hawaii-Aleutian Daylight Time (America/Adak)",gmt:"GMT-09:00",offset:600},{name:"Hawaii-Aleutian Daylight Time (America/Atka)",gmt:"GMT-09:00",offset:600},{name:"GMT-10:00 (Etc/GMT+10)",gmt:"GMT-10:00",offset:600},{name:"Hawaii Standard Time (HST)",gmt:"GMT-10:00",offset:600},{name:"Tokelau Time (Pacific/Fakaofo)",gmt:"GMT+13:00",offset:600},{name:"Hawaii Standard Time (Pacific/Honolulu)",gmt:"GMT-10:00",offset:600},{name:"Hawaii Standard Time (Pacific/Johnston)",gmt:"GMT-10:00",offset:600},{name:"Cook Is. Time (Pacific/Rarotonga)",gmt:"GMT-10:00",offset:600},{name:"Tahiti Time (Pacific/Tahiti)",gmt:"GMT-10:00",offset:600},{name:"Hawaii Standard Time (SystemV/HST10)",gmt:"GMT-10:00",offset:600},{name:"Hawaii-Aleutian Daylight Time (US/Aleutian)",gmt:"GMT-09:00",offset:600},{name:"Hawaii Standard Time (US/Hawaii)",gmt:"GMT-10:00",offset:600},{name:"Marquesas Time (Pacific/Marquesas)",gmt:"GMT-09:30",offset:570},{name:"Alaska Daylight Time (AST)",gmt:"GMT-08:00",offset:540},{name:"Alaska Daylight Time (America/Anchorage)",gmt:"GMT-08:00",offset:540},{name:"Alaska Daylight Time (America/Juneau)",gmt:"GMT-08:00",offset:540},{name:"Alaska Daylight Time (America/Nome)",gmt:"GMT-08:00",offset:540},{name:"Alaska Daylight Time (America/Yakutat)",gmt:"GMT-08:00",offset:540},{name:"GMT-09:00 (Etc/GMT+9)",gmt:"GMT-09:00",offset:540},{name:"Gambier Time (Pacific/Gambier)",gmt:"GMT-09:00",offset:540},{name:"Alaska Standard Time (SystemV/YST9)",gmt:"GMT-08:00",offset:540},{name:"Alaska Daylight Time (SystemV/YST9YDT)",gmt:"GMT-08:00",offset:540},{name:"Alaska Daylight Time (US/Alaska)",gmt:"GMT-08:00",offset:540},{name:"Pacific Daylight Time (America/Dawson)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (America/Ensenada)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (America/Los_Angeles)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (America/Tijuana)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (America/Vancouver)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (America/Whitehorse)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (Canada/Pacific)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (Canada/Yukon)",gmt:"GMT-07:00",offset:480},{name:"GMT-08:00 (Etc/GMT+8)",gmt:"GMT-08:00",offset:480},{name:"Pacific Daylight Time (Mexico/BajaNorte)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (PST)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (PST8PDT)",gmt:"GMT-07:00",offset:480},{name:"Pitcairn Standard Time (Pacific/Pitcairn)",gmt:"GMT-08:00",offset:480},{name:"Pacific Standard Time (SystemV/PST8)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (SystemV/PST8PDT)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (US/Pacific)",gmt:"GMT-07:00",offset:480},{name:"Pacific Daylight Time (US/Pacific-New)",gmt:"GMT-07:00",offset:480},{name:"Mountain Daylight Time (America/Boise)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (America/Cambridge_Bay)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (America/Chihuahua)",gmt:"GMT-06:00",offset:420},{name:"Mountain Standard Time (America/Dawson_Creek)",gmt:"GMT-07:00",offset:420},{name:"Mountain Daylight Time (America/Denver)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (America/Edmonton)",gmt:"GMT-06:00",offset:420},{name:"Mountain Standard Time (America/Hermosillo)",gmt:"GMT-07:00",offset:420},{name:"Mountain Daylight Time (America/Inuvik)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (America/Mazatlan)",gmt:"GMT-06:00",offset:420},{name:"Mountain Standard Time (America/Phoenix)",gmt:"GMT-07:00",offset:420},{name:"Mountain Daylight Time (America/Shiprock)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (America/Yellowknife)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (Canada/Mountain)",gmt:"GMT-06:00",offset:420},{name:"GMT-07:00 (Etc/GMT+7)",gmt:"GMT-07:00",offset:420},{name:"Mountain Standard Time (MST)",gmt:"GMT-07:00",offset:420},{name:"Mountain Daylight Time (MST7MDT)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (Mexico/BajaSur)",gmt:"GMT-06:00",offset:420},{name:"Mountain Daylight Time (Navajo)",gmt:"GMT-06:00",offset:420},{name:"Mountain Standard Time (PNT)",gmt:"GMT-07:00",offset:420},{name:"Mountain Standard Time (SystemV/MST7)",gmt:"GMT-07:00",offset:420},{name:"Mountain Daylight Time (SystemV/MST7MDT)",gmt:"GMT-06:00",offset:420},{name:"Mountain Standard Time (US/Arizona)",gmt:"GMT-07:00",offset:420},{name:"Mountain Daylight Time (US/Mountain)",gmt:"GMT-06:00",offset:420},{name:"Central Standard Time (America/Belize)",gmt:"GMT-06:00",offset:360},{name:"Central Daylight Time (America/Cancun)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Chicago)",gmt:"GMT-05:00",offset:360},{name:"Central Standard Time (America/Costa_Rica)",gmt:"GMT-06:00",offset:360},{name:"Central Standard Time (America/El_Salvador)",gmt:"GMT-06:00",offset:360},{name:"Central Standard Time (America/Guatemala)",gmt:"GMT-06:00",offset:360},{name:"Central Daylight Time (America/Indiana/Knox)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Indiana/Petersburg)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Indiana/Vincennes)",gmt:"GMT-05:00",offset:360},{name:"Eastern Daylight Time (America/Knox_IN)",gmt:"GMT-04:00",offset:360},{name:"Central Standard Time (America/Managua)",gmt:"GMT-06:00",offset:360},{name:"Central Daylight Time (America/Menominee)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Merida)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Mexico_City)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Monterrey)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/North_Dakota/Center)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/North_Dakota/New_Salem)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Rainy_River)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (America/Rankin_Inlet)",gmt:"GMT-05:00",offset:360},{name:"Central Standard Time (America/Regina)",gmt:"GMT-06:00",offset:360},{name:"Central Standard Time (America/Swift_Current)",gmt:"GMT-06:00",offset:360},{name:"Central Standard Time (America/Tegucigalpa)",gmt:"GMT-06:00",offset:360},{name:"Central Daylight Time (America/Winnipeg)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (CST)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (CST6CDT)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (Canada/Central)",gmt:"GMT-05:00",offset:360},{name:"Central Standard Time (Canada/East-Saskatchewan)",gmt:"GMT-06:00",offset:360},{name:"Central Standard Time (Canada/Saskatchewan)",gmt:"GMT-06:00",offset:360},{name:"Easter Is. Time (Chile/EasterIsland)",gmt:"GMT-06:00",offset:360},{name:"GMT-06:00 (Etc/GMT+6)",gmt:"GMT-06:00",offset:360},{name:"Central Daylight Time (Mexico/General)",gmt:"GMT-05:00",offset:360},{name:"Easter Is. Time (Pacific/Easter)",gmt:"GMT-06:00",offset:360},{name:"Galapagos Time (Pacific/Galapagos)",gmt:"GMT-06:00",offset:360},{name:"Central Standard Time (SystemV/CST6)",gmt:"GMT-06:00",offset:360},{name:"Central Daylight Time (SystemV/CST6CDT)",gmt:"GMT-05:00",offset:360},{name:"Central Daylight Time (US/Central)",gmt:"GMT-05:00",offset:360},{name:"Eastern Daylight Time (US/Indiana-Starke)",gmt:"GMT-04:00",offset:360},{name:"Eastern Standard Time (America/Atikokan)",gmt:"GMT-05:00",offset:300},{name:"Colombia Time (America/Bogota)",gmt:"GMT-05:00",offset:300},{name:"Eastern Standard Time (America/Cayman)",gmt:"GMT-05:00",offset:300},{name:"Eastern Standard Time (America/Coral_Harbour)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Detroit)",gmt:"GMT-04:00",offset:300},{name:"Acre Time (America/Eirunepe)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Fort_Wayne)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Grand_Turk)",gmt:"GMT-04:00",offset:300},{name:"Ecuador Time (America/Guayaquil)",gmt:"GMT-05:00",offset:300},{name:"Central Daylight Time (America/Havana)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Indiana/Indianapolis)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Indiana/Marengo)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Indiana/Vevay)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Indianapolis)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Iqaluit)",gmt:"GMT-04:00",offset:300},{name:"Eastern Standard Time (America/Jamaica)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Kentucky/Louisville)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Kentucky/Monticello)",gmt:"GMT-04:00",offset:300},{name:"Peru Time (America/Lima)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Louisville)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Montreal)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Nassau)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/New_York)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Nipigon)",gmt:"GMT-04:00",offset:300},{name:"Eastern Standard Time (America/Panama)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Pangnirtung)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Port-au-Prince)",gmt:"GMT-04:00",offset:300},{name:"Acre Time (America/Porto_Acre)",gmt:"GMT-05:00",offset:300},{name:"Acre Time (America/Rio_Branco)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (America/Thunder_Bay)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (America/Toronto)",gmt:"GMT-04:00",offset:300},{name:"Acre Time (Brazil/Acre)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (Canada/Eastern)",gmt:"GMT-04:00",offset:300},{name:"Central Daylight Time (Cuba)",gmt:"GMT-05:00",offset:300},{name:"Eastern Standard Time (EST)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (EST5EDT)",gmt:"GMT-04:00",offset:300},{name:"GMT-05:00 (Etc/GMT+5)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (IET)",gmt:"GMT-04:00",offset:300},{name:"Eastern Standard Time (Jamaica)",gmt:"GMT-05:00",offset:300},{name:"Eastern Standard Time (SystemV/EST5)",gmt:"GMT-05:00",offset:300},{name:"Eastern Daylight Time (SystemV/EST5EDT)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (US/East-Indiana)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (US/Eastern)",gmt:"GMT-04:00",offset:300},{name:"Eastern Daylight Time (US/Michigan)",gmt:"GMT-04:00",offset:300},{name:"Atlantic Standard Time (America/Anguilla)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Antigua)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Aruba)",gmt:"GMT-04:00",offset:240},{name:"Paraguay Time (America/Asuncion)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Barbados)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Blanc-Sablon)",gmt:"GMT-04:00",offset:240},{name:"Amazon Time (America/Boa_Vista)",gmt:"GMT-04:00",offset:240},{name:"Amazon Time (America/Campo_Grande)",gmt:"GMT-04:00",offset:240},{name:"Venezuela Time (America/Caracas)",gmt:"GMT-04:00",offset:240},{name:"Amazon Time (America/Cuiaba)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Curacao)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Dominica)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Daylight Time (America/Glace_Bay)",gmt:"GMT-03:00",offset:240},{name:"Atlantic Daylight Time (America/Goose_Bay)",gmt:"GMT-03:00",offset:240},{name:"Atlantic Standard Time (America/Grenada)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Guadeloupe)",gmt:"GMT-04:00",offset:240},{name:"Guyana Time (America/Guyana)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Daylight Time (America/Halifax)",gmt:"GMT-03:00",offset:240},{name:"Bolivia Time (America/La_Paz)",gmt:"GMT-04:00",offset:240},{name:"Amazon Time (America/Manaus)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Martinique)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Daylight Time (America/Moncton)",gmt:"GMT-03:00",offset:240},{name:"Atlantic Standard Time (America/Montserrat)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Port_of_Spain)",gmt:"GMT-04:00",offset:240},{name:"Amazon Time (America/Porto_Velho)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Puerto_Rico)",gmt:"GMT-04:00",offset:240},{name:"Chile Time (America/Santiago)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Santo_Domingo)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/St_Kitts)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/St_Lucia)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/St_Thomas)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/St_Vincent)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Daylight Time (America/Thule)",gmt:"GMT-03:00",offset:240},{name:"Atlantic Standard Time (America/Tortola)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (America/Virgin)",gmt:"GMT-04:00",offset:240},{name:"Chile Time (Antarctica/Palmer)",gmt:"GMT-03:00",offset:240},{name:"Atlantic Daylight Time (Atlantic/Bermuda)",gmt:"GMT-03:00",offset:240},{name:"Falkland Is. Summer Time (Atlantic/Stanley)",gmt:"GMT-03:00",offset:240},{name:"Amazon Time (Brazil/West)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Daylight Time (Canada/Atlantic)",gmt:"GMT-03:00",offset:240},{name:"Chile Time (Chile/Continental)",gmt:"GMT-04:00",offset:240},{name:"GMT-04:00 (Etc/GMT+4)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (PRT)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Standard Time (SystemV/AST4)",gmt:"GMT-04:00",offset:240},{name:"Atlantic Daylight Time (SystemV/AST4ADT)",gmt:"GMT-03:00",offset:240},{name:"Newfoundland Daylight Time (America/St_Johns)",gmt:"GMT-02:30",offset:210},{name:"Newfoundland Daylight Time (CNT)",gmt:"GMT-02:30",offset:210},{name:"Newfoundland Daylight Time (Canada/Newfoundland)",gmt:"GMT-02:30",offset:210},{name:"Argentine Time (AGT)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Araguaina)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Buenos_Aires)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Catamarca)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/ComodRivadavia)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Cordoba)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Jujuy)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/La_Rioja)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Mendoza)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Rio_Gallegos)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/San_Juan)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Tucuman)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Argentina/Ushuaia)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Bahia)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Belem)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Buenos_Aires)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Catamarca)",gmt:"GMT-03:00",offset:180},{name:"French Guiana Time (America/Cayenne)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Cordoba)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Fortaleza)",gmt:"GMT-03:00",offset:180},{name:"Western Greenland Summer Time (America/Godthab)",gmt:"GMT-02:00",offset:180},{name:"Argentine Time (America/Jujuy)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Maceio)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Mendoza)",gmt:"GMT-03:00",offset:180},{name:"Pierre &amp; Miquelon Daylight Time (America/Miquelon)",gmt:"GMT-02:00",offset:180},{name:"Uruguay Time (America/Montevideo)",gmt:"GMT-03:00",offset:180},{name:"Suriname Time (America/Paramaribo)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Recife)",gmt:"GMT-03:00",offset:180},{name:"Argentine Time (America/Rosario)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (America/Sao_Paulo)",gmt:"GMT-03:00",offset:180},{name:"Rothera Time (Antarctica/Rothera)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (BET)",gmt:"GMT-03:00",offset:180},{name:"Brasilia Time (Brazil/East)",gmt:"GMT-03:00",offset:180},{name:"GMT-03:00 (Etc/GMT+3)",gmt:"GMT-03:00",offset:180},{name:"Fernando de Noronha Time (America/Noronha)",gmt:"GMT-02:00",offset:120},{name:"South Georgia Standard Time (Atlantic/South_Georgia)",gmt:"GMT-02:00",offset:120},{name:"Fernando de Noronha Time (Brazil/DeNoronha)",gmt:"GMT-02:00",offset:120},{name:"GMT-02:00 (Etc/GMT+2)",gmt:"GMT-02:00",offset:120},{name:"Eastern Greenland Summer Time (America/Scoresbysund)",gmt:"GMT+00:00",offset:60},{name:"Azores Summer Time (Atlantic/Azores)",gmt:"GMT+00:00",offset:60},{name:"Cape Verde Time (Atlantic/Cape_Verde)",gmt:"GMT-01:00",offset:60},{name:"GMT-01:00 (Etc/GMT+1)",gmt:"GMT-01:00",offset:60},{name:"Greenwich Mean Time (Africa/Abidjan)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Accra)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Bamako)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Banjul)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Bissau)",gmt:"GMT+00:00",offset:0},{name:"Western European Time (Africa/Casablanca)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Conakry)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Dakar)",gmt:"GMT+00:00",offset:0},{name:"Western European Time (Africa/El_Aaiun)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Freetown)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Lome)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Monrovia)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Nouakchott)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Ouagadougou)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Sao_Tome)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Africa/Timbuktu)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (America/Danmarkshavn)",gmt:"GMT+00:00",offset:0},{name:"Western European Summer Time (Atlantic/Canary)",gmt:"GMT+01:00",offset:0},{name:"Western European Summer Time (Atlantic/Faeroe)",gmt:"GMT+01:00",offset:0},{name:"Western European Summer Time (Atlantic/Madeira)",gmt:"GMT+01:00",offset:0},{name:"Greenwich Mean Time (Atlantic/Reykjavik)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Atlantic/St_Helena)",gmt:"GMT+00:00",offset:0},{name:"Irish Summer Time (Eire)",gmt:"GMT+01:00",offset:0},{name:"GMT+00",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Etc/Greenwich)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (Etc/UCT)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (Etc/UTC)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (Etc/Universal)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (Etc/Zulu)",gmt:"GMT+00:00",offset:0},{name:"British Summer Time (Europe/Belfast)",gmt:"GMT+01:00",offset:0},{name:"Irish Summer Time (Europe/Dublin)",gmt:"GMT+01:00",offset:0},{name:"British Summer Time (Europe/Guernsey)",gmt:"GMT+01:00",offset:0},{name:"British Summer Time (Europe/Isle_of_Man)",gmt:"GMT+01:00",offset:0},{name:"British Summer Time (Europe/Jersey)",gmt:"GMT+01:00",offset:0},{name:"Western European Summer Time (Europe/Lisbon)",gmt:"GMT+01:00",offset:0},{name:"British Summer Time (Europe/London)",gmt:"GMT+01:00",offset:0},{name:"British Summer Time (GB)",gmt:"GMT+01:00",offset:0},{name:"British Summer Time (GB-Eire)",gmt:"GMT+01:00",offset:0},{name:"Greenwich Mean Time (GMT)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Greenwich)",gmt:"GMT+00:00",offset:0},{name:"Greenwich Mean Time (Iceland)",gmt:"GMT+00:00",offset:0},{name:"Western European Summer Time (Portugal)",gmt:"GMT+01:00",offset:0},{name:"Coordinated Universal Time (UCT)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (UTC)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (Universal)",gmt:"GMT+00:00",offset:0},{name:"Western European Summer Time (WET)",gmt:"GMT+00:00",offset:0},{name:"Coordinated Universal Time (Zulu)",gmt:"GMT+00:00",offset:0},{name:"Central European Time (Africa/Algiers)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Bangui)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Brazzaville)",gmt:"GMT+01:00",offset:-60},{name:"Central European Summer Time (Africa/Ceuta)",gmt:"GMT+02:00",offset:-60},{name:"Western African Time (Africa/Douala)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Kinshasa)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Lagos)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Libreville)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Luanda)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Malabo)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Ndjamena)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Niamey)",gmt:"GMT+01:00",offset:-60},{name:"Western African Time (Africa/Porto-Novo)",gmt:"GMT+01:00",offset:-60},{name:"Central European Summer Time (Africa/Tunis)",gmt:"GMT+02:00",offset:-60},{name:"Western African Summer Time (Africa/Windhoek)",gmt:"GMT+01:00",offset:-60},{name:"Central European Summer Time (Arctic/Longyearbyen)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Atlantic/Jan_Mayen)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (CET)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (ECT)",gmt:"GMT+02:00",offset:-60},{name:"GMT+01",gmt:"GMT+01:00",offset:-60},{name:"Central European Summer Time (Europe/Amsterdam)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Andorra)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Belgrade)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Berlin)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Bratislava)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Brussels)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Budapest)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Copenhagen)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Gibraltar)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Ljubljana)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Luxembourg)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Madrid)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Malta)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Monaco)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Oslo)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Paris)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Podgorica)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Prague)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Rome)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/San_Marino)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Sarajevo)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Skopje)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Stockholm)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Tirane)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Vaduz)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Vatican)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Vienna)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Warsaw)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Zagreb)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Europe/Zurich)",gmt:"GMT+02:00",offset:-60},{name:"Middle Europe Summer Time (MET)",gmt:"GMT+02:00",offset:-60},{name:"Central European Summer Time (Poland)",gmt:"GMT+02:00",offset:-60},{name:"Eastern European Summer Time (ART)",gmt:"GMT+03:00",offset:-120},{name:"Central African Time (Africa/Blantyre)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Bujumbura)",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Summer Time (Africa/Cairo)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Gaborone)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Harare)",gmt:"GMT+02:00",offset:-120},{name:"South Africa Standard Time (Africa/Johannesburg)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Kigali)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Lubumbashi)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Lusaka)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (Africa/Maputo)",gmt:"GMT+02:00",offset:-120},{name:"South Africa Standard Time (Africa/Maseru)",gmt:"GMT+02:00",offset:-120},{name:"South Africa Standard Time (Africa/Mbabane)",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Time (Africa/Tripoli)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Asia/Amman)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Asia/Beirut)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Asia/Damascus)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Asia/Gaza)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Asia/Istanbul)",gmt:"GMT+03:00",offset:-120},{name:"Israel Standard Time (Asia/Jerusalem)",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Summer Time (Asia/Nicosia)",gmt:"GMT+03:00",offset:-120},{name:"Israel Standard Time (Asia/Tel_Aviv)",gmt:"GMT+02:00",offset:-120},{name:"Central African Time (CAT)",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Summer Time (EET)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Egypt)",gmt:"GMT+03:00",offset:-120},{name:"GMT+02",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Summer Time (Europe/Athens)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Bucharest)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Chisinau)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Helsinki)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Istanbul)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Kaliningrad)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Kiev)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Mariehamn)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Minsk)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Nicosia)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Riga)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Simferopol)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Sofia)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Tallinn)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Tiraspol)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Uzhgorod)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Vilnius)",gmt:"GMT+03:00",offset:-120},{name:"Eastern European Summer Time (Europe/Zaporozhye)",gmt:"GMT+03:00",offset:-120},{name:"Israel Standard Time (Israel)",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Time (Libya)",gmt:"GMT+02:00",offset:-120},{name:"Eastern European Summer Time (Turkey)",gmt:"GMT+03:00",offset:-120},{name:"Eastern African Time (Africa/Addis_Ababa)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Asmera)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Dar_es_Salaam)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Djibouti)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Kampala)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Khartoum)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Mogadishu)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Africa/Nairobi)",gmt:"GMT+03:00",offset:-180},{name:"Syowa Time (Antarctica/Syowa)",gmt:"GMT+03:00",offset:-180},{name:"Arabia Standard Time (Asia/Aden)",gmt:"GMT+03:00",offset:-180},{name:"Arabia Daylight Time (Asia/Baghdad)",gmt:"GMT+03:00",offset:-180},{name:"Arabia Standard Time (Asia/Bahrain)",gmt:"GMT+03:00",offset:-180},{name:"Arabia Standard Time (Asia/Kuwait)",gmt:"GMT+03:00",offset:-180},{name:"Arabia Standard Time (Asia/Qatar)",gmt:"GMT+03:00",offset:-180},{name:"Arabia Standard Time (Asia/Riyadh)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (EAT)",gmt:"GMT+03:00",offset:-180},{name:"GMT+03",gmt:"GMT+03:00",offset:-180},{name:"Moscow Daylight Time (Europe/Moscow)",gmt:"GMT+03:00",offset:-180},{name:"Volgograd Summer Time (Europe/Volgograd)",gmt:"GMT+04:00",offset:-180},{name:"Eastern African Time (Indian/Antananarivo)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Indian/Comoro)",gmt:"GMT+03:00",offset:-180},{name:"Eastern African Time (Indian/Mayotte)",gmt:"GMT+03:00",offset:-180},{name:"Moscow Daylight Time (W-SU)",gmt:"GMT+03:00",offset:-180},{name:"( GMT 3:7 ) GMT+03",gmt:"GMT+03:07",offset:-187},{name:"( GMT 3:30 ) Iran Standard Time (Asia/Tehran)",gmt:"GMT+03:30",offset:-210},{name:"( GMT 3:30 ) Iran Standard Time (Iran)",gmt:"GMT+03:30",offset:-210},{name:"Azerbaijan Summer Time (Asia/Baku)",gmt:"GMT+04:00",offset:-240},{name:"Gulf Standard Time (Asia/Dubai)",gmt:"GMT+04:00",offset:-240},{name:"Gulf Standard Time (Asia/Muscat)",gmt:"GMT+04:00",offset:-240},{name:"Georgia Time (Asia/Tbilisi)",gmt:"GMT+04:00",offset:-240},{name:"Armenia Summer Time (Asia/Yerevan)",gmt:"GMT+04:00",offset:-240},{name:"GMT+04",gmt:"GMT+04:00",offset:-240},{name:"Samara Summer Time (Europe/Samara)",gmt:"GMT+04:00",offset:-240},{name:"Seychelles Time (Indian/Mahe)",gmt:"GMT+04:00",offset:-240},{name:"Mauritius Time (Indian/Mauritius)",gmt:"GMT+04:00",offset:-240},{name:"Reunion Time (Indian/Reunion)",gmt:"GMT+04:00",offset:-240},{name:"Armenia Summer Time (NET)",gmt:"GMT+04:00",offset:-240},{name:"( GMT 4:30 ) Afghanistan Time (Asia/Kabul)",gmt:"GMT+04:30",offset:-270},{name:"Aqtau Time (Asia/Aqtau)",gmt:"GMT+05:00",offset:-300},{name:"Aqtobe Time (Asia/Aqtobe)",gmt:"GMT+05:00",offset:-300},{name:"Turkmenistan Time (Asia/Ashgabat)",gmt:"GMT+05:00",offset:-300},{name:"Turkmenistan Time (Asia/Ashkhabad)",gmt:"GMT+05:00",offset:-300},{name:"Tajikistan Time (Asia/Dushanbe)",gmt:"GMT+05:00",offset:-300},{name:"Pakistan Time (Asia/Karachi)",gmt:"GMT+05:00",offset:-300},{name:"Oral Time (Asia/Oral)",gmt:"GMT+05:00",offset:-300},{name:"Uzbekistan Time (Asia/Samarkand)",gmt:"GMT+05:00",offset:-300},{name:"Uzbekistan Time (Asia/Tashkent)",gmt:"GMT+05:00",offset:-300},{name:"Yekaterinburg Summer Time (Asia/Yekaterinburg)",gmt:"GMT+05:00",offset:-300},{name:"GMT+05",gmt:"GMT+05:00",offset:-300},{name:"French Southern &amp; Antarctic Lands Time (Indian/Kerguelen)",gmt:"GMT+05:00",offset:-300},{name:"Maldives Time (Indian/Maldives)",gmt:"GMT+05:00",offset:-300},{name:"Pakistan Time (PLT)",gmt:"GMT+05:00",offset:-300},{name:"India Standard Time (Asia/Calcutta)",gmt:"GMT+05:30",offset:-330},{name:"Sri Lanka Time (Asia/Colombo)",gmt:"GMT+05:30",offset:-330},{name:"India Standard Time (IST)",gmt:"GMT+05:30",offset:-330},{name:"Nepal Time (Asia/Katmandu)",gmt:"GMT+05:45",offset:-345},{name:"Mawson Time (Antarctica/Mawson)",gmt:"GMT+05:00",offset:-360},{name:"Vostok Time (Antarctica/Vostok)",gmt:"GMT+06:00",offset:-360},{name:"Alma-Ata Time (Asia/Almaty)",gmt:"GMT+06:00",offset:-360},{name:"Kirgizstan Time (Asia/Bishkek)",gmt:"GMT+06:00",offset:-360},{name:"Bangladesh Time (Asia/Dacca)",gmt:"GMT+06:00",offset:-360},{name:"Bangladesh Time (Asia/Dhaka)",gmt:"GMT+06:00",offset:-360},{name:"Novosibirsk Summer Time (Asia/Novosibirsk)",gmt:"GMT+07:00",offset:-360},{name:"Omsk Summer Time (Asia/Omsk)",gmt:"GMT+06:00",offset:-360},{name:"Qyzylorda Time (Asia/Qyzylorda)",gmt:"GMT+05:00",offset:-360},{name:"Bhutan Time (Asia/Thimbu)",gmt:"GMT+06:00",offset:-360},{name:"Bhutan Time (Asia/Thimphu)",gmt:"GMT+06:00",offset:-360},{name:"Bangladesh Time (BST)",gmt:"GMT+06:00",offset:-360},{name:"GMT+06",gmt:"GMT+06:00",offset:-360},{name:"Indian Ocean Territory Time (Indian/Chagos)",gmt:"GMT+06:00",offset:-360},{name:"Myanmar Time (Asia/Rangoon)",gmt:"GMT+06:30",offset:-390},{name:"Cocos Islands Time (Indian/Cocos)",gmt:"GMT+06:30",offset:-390},{name:"Davis Time (Antarctica/Davis)",gmt:"GMT+07:00",offset:-420},{name:"Indochina Time (Asia/Bangkok)",gmt:"GMT+07:00",offset:-420},{name:"Hovd Summer Time (Asia/Hovd)",gmt:"GMT+07:00",offset:-420},{name:"West Indonesia Time (Asia/Jakarta)",gmt:"GMT+07:00",offset:-420},{name:"Krasnoyarsk Summer Time (Asia/Krasnoyarsk)",gmt:"GMT+07:00",offset:-420},{name:"Indochina Time (Asia/Phnom_Penh)",gmt:"GMT+07:00",offset:-420},{name:"West Indonesia Time (Asia/Pontianak)",gmt:"GMT+07:00",offset:-420},{name:"Indochina Time (Asia/Saigon)",gmt:"GMT+07:00",offset:-420},{name:"Indochina Time (Asia/Vientiane)",gmt:"GMT+07:00",offset:-420},{name:"GMT+07",gmt:"GMT+07:00",offset:-420},{name:"Christmas Island Time (Indian/Christmas)",gmt:"GMT+07:00",offset:-420},{name:"Indochina Time (VST)",gmt:"GMT+07:00",offset:-420},{name:"Western Standard Time  (Australia) (Antarctica/Casey)",gmt:"GMT+08:00",offset:-480},{name:"Brunei Time (Asia/Brunei)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Chongqing)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Harbin)",gmt:"GMT+08:00",offset:-480},{name:"Hong Kong Time (Asia/Hong_Kong)",gmt:"GMT+08:00",offset:-480},{name:"Irkutsk Summer Time (Asia/Irkutsk)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Kashgar)",gmt:"GMT+08:00",offset:-480},{name:"Malaysia Time (Asia/Kuala_Lumpur)",gmt:"GMT+08:00",offset:-480},{name:"Malaysia Time (Asia/Kuching)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Macao)",gmt:"GMT+08:00",offset:-480},{name:"Central Indonesia Time (Asia/Makassar)",gmt:"GMT+08:00",offset:-480},{name:"Philippines Time (Asia/Manila)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Shanghai)",gmt:"GMT+08:00",offset:-480},{name:"Singapore Time (Asia/Singapore)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Taipei)",gmt:"GMT+08:00",offset:-480},{name:"Central Indonesia Time (Asia/Ujung_Pandang)",gmt:"GMT+08:00",offset:-480},{name:"Ulaanbaatar Summer Time (Asia/Ulaanbaatar)",gmt:"GMT+08:00",offset:-480},{name:"Ulaanbaatar Summer Time (Asia/Ulan_Bator)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (Asia/Urumqi)",gmt:"GMT+08:00",offset:-480},{name:"Western Standard Time  (Australia) (Australia/Perth)",gmt:"GMT+08:00",offset:-480},{name:"Western Standard Time  (Australia) (Australia/West)",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (CTT)",gmt:"GMT+08:00",offset:-480},{name:"GMT+08",gmt:"GMT+08:00",offset:-480},{name:"China Standard Time (PRC)",gmt:"GMT+08:00",offset:-480},{name:"Singapore Time (Singapore)",gmt:"GMT+08:00",offset:-480},{name:"Choibalsan Summer Time (Asia/Choibalsan)",gmt:"GMT+08:00",offset:-540},{name:"East Timor Time (Asia/Dili)",gmt:"GMT+09:00",offset:-540},{name:"East Indonesia Time (Asia/Jayapura)",gmt:"GMT+09:00",offset:-540},{name:"Korea Standard Time (Asia/Pyongyang)",gmt:"GMT+09:00",offset:-540},{name:"Korea Standard Time (Asia/Seoul)",gmt:"GMT+09:00",offset:-540},{name:"Japan Standard Time (Asia/Tokyo)",gmt:"GMT+09:00",offset:-540},{name:"Yaktsk Summer Time (Asia/Yakutsk)",gmt:"GMT+09:00",offset:-540},{name:"GMT+09",gmt:"GMT+09:00",offset:-540},{name:"Japan Standard Time (JST)",gmt:"GMT+09:00",offset:-540},{name:"Japan Standard Time (Japan)",gmt:"GMT+09:00",offset:-540},{name:"Palau Time (Pacific/Palau)",gmt:"GMT+09:00",offset:-540},{name:"Korea Standard Time (ROK)",gmt:"GMT+09:00",offset:-540},{name:"( GMT 9:30 ) Central Standard Time  (Northern Territory) (ACT)",gmt:"GMT+09:30",offset:-570},{name:"( GMT 9:30 ) Central Standard Time  (South Australia) (Australia/Adelaide)",gmt:"GMT+09:30",offset:-570},{name:"( GMT 9:30 ) Central Standard Time  (South Australia/New South Wales) (Australia/Broken_Hill)",gmt:"GMT+09:30",offset:-570},{name:"( GMT 9:30 ) Central Standard Time  (Northern Territory) (Australia/Darwin)",gmt:"GMT+09:30",offset:-570},{name:"( GMT 9:30 ) Central Standard Time  (Northern Territory) (Australia/North)",gmt:"GMT+09:30",offset:-570},{name:"( GMT 9:30 ) Central Standard Time  (South Australia) (Australia/South)",gmt:"GMT+09:30",offset:-570},{name:"( GMT 9:30 ) Central Standard Time  (South Australia/New South Wales) (Australia/Yancowinna)",gmt:"GMT+09:30",offset:-570},{name:"Eastern Standard Time  (New South Wales) (AET)",gmt:"GMT+10:00",offset:-600},{name:"Dumont-d Urville Time (Antarctica/DumontDUrville)",gmt:"GMT+10:00",offset:-600},{name:"Sakhalin Summer Time (Asia/Sakhalin)",gmt:"GMT+11:00",offset:-600},{name:"Vladivostok Summer Time (Asia/Vladivostok)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (New South Wales) (Australia/ACT)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Queensland) (Australia/Brisbane)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (New South Wales) (Australia/Canberra)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (New South Wales) (Australia/Currie)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Tasmania) (Australia/Hobart)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Queensland) (Australia/Lindeman)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Victoria) (Australia/Melbourne)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (New South Wales) (Australia/NSW)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Queensland) (Australia/Queensland)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (New South Wales) (Australia/Sydney)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Tasmania) (Australia/Tasmania)",gmt:"GMT+10:00",offset:-600},{name:"Eastern Standard Time  (Victoria) (Australia/Victoria)",gmt:"GMT+10:00",offset:-600},{name:"GMT+10",gmt:"GMT+10:00",offset:-600},{name:"Chamorro Standard Time (Pacific/Guam)",gmt:"GMT+10:00",offset:-600},{name:"Papua New Guinea Time (Pacific/Port_Moresby)",gmt:"GMT+10:00",offset:-600},{name:"Chamorro Standard Time (Pacific/Saipan)",gmt:"GMT+10:00",offset:-600},{name:"Truk Time (Pacific/Truk)",gmt:"GMT+10:00",offset:-600},{name:"Yap Time (Pacific/Yap)",gmt:"GMT+10:00",offset:-600},{name:"Load Howe Standard Time (Australia/LHI)",gmt:"GMT+10:30",offset:-630},{name:"Load Howe Standard Time (Australia/Lord_Howe)",gmt:"GMT+10:30",offset:-630},{name:"Magadan Summer Time (Asia/Magadan)",gmt:"GMT+11:00",offset:-660},{name:"GMT+11",gmt:"GMT+11:00",offset:-660},{name:"Vanuatu Time (Pacific/Efate)",gmt:"GMT+11:00",offset:-660},{name:"Solomon Is. Time (Pacific/Guadalcanal)",gmt:"GMT+11:00",offset:-660},{name:"Kosrae Time (Pacific/Kosrae)",gmt:"GMT+11:00",offset:-660},{name:"New Caledonia Time (Pacific/Noumea)",gmt:"GMT+11:00",offset:-660},{name:"Ponape Time (Pacific/Ponape)",gmt:"GMT+11:00",offset:-660},{name:"Solomon Is. Time (SST)",gmt:"GMT+11:00",offset:-660},{name:"Norfolk Time (Pacific/Norfolk)",gmt:"GMT+11:00",offset:-690},{name:"New Zealand Standard Time (Antarctica/McMurdo)",gmt:"GMT+12:00",offset:-720},{name:"New Zealand Standard Time (Antarctica/South_Pole)",gmt:"GMT+12:00",offset:-720},{name:"Anadyr Summer Time (Asia/Anadyr)",gmt:"GMT+12:00",offset:-720},{name:"Petropavlovsk-Kamchatski Summer Time (Asia/Kamchatka)",gmt:"GMT+12:00",offset:-720},{name:"GMT+12",gmt:"GMT+12:00",offset:-720},{name:"Marshall Islands Time (Kwajalein)",gmt:"GMT+12:00",offset:-720},{name:"New Zealand Standard Time (NST)",gmt:"GMT+12:00",offset:-720},{name:"New Zealand Standard Time (NZ)",gmt:"GMT+12:00",offset:-720},{name:"New Zealand Daylight Time (NZDT)",gmt:"GMT+13:00",offset:-780},{name:"New Zealand Standard Time (Pacific/Auckland)",gmt:"GMT+12:00",offset:-720},{name:"Fiji Time (Pacific/Fiji)",gmt:"GMT+12:00",offset:-720},{name:"Tuvalu Time (Pacific/Funafuti)",gmt:"GMT+12:00",offset:-720},{name:"Marshall Islands Time (Pacific/Kwajalein)",gmt:"GMT+12:00",offset:-720},{name:"Marshall Islands Time (Pacific/Majuro)",gmt:"GMT+12:00",offset:-720},{name:"Nauru Time (Pacific/Nauru)",gmt:"GMT+12:00",offset:-720},{name:"Gilbert Is. Time (Pacific/Tarawa)",gmt:"GMT+12:00",offset:-720},{name:"Wake Time (Pacific/Wake)",gmt:"GMT+12:00",offset:-720},{name:"Wallis &amp; Futuna Time (Pacific/Wallis)",gmt:"GMT+12:00",offset:-720},{name:"Chatham Standard Time (NZ-CHAT)",gmt:"GMT+12:45",offset:-765},{name:"Chatham Standard Time (Pacific/Chatham)",gmt:"GMT+12:45",offset:-765},{name:"GMT+13",gmt:"GMT+13:00",offset:-780},{name:"Phoenix Is. Time (Pacific/Enderbury)",gmt:"GMT+13:00",offset:-780},{name:"Tonga Time (Pacific/Tongatapu)",gmt:"GMT+13:00",offset:-780},{name:"GMT+14",gmt:"GMT+14:00",offset:-840},{name:"Line Is. Time (Pacific/Kiritimati)",gmt:"GMT+14:00",offset:-840}],t={};for(var n in m){var i=m[n].name,f=m[n].gmt;if(e&&i.includes(e)||a==m[n].offset){t.gmt=f,t.name=i;break}}return t}(e)}}}();var ZSIQInput=function(){var o={tel:"phone",name:"text"},e=function(a,i){this.dataval=a,this.callback=a.callback,this.componentid=i,this.chatid=a.chatid};return e.prototype={init:function(){var a=ZSIQTranscript.getFormatedHTML($Widget.getLayout());a=(a=(a=a.replace(/{BOT_WIDGET}/g,this.getInputHtml())).replace(/{CLASSNAME}/g,"botinput")).replace(/{WIDGET_TYPE}/g,"input-card"),$Widget.attachHTML(a,!0),this.element=$("#bot_widget"+this.componentid),this.element.parents(".ziq_msg").attr("data-widget","input"),this.bindEvent()},getInputHtml:function(){var a=this.dataval,i="",e="";"tel"==a.type&&(i='<div class="tel_li"><div class="teldrop sbold"></div></div>',e="tel_wget ");var n="text",t="",r="";return"password"==a.type&&(n="password",t='<span class="sqico-enable tgl-ico" property="pwdtoggle"></span>',r="posrel"),a.error=a.error||LSResource.getRealValue("cw.common.error"),'<div class="input_widget"><div class="'+e+"input_div "+r+'">'+i+'<input type="'+n+'" data-validate="required '+(o[a.type]||a.type)+'" placeholder="'+(a.placeholder||"")+'" value="'+(a.value||"")+'" data-type="input" data-validate="'+(a.type||"")+'" class="sbold">'+t+'</div><div class="inpt_wd_fdr"><div class="inptwget_error txtelips sbold" title="'+a.error+'">'+a.error+'</div><div class="inptwget_sumbt flexC sbold">'+LSResource.getRealValue("embed.submit")+'<em class="sqico-larrow flexC"></em></div></div></div>'},bindEvent:function(){var i=this,n=this.element,a=n.find(".inptwget_sumbt");a.off("click").on("click",function(){i.handleConfirm()}),"password"==this.dataval.type&&n.find('[property="pwdtoggle"]').off("click").on("click",function(){var a=n.find("input"),i="password"===a.attr("type")?"text":"password",e="text"==i?"sqico-disable":"sqico-enable";a.prop("type",i),$(this).removeClass("sqico-disable sqico-enable").addClass(e)}),n.find("input").off("keyup").on("keyup",function(a){n.find(".inptwget_error").css("visibility","hidden"),13==a.keyCode&&i.handleConfirm()}).off("focus").on("focus",function(){a.removeClass("sel").addClass("sel")}).off("blur").on("blur",function(){a.removeClass("sel")}),"tel"==this.dataval.type&&this.handleDropdown(),n.find("input").focus()},validate:function(){return this.element.find('[data-type="input"]').validateInput()},handleDropdown:function(){ZSIQDropdown.init({options:function(){var a={"+61":"Australia","+93":"Afghanistan","+355":"Albania","+213":"Algeria","+1-684":"American Samoa","+376":"Andorra","+244":"Angola","+1-264":"Anguilla","+672":"Antarctica","+1-268":"Antigua and Barbuda","+54":"Argentina","+374":"Armenia","+297":"Aruba","+43":"Austria","+994":"Azerbaijan","+1-242":"Bahamas","+973":"Bahrain","+880":"Bangladesh","+1-246":"Barbados","+375":"Belarus","+32":"Belgium","+501":"Belize","+229":"Benin","+1-441":"Bermuda","+975":"Bhutan","+591":"Bolivia","+387":"Bosnia and Herzegovina","+267":"Botswana","+55":"Brazil","+246":"British Indian Ocean Territory","+1-284":"British Virgin Islands","+673":"Brunei","+359":"Bulgaria","+226":"Burkina Faso","+257":"Burundi","+855":"Cambodia","+237":"Cameroon","+1":"United States","+238":"Cape Verde","+1-345":"Cayman Islands","+236":"Central African Republic","+235":"Chad","+56":"Chile","+86":"China","+57":"Colombia","+269":"Comoros","+682":"Cook Islands","+506":"Costa Rica","+385":"Croatia","+53":"Cuba","+599":"Netherlands Antilles","+357":"Cyprus","+420":"Czech Republic","+243":"Democratic Republic of the Congo","+45":"Denmark","+253":"Djibouti","+1-767":"Dominica","+1-809, 1-829, 1-849":"Dominican Republic","+670":"East Timor","+593":"Ecuador","+20":"Egypt","+503":"El Salvador","+240":"Equatorial Guinea","+291":"Eritrea","+372":"Estonia","+251":"Ethiopia","+500":"Falkland Islands","+298":"Faroe Islands","+679":"Fiji","+358":"Finland","+33":"France","+689":"French Polynesia","+241":"Gabon","+220":"Gambia","+995":"Georgia","+49":"Germany","+233":"Ghana","+350":"Gibraltar","+30":"Greece","+299":"Greenland","+1-473":"Grenada","+1-671":"Guam","+502":"Guatemala","+44-1481":"Guernsey","+224":"Guinea","+245":"Guinea-Bissau","+592":"Guyana","+509":"Haiti","+504":"Honduras","+852":"Hong Kong","+36":"Hungary","+354":"Iceland","+91":"India","+62":"Indonesia","+98":"Iran","+964":"Iraq","+353":"Ireland","+44-1624":"Isle of Man","+972":"Israel","+39":"Italy","+225":"Ivory Coast","+1-876":"Jamaica","+81":"Japan","+44-1534":"Jersey","+962":"Jordan","+7":"Russia","+254":"Kenya","+686":"Kiribati","+383":"Kosovo","+965":"Kuwait","+996":"Kyrgyzstan","+856":"Laos","+371":"Latvia","+961":"Lebanon","+266":"Lesotho","+231":"Liberia","+218":"Libya","+423":"Liechtenstein","+370":"Lithuania","+352":"Luxembourg","+853":"Macau","+389":"Macedonia","+261":"Madagascar","+265":"Malawi","+60":"Malaysia","+960":"Maldives","+223":"Mali","+356":"Malta","+692":"Marshall Islands","+222":"Mauritania","+230":"Mauritius","+262":"Reunion","+52":"Mexico","+691":"Micronesia","+373":"Moldova","+377":"Monaco","+976":"Mongolia","+382":"Montenegro","+1-664":"Montserrat","+212":"Western Sahara","+258":"Mozambique","+95":"Myanmar","+264":"Namibia","+674":"Nauru","+977":"Nepal","+31":"Netherlands","+687":"New Caledonia","+64":"Pitcairn","+505":"Nicaragua","+227":"Niger","+234":"Nigeria","+683":"Niue","+850":"North Korea","+1-670":"Northern Mariana Islands","+47":"Svalbard and Jan Mayen","+968":"Oman","+92":"Pakistan","+680":"Palau","+970":"Palestine","+507":"Panama","+675":"Papua New Guinea","+595":"Paraguay","+51":"Peru","+63":"Philippines","+48":"Poland","+351":"Portugal","+1-787, 1-939":"Puerto Rico","+974":"Qatar","+242":"Republic of the Congo","+40":"Romania","+250":"Rwanda","+590":"Saint Martin","+290":"Saint Helena","+1-869":"Saint Kitts and Nevis","+1-758":"Saint Lucia","+508":"Saint Pierre and Miquelon","+1-784":"Saint Vincent and the Grenadines","+685":"Samoa","+378":"San Marino","+239":"Sao Tome and Principe","+966":"Saudi Arabia","+221":"Senegal","+381":"Serbia","+248":"Seychelles","+232":"Sierra Leone","+65":"Singapore","+1-721":"Sint Maarten","+421":"Slovakia","+386":"Slovenia","+677":"Solomon Islands","+252":"Somalia","+27":"South Africa","+82":"South Korea","+211":"South Sudan","+34":"Spain","+94":"Sri Lanka","+249":"Sudan","+597":"Suriname","+268":"Swaziland","+46":"Sweden","+41":"Switzerland","+963":"Syria","+886":"Taiwan","+992":"Tajikistan","+255":"Tanzania","+66":"Thailand","+228":"Togo","+690":"Tokelau","+676":"Tonga","+1-868":"Trinidad and Tobago","+216":"Tunisia","+90":"Turkey","+993":"Turkmenistan","+1-649":"Turks and Caicos Islands","+688":"Tuvalu","+1-340":"U.S. Virgin Islands","+256":"Uganda","+380":"Ukraine","+971":"United Arab Emirates","+44":"United Kingdom","+598":"Uruguay","+998":"Uzbekistan","+678":"Vanuatu","+379":"Vatican","+58":"Venezuela","+84":"Vietnam","+681":"Wallis and Futuna","+967":"Yemen","+260":"Zambia","+263":"Zimbabwe"},i=[];for(var e in a)i.push({key:e,val:a[e],subval:e});return i}(),selected:this.dataval.country_code||"+1",element:this.element.find(".teldrop"),currentlist_header:"cw.current.country",list_header:"cw.other.country",placeholder:"cw.search.country",callback:function(){this.element.find('[data-type="input"]').focus()},chatid:this.chatid})},handleConfirm:function(){var a=this.element;if(!this.validate())return a.find(".inptwget_error").css("visibility","visible"),void a.find("input").focus();var i=a.find("#dropdownheader").text()+" "+a.find('[data-type="input"]').val(),e=i=i.trim();"password"==this.dataval.type&&(e=Array(i.length+1).join("*")),a.parents(".ziq_msg").removeAttr("data-widget").removeAttr("data-wtype").removeClass("siq_widget"),this.callback({type:this.dataval.type,msg:e,id:this.componentid,value:i,config:this.dataval,chatid:this.chatid})}},{init:function(a,i){new e(a,i).init()}}}();var ConversationFormInput=function(){var a=function(t,e){this.dataval=t,this.chatid=t.chatid,this.contentdiv=ZSIQConversationManager.getChatWinObjById(this.chatid).contentdiv};return a.prototype={init:function(){this.populateUI()},populateUI:function(){$Widget.attachHTML(""),ZSIQTranscript.scroll(),this.handleTextarea()},handleTextarea:function(){var t=this.dataval,e=t.fieldtype?t.fieldtype.replace("_",""):"";this.contentdiv&&this.contentdiv.find("#msgarea").attr("data-validate","required "+t.validate).attr("purpose",e).attr("data-type",e).attr("placeholder",t.placeholder).attr("dockeyup","validateConversation").attr("fieldtype",t.fieldname).attr("iscustomfield",t.iscustomfield).removeAttr("readonly").removeAttr("disabled").focus(),this.contentdiv&&this.contentdiv.find("#action_icons").show()}},{init:function(t,e){new a(t,e).init()},resetMessageArea:function(t){var e=$Support.EmbedObj.status,a=ZSIQConversationManager.getChatWinObjById(t),i=ZSIQConversationForm.getSelectedDeptstatus(a.department),n=(e=null!=i?e&&i:e)?"sendmessage":"leavemessage",r=ZSIQConversationManager.getChatWinObjById(t).contentdiv||$Support.contentdiv;r.find("#msgarea").attr("data-validate","required").attr("purpose","").attr("placeholder",LSResource.getRealValue("ne.message.hitenter")).attr("dockeyup",n).attr("custom","question").removeAttr("data-type").removeAttr("fieldtype").val(""),r.find("#skipquestion").remove()}}}();var ZSIQContactCard=function(){var n={tel:"phone",name:"text"},i=function(a,e){this.dataval=a,this.callback=a.callback,this.componentid=e,this.chatid=a.chatid};return i.prototype={init:function(){var a=ZSIQTranscript.getFormatedHTML($Widget.getLayout());a=(a=(a=a.replace(/{BOT_WIDGET}/g,this.getInputHtml())).replace(/{CLASSNAME}/g,"botinput")).replace(/{WIDGET_TYPE}/g,"input-card"),$Widget.attachHTML(a,!0),this.element=$("#bot_widget"+this.componentid),this.bindEvent()},getInputHtml:function(){var a="";for(var e in this.dataval.fields){var i=this.dataval.fields[e];i.error=i.error&&i.error[0]?i.error[0]:LSResource.getRealValue("cw.common.error"),a+='<div class="'+("tel"==i.type?"tel_wget ":"")+'input_div">'+("tel"==i.type?'<div class="tel_li"><div class="teldrop"></div></div>':"")+'<input type="text" data-validate="'+(i.required?"required ":"")+(n[i.type]||i.type)+'" placeholder="'+(i.placeholder||"")+'" value="'+(i.value||"")+'" data-type="input" data-fieldtype="'+i.type+'" data-validate="'+(i.type||"")+'">'+(i.label?'<span class="cfld_pholder txtelips'+(i.required?" reg_fld":"")+'">'+i.label+"</span>":"")+'<span class="error_msg">'+i.error+"</span></div>"}return'<div class="input_widget mT15">'+a+'<div class="inpt_wd_fdr mT25"><div class="inptwget_sumbt flexC">'+LSResource.getRealValue("embed.submit")+"</div></div></div>"},bindEvent:function(){var a=this,e=this.element;e.find(".inptwget_sumbt").on("click",function(){a.handleConfirm()}),e.on("keydown","input",function(a){9!=a.keyCode&&$(this).parent().addClass("hide_plhld")}),e.on("keyup","input",function(){var a=$(this),e=a.parent();e.removeClass("hide_plhld").removeClass("error_fld"),a.val()&&e.addClass("hide_plhld")}),this.handleDropdown()},handleDropdown:function(){var a=this.element.find(".teldrop");0==a.length||a.find(".drop_hdr").length||ZSIQDropdown.init({options:function(){var a={"+93":"Afghanistan","+355":"Albania","+213":"Algeria","+1-684":"American Samoa","+376":"Andorra","+244":"Angola","+1-264":"Anguilla","+672":"Antarctica","+1-268":"Antigua and Barbuda","+54":"Argentina","+374":"Armenia","+297":"Aruba","+61":"Cocos Islands","+43":"Austria","+994":"Azerbaijan","+1-242":"Bahamas","+973":"Bahrain","+880":"Bangladesh","+1-246":"Barbados","+375":"Belarus","+32":"Belgium","+501":"Belize","+229":"Benin","+1-441":"Bermuda","+975":"Bhutan","+591":"Bolivia","+387":"Bosnia and Herzegovina","+267":"Botswana","+55":"Brazil","+246":"British Indian Ocean Territory","+1-284":"British Virgin Islands","+673":"Brunei","+359":"Bulgaria","+226":"Burkina Faso","+257":"Burundi","+855":"Cambodia","+237":"Cameroon","+1":"United States","+238":"Cape Verde","+1-345":"Cayman Islands","+236":"Central African Republic","+235":"Chad","+56":"Chile","+86":"China","+57":"Colombia","+269":"Comoros","+682":"Cook Islands","+506":"Costa Rica","+385":"Croatia","+53":"Cuba","+599":"Netherlands Antilles","+357":"Cyprus","+420":"Czech Republic","+243":"Democratic Republic of the Congo","+45":"Denmark","+253":"Djibouti","+1-767":"Dominica","+1-809, 1-829, 1-849":"Dominican Republic","+670":"East Timor","+593":"Ecuador","+20":"Egypt","+503":"El Salvador","+240":"Equatorial Guinea","+291":"Eritrea","+372":"Estonia","+251":"Ethiopia","+500":"Falkland Islands","+298":"Faroe Islands","+679":"Fiji","+358":"Finland","+33":"France","+689":"French Polynesia","+241":"Gabon","+220":"Gambia","+995":"Georgia","+49":"Germany","+233":"Ghana","+350":"Gibraltar","+30":"Greece","+299":"Greenland","+1-473":"Grenada","+1-671":"Guam","+502":"Guatemala","+44-1481":"Guernsey","+224":"Guinea","+245":"Guinea-Bissau","+592":"Guyana","+509":"Haiti","+504":"Honduras","+852":"Hong Kong","+36":"Hungary","+354":"Iceland","+91":"India","+62":"Indonesia","+98":"Iran","+964":"Iraq","+353":"Ireland","+44-1624":"Isle of Man","+972":"Israel","+39":"Italy","+225":"Ivory Coast","+1-876":"Jamaica","+81":"Japan","+44-1534":"Jersey","+962":"Jordan","+7":"Russia","+254":"Kenya","+686":"Kiribati","+383":"Kosovo","+965":"Kuwait","+996":"Kyrgyzstan","+856":"Laos","+371":"Latvia","+961":"Lebanon","+266":"Lesotho","+231":"Liberia","+218":"Libya","+423":"Liechtenstein","+370":"Lithuania","+352":"Luxembourg","+853":"Macau","+389":"Macedonia","+261":"Madagascar","+265":"Malawi","+60":"Malaysia","+960":"Maldives","+223":"Mali","+356":"Malta","+692":"Marshall Islands","+222":"Mauritania","+230":"Mauritius","+262":"Reunion","+52":"Mexico","+691":"Micronesia","+373":"Moldova","+377":"Monaco","+976":"Mongolia","+382":"Montenegro","+1-664":"Montserrat","+212":"Western Sahara","+258":"Mozambique","+95":"Myanmar","+264":"Namibia","+674":"Nauru","+977":"Nepal","+31":"Netherlands","+687":"New Caledonia","+64":"Pitcairn","+505":"Nicaragua","+227":"Niger","+234":"Nigeria","+683":"Niue","+850":"North Korea","+1-670":"Northern Mariana Islands","+47":"Svalbard and Jan Mayen","+968":"Oman","+92":"Pakistan","+680":"Palau","+970":"Palestine","+507":"Panama","+675":"Papua New Guinea","+595":"Paraguay","+51":"Peru","+63":"Philippines","+48":"Poland","+351":"Portugal","+1-787, 1-939":"Puerto Rico","+974":"Qatar","+242":"Republic of the Congo","+40":"Romania","+250":"Rwanda","+590":"Saint Martin","+290":"Saint Helena","+1-869":"Saint Kitts and Nevis","+1-758":"Saint Lucia","+508":"Saint Pierre and Miquelon","+1-784":"Saint Vincent and the Grenadines","+685":"Samoa","+378":"San Marino","+239":"Sao Tome and Principe","+966":"Saudi Arabia","+221":"Senegal","+381":"Serbia","+248":"Seychelles","+232":"Sierra Leone","+65":"Singapore","+1-721":"Sint Maarten","+421":"Slovakia","+386":"Slovenia","+677":"Solomon Islands","+252":"Somalia","+27":"South Africa","+82":"South Korea","+211":"South Sudan","+34":"Spain","+94":"Sri Lanka","+249":"Sudan","+597":"Suriname","+268":"Swaziland","+46":"Sweden","+41":"Switzerland","+963":"Syria","+886":"Taiwan","+992":"Tajikistan","+255":"Tanzania","+66":"Thailand","+228":"Togo","+690":"Tokelau","+676":"Tonga","+1-868":"Trinidad and Tobago","+216":"Tunisia","+90":"Turkey","+993":"Turkmenistan","+1-649":"Turks and Caicos Islands","+688":"Tuvalu","+1-340":"U.S. Virgin Islands","+256":"Uganda","+380":"Ukraine","+971":"United Arab Emirates","+44":"United Kingdom","+598":"Uruguay","+998":"Uzbekistan","+678":"Vanuatu","+379":"Vatican","+58":"Venezuela","+84":"Vietnam","+681":"Wallis and Futuna","+967":"Yemen","+260":"Zambia","+263":"Zimbabwe"},e=[];for(var i in a)e.push({key:i,val:a[i],subval:i});return e}(),selected:this.dataval.country_code||"+1",element:a,currentlist_header:"cw.current.country",list_header:"cw.other.country",placeholder:"cw.search.country",callback:function(){this.element.find('[data-type="input"]').focus()}})},handleConfirm:function(){var a=this.element,t={},r="",o=!0;a.find("input[data-validate]").each(function(){var a=$(this),e=a.parent();if(!a.validateInput())return e.addClass("error_fld"),a.focus(),o=!1;var i=(-1!=a.attr("data-validate").indexOf("phone")?e.find("#dropdownheader").text()+" ":"")+a.val(),n=a.attr("data-fieldtype");t[n]=i,r+=(r?", ":"")+n+" : "+i}),o&&(a.parents(".ziq_msg").removeAttr("data-widget").removeAttr("data-wtype").removeClass("siq_widget"),this.callback({type:this.dataval.type,msg:r,id:this.componentid,value:t,config:this.dataval,chatid:this.chatid}))}},{init:function(a,e){new i(a,e).init()}}}();var ZSIQForm=function(){var i=function(e,t){this.chatid=e.chatid,this.chatobj=ZSIQTranscript.getChatWindowOBJ(this.chatid),this.fields=e.msglist,this.callback=e.callback,this.componentid=t,this.userconfig=e||{},this.dname=this.chatobj.attendername||e.dname||ZSIQConversationForm.getOperatorName(),this.title=e.title||ZSIQConversationForm.getFormQuestion(),this.contentdiv=this.chatobj.contentdiv},c=function(e){return e?'<em class="mL5 req">*</em>':""},l=function(e){var t=e.input_card||{},i=e.skippable?"optional":"required",s=e.type||e.format||"text",a=t.maxlength||"url"==e.format||"textarea"==e.type?100:30,o=i+" "+s,n=!!e.iscustomfield,r=t.visibility||"both",d=n?"custom":!n&&t.type?t.type.replace("_",""):e.field_name,c=((e.input_card?e.input_card.placeholder:e.field_name)||ZSIQConversationForm.getDefaultPlaceholder(d),getEscapedText(e.field_name)||d);return'index="'+e.index+'" custom="'+c+'" purpose="'+d+'" customid="'+c+'" visibility="'+r+'" id="'+c+'" fieldkey="'+ZSIQConversationForm.getDefaultPostMessage(d)+'"name="'+c+'" data-validate="'+o+'" autocomplete="off" maxlength="'+a+'" info="'+s+'"'},p=function(e){getEscapedText(e.name||e.field_name);return'<div class="field_main posrel" field-type="dropdown"><div id="sqico-cdrpdwn" class="dropdown mT15 sqico-drpdwn siq-dropdown" type="selectbox" '+l(e)+"></div></div>"},u=function(e){var t=e.input_card||{},i=(e.options,getEscapedText(e.field_name)),s=c(!e.skippable),a=e.msg,o=a?'<span class="field_lable font14">'+getEscapedText(a)+s+"</span>":"",n=CommonUtil.parseToJSON(e.required)?'iserrorfield="true"':"",r=e.iscustomfield?"custom":e.key;return o+='<div class="custombtn" purpose="'+r+'" fieldkey="'+r+'" type="'+t.type+'" visibility="'+t.visibility+'" custom="'+i+'" '+l(e)+' data-validate="" '+n+">"};return i.prototype={init:function(){this.populateUI()},populateUI:function(){this.populateFormTitle();var e=!!this.userconfig.isuseredit||"",t=this.userconfig.triggerclbk?'callback = "'+this.userconfig.triggerclbk+'"':"",i='<div class="form_content pLR16" id="siqform" isuseredit = '+e+">",s=this.chatobj,a=$Support.getEmbedDepartments();for(var o in this.fields){var n=this.fields[o].meta?this.fields[o].meta:{},r=n.input_card||{};this.fields[o].meta&&(this.fields[o].meta.index=o),"subscribe"==n.key&&e||(n.msg=this.fields[o].msg,r.type&&!/^(visitor_phone|visitor_name|visitor_email||campaign)$/.exec(r.type)&&(n.iscustomfield=!0),"department"!=n.field_name?i+=this.getHTML(this.fields[o].meta):"-1"!=$Support.EmbedObj.department||e||-1!=s.department||(1==a.length?($Support.EmbedObj.department=a[0].ID,s.department=a[0].ID):(this.fields[o].meta.suggestions=a,i+=p(this.fields[o].meta))))}i+='<div id="customfields"></div><div class="save" data-val = '+LSResource.getRealValue("common.done")+' id="siqformsave"'+t+">"+LSResource.getRealValue("common.done")+"</div>"+this.checkAndGetSkipHTML()+"</div>";var d=$Widget.getLayout();d=(d=(d=d.replace(/{BOT_WIDGET}/g,i)).replace(/{CLASSNAME}/g,"botform")).replace(/{WIDGET_TYPE}/g,"input-card"),$Widget.attachHTML(d),this.handleDropdown(),this.reStoreValues(),this.bindEvents()},populateFormTitle:function(){var e=!(!this.userconfig.isuseredit&&!this.userconfig.triggerclbk),t=this.componentid?MyDate.getHoursandMin(this.componentid,!0,"bclient"):"";this.title&&!e&&$BotImpl.formatAndDisplay({sender:"-1",dname:this.dname,msg:getEncodedText(this.title),time:t},"",!0)},checkAndGetSkipHTML:function(){for(var e=this.userconfig.msglist,t=!1,i=!!this.userconfig.isuseredit,s=0;s<e.length;s++)if(e[s].meta&&0==e[s].meta.skippable){t=!0;break}return!t||i?'<div class="save siq-skip" data-val = '+LSResource.getRealValue("common.skip")+' id="siqformskip">'+LSResource.getRealValue("common.skip")+"</div>":""},getHTML:function(s){var e,t,i,a,o,n,r,d=s.format?s.format:s.input_card?s.input_card.type:"text";return/^(number|text|email|phone|url|percentage|decimal|percent|website)$/.exec(d)?(e=s,t=$Support.EmbedObj.errorinfo||{},i=e&&e.input_card&&e.input_card.type?e.input_card.type:"",a=e.iscustomfield?i:"vis"+i.replace("visitor_",""),o=e.iscustomfield?"custom":i.replace("_","")||e.field_name,n=e.input_card?getEscapedText(e.input_card.placeholder)||ZSIQConversationForm.getDefaultPlaceholder(o):"",r=t[a]?t[a]:/^number|email|url|percentage|percent|decimal|name|email|phone$/.exec(a)?LSResource.getRealValue("ne.errorinfo."+a):"",'<div class="field_main posrel" type="'+e.format+'"><input type="text" class="input_field font15" value="" '+l(e)+' docfocus="inputFocus" dockeydown="removeError" docblur="custominput"/><span class="field_title font15 txtelips w100">'+n+c(!e.skippable)+'</span><em class="sqico-invalid txt-invalid dN" purpose="invalid" title="'+r+'"></em></div>'):{checkbox:function(){return function(e){for(var t=e.input_card?e.input_card.options:e.options,i=getEscapedText(e.field_name),s="",a=0;a<t.length;a++){var o=t[a],n=getEscapedText(o.text),r=getEscapedText(o.value);s+='<span class="posrel dIB mT10"><input type="checkbox" class="hide_fld" id="'+r+'" name="'+i+'" value="'+r+'"><span class="checkbox sqico-checkbox siq-check"><label for="'+r+'" class="curP dib-mid">'+n+"</label></span></span>"}return'<div class="field_main posrel pL15" field-type="checkbox" custombx="true" customid="'+i+'">'+u(e)+'<div class="w100">'+s+"</div></div></div>"}(s)},radio:function(){return function(e){for(var t=e.input_card?e.input_card.options:e.options,i=getEscapedText(e.field_name)||"",s="",a=0;a<t.length;a++){var o=t[a],n=getEscapedText(o.text),r=getEscapedText(o.value);s+='<span class="posrel dIB"><input type="radio" class="hide_fld" id="'+r+'" name="'+i+'" value="'+r+'"><span class="checkbox sqico-radio siq-radio"><label for="'+r+'" class="curP dib-mid">'+n+"</label></span></span>"}return'<div class="field_main posrel pL15" field-type="radio" custombx="true" customid="'+i+'">'+u(e)+"<div>"+s+"</div></div></div>"}(s)},selectbox:function(){return p(s)},textarea:function(){return e=s,t=getEscapedText(e.field_name)||"",i=getEscapedText(e.msg)||t,'<div custom="'+t+'" type="'+e.key+'" customid="'+t+'" custombx="true" purpose = "custom" class="field_main posrel" field-type="textarea"><textarea type="text" class="input_field font15" value="" visibility="'+e.visibility+'" '+l(e)+' docfocus="inputFocus" dockeydown="removeError" docblur="custominput"></textarea><span class="field_title font15">'+i+c(e.required)+"</span></div>";var e,t,i},label:function(){return(e=s).msg?'<div class="subtitle mT20 lH20 pL15 c333" purpose = "custom" customid="'+(getEscapedText(e.field_name)||"")+'" custombx="true">'+getEscapedText(e.msg)+"</div>":"";var e}}[d]()||""},handleDropdown:function(){var e=this.contentdiv.find("#siqform"),n=this;e.find(".sqico-drpdwn").each(function(){var e=$(this),t=e.attr("index"),i=n.fields[t],s=!i.meta||!i.meta.iscustomfield,a=i.meta?i.meta.suggestions||(i.meta.input_card?i.meta.input_card.options:""):i.options,o=s?LSResource.getRealValue("ne.chosedepartment"):i.msg||(i.meta?i.meta.field_name:"");e.dropdown({options:a,purpose:s?"department":"customdrpdwn",defaultval:o+c("true")})})},reStoreValues:function(){var e=this.contentdiv.find("#siqform"),t=$Support.EmbedObj,i=e.find('[purpose = "visitorname"]'),s=e.find('[purpose = "visitoremail"]'),a=e.find('[purpose = "visitorphone"]');t.visitorname&&!$Support.Util.isInValidVisitorName(t.visitorname)&&0<i.length&&this.setValue(i,t.visitorname),t.visitoremail&&0<s.length&&this.setValue(s,t.visitoremail),t.visitorphone&&0<a.length&&this.setValue(a,t.visitorphone)},setValue:function(e,t){$(e).trigger("focus"),$(e).val(t)},bindEvents:function(){var t=this;this.contentdiv.find("#siqformsave, #siqformskip").on("click",function(e){t.callback(t.userconfig,"",e)}),this.contentdiv.find("#siqform").on("keyup",function(e){"13"==(e.keyCode?e.keyCode:e.which)&&t.callback(t.userconfig,"",e)})}},{init:function(e,t){new i(e,t).init()}}}();var ZSIQLinkInfo=function(){var n=function(i,t){this.data=$.extend(i.link_info||{},i),this.data.id=t,this.data.url=$BotImpl.sanitizeUrlContent(this.data.url)},l=function(t){try{return t.provider_name||t.url.split("://")[1].split(/[/?#]/)[0]}catch(i){return t.url||""}},s=function(i){if(i.html){if(!i.autoplay)return i.html;var t=$(i.html),a=t.attr("src");return t.attr("src",a+(-1==a.indexOf("?")?"?":"&")+"autoplay=1")[0].outerHTML}var n=i.url.split(".").pop().split("?")[0];return"<video controls "+(i.autoplay?"autoplay":"")+'><source src="'+i.url+'" type="video/'+n+'">'+(i.subtitles?'<track label="English" kind="subtitles" srclang="en" src="'+i.subtitles+'" default=""/>':"")+"</video>"};return n.prototype={render:function(){var i,t,a;$Widget.attachHTML((i=this.data,t=this.data.id,a=$Widget.getMessageOBJ().msg,'<div class="linfo_widget" id="linkinfo_'+t+'"><div class="linfo_main"><div class="linfo_submain"><div class="flexC">'+(i.favicon_link?'<img src="'+i.favicon_link+'" class="linfo_fav">':"")+'<span class="linfo_proname">'+l(i)+"</span></div>"+(i.title?'<div class="font16 sbold mT5 mB5 c222">'+i.title+"</div>":"")+(i.description?'<div class="c555 mB10">'+i.description+"</div>":"")+"</div>"+(i.thumbnail_url?'<div class="linfo_thum"><img src="'+i.thumbnail_url+'" onload="$Support.handleUploadImageLoad( this )" />'+("video"==i.type?'<span class="sqico-play" id="linfoplay"></span>':"")+"</div>":"")+(i.thumbnail_url?"":s(i))+'</div></div><div class="linfo_url"></div>'+(a?'<div class="linfo_msg">'+Markdown.apply(a,!0)+"</div>":"")))},setEvents:function(){var t=this.data,i=$("#linkinfo_"+this.data.id),a=i.find("#linfoplay");a.click(function(i){$(this).parent().replaceWith(s(t)),i.stopPropagation()}),i.click(function(){t.url&&window.open(t.url)}),t.autoplay&&t.thumbnail_url&&a.trigger("click")}},{init:function(i,t){var a=new n(i,t);a.render(),a.setEvents()}}}();var ZSIQRelPhrases=function(){var a=function(t,i){this.data=t.msglist,this.id=i,this.callback=t.callback,this.chatid=t.chatid,this.chatdiv=ZSIQTranscript.getChatWindowOBJ(this.chatid).chatdiv};return a.prototype={renderMessages:function(){var t=this.getMessageHtml(this.data);$Widget.attachHTML(t,!0),this.bindEvent(),ZSIQTranscript.scroll()},getMessageHtml:function(){for(var t=this.data.list,i='<div class="rel-phr-wrap mT5">'+(this.data.title?'<div class="font15 c333">'+this.data.title+"</div>":"")+"<div>",a=0;a<t.length;a++){var s=t[a],e=s.text||"";i+='<div class="phrase-list " prop = "relphrase" data-value ="'+e+'" '+("article"==s.type?'article-id = "'+s.id+'"':"")+'><em class="circle-dot"></em><div class="dib-mid"><span class="lH20">'+e+"</span></div></div>"}return i+="</div></div>"},bindEvent:function(){var t=this;this.chatdiv.find("div[prop=relphrase]").off("click.relphrase").on("click.relphrase",function(){$(this).attr("article-id")?$FAQ.showFAQPreview($(this)):t.chooseField(this)})},chooseField:function(t){var i=(t=$(t)).attr("data-value");this.callback({msg:i,id:this.id,element:t,config:this.userconfig,data_value:i,config:this.userconfig,type:"related_phrases",chatid:this.chatid})}},{init:function(t,i){($BotImpl.enableComposer(),t.msglist)?new a(t,i).renderMessages():t.callback("",i)}}}();var ZSIQCarousal=function(){var e=function(t,i){this.data=t.elements,this.title=t.title,this.sliderlength=this.data.length,this.subtitle=t.subtitle,this.actions=t.actions||{},this.id=i,this.curindex=0,this.chatid=t.chatid,this.chatdiv=ZSIQTranscript.getChatWindowOBJ(this.chatid).chatdiv,this.type=t.type,this.faddingtime=0};return e.prototype={populateLayout:function(){var t=$Widget.getLayout();t=(t=(t=t.replace(/{BOT_WIDGET}/g,this.getCarouselHtml(this.curindex))).replace(/{CLASSNAME}/g,"single-product")).replace(/{WIDGET_TYPE}/g,"display-card"),this.componentcontainer=$(t),this.componentcontainer.find(".cmpnt-desc").addClass("sugg_titl"),this.componentcontainer.find('[prop ="slidercont"]').css("width",310*this.sliderlength+"px"),"multiple-product"==this.type?this.updateDotsHtml():this.dotscontainer=this.componentcontainer.find('[prop="dotsparent"]'),this.updateSliderIndex(0),this.bindEvent(),t=this.componentcontainer.prop("outerHTML"),$Widget.attachHTML(t,!0,"carousel"),delete this.componentcontainer},getCarouselHtml:function(){var t=this.getTitleObj(this.curindex),i=(this.getLabelAndActionHtml(this.curindex),'<div prop = "carouselcontainer" class="parentwin mT20 '+("multiple-product"==this.type?" multi-carosuel":"")+'">');return"multiple-product"==this.type&&(i+='<div class="inner-par"><div prop ="slidercont" class="slidercont">'+this.getSliderHtml()+"</div></div>"+this.getArrowHtml()+'<div class="p20"><p class="c333 font18 sbold" prop = "title">'+t.title+'</p><div class="c888 mT10" prop = "subtitle">'+t.subtitle+'</div></div><div prop="actiondiv">'+this.getLabelAndActionHtml(this.curindex)+"</div>"),"single-product"==this.type&&(i+='<div class="sinl-prw"><div class="inner-par"><div prop="slidercont" class="slidercont">'+this.getSliderHtml()+"</div>"+this.getArrowHtml()+this.getDotsHtml()+'</div><div class="p20"><p class="c333 font18 sbold" prop = "title">'+t.title+'</p><div class="c333" prop="subtitle">'+t.subtitle+'</div></div></div><div class="sinl-prw-link mT10">'+this.getLabelAndActionHtml(this.curindex)),i+="</div>"},getArrowHtml:function(){return 1==this.sliderlength?"":'<em class="nav-arw sqico-larrow" prop="sqicolarrow"></em><em class="nav-arw sqico-rarrow" prop="sqicorarrow"></em>'},getDotsHtml:function(){if(1==this.sliderlength)return"";for(var t='<div class="hide-buble" prop="activedots"><div class="more-buble mT15" prop="dotsparent">',i=0;i<this.sliderlength;i++)t+='<em prop="activedots" index="'+i+'"></em>';return t+="</div></div>"},updateDotsHtml:function(){var t=this.getDotsHtml(),i=this.getComponentContainer();i.closest(".msgbx");i.append(t),this.dotscontainer=i.find('[prop="dotsparent"]')},getTitleObj:function(t){var i,e;if("single-product"==this.type&&(i=this.title,e=this.subtitle),"multiple-product"==this.type){var s=this.data[t]||{};i=s.title,e=s.subtitle}return{title:Message.trim(i)||"",subtitle:Message.trim(e)||""}},getLabelAndActionHtml:function(t){var i=this.type,e=!0,s="single-product"==i?this.actions:{};"multiple-product"==i&&(s=(this.data[t]||{}).actions||{},e=!1);return $Widget.getCtaHtml(s,e).replace(/{BINDEVENT}/g,"")},getSliderHtml:function(){for(var t=this.data,i=t.length,e='<div prop="imgslider" class="img-slider cloneend"><img src="'+t[i-1].image+'" class="siqcrd-img"></div>',s=0;s<i;s++)e+='<div prop="imgslider" class="img-slider"><img src="'+(t[s].image||"")+'" class="siqcrd-img"></div>';return e+='<div prop="imgslider" class="img-slider clonestart"><img src="'+t[0].image+'" class="siqcrd-img"></div>'},getNextElemIndex:function(){return this.curindex+1>=this.sliderlength?0:this.curindex+1},getPrevElemIndex:function(){return this.curindex-1<0?this.sliderlength-1:this.curindex-1},updateLabelAndTitle:function(){var e=this.getLabelAndActionHtml(this.curindex),s=this.getTitleObj(this.curindex);this.getComponentContainer().find('[prop="title"],[prop="subtitle"],[prop="actiondiv"]').fadeOut(this.faddingtime,function(){var t=this.getComponentContainer(),i=t.find('[prop="actiondiv"]');t.find('[prop="title"]').html(s.title),t.find('[prop="subtitle"]').html(s.subtitle),i.html(e),t.find('[prop="title"],[prop="subtitle"],[prop="actiondiv"]').fadeIn(this.faddingtime)}.bind(this))},updateSliderIndex:function(t,i){this.curindex=t;var e=this.getComponentContainer();return"multiple-product"==this.type&&this.updateLabelAndTitle(),0!=t||i||e.find('[prop = "slidercont"]').css("left","-310px"),"left"==i&&t==this.sliderlength-1?(e.find('[prop = "slidercont"]').css("left","0px"),this.resetSlider(310*this.sliderlength)):"right"==i&&0==t?(e.find('[prop = "slidercont"]').css("left","-"+310*(this.sliderlength+1)+"px"),this.resetSlider(310)):e.find('[prop = "slidercont"]').css("left","-"+310*(t+1)+"px"),void this.updateDotsIndex(i)},resetSlider:function(t){this.cloningprocess=!0,setTimeout(function(){this.getComponentContainer().find('[prop = "slidercont"]').addClass("notransition").css("left","-"+t+"px"),setTimeout(function(){this.cloningprocess=!1,this.getComponentContainer().find('[prop = "slidercont"]').removeClass("notransition")}.bind(this),50)}.bind(this),600)},updateDotsIndex:function(){this.sliderlength<=5||this.curindex<=3?this.setDotsFronView():4<this.sliderlength-this.curindex?this.setDotsMiddleView():this.setDotsEndView()},setDotsFronView:function(t){var i=this.dotscontainer;5<=this.sliderlength&&(i.css("left","0px"),i.parent().addClass("hidebuble-small"),this.setselectedDot(!0),i.find('[index="5"]').addClass("size2").siblings('[index="6"]').addClass("size1")),this.setselectedDot()},setDotsMiddleView:function(t){var i=this.dotscontainer;this.setselectedDot(!0),i.find('[index="'+(this.curindex-2)+'"]').addClass("size2").siblings('[index="'+(this.curindex-3)+'"]').addClass("size1").siblings('[index="'+(this.curindex+2)+'"]').addClass("size2").siblings('[index="'+(this.curindex+3)+'"]').addClass("size1"),this.setAndUpdateDotsPosition()},setDotsEndView:function(t){this.dotscontainer;this.setAndUpdateDotsPosition(),this.setselectedDot(!0),this.dotscontainer.find('[index="'+(this.sliderlength-6)+'"]').addClass("size2").siblings('[index="'+(this.sliderlength-7)+'"]').addClass("size1")},setAndUpdateDotsPosition:function(){var t=this.sliderlength-this.curindex<4?12*(this.sliderlength-7):12*(this.curindex+1-4);t&&this.dotscontainer.css("left","-"+t+"px")},setselectedDot:function(t){var i=this.dotscontainer;if(t)return i.find("em").removeClass("sel").removeClass("size2").removeClass("size1"),void i.find('[index="'+this.curindex+'"]').addClass("sel");i.find("em").removeClass("sel").siblings('[index="'+this.curindex+'"]').addClass("sel")},updateContainer:function(t){var i=t.attr("prop");"sqicorarrow"==i&&this.updateSliderIndex(this.getNextElemIndex(),"right"),"sqicolarrow"==i&&this.updateSliderIndex(this.getPrevElemIndex(),"left")},bindCtaEvent:function(){this.getComponentContainer().find('[prop="callback"]').off("click.carousel").on("click.carousel",function(){this.handleCustomAction($(event.target))}.bind(this))},bindEvent:function(){this.getComponentContainer();this.cloningprocess||$(this.chatdiv).off("click.carousel","#bot_widget"+this.id).on("click.carousel","#bot_widget"+this.id,function(t){this.handleEvents(t)}.bind(this))},handleDotsEvent:function(t){if(!this.cloningprocess){var i=t.attr("index"),e=this.curindex!=i&&this.curindex>i?"left":"right";i&&this.updateSliderIndex(JSON.parse(i),e)}},handleEvents:function(t){var i=$(t.target),e=i.attr("prop");this.checkAndUpdateWidgetContainer(),"sqicorarrow"==e||"sqicolarrow"==e?this.updateContainer(i):"activedots"==e?this.handleDotsEvent(i):"ctacontainer"!=e&&"callback"!=e||(i="callback"==e?i.closest('[prop="ctacontainer"]'):i,this.handleCustomAction(i))},checkAndUpdateWidgetContainer:function(){this.componentcontainer||(this.componentcontainer=this.chatdiv.find($("#cmpnt"+this.id)),this.dotscontainer=this.componentcontainer.closest(".msgbx").find('[prop="dotsparent"]'),this.faddingtime=350)},getComponentContainer:function(){return this.componentcontainer||this.checkAndUpdateWidgetContainer(),this.componentcontainer},handleCustomAction:function(t){var i=t.attr("data-val"),e=t.attr("name"),s=this.data[this.curindex].id;$Support.handleWidgetCustomAction(i,{name:e,element_id:s})}},{init:function(t,i){t.elements?new e(t,i).populateLayout():t.callback("",i)}}}();var ZSIQDropdown=function(){var t=function(e){this.data=e,this.standalonedropdown=e.standalonedropdown,this.ismultiselect=e.ismultiselect,this.deSelectCallback=e.deSelectCallback,this.maxlimit=e.maxlimit,this.numberofselection=0,this.selectcallback=e.callback||function(){},this.deselectcallback=e.deselectcallback||function(){}};return t.prototype={render:function(){this.populateList(),!this.standalonedropdown&&this.populateHeader(),this.populateOptionContainer(),this.header=this.data.element.find(".drop_hdr"),this.listdiv=this.data.element.find(".popup_list"),this.searchinput=this.data.element.find("#popupsearch"),this.setEvents(),this.standalonedropdown&&this.default_select&&this.listdiv.find('[data-key="'+this.default_select.key+'"]').trigger("click")},populateHeader:function(e){this.data.element.append('<div class="drop_hdr" id="dropdownheader"><span class="txtelips sbold" data-key="'+this.default_select.key+'">'+this.default_select.key+'</span><em class="sqico-darrow"></em></div>')},populateList:function(){var e="";for(var t in this.data.options){var i=this.data.options[t],a=i.key;e+='<div class="popup_li" data-key="'+a+'" data-val="'+i.val+'">'+i.val+"<em>"+(i.subval||"")+"</em></div>",a!=this.data.selected&&"true"!=i.selected||(this.default_select=i)}this.default_select=this.default_select||this.data.options[0];var s=this.default_select,l=this.standalonedropdown?"":'<div class="popup_li" id="selectedval" data-key="'+s.key+'">'+s.val+"<em>"+(s.subval||"")+"</em></div>",d='<div class="popup_list" id="dropdownlist"><div class="ppup_srcmain"><em class="sqico-search"></em><input type="text" id="popupsearch" placeholder="'+LSResource.getRealValue(this.data.placeholder)+'"><em class="sqico-close" puprose="closedropdown"></em></div><div class="mT10 popup_src_ul"><div class="curnt_val"><div class="c999 mL5">'+(LSResource.getRealValue(this.data.currentlist_header)||"")+"</div>"+l+'</div><div class="select_val"><div class="mB5 c999 mL5">'+(LSResource.getRealValue(this.data.list_header)||"")+"</div>"+e+"</div></div></div>";this.data.element.append(d)},populateOptionContainer:function(){this.data.optioncontainer&&this.data.optioncontainer.append(this.optionholder=$('<div prop="selvalues" class="cmpnt-optn-list"></div>'))},setEvents:function(){var a=this;this.header.on("click",function(e){a.clearSearch(),$(this).parent().find(".popup_list").toggle();var t=a.default_select;a.listdiv.find("#selectedval").attr("data-key",t.key).html(t.val+"<em>"+(t.subval||"")+"</em>"),$Clickoutside.bindclick(function(){a.listdiv.hide()},"dropdownlist","dropdownheader",!0,e),$("#popupsearch").focus()}),this.listdiv.on("click",function(e){var t=$(e.target);if($(e.target).hasClass("popup_li")){var i=t.attr("data-key");if(a.ismultiselect)return void a.handleMultiSelect(t);a.standalonedropdown&&a.addTickForSelection(a.listdiv.find("[data-key="+i+"]")),a.setSelectedObj(t.attr("data-key")),a.header.find(".txtelips").attr("data-key",a.default_select.key).text(a.default_select.key),a.listdiv.hide(),a.triggerCallBack({key:i,val:t.attr("data-val")},"select")}}),this.searchinput.on("keyup",function(){a.handleSearch()}),this.optionholder&&this.optionholder.on("click",function(e){var t=$(e.target);"deselect"==t.attr("prop")&&a.handleMultiSelect(t,!0)}),this.listdiv.find('[puprose="closedropdown"]').on("click",function(){a.listdiv.hide()})},handleMultiSelect:function(e,t){var i=e.hasClass("sel")||t?"deselect":"select";if(!(("deselect"!=i&&this.numberofselection+1)>this.maxlimit)){var a=e.attr("data-key"),s={key:a,val:e.attr("data-val")};this.updateSelectionInOptionHolder(s),this.toggleListClass(this.listdiv.find("[data-key="+a+"]")),this.triggerCallBack(s,i)}},toggleListClass:function(e){e.toggleClass("sel"),e.find("em").toggleClass("cmpnt-mul-optn sqico-tick")},triggerCallBack:function(e,t){({select:function(){this.numberofselection++,this.selectcallback(e)}.bind(this),deselect:function(){this.numberofselection--,this.deselectcallback(e)}.bind(this)})[t]()},addTickForSelection:function(e){var t=this.listdiv.find("[data-key="+this.default_select.key+"]");t.removeClass("sel"),t.find("em").removeClass("cmpnt-mul-optn sqico-tick"),e.addClass("sel"),e.find("em").addClass("cmpnt-mul-optn sqico-tick")},updateSelectionInOptionHolder:function(e){if(this.optionholder){var t=this.optionholder.find("[data-key="+e.key+"]");0<t.length?t.remove():this.optionholder.append('<div class="dropdownbtn" data-key="'+e.key+'">'+e.val+'<em class="sqico-close drpdownclose" title="Close" prop="deselect" data-key="'+e.key+'" data-val="'+e.val+'"></em></div>')}},setSelectedObj:function(e){for(var t in this.data.options)if(this.data.options[t].key==e){this.default_select=this.data.options[t];break}},handleSearch:function(){var t=this.searchinput.val().toLowerCase().replace(/ /g,""),e=this.listdiv;if(e.find(".popup_src_emty").remove(),t){e.find(".curnt_val").hide(),e.find(".select_val div").hide();var i=!1;e.find(".select_val").find(".popup_li").each(function(){var e=$(this);-1!=e.text().toLowerCase().replace(/ /g,"").indexOf(t)&&(e.show(),i=!0)}),i||this.handleEmpty()}else this.clearSearch()},clearSearch:function(){var e=this.listdiv;e.find(".curnt_val").show(),e.find(".select_val").show(),e.find(".select_val div").show(),e.find(".popup_src_emty").remove(),this.searchinput.val("")},handleEmpty:function(){var e=this.listdiv;e.find(".curnt_val").hide(),e.find(".select_val").hide(),e.find(".popup_src_ul").append('<div class="popup_src_emty"><div class="c666 lH20">'+LSResource.getRealValue("common.searchnotfound")+'</div><div class="lH20">â'+this.searchinput.val()+"â</div></div>")}},{init:function(e){new t(e).render()}}}();var Dropdowncreator=function(){var i=function(e,t){this.options=e.options,this.callback=e.callback,this.select_label=e.select_label,this.componentid=t,this.userconfig=e,this.chatid=e.chatid,this.contentdiv=ZSIQTranscript.getChatWindowOBJ(this.chatid).contentdiv,this.placeholder=e.placeholder,this.minselection=e.min_selection,this.maxselection=e.max_selection,this.allowmultiselect=e.multiple,this.selitemarr=[]};return i.prototype={populateDropDown:function(){var e=$Widget.getLayout();e=(e=(e=e.replace(/{BOT_WIDGET}/g,this.getInputHtml())).replace(/{CLASSNAME}/g,"botsselect")).replace(/{WIDGET_TYPE}/g,"input-card"),$Widget.attachHTML(e),this.dropdowncontainer=$("#bot_widget"+this.componentid),this.optioncontainer=this.dropdowncontainer.find('[prop="selvalues"]'),this.bindEvent(),this.handleDropDown()},getInputHtml:function(){return'<div class="field_main posrel teldrop sbold" field-type="dropdown" id="dropdownheader"><div id="sqico-cdrpdwn" class="dropdown mT15 sqico-drpdwn siq-dropdown zindrp drop_hdr" type="selectbox" ><a href="javascript:;" id="dropheader">'+(this.select_label||"")+'</a></div></div><div prop="optionholder"></div><div class="compnt-btn cur-non" id="cnfmsel" prop="saveval">'+LSResource.getRealValue("common.confirm")+"</div>"},handleDropDown:function(){var e=$("#bot_widget"+this.componentid);ZSIQDropdown.init({options:function(e){for(var t=e.length,i=[],n=0;n<t;n++){var o=e[n],l=o.selected?"true":"false";i.push({key:o.value,val:o.label,selected:l})}return i}(this.options),element:e.find('[field-type="dropdown"]'),placeholder:this.placeholder,callback:this.handleSelectItem.bind(this),chatid:this.chatid,placeholder:this.placeholder||LSResource.getRealValue("ne.message.choose"),standalonedropdown:!0,ismultiselect:this.allowmultiselect,deselectcallback:this.deSelectItem.bind(this),optioncontainer:e.find('[prop="optionholder"]'),maxlimit:this.maxselection})},bindEvent:function(){var e=this;this.dropdowncontainer.find('[prop="saveval"]').off("click.drpdwn").on("click.drpdwn",function(){e.handleConfirm(this)})},deSelectItem:function(t){this.selitemarr=this.selitemarr.filter(function(e){if(e.value!=t.key)return e}),this.selitemarr.length<this.minselection&&this.dropdowncontainer.find('[prop="saveval"]').removeClass("btn-enbl").addClass("cur-non")},handleConfirm:function(e){for(var t=[],i=this.selitemarr.length,n=0;n<i;n++)t.push(this.selitemarr[n].label);t=t.join(", "),this.callback({type:"drop-down",msg:t,id:this.componentid,value:this.selitemarr,element:this.dropdowncontainer,config:this.userconfig,chatid:this.chatid})},handleSelectItem:function(e){this.allowmultiselect?this.handleMultiSelectItem(e):(this.selitemarr=[{value:e.key,label:e.val}],this.enableSubmitButton(),this.dropdowncontainer.find("#dropheader").html(e.val))},handleMultiSelectItem:function(e){this.selitemarr.push({value:e.key,label:e.val}),this.selitemarr.length==this.minselection&&this.enableSubmitButton()},enableSubmitButton:function(){this.dropdowncontainer.find('[prop="saveval"]').addClass("btn-enbl").removeClass("cur-non")}},{init:function(e,t){e.options?new i(e,t).populateDropDown():e.callback("",t)}}}();var ZSIQFileUpload=function(){var f,p,m=[],u=function(){parent_window=$Widget.isPreview()?window:window.parent,p=parent_window.document.body},t=function(){var e=$Widget.getFileUploadHtml(f.label),i=$Widget.getLayout();i=(i=(i=i.replace(/{BOT_WIDGET}/g,e)).replace(/{CLASSNAME}/g,"bot-locatn")).replace(/{WIDGET_TYPE}/g,"input-card"),$Widget.attachHTML(i)},v=function(){$(p).find('[data-target="zsiqsendfiles"]').on("click",n),$(p).find('[data-target="zsiqattachment"]').on("change",function(e){ZSIQFileUpload.handleFileUpload(this,e)}),$(p).find('[data-target="close"]').on("click",e)},e=function(){$(p).find("#zsiqfileupload_body").remove(),m=[]},h=function(){var e=$(p),i=e.find("#zsiq-overlaymain"),t=e.find(".zsiq-filemain").length;i.removeClass("zsiq_flexM").removeClass("zsiq_hideclose"),t<=2&&i.addClass("zsiq_flexM"),1==t&&i.addClass("zsiq_hideclose")},g=function(e){if(!f)return!0;var i=e.name.split(".").pop();return-1!=f.allowed_formats.indexOf(i)},z=function(e,i){$(p).find("#zsiq-overlaymain").append('<div class="zsiqerrorpopup"><div class="zsiqerrorpopup_sub"><em></em><span>'+e+"</span></div></div>"),i&&setTimeout(function(){$(p).find(".zsiqerrorpopup").remove()},i)},q=function(){$(p).find(".zsiqfcount").text(m.length)},s=function(){$(p).find("#zsiqfileupload_body").remove(),m=[]},n=function(){if(0==$(p).find(".zsiq-errorcmt").length)if(f&&(m.length<f.min||m.length>f.max))z("Max file count reached. max file count is "+f.max);else{var e,i;if(f){e=$Support.getprefixURL()+"/visitor/v2/"+_SCREENNAME+"/conversations/"+ZSIQConversationManager.getcurrchatwinobj().visitorID+"/messages";var t=function(){for(var e=[],i={},t=0;t<m.length;t++){var a=m[t];e.push(a.file),i[a.file.name]={comment:a.comment||""}}return{files_array:e,comment_obj:i}}();return i={file:t.files_array,comments:JSON.stringify(t.comment_obj),session_id:LSMessanger.getSid(),att_type:"chat_attachment"},l(i,i,e),void s()}for(var a=0;a<m.length;a++){var n=m[a];i={file:n.file,client_message_id:(new Date).getTime()+a,timezone_offset:-1*(new Date).getTimezoneOffset()*6e4,session_id:LSMessanger.getSid(),uts_session_id:$Support.getParent().$UTSHandler.getUTSSID(),att_type:n.att_type||"chat_attachment"},m[a].comment&&(i.comment=n.comment),l(n,i,e)}s()}},l=function(e,t,i,a){var n,s,l=ZSIQConversationManager.getcurrchatwinobj(),o=e.file,r=t.client_message_id||(new Date).getTime(),d={progress:function(e,i){$UI.showUploadProgress({fileobj:o,prgval:e,msgid:i,comment:t.comment,att_type:t.att_type,reply_to:l.msgreply_to},l.chatID)},complete:function(e){f()},success:function(){f()}},c=l.msgreply_to?{replyurl:"/"+l.msgreply_to.msguid+"/reply"}:"";function f(){$UI.hideUploadProgress(r),$Support.Util.handleCallbacks("chat.file",{})}CommonUtil.v2handleFileUpload({callbacks:d,formdata:(n=t,s=new FormData,$.each(n,function(e,i){if(Array.isArray(i))for(var t=0;t<i.length;t++)s.append(e,i[t]);else s.append(e,i)}),s),type:o.type,msgid:r,url:i},c),delete l.msgreply_to},_=function(e,i){this.file=e,this.index=i,this.config=f,this.init()};return _.prototype={init:function(){this.populatePreview()},populatePreview:function(){var e='<div class="zsiq-filemain" data-index="'+this.index+'"><div class="zsiq-filename zsiq-elips" title="'+this.file.name+'">'+this.file.name+'</div><div class="zsiq-file-thub"> <em class="siqico-close"></em> </div><div class="zsiq-filecmtmain"><textarea placeholder="'+LSResource.getRealValue("common.comment.placeholder")+'"></textarea><span class="zsiq-filecmt-cunt"></span></div></div>';$(p).find(".zsiq-overlaymain").append(e),this.parent=$(p).find('[data-index="'+this.index+'"]'),this.handleEvents(),this.setPreview()},handleEvents:function(){var n=this,e=function(e){var i=$(e),t=i.val(),a=i.parent();a.removeClass("zsiq-errorcmt").find(".zsiq-filecmt-cunt").text(t.length+"/150"),150<t.length?a.addClass("zsiq-errorcmt"):m[n.index].comment=t};$(p).find('[data-index="'+this.index+'"]').find("textarea").on("keyup",function(){e(this)}).on("blur",function(){e(this)}).focus()},setPreview:function(){var e=this.file.type,i=this.parent.find(".zsiq-file-thub");if(-1!=e.indexOf("image/"))if(-1!=["image/svg+xml","image/heic","image/heif"].indexOf(e))i.append('<em class="zfile-ico siqico-img"></em>');else{var t=new FileReader;t.onload=function(e){i.append('<img src="'+e.target.result+'"/>')},t.readAsDataURL(this.file)}else{i.append('<em class="zfile-ico siqico-'+function(e){var i={doc:["doc","docx","odt","msword"],excel:["xls","xlsx","csv","ods"],powerpoint:["ppt","pptx","odp"],txt:["txt"],pdf:["pdf"],zip:["zip","rar"],exe:["ext","exe","bat"],img:["svg","tiff","raw","webp","ico","fav"],code:["html","js","java","css","less","xml","py","vim","json","jsp"],audiofile:["wav","mp3","aac","ogg"],videofile:["mp4","mov","avi","webm","mpg","3gp"]};for(var t in i)if(-1!=i[t].indexOf(e))return t;return"unfile"}(this.file.name.split(".").pop())+'"></em>')}i.find(".siqico-close").on("click",function(){var e=$(this).parents(".zsiq-filemain");m.splice(e.attr("data-index"),1),e.remove(),h()})}},{init:function(e,i){f=e,u(),t()},handleFileUpload:function(e,i){u();var t=$(e)[0],a=t.files;if(0!=a.length){if(!(52428800<function(e){for(var i=0,t=0;t<m.length;t++)i+=m[t].file.size;if(e)if(null!=$(e).attr("multiple")){var a=e.files.length;for(t=0;t<a;t++)i+=e.files[t].size}else i=e.files[0].size;return i}(t))){var n,s,l;!$(p).find("#zsiqfileupload_body").length&&(n=f?'(<span class="zsiqfcount">0</span>/'+f.max+")":"",s=f?'<span class="zsiq-sfiles siqico-help zsiq-flex">Supported Files</span>':"",l='<div class="zsiq-overlay" id="zsiqfileupload_body"><div class="cmpnt-cal-wrap"><div class="cmpnt-calndr"><em class="siqico-close" data-target="close"></em><header class="calndr-head"><span class="siqico-share zsiq-lH22 zsiq-flex_GS0">Share with '+getEscapedText(ZSIQConversationManager.getcurrchatwinobj().attendername)+n+'</span><div class="zsiq-fup">'+s+'<div class="calndr-sedulbtn zsiq-flex_GS0" data-target="zsiqsendfiles">Share</div></div></header><div class="zsiq-overlaymain" id="zsiq-overlaymain"></div><em class="siqico-plus zsiq_flexM"><input name="file1" type="file" data-target="zsiqattachment" multiple="" size="1" onclick="this.value="></em></div></div></div>',$(p).append(l),v());for(var o=[],r=0;r<a.length;r++){var d=a[r];g(d)?(new _(d,m.length),m.push({file:d}),q()):o.push(d.name)}return o.length&&z(o.join(", ")+"files are unsupported."),i.preventDefault(),h(),!1}var c=LSResource.getRealValue("filetransfer.file_size_greater","50MB");0==$(p).find("#zsiqfileupload_body").length?$UI.showBanner(c,!0):z(c,4e3)}},getFiles:function(){return m},handleVoicenoteUpload:function(e,i,t,a){m.push({file:i[0],att_type:t}),n()},closeFilePreview:e}}();PeerConnection=function(){var i,a=null,o=null,c=null,r=0,s={getScreenShareConstrains:function(){return window.webkitRTCPeerConnection&&navigator.mediaDevices&&void 0===navigator.mediaDevices.getDisplayMedia?{audio:!1,video:{mandatory:{chromeMediaSource:"desktop"}}}:window.webkitRTCPeerConnection?{audio:!1,video:!0}:{audio:!1,video:{mediaSource:"screen"}}},setcredential:function(e,n){return s.initConnection(e,n).connectionId},initConnection:function(e,n){return e=t(e,n)},getUserMedia:function(){return navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||null},checkScreenExtensionNeeded:function(e){if("SCREEN_SHARE"===e&&window.webkitRTCPeerConnection&&void 0===navigator.mediaDevices.getDisplayMedia)return window.addEventListener("message",function(e){s._screenShareExtnSuccsess(e)}),void MediaConnection.sendPostMessageToExtn("zoho_cliq_extn_check")},_screenShareExtnSuccsess:function(e){if(e.data.message&&"ZOHOCLIQ-EXTN-CHECK"===e.data.message.type)!0,s.getExtensionScreenId();else if(e.data.message&&"ZOHOCLIQ-SCEEN-SOURCE-ID"===e.data.message.type){var n=e.data.message.data;d.constraints.SCREEN_SHARE.video.mandatory.chromeMediaSourceId=n,mediaApi=s.getUserMedia(),navigator.mediaDevices.getUserMedia(d.constraints.SCREEN_SHARE).then(function(e){s.addLocalStream(e,"SCREEN_SHARE",i)}).catch(function(e){s.mediafailure(e)})}},getExtensionScreenId:function(){MediaConnection.sendPostMessageToExtn("zoho_cliq_get_screen_sourceId")},checkMediaPermission:function(e,n){var t=e;if(i=n,mediaApi=s.getUserMedia(),window.webkitRTCPeerConnection?window.RTCPeerConnection=webkitRTCPeerConnection:window.mozRTCPeerConnection&&(window.RTCPeerConnection=mozRTCPeerConnection),window.$Temp&&"AUDIO"==e&&(r=setTimeout(function(){$(window.parent.document).find("body").append($Temp.getMediaSetting(avimpl.getCurrentBrowerName())),clearTimeout(r)},1500)),e!=d.screenshare.toUpperCase()||void 0!==navigator.mediaDevices.getDisplayMedia)return mediaApi||e==d.screenshare.toUpperCase()?e==d.screenshare.toUpperCase()&&void 0!==navigator.mediaDevices.getDisplayMedia?(null!=typeof navigator.mediaDevices.getDisplayMedia?navigator.mediaDevices.getDisplayMedia(d.constraints[e]).then(function(e){s.addLocalStream(e,t,n)}).catch(function(e){s.mediafailure(e,!0,t)}):navigator.mediaDevices.getUserMedia(d.constraints[e]).then(function(e){s.addLocalStream(e,t,n)}).catch(function(e){s.mediafailure(e,!0,t)}),!0):void mediaApi.call(navigator,d.constraints[e],function(e){s.addLocalStream(e,t,n)},function(e){s.mediafailure(e,!0,t)}):(navigator.mediaDevices.getUserMedia(d.constraints[e]).then(function(e){s.addLocalStream(e,t,n)}).catch(function(e){mediafailure(e,!0,t)}),!1);s.checkScreenExtensionNeeded(e)},addLocalStream:function(e,n,t){clearTimeout(r),"AUDIO"==n?a=e:"SCREEN_SHARE"==n?(o=e).getVideoTracks()[0].onended=function(){MediaConnection.endConnection("screen_share")}:"VIDEO"==n&&(c=e),window.$Temp&&avimpl.closeViewMediaPermission(),"SCREEN_SHARE"==n&&ZSIQMedia.isAlreadyShared()?s.closeLocalStream("screen_share"):MediaConnection.initiateConnection(n,t)},mediafailure:function(e,n,t){switch(window.$Temp&&"AUDIO"==t&&(clearTimeout(r),avimpl.closeViewMediaPermission()),e.name){case"NotFoundError":case"DevicesNotFoundError":message=LSResource.getRealValue("av.info.microphone.notavailable");break;case"SourceUnavailableError":case"PermissionDeniedError":case"SecurityError":case"NotAllowedError":default:message=LSResource.getRealValue("av.info.microphone.blocked")}"NotAllowedError"==e.name&&window.$Temp&&"AUDIO"==t&&$(window.parent.document).find("body").append($Temp.getAskMediaPermission(avimpl.getCurrentBrowerName())),0==n&&"AUDIO"==t&&(LSDebugger.postDebugInfo("Audio Call reject by - peerconnection chatid "+i,null,null,!0),avimpl.rejectCallInvite(i,null)),window.$Temp&&n&&"AUDIO"==t&&avimpl.clear(),"AUDIO"==t&&avimpl.checkMediaPermission(message,i),"SCREEN_SHARE"==t&&ZSIQMedia.isInvite()&&ZSIQMedia.screenShareReject(),LSDebugger.postDebugInfo("Audio Call - Inside Filure media permission | PeerConnection ",null,null,!0)},closeLocalStream:function(e){"audio"==e?(a&&s.closeTracksInStream(a),o&&s.closeTracksInStream(o)):"screen_share"==e&&o&&s.closeTracksInStream(o)},closeTracksInStream:function(e){var n=e.getTracks();for(var t in n)n[t].stop()}},d={incoming:1,outgoing:2,connected:3,reconnect:4,onhold:5,accepted:6,agent:"agent",visitor:"visitor",screenshare:"screen_share",sdpConstraints:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}},constraints:{AUDIO:{audio:!0,video:!1},VIDEO:{audio:!0,video:!0},SCREEN_SHARE:s.getScreenShareConstrains(),SCREEN_VIEW:{audio:!0,video:!1}}},t=function(e,n){this.chatid=e.chatid;var t=JSON.parse(e.credentials),i=new l(e.chatid,e.id,e.type,n,t.user_name,t.servers,t.token);return"AUDIO"==i._type&&(i._localStream=a),MediaConnection.addNewPeerConnection(i.referenceId,i),i},l=function(e,n,t,i,a,o,c){this.referenceId=e,this._connectionId=Math.floor(1e9*Math.random()),this._mediaId=n,this._type=t.toUpperCase(),this._localSdp=null,this._remoteSdp=null,this._isUpStream=i,this._localStream=null,this._isReconnecting=!1,this._callstatus=null,this._localIceCandidates=null,this._remoteIceCandidates=null,this._credential=c,this._userName=a,this._turnServer=o,this._mediaApi=null,this._browser=null,this._remoteCandidatePushed=!1,this._connection=null,this._reconnectInterval=null};return l.prototype={_getConfiguration:function(){var e=this._turnServer.split(","),n=this._userName,t=this._credential,i=[];return e.forEach(function(e){i.push({urls:e,username:n,credential:t})}),{iceServers:i}},_requestStream:function(e){if(this._isReconnecting)this._setRemoteDescription(e);else{this._mediaApi=s.getUserMedia();var n=this;if(n.mediaObj=e,window.webkitRTCPeerConnection?(this._browser="Chrome",window.RTCPeerConnection=webkitRTCPeerConnection):window.mozRTCPeerConnection&&(avaction.callObj.hostbrowser="Firefox",window.RTCPeerConnection=mozRTCPeerConnection),window.$Temp&&"AUDIO"==this._type&&(r=setTimeout(function(){$(window.parent.document).find("body").append($Temp.getMediaSetting(avimpl.getCurrentBrowerName())),clearTimeout(r)},1500)),!this._mediaApi&&this._type!=d.screenshare.toUpperCase())return navigator.mediaDevices.getUserMedia(d.constraints[this._type]).then(function(e){n._localStream=e,MediaConnection.replacePeerConnection(n.referenceId,n),n._isUpStream||(n.initRTCConn(!1),n._setRemoteDescription(n.mediaObj))}).catch(function(e){s.mediafailure(e,n._isUpStream,n._type)}),!1;this._type!=d.screenshare.toUpperCase()?this._mediaApi.call(navigator,d.constraints[this._type],function(e){n._localStream=e,MediaConnection.replacePeerConnection(n.referenceId,n),n._isUpStream||(n.initRTCConn(!1),n._setRemoteDescription(n.mediaObj))},function(e){s.mediafailure(e,n._isUpStream,n._type)}):n._isUpStream?null!=typeof navigator.mediaDevices.getDisplayMedia?navigator.mediaDevices.getDisplayMedia(d.constraints[this._type]).then(function(e){n._localStream=e,MediaConnection.replacePeerConnection(n.referenceId,n)}).catch(function(e){s.mediafailure(e,n._isUpStream,n._type)}):navigator.mediaDevices.getUserMedia(d.constraints[this._type]).then(function(e){n._localStream=e,MediaConnection.replacePeerConnection(n.referenceId,n)}).catch(function(e){s.mediafailure(e,n._isUpStream,n._type)}):(MediaConnection.addNewPeerConnection(n.referenceId,n),n.initRTCConn(!1),n._setRemoteDescription(n.mediaObj))}},initRTCConn:function(e){window.$Temp&&"AUDIO"==this._type&&(clearTimeout(r),avimpl.closeViewMediaPermission()),this._isUpStream?e||("AUDIO"==this._type?this._localStream=a:"SCREEN_SHARE"==this._type?this._localStream=o:"VIDEO"==this._type&&(this._localStream=c),this._connection=new RTCPeerConnection(this._getConfiguration()),MediaConnection.replacePeerConnection(this.referenceId,this),this._createOffer(!1)):this._connection=new RTCPeerConnection(this._getConfiguration()),"AUDIO"==this._type&&avimpl.addAudioElemts(this._localStream,this._type),this._getRemoteStream(this)},_createOffer:function(e){e&&(d.sdpConstraints.iceRestart=!0);var n=this._connection,t=this;e||(t._streamData=t._localStream.getTracks().forEach(function(e){"function"==typeof t._connection.addTrack?t._connection.addTrack(e,t._localStream):t._connection.addStream(t._localStream)})),n.createOffer(d.sdpConstraints).then(function(e){t._localSdp=e,t._connection.setLocalDescription(e),MediaConnection.replacePeerConnection(t.referenceId,t),MediaConnection.sendOffer(e,t._type),t._createIceCandidate(),t._connection.onicecandidate=function(e){t._localIceCandidates.push(e),MediaConnection.sendCandidate(e,t._type)},t._chekConnectionStatus(t)})},_createIceCandidate:function(){var n=this;n._localIceCandidates=[],n._connection.onicecandidate=function(e){n._localIceCandidates.push(e),MediaConnection.sendCandidate(e,n._type)}},_setRemoteDescription:function(e){var n=e.session;this._remoteSdp=n;var t=this;t._isUpStream||"AUDIO"!=t._type||(t._streamData?t._localStream.getTracks().forEach(function(e){t._streamData.replaceTrack(e)}):t._localStream.getTracks().forEach(function(e){"function"==typeof t._connection.addTrack?t._streamData=t._connection.addTrack(e,t._localStream):t._connection.addStream(t._localStream)})),t._connection.setRemoteDescription(new RTCSessionDescription(JSON.parse(n))),t._reconnectInterval&&(clearTimeout(t._reconnectInterval),t._reconnectInterval=null),t._isUpStream||t._connection.createAnswer(d.sdpConstraints).then(function(e){t._localSdp=e,t._connection.setLocalDescription(new RTCSessionDescription(e)),MediaConnection.replacePeerConnection(t.referenceId,t),MediaConnection.sendAnswer(e,t._type),t._createIceCandidate(),t._chekConnectionStatus(t),t._remoteCandidatePushed||t._pushIceCandidate()}),t._remoteCandidatePushed||t._pushIceCandidate()},_pushIceCandidate:function(){if(this._remoteIceCandidates&&0<this._remoteIceCandidates.length){for(var e in this._remoteIceCandidates){var n=this._remoteIceCandidates[e],t=new RTCIceCandidate({sdpMid:n.id,sdpMLineIndex:n.label,candidate:n.candidate});this._connection.addIceCandidate(t)}this._remoteCandidatePushed=!0}},_setIceCandidate:function(e){var n;if(n=e.candidates?JSON.parse(e.candidates):JSON.parse(e.msg.candidate),this._remoteSdp&&this._localSdp){this._remoteIceCandidates&&0<this._remoteIceCandidates.length&&!this._remoteCandidatePushed&&this._pushIceCandidate();var t=new RTCIceCandidate({sdpMid:n.id,sdpMLineIndex:n.label,candidate:n.candidate});this._connection.addIceCandidate(t)}else this._remoteIceCandidates&&0<this._remoteIceCandidates.length||(this._remoteIceCandidates=[]),this._remoteIceCandidates.push(n)},_chekConnectionStatus:function(t){t._connection.oniceconnectionstatechange=function(e){var n=t._connection.iceConnectionState;"connected"==n?((0==avimpl.reconcount||t._isReconnecting)&&avaction.callObj.sendConnectionStatus("callconnected"),avaction.callObj.sendStats(null,"call connected"),t._callstatus="connected",t._isReconnecting=!1,"AUDIO"==t._type&&avimpl.callConnected(e,t.referenceId),ZSIQMedia.clearNetworkTimer(),avaction.callObj.webrtcStatus=1):"disconnected"==n?(t._callstatus="disconnected","AUDIO"==t._type&&avimpl.showReconnect()):"failed"==n&&(t._callstatus="failed",t._remoteIceCandidates=[],t._remoteCandidatePushed=!1,t._remoteSdp=null,t._isReconnecting=!0,ZSIQMedia.checkNetwork(t.referenceId,t._mediaId))},t._connection.onconnectionstatechange=function(e){"failed"==t._connection.connectionState&&(t._callstatus="failed",t._remoteIceCandidates=[],t._remoteCandidatePushed=!1,t._remoteSdp=null,t._isReconnecting=!0,ZSIQMedia.checkNetwork(t.referenceId,t._mediaId))}},_initReconnect:function(){if(this._isReconnecting=!0,this._isUpStream){var e=this;this._reconnectInterval=setInterval(function(){e._createOffer(!0)},1e4)}},_getRemoteStream:function(e){var n=e;n._connection.onaddstream=n._connection.ontrack=function(e){avimpl.addremotestream(e,n)}}},{setcredential:s.setcredential,setRemoteDescription:s.setRemoteDescription,checkMediaPermission:s.checkMediaPermission,screenShareExtnSuccsess:s._screenShareExtnSuccsess,closeLocalStream:s.closeLocalStream}}();MediaAction=function(){var a={getObject:function(e){return"undefined"==typeof AgentCall||"agent"!==e.msg.media.mode||e.msg.media.visitoraccess?avimpl:AgentCall},init:function(e){ZSIQMedia.handleMediaUI(e),avaction.callObj=a.getObject(e);var n,t=e.msg,i=t.media;("credential"!==e.msg.cbtype&&"call_credential"!==t.operation||MediaConnection.setcredential(i,!0),"invite"!==e.msg.cbtype&&"call_initiate"!==t.operation||("audio"==i.type&&avimpl.showInvitation(i),(i.credentials||e.msg.credential)&&MediaConnection.setcredential(i,!1),n="added credential data and invitation successfully"),"accept"===e.msg.status||"call_accept"===t.operation)&&("function"==typeof MediaConnection.setActiveMediaId&&MediaConnection.setActiveMediaId(i.id),MediaConnection.getPeerConnectionObj(i.chatid,i.id).initRTCConn(!1),avaction.callObj.acceptedTime=Date.now());("reject"!==e.msg.cbtype&&"call_reject"!==t.operation||("audio"==t.type&&("function"==typeof avaction.callObj.showRejectedBanner&&avaction.callObj.showRejectedBanner(i),"function"==typeof avaction.callObj.handleUserBusy&&avaction.callObj.handleUserBusy(),MediaConnection.closePeerConnection(i.chatid,i.id),MediaConnection.clearPeerConnectionObj(i.chatid,i.id)),avaction.callObj.sendStats(e)),"candidate"===e.msg.cbtype||"call_candidates"===t.operation)&&MediaConnection.getPeerConnectionObj(i.chatid,i.id)._setIceCandidate(i);"answer"!==e.msg.cbtype&&"call_answer"!==t.operation||MediaConnection.getPeerConnectionObj(i.chatid,i.id)._setRemoteDescription(i);("end"===e.msg.status||t.operation,"offer"===e.msg.cbtype||"call_offer"===t.operation)&&MediaConnection.getPeerConnectionObj(i.chatid,i.id)._requestStream(i);"cancel"!==e.msg.cbtype&&"call_cancel"!==t.operation&&"miss"!==e.msg.cbtype&&"call_miss"!==t.operation||(MediaConnection.closePeerConnection(i.chatid,i.id),MediaConnection.clearPeerConnectionObj(i.chatid,i.id)),"invite"===e.msg.cbtype||t.operation,avaction.callObj.sendStats(e,n)}};return{init:a.init}}();MediaConnection=function(){var c,i="",r={setActiveMediaId:function(e){e},addAvObj:function(e){var n=e.chatid,t=e.id,a=e.mode;r.setAvObj(n,{media_id:t,mode:a,peerconnections:[]})},setAvObj:function(e,n){c||(c={}),c[e]=n},getAvObj:function(e){if(!c)return{};if(!e)return c;var n=c[e];return n||{}},replacePeerConnection:function(e,n){if(c){var t=[],a=c[e].peerconnections;for(var o in a){var i=a[o];i._mediaId==n._mediaId&&(i=n),t.push(i)}r.updateAvObj(e,t)}},addNewPeerConnection:function(e,n){if(c){var t=c[e],a=t.peerconnections;a||(a=t.peerconnections=[]),a.push(n),r.updateAvObj(e,a)}},updateAvObj:function(e,n){var t=c[e],a=t.media_id,o=t.mode;r.setAvObj(e,{media_id:a,mode:o,peerconnections:n})},getPeerConnectionObj:function(e,n){if(c){var t=c[e].peerconnections;for(var a in t){var o=t[a];if(o._mediaId==n)return o}}},clearAvMediaObj:function(e){var n=c;n&&(delete n[e],c=n)},clearPeerConnectionObj:function(e,n){if(c){var t=c[e].peerconnections;for(var a in t){t[a]._mediaId==n&&t.splice(a,1)}r.updateAvObj(e,t)}},setCredential:function(e,n){var t=r.getAvObj(e.chatid);0==Object.keys(t).length&&r.addAvObj(e),PeerConnection.setcredential(e,n)},sendOffer:function(e,n){var t={};t.session=CommonUtil.toJSON(e),t.type=n.toLowerCase();var a=ZSIQMedia.getCurrentMedia(t.type);i=a.connectionid,d._handleAjax("offer",t)},sendAnswer:function(e,n){var t={};t.session=CommonUtil.toJSON(e),t.type=n.toLowerCase();var a=ZSIQMedia.getCurrentMedia(t.type);i=a.connectionid,d._handleAjax("answer",t)},sendCandidate:function(e,n){var t={};if(e.candidate){t.label=e.candidate.sdpMLineIndex,t.type="candidate",t.id=e.candidate.sdpMid,t.candidate=e.candidate.candidate,candstring=CommonUtil.toJSON(t);var a={};a.candidates=candstring,a.type=n.toLowerCase();var o=ZSIQMedia.getCurrentMedia(a.type);i=o.connectionid,d._handleAjax("candidates",a)}},acceptCallInvite:function(e){var n=ZSIQMedia.getCurrentMedia(e);i=n.connectionid;var t={};t.type=e,d._handleAjax("accept",t)},endConnection:function(e,n){var t={},a=ZSIQMedia.getCurrentMedia(e);t.type=e,i=a.connectionid,r.closePeerConnection(a.chatid,i),r.clearPeerConnectionObj(a.chatid,i),d._handleAjax("end",t,function(){ZSIQMedia.handleEndConnection(e)}),"audio"==t.type&&r.clearAvMediaObj(a.chatid)},terminateConnection:function(e,n){var t={},a=ZSIQMedia.getCurrentMedia(e);t.type=e,i=a.connectionid,"reject"!=n&&"cancel"!=n||"audio"!=e||(r.closePeerConnection(a.chatid,i),r.clearPeerConnectionObj(a.chatid,i)),d._handleAjax(n,t),"audio"==t.type&&r.clearAvMediaObj(a.chatid)},initiateConnection:function(e,n){var t=ZSIQConversationManager.getChatWinObjById(n),a={};a.type=e.toLowerCase(),a.chatid=n,a.mode="visitor",a.wmsid=$Support.EmbedObj.vwmsid,a.lsuid=t.attender,a.lsid=$Support.getParent().$ZSIQWidget.getWidgetObject().lsid,avimpl.active=!0,"AUDIO"==e?d._handleAjax(null,a,avimpl.startCallSuccessCallBack):d._handleAjax(null,a)},showObj:function(){return c},toggleMute:function(e,n){if(c){var t=c[e].peerconnections;for(var a in t){var o=t[a];o._mediaId==n&&o._localStream&&(o._localStream.getAudioTracks()[0].enabled=!o._localStream.getAudioTracks()[0].enabled)}}},closePeerConnection:function(e,n){if(c){var t=c[e].peerconnections;for(var a in t){var o=t[a];o._mediaId==n&&(o._reconnectInterval&&clearTimeout(o._reconnectInterval),o._connection&&o._connection.close(),o._localStream&&r.closeTracksInStream(o._localStream),o._remoteStream&&r.closeTracksInStream(peeConn._remoteStream),PeerConnection.closeLocalStream(o._type.toLowerCase()))}r.checkAndClearScreenShareConnection(e)}},closeTracksInStream:function(e){var n=e.getTracks();for(var t in n)n[t].stop()},callReqInvite:function(e){var n={};n.type=e;var t=ZSIQMedia.getCurrentMedia("audio");i=t.connectionid,actiontype="invite",d._handleAjax(actiontype,n)},getPeerConnection:function(e,n){if(c){var t=c[e].peerconnections;for(var a in t){var o=t[a];if(o._mediaId==n)return o._connection}}},checkScreenExtensionNeeded:function(e){if("SCREEN_SHARE"===e&&window.webkitRTCPeerConnection&&void 0===navigator.mediaDevices.getDisplayMedia)return window.addEventListener("message",function(e){e.data.message&&"ZOHOCLIQ-GET-SCREEN-SOURCEID"===e.data.message.type&&(avimpl.screen_id=e.data.message.data,avaction.constraints.SCREEN_SHARE.video.mandatory.chromeMediaSourceId=avimpl.screen_id)}),void window.postMessage({requestId:"zoho_cliq_get_screen_sourceId",message:"ZOHOCLIQ-GET-SCREEN-SOURCEID"},"*")},sendPostMessageToExtn:function(e){"zoho_cliq_extn_check"==e?parent.postMessage({requestId:"zoho_cliq_extn_check",message:"ZOHOCLIQ-EXTN-CHECK"},"*"):"zoho_cliq_get_screen_sourceId"==e&&parent.postMessage({requestId:"zoho_cliq_get_screen_sourceId",message:"ZOHOCLIQ-GET-SCREEN-SOURCEID"},"*")},initReconnect:function(e,n){if(c){var t=c[e].peerconnections;for(var a in avimpl.reconnecttime=avimpl.starttime,t){var o=t[a];o._mediaId==n&&o._initReconnect()}}},checkAndClearScreenShareConnection:function(e){if(c){var n=c[e].peerconnections;for(var t in n){var a=n[t];a&&"SCREEN_SHARE"==a._type&&(a._connection&&a._connection.close(),a._localStream&&r.closeTracksInStream(a._localStream),a._remoteStream&&r.closeTracksInStream(peeConn._remoteStream),a._reconnectInterval&&clearInterval(a._reconnectInterval),PeerConnection.closeLocalStream(a._type.toLowerCase()),a._reconnectInterval&&clearTimeout(a._reconnectInterval))}}}},d={_handleAjax:function(e,n,t){var a=_SCHEMA+"://"+_EMBEDSERVERURL+"/visitor/v2/"+_SCREENNAME+"/media";e&&(a+="/"+i+"/"+e),$.ajax({url:a,type:"POST",data:n,dataType:"json",success:function(e){t&&t(e)}})}};return{addAvObj:r.addAvObj,replacePeerConnection:r.replacePeerConnection,addNewPeerConnection:r.addNewPeerConnection,getPeerConnectionObj:r.getPeerConnectionObj,setcredential:r.setCredential,avMediaObj:r.avMediaObj,sendOffer:r.sendOffer,sendAnswer:r.sendAnswer,sendCandidate:r.sendCandidate,setActiveMediaId:r.setActiveMediaId,acceptCallInvite:r.acceptCallInvite,handleAjax:d._handleAjax,initiateConnection:r.initiateConnection,showObj:r.showObj,clearPeerConnectionObj:r.clearPeerConnectionObj,toggleMute:r.toggleMute,checkScreenExtensionNeeded:r.checkScreenExtensionNeeded,sendPostMessageToExtn:r.sendPostMessageToExtn,callReqInvite:r.callReqInvite,terminateConnection:r.terminateConnection,endConnection:r.endConnection,initReconnect:r.initReconnect,closePeerConnection:r.closePeerConnection,clearAvMediaObj:r.clearAvMediaObj}}();var ZSIQMedia=function(){var t={},e=0,n=0,i="audio",c="screen_share",o=!1,a=!1,r=function(e,n){return n=n||"",LSResource.getRealValue(e,n)},s=function(){try{if($Support.getChatID())return!0}catch(e){return!1}},d=function(){return s()?$(parent.document.body):$("body")},l=function(e,n,i){t[e]={chatid:n,connectionid:i}},u=function(e){e.type==i&&("function"==typeof avimpl.showRejectedBanner&&avimpl.showRejectedBanner(e),"function"==typeof avimpl.handleUserBusy&&avimpl.handleUserBusy()),o=!1},p=function(e){e.type==c&&avimpl.toggleScreenShareLogo(),s()&&e.type==c&&avimpl.setAvScreenShareId(e.id)},f=function(e){avimpl.clear(e.chatid)},m=function(e){l(e.type,e.chatid,e.id),e.type==c&&avimpl.toggleScreenShareLogo(),a=o=!1,s()&&e.type==c&&avimpl.setAvScreenShareId(e.id)},h=function(e){MediaConnection.closePeerConnection(e.chatid,e.id),MediaConnection.clearPeerConnectionObj(e.chatid,e.id),e.type==c?_():e.type==i&&(avimpl.endCall(),MediaConnection.clearAvMediaObj(),_(),v("screen_share")),v(e.type)},v=function(e){t[e]="",o=!1,y()},_=function(){d().find(".zsiq_video_main").remove(),avimpl.showCallDiv()},C=function(e){avimpl.clear(e.chatid)},S=function(e){e.type==c&&(avimpl.active=!0,e.mediaInvitation?g(e):(l(e.type,e.chatid,e.id),MediaConnection.acceptCallInvite(c))),e.type==i&&(avimpl.active=!0,l(e.type,e.chatid,e.id)),s()&&l(e.type,e.chatid,e.id)},g=function(e){e.type==c&&(l(e.type,e.chatid,e.id),q(e),a=!0)},q=function(e){if(!d().find(".zsiq_popup").length){var n='<div class="zsiq_popup" id="zsiqssconfirmbox"><div class="zsiq_popupsub"><em class="siqico-close zsiq_center"></em><em class="siqico-screenshare zsiq_popuplogo"></em><div class="zsiq_popup_hdr">'+r("common.screenshare")+'</div><div class="zsiq_popup_desc">'+r("screenshare.request.desc",s()?$Support.EmbedObj.attendername:avimpl.getVisitorName())+'</div><div class="zsiq_popup_btn zsiq_center"><span class="zsiq_center" id="zsiqconfirmss">'+r("common.share")+'</span><span class="zsiq_center zsiq_cancelbtn" id="zsiqdecliness">'+r("common.decline")+"</span></div></div></div>",i=d();i.append(n),i.find("#zsiqconfirmss").on("click",function(){I(),y()}),i.find("#zsiqdecliness").on("click",M),i.find(".zsiq_popup").find(".siqico-close").on("click",M)}},y=function(){d().find(".zsiq_popup").remove()},M=function(){MediaConnection.terminateConnection(c,"reject"),v("screen_share"),a=!1},z=function(){MediaConnection.endConnection(c),d().find(".zsiq_video_main").remove(),avimpl.showCallDiv()},I=function(e){if(o)$UI.updateStatus(r("screenshare.requested.errormsg"),5e3,!0);else{var n=s()?$EmbedManger.getChatID():t.audio.chatid;PeerConnection.checkMediaPermission(c.toUpperCase(),n),e&&e.parent().hide()}},w=function(n,i){setTimeout(function(){var e=document.createElement("IMG");e.src=getStaticURL("/salesiq/images/spacer_592ebefc7104d681d57852665e9ad514_.gif")+"?nocache="+(new Date).getTime(),e.onload=function(){MediaConnection.initReconnect(n,i)},e.onerror=function(){w(n,i)}},2e3),e||(e=setTimeout(function(){avimpl.stopOngoingCall()},3e4)),avimpl.showReconnect()};return{init:function(e,n){PeerConnection.checkMediaPermission(e.toUpperCase(),n)},handleMediaUI:function(e){var n={credential:function(e){},call_credential:function(e){l(e.type,e.chatid,e.id)},answer:function(e){},call_answer:function(e){},reject:u,call_reject:u,offer:p,call_offer:p,invite:g,call_initiate:S,accept:m,call_accept:m,end:h,call_end:h,cancel:f,call_cancel:f,miss:C,call_miss:C,call_invite:g},i=e.msg.cbtype||e.msg.operation;n[i]&&n[i](e.msg.media)},handleMediaErrorCallBack:function(e){},endCall:function(){t.screen_share&&z()},endScreenShare:z,acceptScreenShare:function(){MediaConnection.acceptCallInvite(c),ZSIQVideo.init()},getCurrentMedia:function(e){return t[e]},requestScreenShare:function(e){e&&e.parent().hide(),o?$UI.updateStatus(r("screenshare.requested.errormsg"),5e3,!0):(MediaConnection.callReqInvite(c),o=!0)},shareMyScreen:I,setCurrentMedia:l,isEmbed:s,getBody:d,checkNetwork:w,clearNetworkTimer:function(){clearTimeout(e),e=0},isScreenShareAllowed:function(){var e=window.navigator.userAgent;if(-1!=e.indexOf("MSIE ")||-1!=e.indexOf("Safari")&&-1==e.indexOf("Chrome"))return!1;if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB10|IEMobile|Opera Mini/i.test(e))return!1;try{if(!s()&&/Apple Safari|Microsoft Edge|Microsoft Internet Explorer/i.test(avimpl.details[Visitors.getCUIDFromCHID(ZSIQMedia.getCurrentMedia("audio").chatid)].BROWSER))return!1}catch(e){}return CommonUtil.isScreenSharingAllowed()},handleEndConnection:function(e){v(e),e==c&&avimpl.changeScreenShareIcon()},showVideoIcons:function(){clearTimeout(n);var e=d().find(".zsiq_video_main");e.length&&(e.removeClass("zsiq_showcntl").addClass("zsiq_showcntl"),n=setTimeout(function(){e.removeClass("zsiq_showcntl")},1500))},toggleMute:function(){var e=t[i];MediaConnection.toggleMute(e.chatid,e.connectionid)},clearUI:y,isScreenShareRequested:function(){return o},screenShareReject:M,isAlreadyShared:function(){return t.screen_share&&!a},isInvite:function(){return a},isOnbeforeUnload:function(){return!!t[c]}}}();var ZSIQMedia=function(){var t={},e=0,n=0,i="audio",c="screen_share",o=!1,a=!1,r=function(e,n){return n=n||"",LSResource.getRealValue(e,n)},s=function(){try{if($Support.getChatID())return!0}catch(e){return!1}},d=function(){return s()?$(parent.document.body):$("body")},l=function(e,n,i){t[e]={chatid:n,connectionid:i}},u=function(e){e.type==i&&("function"==typeof avimpl.showRejectedBanner&&avimpl.showRejectedBanner(e),"function"==typeof avimpl.handleUserBusy&&avimpl.handleUserBusy()),o=!1},p=function(e){e.type==c&&avimpl.toggleScreenShareLogo(),s()&&e.type==c&&avimpl.setAvScreenShareId(e.id)},f=function(e){avimpl.clear(e.chatid)},m=function(e){l(e.type,e.chatid,e.id),e.type==c&&avimpl.toggleScreenShareLogo(),a=o=!1,s()&&e.type==c&&avimpl.setAvScreenShareId(e.id)},h=function(e){MediaConnection.closePeerConnection(e.chatid,e.id),MediaConnection.clearPeerConnectionObj(e.chatid,e.id),e.type==c?_():e.type==i&&(avimpl.endCall(),MediaConnection.clearAvMediaObj(),_(),v("screen_share")),v(e.type)},v=function(e){t[e]="",o=!1,y()},_=function(){d().find(".zsiq_video_main").remove(),avimpl.showCallDiv()},C=function(e){avimpl.clear(e.chatid)},S=function(e){e.type==c&&(avimpl.active=!0,e.mediaInvitation?g(e):(l(e.type,e.chatid,e.id),MediaConnection.acceptCallInvite(c))),e.type==i&&(avimpl.active=!0,l(e.type,e.chatid,e.id)),s()&&l(e.type,e.chatid,e.id)},g=function(e){e.type==c&&(l(e.type,e.chatid,e.id),q(e),a=!0)},q=function(e){if(!d().find(".zsiq_popup").length){var n='<div class="zsiq_popup" id="zsiqssconfirmbox"><div class="zsiq_popupsub"><em class="siqico-close zsiq_center"></em><em class="siqico-screenshare zsiq_popuplogo"></em><div class="zsiq_popup_hdr">'+r("common.screenshare")+'</div><div class="zsiq_popup_desc">'+r("screenshare.request.desc",s()?$Support.EmbedObj.attendername:avimpl.getVisitorName())+'</div><div class="zsiq_popup_btn zsiq_center"><span class="zsiq_center" id="zsiqconfirmss">'+r("common.share")+'</span><span class="zsiq_center zsiq_cancelbtn" id="zsiqdecliness">'+r("common.decline")+"</span></div></div></div>",i=d();i.append(n),i.find("#zsiqconfirmss").on("click",function(){I(),y()}),i.find("#zsiqdecliness").on("click",M),i.find(".zsiq_popup").find(".siqico-close").on("click",M)}},y=function(){d().find(".zsiq_popup").remove()},M=function(){MediaConnection.terminateConnection(c,"reject"),v("screen_share"),a=!1},z=function(){MediaConnection.endConnection(c),d().find(".zsiq_video_main").remove(),avimpl.showCallDiv()},I=function(e){if(o)$UI.updateStatus(r("screenshare.requested.errormsg"),5e3,!0);else{var n=s()?$EmbedManger.getChatID():t.audio.chatid;PeerConnection.checkMediaPermission(c.toUpperCase(),n),e&&e.parent().hide()}},w=function(n,i){setTimeout(function(){var e=document.createElement("IMG");e.src=getStaticURL("/salesiq/images/spacer_592ebefc7104d681d57852665e9ad514_.gif")+"?nocache="+(new Date).getTime(),e.onload=function(){MediaConnection.initReconnect(n,i)},e.onerror=function(){w(n,i)}},2e3),e||(e=setTimeout(function(){avimpl.stopOngoingCall()},3e4)),avimpl.showReconnect()};return{init:function(e,n){PeerConnection.checkMediaPermission(e.toUpperCase(),n)},handleMediaUI:function(e){var n={credential:function(e){},call_credential:function(e){l(e.type,e.chatid,e.id)},answer:function(e){},call_answer:function(e){},reject:u,call_reject:u,offer:p,call_offer:p,invite:g,call_initiate:S,accept:m,call_accept:m,end:h,call_end:h,cancel:f,call_cancel:f,miss:C,call_miss:C,call_invite:g},i=e.msg.cbtype||e.msg.operation;n[i]&&n[i](e.msg.media)},handleMediaErrorCallBack:function(e){},endCall:function(){t.screen_share&&z()},endScreenShare:z,acceptScreenShare:function(){MediaConnection.acceptCallInvite(c),ZSIQVideo.init()},getCurrentMedia:function(e){return t[e]},requestScreenShare:function(e){e&&e.parent().hide(),o?$UI.updateStatus(r("screenshare.requested.errormsg"),5e3,!0):(MediaConnection.callReqInvite(c),o=!0)},shareMyScreen:I,setCurrentMedia:l,isEmbed:s,getBody:d,checkNetwork:w,clearNetworkTimer:function(){clearTimeout(e),e=0},isScreenShareAllowed:function(){var e=window.navigator.userAgent;if(-1!=e.indexOf("MSIE ")||-1!=e.indexOf("Safari")&&-1==e.indexOf("Chrome"))return!1;if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB10|IEMobile|Opera Mini/i.test(e))return!1;try{if(!s()&&/Apple Safari|Microsoft Edge|Microsoft Internet Explorer/i.test(avimpl.details[Visitors.getCUIDFromCHID(ZSIQMedia.getCurrentMedia("audio").chatid)].BROWSER))return!1}catch(e){}return CommonUtil.isScreenSharingAllowed()},handleEndConnection:function(e){v(e),e==c&&avimpl.changeScreenShareIcon()},showVideoIcons:function(){clearTimeout(n);var e=d().find(".zsiq_video_main");e.length&&(e.removeClass("zsiq_showcntl").addClass("zsiq_showcntl"),n=setTimeout(function(){e.removeClass("zsiq_showcntl")},1500))},toggleMute:function(){var e=t[i];MediaConnection.toggleMute(e.chatid,e.connectionid)},clearUI:y,isScreenShareRequested:function(){return o},screenShareReject:M,isAlreadyShared:function(){return t.screen_share&&!a},isInvite:function(){return a},isOnbeforeUnload:function(){return!!t[c]}}}();var ZSIQAudio=function(){var t=function(e,i){this.data=e,this.fileObj=e.file,this.playerDiv="",this.fileName=getEscapedText(e.file.fName||e.file.name),this.fileType=e.msg.content,this.fileSize=getMemSize(e.file.size),this.embedObj=$Support.EmbedObj,this.msgId=e.file.msgid||"",this.fileId=e.msgId||e.file.fileId||Date.now(),this.fileURL=s(e),this.fileComment=$.trim(e.file.comment)?'<code proptype="filecomment">'+getEscapedText(e.file.comment)+(e.is_edited?' <span proptype="edited">('+LSResource.getRealValue("common.edited")+")</span>":"")+"</code>":"",this.isFileComment=this.fileComment?" imgcmt":"",this.downLoadURL=n(e,i)},s=function(e){if(e.file.purl)return e.file.purl;var i=$Support.getParent().$ZSIQWidget.getEmbedObject().pinfo.soid,t=$Support.EmbedObj.livelsid,s={"x-siq-filetype":e.msg.content,"x-siq-cuid":t,"x-siq-pfname":e.file.fName||e.file.name,"x-siq-url":e.file.url,mode:"view",file_size:e.file.size,"x-siq-soid":i,"x-siq-downloadtype":"proactivechats"};return $Support.getParent().$ZSIQChat.getWidgetData().commondata.downloadserver+"/public?x-service=LiveDesk&event-id="+Date.now()+"&x-cli-msg="+encodeURIComponent(JSON.stringify(s))},n=function(e,i){var t=e.convvisitorid,s=e.file,n=getEscapedText(e.file.fName||e.file.name),a=$Support.EmbedObj,o=i||s.chatid,l=$Support.getAjaxURL("download",".ls");return l+="?fsize="+s.size+"&url="+escape(s.url)+"&fName="+encodeURIComponent(n),l+=t?"&visitorid="+t+"&chid="+e.convchid+"&isconversation=true":a?"&chid="+o+"&wmsid="+a.vwmsid:"&chid="+o,s.purl?s.purl:l};return t.prototype={getHTML:function(){return function(){return['<div class="siq-voice-audio'+this.isFileComment+'" data-ftype="'+this.fileType+'" msgid="'+this.msgId+'" data-audioid="'+this.fileId+'" data-filesize="'+this.fileSize+'" id="'+this.fileId+'" proptype="voiceplayer">','<span class="siq-vcname elips" title="'+this.fileName+'">'+this.fileName+"</span>",'<div class="flexC mT18">','<span class="siq-voice-control sqico-play mR15" title="'+LSResource.getRealValue("av.info.play")+'"></span>','<div class="range posrel">','<span class="range-path" id="range-body posrel">','<span id="slider-val" class="range-val"></span>','<span class="range-handle" id="player_thumb" ></span>',"</span>",'<div class="range-point-wrp">','<span id="sqico-played-duration">00:00</span>','<span id="sqico-total-duration">00:00</span>',"</div>","</div>",'<a target="_blank"  href="'+this.downLoadURL+'" ><span class="sqico-dwnld" title="'+LSResource.getRealValue("common.download")+'"></span></a>','<audio src="'+this.fileURL+'"/>',"</div>","</div>"+Smiley.replace(this.fileComment)].join("")}.call(this)},init:function(){this.assignDOMVariables(),this.setEvents(),this.isPaused=!0},assignDOMVariables:function(){var e=$('[id="'+this.fileId+'"]');this.$elem=e,this.slider=this.$elem.find(".range-path"),this.player=e.find("audio")[0],this.seekCircle=e.find("#player_thumb")},setEvents:function(){this.$elem.find(".siq-voice-control").on("click",this.togglePlayBack.bind(this)),this.slider.on("mousedown",this.seekMouseDown.bind(this));var e=$(this.player);e.on("timeupdate",this.timerUpdate.bind(this)),e.on("durationchange",this.handleDurationChange.bind(this)),e.on("ended",this.pausePlayer.bind(this))},togglePlayBack:function(){window.currentAudioElement&&this.isPaused&&window.currentAudioElement.pause(),window.currentRecorder&&window.currentRecorder.isRecording()&&window.currentRecorder.stopRecorder(),this.player[this.isPaused?"play":"pause"](),this.isPaused=!this.isPaused,!this.isPaused&&(window.currentAudioElement=this),this.toggleClasses()},pausePlayer:function(){this.isPaused=!0,this.toggleClasses()},pause:function(){this.isPaused||(this.isPaused=!0,this.player.pause(),this.toggleClasses())},toggleClasses:function(){var e=this.$elem.find(".siq-voice-control");e.toggleClass("sqico-play").toggleClass("sqico-pause"),e.hasClass("sqico-play")?e.attr("title",LSResource.getRealValue("av.info.play")):e.attr("title",LSResource.getRealValue("av.info.pause"))},getOffsetX:function(e){var i=e.target,t=e.offsetX,s=this.seekCircle[0];return s&&s.contains(i)&&(t+=i.offsetLeft),t},seekMouseDown:function(e){e.preventDefault();var i=this.getOffsetX(e);this.setSeekPercentage(i),this.seekMouseMove=this.seekMouseMove.bind(this),this.mouseUp=this.mouseUp.bind(this),this.slider.on("mousemove",this.seekMouseMove),this.$elem&&this.$elem.on("mouseup",this.mouseUp)},mouseUp:function(e){e.preventDefault(),this.slider.off("mousemove",this.seekMouseMove),this.$elem&&this.$elem.off("mouseup",this.mouseUp)},seekMouseMove:function(e){e.preventDefault();var i=this.getOffsetX(e);this.setSeekPercentage(i)},setSeekPercentage:function(e){var i=this.getSliderWidth(e,this.slider[0]);this.paintSeekBarWidth(i);var t=this.player.duration;t&&(this.player.currentTime=t*(i/100),this.timerUpdate())},getSliderWidth:function(e,i){var t=e/i.clientWidth*100;return 100<t?100:t<0?0:t},paintSeekBarWidth:function(e){this.$elem.find("#slider-val").css("width",e+"%"),this.$elem.find("#player_thumb").css("left",e+"%")},timerUpdate:function(){if($Support.isConversationUIFocussed())return this.pause();this.paintSeekBarWidth(this.getSeekPercentage()),this.$elem.find("#sqico-played-duration").text(this.secondsToMinutes(this.player.currentTime))},handleDurationChange:function(){var e=this.player.duration;this.$elem.find("#sqico-total-duration").text(this.secondsToMinutes(e))},getSeekPercentage:function(){var e=this.player.currentTime,i=this.player.duration;return(100*parseFloat(e/i)).toFixed(2)},secondsToMinutes:function(e){if("Infinity"!=e)return new Date(1e3*e).toISOString().substr(14,5)}},{init:function(e,i){try{return new t(e,i)}catch(e){}}}}();